---
sidebar_title: 'Анализ запросов'
slug: /cloud/get-started/query-insights
description: 'Визуализируйте данные system.query_log для упрощения отладки запросов и оптимизации производительности'
keywords: ['анализ запросов', 'журнал запросов', 'интерфейс журнала запросов', 'анализ system.query_log']
title: 'Анализ запросов'
---

import Image from '@theme/IdealImage';
import insights_overview from '@site/static/images/cloud/sqlconsole/insights_overview.png';
import insights_latency from '@site/static/images/cloud/sqlconsole/insights_latency.png';
import insights_recent from '@site/static/images/cloud/sqlconsole/insights_recent.png';
import insights_drilldown from '@site/static/images/cloud/sqlconsole/insights_drilldown.png';
import insights_query_info from '@site/static/images/cloud/sqlconsole/insights_query_info.png';


# Анализ запросов

Функция **Анализ запросов** упрощает использование встроенного журнала запросов ClickHouse с помощью различных визуализаций и таблиц. Таблица `system.query_log` ClickHouse является ключевым источником информации для оптимизации запросов, отладки и мониторинга общего состояния и производительности кластера.

## Обзор запросов {#query-overview}

После выбора сервиса элемент навигации **Мониторинг** в левой боковой панели должен расшириться, чтобы показать новый подпункт **Анализ запросов**. Нажатие на этот пункт открывает новую страницу Анализа запросов:

<Image img={insights_overview} size="md" alt="Обзор интерфейса анализа запросов" border/>

## Метрики верхнего уровня {#top-level-metrics}

Статистические блоки в верхней части представляют собой базовые метрики запросов верхнего уровня за выбранный период времени. Под ними представлены три графика временных рядов, отображающих объем запросов, задержку и уровень ошибок, разбитые по типам запросов (выбор, вставка, другие) за выбранный временной интервал. График задержки также можно дополнительно настроить для отображения p50, p90 и p99 задержек:

<Image img={insights_latency} size="md" alt="График задержки интерфейса анализа запросов" border/>

## Недавние запросы {#recent-queries}

Под метриками верхнего уровня таблица отображает записи журнала запросов (сгруппированные по нормализованному хешу запроса и пользователю) за выбранный временной интервал:

<Image img={insights_recent} size="md" alt="Таблица недавних запросов интерфейса анализа запросов" border/>

Недавние запросы можно фильтровать и сортировать по любому доступному полю. Таблицу также можно настроить для отображения или скрытия дополнительных полей, таких как таблицы, задержки p90 и p99.

## Глубинный анализ запроса {#query-drill-down}

Выбор запроса из таблицы недавних запросов откроет выдвижное окно, содержащее метрики и информацию, специфичные для выбранного запроса:

<Image img={insights_drilldown} size="md" alt="Глубинный анализ запроса интерфейса анализа запросов" border/>

Как видно из выдвижного окна, этот конкретный запрос был выполнен более 3000 раз за последние 24 часа. Все метрики на вкладке **Информация о запросе** являются агрегированными метриками, но мы также можем просмотреть метрики отдельных запусков, выбрав вкладку **История запросов**:

<Image img={insights_query_info} size="sm" alt="Информация о запросе интерфейса анализа запросов" border/>

<br />

Из этой панели можно развернуть элементы `Настройки` и `События профилирования` для каждого выполнения запроса, чтобы получить дополнительную информацию.
