---
slug: /ja/sql-reference/functions/overview
sidebar_position: 1
sidebar_label: 概要
---

# 定常関数

少なくとも\* 2種類の関数があります - 定常関数（単に「関数」と呼ばれます）と集約関数です。これらは全く異なる概念です。定常関数は、各行に対して個別に適用されるかのように動作します（各行について、関数の結果は他の行に依存しません）。集約関数は、さまざまな行からの値の集合を蓄積します（つまり、それらは全ての行の集合に依存します）。

このセクションでは、定常関数について説明します。集約関数については、「集約関数」セクションを参照してください。

:::note 
第三のタイプの関数があり、それは['arrayJoin'関数](../functions/array-join.md)に該当します。また、[テーブル関数](../table-functions/index.md)も別に言及できます。
:::

## 強い型 {#strong-typing}

標準SQLとは対照的に、ClickHouseは強い型を持っています。言い換えれば、型間の暗黙の変換を行いません。各関数は特定の型のセットに対して動作します。これは、時には型変換関数を使用する必要があることを意味します。

## 共通部分式の削除 {#common-subexpression-elimination}

クエリ内のすべての式は、同じAST（同じレコードまたは同じ構文解析結果）を持つものは同一の値を持つとみなされます。そのような式は結合され、一度だけ実行されます。同一のサブクエリもこの方法で削除されます。

## 結果の型 {#types-of-results}

すべての関数は、結果として単一の値を返します（複数の値やゼロの値ではありません）。結果の型は通常、引数の型によって定義され、値によっては定義されません。例外は、tupleElement関数（a.N演算子）、およびtoFixedString関数です。

## 定数 {#constants}

簡単のために、特定の関数は一部の引数に対してのみ定数で動作することがあります。例えば、LIKE演算子の右側の引数は定数でなければなりません。
ほぼすべての関数は、定数引数に対して定数を返します。例外は、乱数を生成する関数です。
'now'関数は、異なる時間に実行されたクエリに対して異なる値を返しますが、その結果は定数と見なされます。なぜなら、一貫性は単一のクエリ内でのみ重要だからです。
定数式も定数と見なされます（例えば、LIKE演算子の右側は複数の定数から構成されることができます）。

関数は、定数引数と非定数引数に対して異なる方法で実装されることがあります（異なるコードが実行されます）。ただし、定数と、同じ値のみを含む真のカラムの結果は一致する必要があります。

## NULLの処理 {#null-processing}

関数は次のように振る舞います：

- 関数の引数のうち少なくとも1つが `NULL` の場合、関数の結果も `NULL` です。
- 特別な動作は、各関数の説明に個別に指定されています。ClickHouseのソースコードでは、これらの関数に `UseDefaultImplementationForNulls=false` が設定されています。

## 一貫性 {#constancy}

関数は引数の値を変更することはできません - 変更は結果として返されます。したがって、個別の関数の計算結果は、クエリ内で関数が記述される順序には依存しません。

## 高階関数、`->` 演算子と lambda(params, expr) 関数 {#higher-order-functions---operator-and-lambdaparams-expr-function}

高階関数は、関数的引数としてラムダ関数のみを受け取ることができます。高階関数にラムダ関数を渡すには `->` 演算子を使用します。矢印の左側には形式的なパラメータがあり、これは任意のID、または複数の形式的パラメータ（タプル内の任意のID）です。矢印の右側には、これらの形式的パラメータおよび任意のテーブルカラムを使用できる式があります。

例：

```The correct language is `python`.
x -> 2 * x
str -> str != Referer
```

複数の引数を受け取るラムダ関数も高階関数に渡すことができます。この場合、高階関数には、これらの引数に対して対応する同じ長さの配列がいくつか渡されます。

一部の関数では、最初の引数（ラムダ関数）を省略することができます。この場合、同一のマッピングが想定されます。

## ユーザー定義関数 (UDFs) {#user-defined-functions-udfs}

ClickHouseはユーザー定義関数をサポートしています。詳細は[UDFs](../functions/udf.md)を参照してください。
