---
description: 'Документация для функции оконного метода leadInFrame'
sidebar_label: 'leadInFrame'
sidebar_position: 10
slug: /sql-reference/window-functions/leadInFrame
title: 'leadInFrame'
---


# leadInFrame

Возвращает значение, вычисленное на строке, которая смещена на заданное количество строк после текущей строки в упорядоченной рамке.

:::warning
Поведение `leadInFrame` отличается от стандартной функции оконного метода SQL `lead`.
Функция оконного метода ClickHouse `leadInFrame` уважает рамки окна.
Чтобы получить поведение, идентичное `lead`, используйте `ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING`.
:::

**Синтаксис**

```sql
leadInFrame(x[, offset[, default]])
  OVER ([[PARTITION BY grouping_column] [ORDER BY sorting_column]
        [ROWS or RANGE expression_to_bound_rows_withing_the_group]] | [window_name])
FROM table_name
WINDOW window_name as ([[PARTITION BY grouping_column] [ORDER BY sorting_column])
```

Для получения более подробной информации о синтаксисе функций оконного метода смотрите: [Функции оконного метода - Синтаксис](./index.md/#syntax).

**Параметры**
- `x` — Имя столбца.
- `offset` — Смещение для применения. [(U)Int*](../data-types/int-uint.md). (Необязательный - по умолчанию `1`).
- `default` — Значение, которое будет возвращено, если вычисленная строка превышает границы окна. (Необязательный - значение по умолчанию типа столбца, если пропущено).

**Возвращаемое значение**

- значение, вычисленное на строке, которая смещена на заданное количество строк после текущей строки в упорядоченной рамке.

**Пример**

Этот пример рассматривает [исторические данные](https://www.kaggle.com/datasets/sazidthe1/nobel-prize-data) о лауреатах Нобелевской премии и использует функцию `leadInFrame`, чтобы вернуть список последовательных лауреатов в категории физики.

Запрос:

```sql
CREATE OR REPLACE VIEW nobel_prize_laureates
AS SELECT *
FROM file('nobel_laureates_data.csv');
```

```sql
SELECT
    fullName,
    leadInFrame(year, 1, year) OVER (PARTITION BY category ORDER BY year ASC
      ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
    ) AS year,
    category,
    motivation
FROM nobel_prize_laureates
WHERE category = 'physics'
ORDER BY year DESC
LIMIT 9
```

Результат:

```response
   ┌─fullName─────────┬─year─┬─category─┬─motivation─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
1. │ Anne L Huillier  │ 2023 │ physics  │ за экспериментальные методы, которые генерируют атаосекундные импульсы света для изучения динамики электронов в веществе                     │
2. │ Pierre Agostini  │ 2023 │ physics  │ за экспериментальные методы, которые генерируют атаосекундные импульсы света для изучения динамики электронов в веществе                     │
3. │ Ferenc Krausz    │ 2023 │ physics  │ за экспериментальные методы, которые генерируют атаосекундные импульсы света для изучения динамики электронов в веществе                     │
4. │ Alain Aspect     │ 2022 │ physics  │ за эксперименты с запутанными фотонами, устанавливающие нарушение неравенств Белла и пионерскую работу в области квантовой информации │
5. │ Anton Zeilinger  │ 2022 │ physics  │ за эксперименты с запутанными фотонами, устанавливающие нарушение неравенств Белла и пионерскую работу в области квантовой информации │
6. │ John Clauser     │ 2022 │ physics  │ за эксперименты с запутанными фотонами, устанавливающие нарушение неравенств Белла и пионерскую работу в области квантовой информации │
7. │ Giorgio Parisi   │ 2021 │ physics  │ за открытие взаимодействия беспорядка и колебаний в физических системах от атомного до планетарного масштаба                │
8. │ Klaus Hasselmann │ 2021 │ physics  │ за физическое моделирование климата Земли, количественную оценку изменчивости и надежное прогнозирование глобального потепления                        │
9. │ Syukuro Manabe   │ 2021 │ physics  │ за физическое моделирование климата Земли, количественную оценку изменчивости и надежное прогнозирование глобального потепления                        │
   └──────────────────┴──────┴──────────┴────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```
