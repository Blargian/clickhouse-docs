---
'description': 'Documentation for Clickhouse Obfuscator'
'slug': '/operations/utilities/clickhouse-obfuscator'
'title': 'clickhouse-obfuscator'
---



一个简单的表数据混淆工具。

它读取输入表并生成输出表，该输出表保留输入的一些属性，但包含不同的数据。
它允许发布几乎真实的生产数据用于基准测试。

它旨在保留以下数据属性：
- 每一列和每一组列的值的基数（不同值的数量）；
- 条件基数：在另一个列的值条件下一个列的不同值的数量；
- 整数的绝对值的概率分布；有符号整数的符号；浮点数的指数和符号；
- 字符串长度的概率分布；
- 数字的零值的概率；空字符串和数组，`NULL`s；

- 使用LZ77和熵编码家族编码时的数据压缩比；
- 表中时间值的连续性（差异的大小）；浮点值的连续性；
- `DateTime`值的日期部分；

- 字符串值的UTF-8有效性；
- 字符串值看起来自然。

上述大部分属性在性能测试中是可行的：

读取数据、过滤、聚合和排序的速度几乎与原始数据相同，因为保留了基数、数值范围、压缩比等。

它以确定性的方式工作：您定义一个种子值，转换由输入数据和种子决定。
某些转换是一对一且可以逆转，因此您需要拥有一个大的种子并将其保密。

它使用一些加密原语来转换数据，但从加密的角度来看，它并没有做到这一点，因此您不应将结果视为安全，除非您有其他理由。结果可能保留您不想发布的一些数据。

它始终将0、1、-1数字、日期、数组长度和空标志保留与源数据完全相同。
例如，您在表中有一个 `IsMobile` 列，其值为0和1。在转换后的数据中，它将具有相同的值。

因此，用户将能够计算移动流量的确切比率。

让我们举另一个例子。当您的表中有一些私人数据，如用户电子邮件，并且您不想发布任何单个电子邮件地址。如果您的表足够大且包含多个不同的电子邮件，并且没有电子邮件的频率明显高于其他电子邮件，那么它将对所有数据进行匿名处理。但如果您在某一列中有少数不同的值，它可能会重现其中的一些。
您应该查看该工具的工作算法，并微调其命令行参数。

该工具仅在至少有适度数据量（至少1000行）时效果良好。
