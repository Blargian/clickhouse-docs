---
sidebar_label: 'Аутентификация в облаке'
slug: /cloud/security/cloud-authentication
title: 'Аутентификация в облаке'
description: 'Это руководство объясняет некоторые хорошие практики для настройки вашей аутентификации.'
---

import ScalePlanFeatureBadge from '@theme/badges/ScalePlanFeatureBadge'
import EnterprisePlanFeatureBadge from '@theme/badges/EnterprisePlanFeatureBadge'


# Аутентификация в облаке

ClickHouse Cloud предоставляет несколько способов аутентификации. Это руководство объясняет некоторые хорошие практики для настройки вашей аутентификации. Всегда проконсультируйтесь с вашей командой безопасности при выборе методов аутентификации.

## Настройки пароля {#password-settings}

Минимальные настройки пароля для нашей консоли и сервисов (баз данных) в настоящее время соответствуют требованиям [NIST 800-63B](https://pages.nist.gov/800-63-3/sp800-63b.html#sec4) Уровня уверенности в аутентификаторе 1:
- Минимум 12 символов
- Включает 3 из следующих 4 элементов:
   - 1 заглавная буква
   - 1 строчная буква
   - 1 цифра
   - 1 специальный символ

## Email + Пароль {#email--password}

ClickHouse Cloud позволяет вам аутентифицироваться с помощью адреса электронной почты и пароля. При использовании этого метода лучший способ защитить вашу учетную запись ClickHouse - использовать надежный пароль. Существует множество онлайн-ресурсов, которые помогут вам придумать запоминающийся пароль. Кроме того, вы можете использовать генератор случайных паролей и хранить свой пароль в менеджере паролей для повышения безопасности.

## SSO с использованием Google или Microsoft Social Authentication {#sso-using-google-or-microsoft-social-authentication}

Если ваша компания использует Google Workspace или Microsoft 365, вы можете использовать текущую настройку единого входа (SSO) в ClickHouse Cloud. Для этого просто зарегистрируйтесь, используя корпоративный адрес электронной почты, и приглашайте других пользователей, используя их корпоративные адреса. Таким образом, ваши пользователи должны войти в систему, используя потоки авторизации вашей компании, будь то через вашего провайдера удостоверений или напрямую через аутентификацию Google или Microsoft, прежде чем они смогут аутентифицироваться в ClickHouse Cloud.

## Многофакторная аутентификация {#multi-factor-authentication}

Пользователи с Email + Пароль или социальным методом аутентификации могут дополнительно защитить свою учетную запись с помощью многофакторной аутентификации (MFA). Чтобы настроить MFA:
1. Войдите в console.clickhouse.cloud
2. Нажмите на свои инициалы в верхнем левом углу рядом с логотипом ClickHouse
3. Выберите Профиль
4. Выберите Безопасность слева
5. Нажмите Настроить в блоке приложения-аутентификатора
6. Используйте приложение-аутентификатор, такое как Authy, 1Password или Google Authenticator, чтобы сканировать QR-код
7. Введите код для подтверждения
8. На следующем экране скопируйте код восстановления и сохраните его в безопасном месте
9. Установите галочку рядом с `Я безопасно сохранил этот код`
10. Нажмите Продолжить

## Восстановление учетной записи {#account-recovery}

<details> 
   <summary>Получить код восстановления</summary>

   Если вы ранее подключились к MFA и не создали или потеряли код восстановления, выполните следующие шаги, чтобы получить новый код восстановления:
   1. Перейдите на https://console.clickhouse.cloud
   2. Войдите с вашими учетными данными и MFA
   3. Перейдите в свой профиль в верхнем левом углу
   4. Нажмите Безопасность слева
   5. Нажмите на корзину рядом с вашим приложением-автентификатором
   6. Нажмите Удалить приложение-автентификатор
   7. Введите ваш код и нажмите Продолжить
   8. Нажмите Настроить в разделе приложения-автентификатора
   9. Сканируйте QR-код и введите новый код
   10. Скопируйте ваш код восстановления и сохраните его в безопасном месте
   11. Установите галочку рядом с `Я безопасно сохранил этот код`
   12. Нажмите Продолжить
   
</details>
<details>
   <summary>Забыли пароль</summary>

   Если вы забыли свой пароль, выполните следующие шаги для самостоятельного восстановления:
   1. Перейдите на https://console.clickhouse.cloud
   2. Введите свой адрес электронной почты и нажмите Продолжить
   3. Нажмите Забыли свой пароль?
   4. Нажмите Отправить ссылку на сброс пароля
   5. Проверьте свою электронную почту и нажмите Сбросить пароль из письма
   6. Введите новый пароль, подтвердите пароль и нажмите Обновить пароль
   7. Нажмите Назад к входу
   8. Войдите в систему, используя ваш новый пароль
            
</details>
<details>
   <summary>Потерянное устройство или токен MFA</summary>

   Если вы потеряли устройство MFA или удалили свой токен, выполните следующие шаги, чтобы восстановить и создать новый токен:
   1. Перейдите на https://console.clickhouse.cloud
   2. Введите ваши учетные данные и нажмите Продолжить
   3. На экране многофакторной аутентификации нажмите Отмена
   4. Нажмите Код восстановления
   5. Введите код и нажмите Продолжить
   6. Скопируйте новый код восстановления и сохраните его в безопасном месте
   7. Установите галочку рядом с `Я безопасно сохранил этот код` и нажмите Продолжить
   8. После входа в систему перейдите в свой профиль в верхнем левом углу
   9. Нажмите на безопасность в верхнем левом углу
   10. Нажмите на значок корзины рядом с приложением-автентификатором, чтобы удалить ваш старый автентификатор
   11. Нажмите Удалить приложение-автентификатор
   12. Когда будет предложено ввести вашу многофакторную аутентификацию, нажмите Отмена
   13. Нажмите Код восстановления
   14. Введите ваш код восстановления (это новый код, созданный на шаге 7) и нажмите Продолжить
   15. Скопируйте новый код восстановления и сохраните его в безопасном месте - это страховка на случай, если вы покинете экран во время процесса удаления
   16. Установите галочку рядом с `Я безопасно сохранил этот код` и нажмите Продолжить
   17. Следуйте процессу выше, чтобы настроить новый фактор MFA
       
</details>
<details>
   <summary>Потерянное устройство MFA и код восстановления</summary>

   Если вы потеряли устройство MFA И код восстановления или вы потеряли устройство MFA и никогда не получали код восстановления, выполните следующие шаги, чтобы запросить сброс:

   **Отправить запрос:** Если вы находитесь в организации, где есть другие администраторы, даже если вы пытаетесь получить доступ к одной пользовательской организации, попросите члена вашей организации, которому назначена роль администратора, войти в организацию и отправить заявочный тикет на сброс вашего MFA от вашего имени. Как только мы подтвердим, что запрос аутентифицирован, мы сбросим ваш MFA и уведомим администратора. Войдите, как обычно, без MFA и перейдите в настройки профиля, чтобы зарегистрировать новый фактор, если хотите.

   **Сброс через электронную почту:** Если вы единственный пользователь в организации, отправьте запрос на поддержку по электронной почте (support@clickhouse.com), используя адрес электронной почты, связанный с вашей учетной записью. Как только мы подтвердим, что запрос поступает с правильного адреса электронной почты, мы сбросим ваш MFA И пароль. Проверьте свою электронную почту, чтобы получить ссылку для сброса пароля. Настройте новый пароль, затем перейдите в настройки профиля, чтобы зарегистрировать новый фактор, если хотите.
   
</details>

## SAML SSO {#saml-sso}

<EnterprisePlanFeatureBadge feature="SAML SSO"/>

ClickHouse Cloud также поддерживает протокол SAML для единого входа (SSO). Для получения дополнительной информации см. [Настройка SAML SSO](/cloud/security/saml-setup).

## Учетная запись пользователя базы данных + Пароль {#database-user-id--password}

Используйте метод SHA256_hash при [создании учетных записей пользователей](/sql-reference/statements/create/user.md) для защиты паролей.

**ПОДСКАЗКА:** Поскольку пользователи с менее чем административными привилегиями не могут установить свой собственный пароль, попросите пользователя хэшировать свой пароль, используя генератор, такой как [этот](https://tools.keycdn.com/sha256-online-generator), прежде чем предоставлять его администратору для настройки учетной записи. Пароли должны соответствовать [требованиям](#password-settings), указанным выше.

```sql
CREATE USER userName IDENTIFIED WITH sha256_hash BY 'hash';
```
