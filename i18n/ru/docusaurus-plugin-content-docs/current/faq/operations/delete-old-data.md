---
slug: /faq/operations/delete-old-data
title: 'Возможно ли удалить старые записи из таблицы ClickHouse?'
toc_hidden: true
toc_priority: 20
description: 'Эта страница отвечает на вопрос, возможно ли удалить старые записи из таблицы ClickHouse'
---


# Возможно ли удалить старые записи из таблицы ClickHouse? {#is-it-possible-to-delete-old-records-from-a-clickhouse-table}

Краткий ответ — “да”. ClickHouse имеет несколько механизмов, позволяющих освобождать дисковое пространство за счёт удаления устаревших данных. Каждый механизм предназначен для различных сценариев.

## TTL {#ttl}

ClickHouse позволяет автоматически удалять значения, когда происходит какое-либо условие. Это условие настраивается как выражение на основе любых колонок, обычно просто статического смещения для любой колонки временной метки.

Ключевое преимущество этого подхода заключается в том, что не требуется никакая внешняя система для его активации; как только TTL настроен, удаление данных происходит автоматически в фоновом режиме.

:::note
TTL также может быть использован для перемещения данных не только в [/dev/null](https://en.wikipedia.org/wiki/Null_device), но и между различными системами хранения, например, с SSD на HDD.
:::

Более подробно о [настройке TTL](../../engines/table-engines/mergetree-family/mergetree.md#table_engine-mergetree-ttl).

## DELETE FROM {#delete-from}

[DELETE FROM](/sql-reference/statements/delete.md) позволяет выполнять стандартные запросы DELETE в ClickHouse. Строки, указанные в условии фильтра, отмечаются как удалённые и исключаются из будущих наборов результатов. Очистка строк происходит асинхронно.

:::note
DELETE FROM обычно доступен с версии 23.3 и новее. В старых версиях он считается экспериментальным и должен быть включён с помощью:
```sql
SET allow_experimental_lightweight_delete = true;
```
:::

## ALTER DELETE {#alter-delete}

ALTER DELETE удаляет строки с использованием асинхронных пакетных операций. В отличие от DELETE FROM, запросы, выполняемые после ALTER DELETE и до завершения пакетных операций, будут включать строки, предназначенные для удаления. Для получения дополнительной информации смотрите документы по [ALTER DELETE](/sql-reference/statements/alter/delete.md).

`ALTER DELETE` может быть использован для гибкого удаления устаревших данных. Если вам нужно делать это регулярно, основным недостатком будет необходимость иметь внешнюю систему для отправки запроса. Также есть некоторые соображения по производительности, поскольку мутации переписывают полные части, даже если нужно удалить только одну строку.

Это самый распространённый подход, чтобы сделать вашу систему на основе ClickHouse соответствующей [GDPR](https://gdpr-info.eu).

Более подробно о [мутациях](/sql-reference/statements/alter#mutations).

## DROP PARTITION {#drop-partition}

`ALTER TABLE ... DROP PARTITION` предоставляет экономически эффективный способ удалить целую партицию. Этот метод не так гибок и требует должной схемы партиционирования, настроенной при создании таблицы, но всё же охватывает большинство распространённых случаев. Как и мутации, они должны выполняться из внешней системы для регулярного использования.

Более подробно о [манипуляциях с партициями](/sql-reference/statements/alter/partition).

## TRUNCATE {#truncate}

Это довольно радикально — удалить все данные из таблицы, но в некоторых случаях это может быть именно то, что вам нужно.

Более подробно о [усечении таблицы](/sql-reference/statements/truncate.md).
