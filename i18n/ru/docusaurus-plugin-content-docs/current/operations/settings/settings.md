---
title: 'Настройки Сессии'
sidebar_label: 'Настройки Сессии'
slug: /operations/settings/settings
toc_max_heading_level: 2
description: 'Настройки, которые находятся в таблице system.settings.'
---

import ExperimentalBadge from '@theme/badges/ExperimentalBadge';
import BetaBadge from '@theme/badges/BetaBadge';
import CloudAvailableBadge from '@theme/badges/CloudAvailableBadge';

<!-- Autogenerated -->
Все нижеуказанные настройки также доступны в таблице [system.settings](/docs/operations/system-tables/settings). Эти настройки автоматически генерируются из [source](https://github.com/ClickHouse/ClickHouse/blob/master/src/Core/Settings.cpp).
## add_http_cors_header {#add_http_cors_header}



Type: Bool

Default value: 0

Write add http CORS header.
## additional_result_filter {#additional_result_filter}



Type: String

Default value: 

Дополнительное выражение фильтра, применяемое к результату запроса `SELECT`.
Эта настройка не применяется к каким-либо подзапросам.

**Пример**

```sql
INSERT INTO table_1 VALUES (1, 'a'), (2, 'bb'), (3, 'ccc'), (4, 'dddd');
SElECT * FROM table_1;
```
```response
┌─x─┬─y────┐
│ 1 │ a    │
│ 2 │ bb   │
│ 3 │ ccc  │
│ 4 │ dddd │
└───┴──────┘
```
```sql
SELECT *
FROM table_1
SETTINGS additional_result_filter = 'x != 2'
```
```response
┌─x─┬─y────┐
│ 1 │ a    │
│ 3 │ ccc  │
│ 4 │ dddd │
└───┴──────┘
```
## additional_table_filters {#additional_table_filters}



Type: Map

Default value: {}

Дополнительное выражение фильтра, которое применяется после чтения
из указанной таблицы.

**Пример**

```sql
INSERT INTO table_1 VALUES (1, 'a'), (2, 'bb'), (3, 'ccc'), (4, 'dddd');
SELECT * FROM table_1;
```
```response
┌─x─┬─y────┐
│ 1 │ a    │
│ 2 │ bb   │
│ 3 │ ccc  │
│ 4 │ dddd │
└───┴──────┘
```
```sql
SELECT *
FROM table_1
SETTINGS additional_table_filters = {'table_1': 'x != 2'}
```
```response
┌─x─┬─y────┐
│ 1 │ a    │
│ 3 │ ccc  │
│ 4 │ dddd │
└───┴──────┘
```
## aggregate_functions_null_for_empty {#aggregate_functions_null_for_empty}



Type: Bool

Default value: 0

Включает или отключает преобразование всех агрегатных функций в запросе, добавляя суффикс [-OrNull](/sql-reference/aggregate-functions/combinators#-ornull). Включите это для совместимости со стандартом SQL.
Это реализовано через переписывание запроса (аналогично настройке [count_distinct_implementation](#count_distinct_implementation)), чтобы получить единообразные результаты для распределенных запросов.

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

**Пример**

Рассмотрим следующий запрос с агрегатными функциями:
```sql
SELECT SUM(-1), MAX(0) FROM system.one WHERE 0;
```

С `aggregate_functions_null_for_empty = 0` это даст:
```text
┌─SUM(-1)─┬─MAX(0)─┐
│       0 │      0 │
└─────────┴────────┘
```

С `aggregate_functions_null_for_empty = 1` результат будет:
```text
┌─SUMOrNull(-1)─┬─MAXOrNull(0)─┐
│          NULL │         NULL │
└───────────────┴──────────────┘
```
## aggregation_in_order_max_block_bytes {#aggregation_in_order_max_block_bytes}



Type: UInt64

Default value: 50000000

Максимальный размер блока в байтах, накопленный во время агрегации в порядке первичного ключа. Меньший размер блока позволяет параллелизовать более финальную стадию слияния агрегации.
## aggregation_memory_efficient_merge_threads {#aggregation_memory_efficient_merge_threads}



Type: UInt64

Default value: 0

Количество потоков, которые будут использоваться для слияния промежуточных результатов агрегации в режиме с низким потреблением памяти. Когда больше, то потребляется больше памяти. 0 означает - то же самое, что и 'max_threads'.
## allow_aggregate_partitions_independently {#allow_aggregate_partitions_independently}



Type: Bool

Default value: 0

Включить независимую агрегацию партиций на отдельных потоках, когда ключ партиции соответствует ключу группировки. Полезно, когда количество партиций близко к количеству ядров и партиции имеют примерно одинаковый размер.
## allow_archive_path_syntax {#allow_archive_path_syntax}
<ExperimentalBadge/>


Type: Bool

Default value: 1

Движки файлов/S3 и табличные функции будут анализировать пути с '::' как `<archive> :: <file>\`, если архив имеет правильное расширение.
## allow_asynchronous_read_from_io_pool_for_merge_tree {#allow_asynchronous_read_from_io_pool_for_merge_tree}



Type: Bool

Default value: 0

Использовать фоновый I/O пул для чтения из таблиц MergeTree. Эта настройка может увеличить производительность для I/O-ограниченных запросов.
## allow_changing_replica_until_first_data_packet {#allow_changing_replica_until_first_data_packet}



Type: Bool

Default value: 0

Если включено, в хеджированных запросах мы можем начать новое соединение до получения первого пакета данных, даже если мы уже сделали некоторый прогресс
(но прогресс не был обновлен для `receive_data_timeout` таймаута), в противном случае мы отключаем изменение реплики после первого времени, когда мы сделали прогресс.
## allow_create_index_without_type {#allow_create_index_without_type}



Type: Bool

Default value: 0

Разрешить запрос CREATE INDEX без TYPE. Запрос будет проигнорирован. Сделано для тестов совместимости SQL.
## allow_custom_error_code_in_throwif {#allow_custom_error_code_in_throwif}



Type: Bool

Default value: 0

Включить пользовательский код ошибки в функции throwIf(). Если true, выброшенные исключения могут иметь неожиданные коды ошибок.
## allow_ddl {#allow_ddl}



Type: Bool

Default value: 1

Если установлено в true, пользователю разрешается выполнять DDL запросы.
## allow_deprecated_database_ordinary {#allow_deprecated_database_ordinary}



Type: Bool

Default value: 0

Разрешить создавать базы данных с устаревшим Ordinary движком.
## allow_deprecated_error_prone_window_functions {#allow_deprecated_error_prone_window_functions}



Type: Bool

Default value: 0

Разрешить использование устаревших оконных функций, подверженных ошибкам (neighbor, runningAccumulate, runningDifferenceStartingWithFirstValue, runningDifference).
## allow_deprecated_snowflake_conversion_functions {#allow_deprecated_snowflake_conversion_functions}



Type: Bool

Default value: 0

Функции `snowflakeToDateTime`, `snowflakeToDateTime64`, `dateTimeToSnowflake`, и `dateTime64ToSnowflake` устарели и отключены по умолчанию.
Пожалуйста, используйте функции `snowflakeIDToDateTime`, `snowflakeIDToDateTime64`, `dateTimeToSnowflakeID`, и `dateTime64ToSnowflakeID` вместо них.

Чтобы повторно включить устаревшие функции (например, в течение переходного периода), установите эту настройку в `true`.
## allow_deprecated_syntax_for_merge_tree {#allow_deprecated_syntax_for_merge_tree}



Type: Bool

Default value: 0

Разрешить создание таблиц *MergeTree с устаревшим синтаксисом определения движка.
## allow_distributed_ddl {#allow_distributed_ddl}



Type: Bool

Default value: 1

Если установлено в true, пользователю разрешается выполнять распределенные DDL запросы.
## allow_drop_detached {#allow_drop_detached}



Type: Bool

Default value: 0

Разрешить запросы ALTER TABLE ... DROP DETACHED PART[ITION] ...
## allow_execute_multiif_columnar {#allow_execute_multiif_columnar}



Type: Bool

Default value: 1

Разрешить выполнять функцию multiIf в столбцовом виде.
## allow_experimental_analyzer {#allow_experimental_analyzer}



Type: Bool

Default value: 1

Разрешить новый анализатор запросов.
## allow_experimental_codecs {#allow_experimental_codecs}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Если установлено в true, разрешить указывать экспериментальные кодеки сжатия (но у нас их еще нет, и эта опция ничего не делает).
## allow_experimental_database_glue_catalog {#allow_experimental_database_glue_catalog}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Разрешить экспериментальный движок базы данных DataLakeCatalog с catalog_type = 'glue'.
## allow_experimental_database_iceberg {#allow_experimental_database_iceberg}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Разрешить экспериментальный движок базы данных DataLakeCatalog с catalog_type = 'iceberg'.
## allow_experimental_database_materialized_postgresql {#allow_experimental_database_materialized_postgresql}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Разрешить создание базы данных с Engine=MaterializedPostgreSQL(...).
## allow_experimental_database_unity_catalog {#allow_experimental_database_unity_catalog}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Разрешить экспериментальный движок базы данных DataLakeCatalog с catalog_type = 'unity'.
## allow_experimental_dynamic_type {#allow_experimental_dynamic_type}



Type: Bool

Default value: 1

Разрешает создание типа данных [Dynamic](../../sql-reference/data-types/dynamic.md).
## allow_experimental_full_text_index {#allow_experimental_full_text_index}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Если установлено в true, разрешает использование экспериментального полнотекстового индекса.
## allow_experimental_funnel_functions {#allow_experimental_funnel_functions}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Включить экспериментальные функции для анализа воронки.
## allow_experimental_hash_functions {#allow_experimental_hash_functions}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Включить экспериментальные хеш-функции.
## allow_experimental_inverted_index {#allow_experimental_inverted_index}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Если установлено в true, разрешает использование экспериментированного инвертированного индекса.
## allow_experimental_join_condition {#allow_experimental_join_condition}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Поддержка объединений с неравными условиями, которые вовлекают столбцы из обеих таблиц. Например, `t1.y < t2.y`.
## allow_experimental_join_right_table_sorting {#allow_experimental_join_right_table_sorting}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Если установлено в true, и условия `join_to_sort_minimum_perkey_rows` и `join_to_sort_maximum_table_rows` выполнены, перераспределите правую таблицу по ключу для улучшения производительности левого или внутреннего хеш-объединения.
## allow_experimental_json_type {#allow_experimental_json_type}



Type: Bool

Default value: 1

Разрешает создание типа данных [JSON](../../sql-reference/data-types/newjson.md).
## allow_experimental_kafka_offsets_storage_in_keeper {#allow_experimental_kafka_offsets_storage_in_keeper}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Разрешить экспериментальную функцию хранения смещений, относящихся к Kafka, в ClickHouse Keeper. При включении путь ClickHouse Keeper и имя реплики могут быть указаны для движка таблиц Kafka. В результате вместо обычного движка Kafka будет использоваться новый тип движка хранения, который хранит зафиксированные смещения в первую очередь в ClickHouse Keeper.
## allow_experimental_kusto_dialect {#allow_experimental_kusto_dialect}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Включить Kusto Query Language (KQL) - альтернативу SQL.
## allow_experimental_live_view {#allow_experimental_live_view}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Разрешает создание устаревшего LIVE VIEW.

Возможные значения:

- 0 — Работы с live-представлениями отключены.
- 1 — Работы с live-представлениями включены.
## allow_experimental_materialized_postgresql_table {#allow_experimental_materialized_postgresql_table}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Разрешает использовать движок таблиц MaterializedPostgreSQL. Отключено по умолчанию, потому что эта функция экспериментальная.
## allow_experimental_nlp_functions {#allow_experimental_nlp_functions}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Включить экспериментальные функции для обработки естественного языка.
## allow_experimental_object_type {#allow_experimental_object_type}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Разрешить устаревший тип данных Object.
## allow_experimental_parallel_reading_from_replicas {#allow_experimental_parallel_reading_from_replicas}
<BetaBadge/>


Type: UInt64

Default value: 0

Используйте до `max_parallel_replicas` количества реплик из каждой шардированной таблицы для выполнения запроса SELECT. Чтение параллелизовано и координируется динамически. 0 - отключено, 1 - включено, безмолвно отключить в случае сбоя, 2 - включено, выбросить исключение в случае сбоя.
## allow_experimental_prql_dialect {#allow_experimental_prql_dialect}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Включить PRQL - альтернативу SQL.
## allow_experimental_query_deduplication {#allow_experimental_query_deduplication}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Экспериментальная дедупликация данных для запросов SELECT на основе UUID частей.
## allow_experimental_shared_set_join {#allow_experimental_shared_set_join}
<ExperimentalBadge/>

<CloudAvailableBadge/>

Type: Bool

Default value: 0

Имеет эффект только в ClickHouse Cloud. Разрешить создавать ShareSet и SharedJoin.
## allow_experimental_statistics {#allow_experimental_statistics}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Разрешает определять столбцы с [статистикой](../../engines/table-engines/mergetree-family/mergetree.md/#table_engine-mergetree-creating-a-table) и [управлять статистикой](../../engines/table-engines/mergetree-family/mergetree.md/#column-statistics).
## allow_experimental_time_series_table {#allow_experimental_time_series_table}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Разрешает создание таблиц с движком таблиц [TimeSeries](../../engines/table-engines/integrations/time-series.md).

Возможные значения:

- 0 — движок таблиц [TimeSeries](../../engines/table-engines/integrations/time-series.md) отключен.
- 1 — движок таблиц [TimeSeries](../../engines/table-engines/integrations/time-series.md) включен.
## allow_experimental_ts_to_grid_aggregate_function {#allow_experimental_ts_to_grid_aggregate_function}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Экспериментальная функция агрегации tsToGrid для пересэмплирования временных рядов в стиле Prometheus. Только для облака.
## allow_experimental_variant_type {#allow_experimental_variant_type}



Type: Bool

Default value: 1

Разрешает создание типа данных [Variant](../../sql-reference/data-types/variant.md).
## allow_experimental_vector_similarity_index {#allow_experimental_vector_similarity_index}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Разрешить экспериментальный индекс сходства векторов.
## allow_experimental_window_view {#allow_experimental_window_view}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Включить WINDOW VIEW. Еще недостаточно развито.
## allow_general_join_planning {#allow_general_join_planning}



Type: Bool

Default value: 1

Позволяет более общему алгоритму планирования объединения, который может обрабатывать более сложные условия, но работает только с хеш-объединениями. Если хеш-объединение не включено, тогда используется обычный алгоритм планирования объединения независимо от значения этой настройки.
## allow_get_client_http_header {#allow_get_client_http_header}



Type: Bool

Default value: 0

Разрешить использовать функцию `getClientHTTPHeader`, которая позволяет получить значение заголовка текущего HTTP запроса. Это не включено по умолчанию по соображениям безопасности, так как некоторые заголовки, такие как `Cookie`, могут содержать конфиденциальную информацию. Обратите внимание, что заголовки `X-ClickHouse-*` и `Authentication` всегда ограничены и не могут быть получены с помощью этой функции.
## allow_hyperscan {#allow_hyperscan}



Type: Bool

Default value: 1

Разрешить функции, которые используют библиотеку Hyperscan. Отключить, чтобы избежать потенциально длительного времени компиляции и чрезмерного использования ресурсов.
## allow_introspection_functions {#allow_introspection_functions}



Type: Bool

Default value: 0

Включает или отключает [интроспекционные функции](../../sql-reference/functions/introspection.md) для профилирования запросов.

Возможные значения:

- 1 — Интроспекционные функции включены.
- 0 — Интроспекционные функции отключены.

**Смотрите также**

- [Sampling Query Profiler](../../operations/optimizing-performance/sampling-query-profiler.md)
- Системная таблица [trace_log](/operations/system-tables/trace_log).
## allow_materialized_view_with_bad_select {#allow_materialized_view_with_bad_select}



Type: Bool

Default value: 1

Разрешить CREATE MATERIALIZED VIEW с запросом SELECT, который ссылается на несуществующие таблицы или столбцы. Он все равно должен быть синтаксически корректным. Не применяется к обновляемым МВ. Не применяется, если схема МВ должна быть выведена из запроса SELECT (то есть, если CREATE не содержит списка столбцов и не TO таблицы). Может использоваться для создания МВ перед созданием его исходной таблицы.
## allow_named_collection_override_by_default {#allow_named_collection_override_by_default}



Type: Bool

Default value: 1

Разрешить переопределение полей именованных коллекций по умолчанию.
## allow_non_metadata_alters {#allow_non_metadata_alters}



Type: Bool

Default value: 1

Разрешить выполнять изменения, которые влияют не только на метаданные таблиц, но и на данные на диске.
## allow_nonconst_timezone_arguments {#allow_nonconst_timezone_arguments}



Type: Bool

Default value: 0

Разрешить неконстантные временные аргументы в некоторых временных функциях, таких как toTimeZone(), fromUnixTimestamp*(), snowflakeToDateTime*().
## allow_nondeterministic_mutations {#allow_nondeterministic_mutations}



Type: Bool

Default value: 0

Настройка на уровне пользователя, которая позволяет мутации в реплицируемых таблицах использовать недетерминированные функции, такие как `dictGet`.

Учитывая, что, например, словари могут быть несинхронизированы между узлами, мутации, которые извлекают значения из них, по умолчанию запрещены для реплицируемых таблиц. Включение этой настройки разрешает такое поведение, возлагая на пользователя ответственность за обеспечение синхронизации данных между всеми узлами.

**Пример**

```xml
<profiles>
    <default>
        <allow_nondeterministic_mutations>1</allow_nondeterministic_mutations>

        <!-- ... -->
    </default>

    <!-- ... -->

</profiles>
```
## allow_nondeterministic_optimize_skip_unused_shards {#allow_nondeterministic_optimize_skip_unused_shards}



Type: Bool

Default value: 0

Разрешить недетерминированные (такие как `rand` или `dictGet`, так как последний имеет некоторые нюансы с обновлениями) функции в ключе шардирования.

Возможные значения:

- 0 — Запрещено.
- 1 — Разрешено.
## allow_not_comparable_types_in_comparison_functions {#allow_not_comparable_types_in_comparison_functions}



Type: Bool

Default value: 0

Разрешает или ограничивает использование несравнимых типов (таких как JSON/Объект/АгрегатнаяФункция) в функциях сравнения `equal/less/greater/etc`.
## allow_not_comparable_types_in_order_by {#allow_not_comparable_types_in_order_by}



Type: Bool

Default value: 0

Разрешает или ограничивает использование несравнимых типов (таких как JSON/Объект/АгрегатнаяФункция) в ключах ORDER BY.
## allow_prefetched_read_pool_for_local_filesystem {#allow_prefetched_read_pool_for_local_filesystem}



Type: Bool

Default value: 0

Предпочтение к предварительно загруженному пулу потоков, если все части находятся в локальной файловой системе.
## allow_prefetched_read_pool_for_remote_filesystem {#allow_prefetched_read_pool_for_remote_filesystem}



Type: Bool

Default value: 1

Предпочтение к предварительно загруженному пулу потоков, если все части находятся в удаленной файловой системе.
## allow_push_predicate_ast_for_distributed_subqueries {#allow_push_predicate_ast_for_distributed_subqueries}



Type: Bool

Default value: 1

Разрешает прокидывать предикат на уровне AST для распределенных подзапросов с включенным анализатором.
## allow_push_predicate_when_subquery_contains_with {#allow_push_predicate_when_subquery_contains_with}



Type: Bool

Default value: 1

Разрешает прокидывать предикат, когда подзапрос содержит оператор WITH.
## allow_reorder_prewhere_conditions {#allow_reorder_prewhere_conditions}



Type: Bool

Default value: 1

При перемещении условий из WHERE в PREWHERE разрешить их перераспределение для оптимизации фильтрации.
## allow_settings_after_format_in_insert {#allow_settings_after_format_in_insert}



Type: Bool

Default value: 0

Контролирует, разрешено ли использование `SETTINGS` после `FORMAT` в запросах `INSERT`. Рекомендуется не использовать это, так как это может интерпретировать часть `SETTINGS` как значения.

Пример:

```sql
INSERT INTO FUNCTION null('foo String') SETTINGS max_threads=1 VALUES ('bar');
```

Но следующий запрос будет работать только с `allow_settings_after_format_in_insert`:

```sql
SET allow_settings_after_format_in_insert=1;
INSERT INTO FUNCTION null('foo String') VALUES ('bar') SETTINGS max_threads=1;
```

Возможные значения:

- 0 — Запрещено.
- 1 — Разрешено.

:::note
Используйте эту настройку только для обратной совместимости, если ваши случаи использования зависят от старого синтаксиса.
:::
## allow_simdjson {#allow_simdjson}



Type: Bool

Default value: 1

Разрешить использование библиотеки simdjson в функциях 'JSON*', если доступны инструкции AVX2. Если отключено, будет использован rapidjson.
## allow_statistics_optimize {#allow_statistics_optimize}
<ExperimentalBadge/>


Type: Bool

Default value: 0

Разрешает использование статистики для оптимизации запросов.
## allow_suspicious_codecs {#allow_suspicious_codecs}



Type: Bool

Default value: 0

Если установлено в true, разрешает указывать бессмысленные кодеки сжатия.
## allow_suspicious_fixed_string_types {#allow_suspicious_fixed_string_types}



Type: Bool

Default value: 0

В операторе CREATE TABLE разрешает создавать столбцы типа FixedString(n) с n > 256. FixedString с длиной >= 256 вызывает подозрения и скорее всего указывает на неправильное использование.
## allow_suspicious_indices {#allow_suspicious_indices}



Type: Bool

Default value: 0

Отклоняет первичные/вторичные индексы и ключи сортировки с идентичными выражениями.
## allow_suspicious_low_cardinality_types {#allow_suspicious_low_cardinality_types}



Type: Bool

Default value: 0

Разрешает или ограничивает использование [LowCardinality](../../sql-reference/data-types/lowcardinality.md) с типами данных фиксированного размера 8 байт или меньше: числовые типы данных и `FixedString(8_bytes_or_less)`.

Для небольших фиксированных значений использование `LowCardinality` обычно неэффективно, так как ClickHouse хранит числовой индекс для каждой строки. В результате:

- Использование дискового пространства может увеличиться.
- Потребление оперативной памяти может быть выше, в зависимости от размера словаря.
- Некоторые функции могут работать медленнее из-за дополнительных операций кодирования/декодирования.

Время слияния в таблицах с движком [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md) может увеличиться по всем описанным причинам.

Возможные значения:

- 1 — Использование `LowCardinality` не ограничено.
- 0 — Использование `LowCardinality` ограничено.
## allow_suspicious_primary_key {#allow_suspicious_primary_key}



Type: Bool

Default value: 0

Разрешить подозрительные `PRIMARY KEY`/`ORDER BY` для MergeTree (т.е. SimpleAggregateFunction).
## allow_suspicious_ttl_expressions {#allow_suspicious_ttl_expressions}



Type: Bool

Default value: 0

Отклоняет выражения TTL, которые не зависят от каких-либо столбцов таблицы. Обычно это указывает на ошибку пользователя.
## allow_suspicious_types_in_group_by {#allow_suspicious_types_in_group_by}



Type: Bool

Default value: 0

Разрешает или ограничивает использование типов [Variant](../../sql-reference/data-types/variant.md) и [Dynamic](../../sql-reference/data-types/dynamic.md) в ключах GROUP BY.
## allow_suspicious_types_in_order_by {#allow_suspicious_types_in_order_by}



Type: Bool

Default value: 0

Разрешает или ограничивает использование типов [Variant](../../sql-reference/data-types/variant.md) и [Dynamic](../../sql-reference/data-types/dynamic.md) в ключах ORDER BY.
## allow_suspicious_variant_types {#allow_suspicious_variant_types}



Type: Bool

Default value: 0

В операторе CREATE TABLE разрешает указывать тип Variant с похожими вариантными типами (например, с разными числовыми или датированными типами). Включение этой настройки может создать некоторую двусмысленность при работе со значениями с похожими типами.
## allow_unrestricted_reads_from_keeper {#allow_unrestricted_reads_from_keeper}



Type: Bool

Default value: 0

Разрешить неограниченные (без условия по пути) чтения из системной таблицы zookeeper, может быть полезным, но не безопасным для zookeeper.
## alter_move_to_space_execute_async {#alter_move_to_space_execute_async}



Type: Bool

Default value: 0

Выполнять ALTER TABLE MOVE ... TO [DISK|VOLUME] асинхронно.
## alter_partition_verbose_result {#alter_partition_verbose_result}



Type: Bool

Default value: 0

Включает или отключает отображение информации о частях, к которым успешно применены операции манипуляции с партициями и частями.
Применимо к [ATTACH PARTITION|PART](/sql-reference/statements/alter/partition#attach-partitionpart) и к [FREEZE PARTITION](/sql-reference/statements/alter/partition#freeze-partition).

Возможные значения:

- 0 — отключить подробный вывод.
- 1 — включить подробный вывод.

**Пример**

```sql
CREATE TABLE test(a Int64, d Date, s String) ENGINE = MergeTree PARTITION BY toYYYYMDECLARE(d) ORDER BY a;
INSERT INTO test VALUES(1, '2021-01-01', '');
INSERT INTO test VALUES(1, '2021-01-01', '');
ALTER TABLE test DETACH PARTITION ID '202101';

ALTER TABLE test ATTACH PARTITION ID '202101' SETTINGS alter_partition_verbose_result = 1;

┌─command_type─────┬─partition_id─┬─part_name────┬─old_part_name─┐
│ ATTACH PARTITION │ 202101       │ 202101_7_7_0 │ 202101_5_5_0  │
│ ATTACH PARTITION │ 202101       │ 202101_8_8_0 │ 202101_6_6_0  │
└──────────────────┴──────────────┴──────────────┴───────────────┘

ALTER TABLE test FREEZE SETTINGS alter_partition_verbose_result = 1;

┌─command_type─┬─partition_id─┬─part_name────┬─backup_name─┬─backup_path───────────────────┬─part_backup_path────────────────────────────────────────────┐
│ FREEZE ALL   │ 202101       │ 202101_7_7_0 │ 8           │ /var/lib/clickhouse/shadow/8/ │ /var/lib/clickhouse/shadow/8/data/default/test/202101_7_7_0 │
│ FREEZE ALL   │ 202101       │ 202101_8_8_0 │ 8           │ /var/lib/clickhouse/shadow/8/ │ /var/lib/clickhouse/shadow/8/data/default/test/202101_8_8_0 │
└──────────────┴──────────────┴──────────────┴─────────────┴───────────────────────────────┴─────────────────────────────────────────────────────────────┘
```
## alter_sync {#alter_sync}



Type: UInt64

Default value: 1

Позволяет установить ожидание выполнения действий на репликах при выполнении запросов [ALTER](../../sql-reference/statements/alter/index.md), [OPTIMIZE](../../sql-reference/statements/optimize.md) или [TRUNCATE](../../sql-reference/statements/truncate.md).

Возможные значения:

- 0 — Не ждать.
- 1 — Ждать выполнения собственных запросов.
- 2 — Ждать от всех.

Cloud default value: `0`.

:::note
`alter_sync` применимо только к реплицируемым таблицам; оно ничего не делает для не реплицируемых таблиц.
:::
## analyze_index_with_space_filling_curves {#analyze_index_with_space_filling_curves}



Type: Bool

Default value: 1

Если таблица имеет пространственную заполненную кривую в своем индексе, например `ORDER BY mortonEncode(x, y)` или `ORDER BY hilbertEncode(x, y)`, и запрос имеет условия по его аргументам, например `x >= 10 AND x <= 20 AND y >= 20 AND y <= 30`, используйте пространственную заполненную кривую для анализа индекса.
## analyzer_compatibility_join_using_top_level_identifier {#analyzer_compatibility_join_using_top_level_identifier}



Type: Bool

Default value: 0

Принудительно разрешать идентификатор в JOIN USING из проекции (например, в `SELECT a + 1 AS b FROM t1 JOIN t2 USING (b)` объединение будет выполнено по `t1.a + 1 = t2.b`, а не `t1.b = t2.b`).
## any_join_distinct_right_table_keys {#any_join_distinct_right_table_keys}



Type: Bool

Default value: 0

Включает поведение сервера ClickHouse предыдущей версии в операциях `ANY INNER|LEFT JOIN`.

:::note
Используйте эту настройку только для обратной совместимости, если ваши случаи использования зависят от поведение объединений старой версии.
:::

Когда поведение предыдущей версии включено:

- Результаты операций `t1 ANY LEFT JOIN t2` и `t2 ANY RIGHT JOIN t1` не равны, поскольку ClickHouse использует логику с сопоставлением ключей таблицы много к одному слева направо.
- Результаты операций `ANY INNER JOIN` содержат все строки из левой таблицы, как операции `SEMI LEFT JOIN`.

Когда поведение предыдущей версии отключено:

- Результаты операций `t1 ANY LEFT JOIN t2` и `t2 ANY RIGHT JOIN t1` равны, поскольку ClickHouse использует логику, которая обеспечивает сопоставление ключей один к многим в операциях `ANY RIGHT JOIN`.
- Результаты операций `ANY INNER JOIN` содержат по одной строке для каждого ключа из левой и правой таблиц.

Возможные значения:

- 0 — Поведение предыдущей версии отключено.
- 1 — Поведение предыдущей версии включено.

Смотрите также:

- [Строгость объединения](/sql-reference/statements/select/join#settings).
## apply_deleted_mask {#apply_deleted_mask}



Type: Bool

Default value: 1

Включает фильтрацию строк, удаленных с помощью легковесного удаления. Если отключено, запрос сможет читать эти строки. Это полезно для отладки и сценариев "восстановления".
## apply_mutations_on_fly {#apply_mutations_on_fly}



Type: Bool

Default value: 0

Если true, мутации (UPDATE и DELETE), которые не материализованы в части данных, будут применены в запросах SELECT.
## apply_settings_from_server {#apply_settings_from_server}



Type: Bool

Default value: 1

Должен ли клиент принимать настройки от сервера.

Это влияет только на операции, выполняемые на стороне клиента, в частности, на синтаксический анализ входных данных INSERT и форматирование результата запроса. Большинство выполнения запроса происходит на сервере и не затрагивается этой настройкой.

Обычно эта настройка должна определяться в пользовательском профиле (users.xml или запросы, такие как `ALTER USER`), а не через клиент (командные аргументы клиента, запрос `SET` или секция `SETTINGS` в запросе `SELECT`). Через клиент его можно изменить на false, но не на true (поскольку сервер не отправит настройки, если пользовательский профиль имеет `apply_settings_from_server = false`).

Обратите внимание, что изначально (24.12) была серверная настройка (`send_settings_to_client`), но позже она была заменена на эту настройку для лучшей удобства использования.
## asterisk_include_alias_columns {#asterisk_include_alias_columns}



Type: Bool

Default value: 0

Включить [ALIAS](../../sql-reference/statements/create/table.md/#alias) столбцы для запроса с подстановочным знаком (`SELECT *`).

Возможные значения:

- 0 - отключено
- 1 - включено
## asterisk_include_materialized_columns {#asterisk_include_materialized_columns}



Type: Bool

Default value: 0

Включить [MATERIALIZED](/sql-reference/statements/create/view#materialized-view) столбцы для запроса с подстановочным знаком (`SELECT *`).

Возможные значения:

- 0 - отключено
- 1 - включено
## async_insert {#async_insert}



Type: Bool

Default value: 0

Если true, данные из запроса INSERT хранятся в очереди и позже сбрасываются в таблицу в фоновом режиме. Если wait_for_async_insert равно false, запрос INSERT обрабатывается почти мгновенно, в противном случае клиент будет ждать, пока данные будут сброшены в таблицу.

## async_insert_busy_timeout_decrease_rate {#async_insert_busy_timeout_decrease_rate}

Тип: Double

Значение по умолчанию: 0.2

Экспоненциальная скорость роста, с которой адаптивный тайм-аут для асинхронной вставки уменьшается.

## async_insert_busy_timeout_increase_rate {#async_insert_busy_timeout_increase_rate}

Тип: Double

Значение по умолчанию: 0.2

Экспоненциальная скорость роста, с которой адаптивный тайм-аут для асинхронной вставки увеличивается.

## async_insert_busy_timeout_max_ms {#async_insert_busy_timeout_max_ms}

Тип: Миллисекунды

Значение по умолчанию: 200

Максимальное время ожидания перед выгрузкой собранных данных за каждый запрос с момента появления первых данных.

## async_insert_busy_timeout_min_ms {#async_insert_busy_timeout_min_ms}

Тип: Миллисекунды

Значение по умолчанию: 50

Если автоподстройка включена через async_insert_use_adaptive_busy_timeout, минимальное время ожидания перед выгрузкой собранных данных за каждый запрос с момента появления первых данных. Также служит начальным значением для адаптивного алгоритма.

## async_insert_deduplicate {#async_insert_deduplicate}

Тип: Bool

Значение по умолчанию: 0

Для асинхронных запросов INSERT в реплицированной таблице указывает, что должна выполняться дедупликация вставляемых блоков.

## async_insert_max_data_size {#async_insert_max_data_size}

Тип: UInt64

Значение по умолчанию: 10485760

Максимальный размер в байтах неразобранных данных, собранных за каждый запрос перед вставкой.

## async_insert_max_query_number {#async_insert_max_query_number}

Тип: UInt64

Значение по умолчанию: 450

Максимальное количество запросов на вставку перед вставкой.

## async_insert_poll_timeout_ms {#async_insert_poll_timeout_ms}

Тип: Миллисекунды

Значение по умолчанию: 10

Тайм-аут для опроса данных из очереди асинхронной вставки.

## async_insert_use_adaptive_busy_timeout {#async_insert_use_adaptive_busy_timeout}

Тип: Bool

Значение по умолчанию: 1

Если установлено в true, использовать адаптивный тайм-аут занятости для асинхронных вставок.

## async_query_sending_for_remote {#async_query_sending_for_remote}

Тип: Bool

Значение по умолчанию: 1

Включает создание асинхронного соединения и отправку запросов при выполнении удаленного запроса.

По умолчанию включено.

## async_socket_for_remote {#async_socket_for_remote}

Тип: Bool

Значение по умолчанию: 1

Включает асинхронное чтение из сокета при выполнении удаленного запроса.

По умолчанию включено.

## azure_allow_parallel_part_upload {#azure_allow_parallel_part_upload}

Тип: Bool

Значение по умолчанию: 1

Использовать несколько потоков для многокомпонентной загрузки Azure.

## azure_check_objects_after_upload {#azure_check_objects_after_upload}

Тип: Bool

Значение по умолчанию: 0

Проверять каждый загруженный объект в хранилище Azure blob, чтобы убедиться, что загрузка прошла успешно.

## azure_create_new_file_on_insert {#azure_create_new_file_on_insert}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает создание нового файла при каждой вставке в таблицы движка Azure.

## azure_ignore_file_doesnt_exist {#azure_ignore_file_doesnt_exist}

Тип: Bool

Значение по умолчанию: 0

Игнорировать отсутствие файла, если он не существует при чтении определенных ключей.

Допустимые значения:
- 1 — `SELECT` возвращает пустой результат.
- 0 — `SELECT` вызывает исключение.

## azure_list_object_keys_size {#azure_list_object_keys_size}

Тип: UInt64

Значение по умолчанию: 1000

Максимальное количество файлов, которые могут быть возвращены в пакетном запросе ListObject.

## azure_max_blocks_in_multipart_upload {#azure_max_blocks_in_multipart_upload}

Тип: UInt64

Значение по умолчанию: 50000

Максимальное количество блоков в многокомпонентной загрузке для Azure.

## azure_max_inflight_parts_for_one_file {#azure_max_inflight_parts_for_one_file}

Тип: UInt64

Значение по умолчанию: 20

Максимальное количество одновременно загруженных частей в запросе многокомпонентной загрузки. 0 означает неограниченное количество.

## azure_max_single_part_copy_size {#azure_max_single_part_copy_size}

Тип: UInt64

Значение по умолчанию: 268435456

Максимальный размер объекта для копирования с использованием однокомпонентного копирования в хранилище Azure blob.

## azure_max_single_part_upload_size {#azure_max_single_part_upload_size}

Тип: UInt64

Значение по умолчанию: 104857600

Максимальный размер объекта для загрузки с использованием однокомпонентной загрузки в хранилище Azure blob.

## azure_max_single_read_retries {#azure_max_single_read_retries}

Тип: UInt64

Значение по умолчанию: 4

Максимальное количество повторных попыток во время одного чтения из хранилища Azure blob.

## azure_max_unexpected_write_error_retries {#azure_max_unexpected_write_error_retries}

Тип: UInt64

Значение по умолчанию: 4

Максимальное количество повторных попыток в случае неожиданных ошибок во время записи в хранилище Azure blob.

## azure_max_upload_part_size {#azure_max_upload_part_size}

Тип: UInt64

Значение по умолчанию: 5368709120

Максимальный размер части для загрузки во время многокомпонентной загрузки в хранилище Azure blob.

## azure_min_upload_part_size {#azure_min_upload_part_size}

Тип: UInt64

Значение по умолчанию: 16777216

Минимальный размер части для загрузки во время многокомпонентной загрузки в хранилище Azure blob.

## azure_sdk_max_retries {#azure_sdk_max_retries}

Тип: UInt64

Значение по умолчанию: 10

Максимальное количество повторных попыток в Azure SDK.

## azure_sdk_retry_initial_backoff_ms {#azure_sdk_retry_initial_backoff_ms}

Тип: UInt64

Значение по умолчанию: 10

Минимальная пауза между попытками в Azure SDK.

## azure_sdk_retry_max_backoff_ms {#azure_sdk_retry_max_backoff_ms}

Тип: UInt64

Значение по умолчанию: 1000

Максимальная пауза между попытками в Azure SDK.

## azure_skip_empty_files {#azure_skip_empty_files}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает пропуск пустых файлов в движке S3.

Допустимые значения:
- 0 — `SELECT` вызывает исключение, если пустой файл несовместим с запрашиваемым форматом.
- 1 — `SELECT` возвращает пустой результат для пустого файла.

## azure_strict_upload_part_size {#azure_strict_upload_part_size}

Тип: UInt64

Значение по умолчанию: 0

Точный размер части для загрузки во время многокомпонентной загрузки в хранилище Azure blob.

## azure_throw_on_zero_files_match {#azure_throw_on_zero_files_match}

Тип: Bool

Значение по умолчанию: 0

Вызывает ошибку, если соответствует нулевому количеству файлов согласно правилам развертывания glob.

Допустимые значения:
- 1 — `SELECT` вызывает исключение.
- 0 — `SELECT` возвращает пустой результат.

## azure_truncate_on_insert {#azure_truncate_on_insert}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает обрезку перед вставкой в таблицы движка Azure.

## azure_upload_part_size_multiply_factor {#azure_upload_part_size_multiply_factor}

Тип: UInt64

Значение по умолчанию: 2

Умножает azure_min_upload_part_size на этот коэффициент каждый раз, когда azure_multiply_parts_count_threshold частей была загружена из одной записи в хранилище Azure blob.

## azure_upload_part_size_multiply_parts_count_threshold {#azure_upload_part_size_multiply_parts_count_threshold}

Тип: UInt64

Значение по умолчанию: 500

Каждый раз, когда это количество частей было загружено в хранилище Azure blob, azure_min_upload_part_size умножается на azure_upload_part_size_multiply_factor.

## backup_restore_batch_size_for_keeper_multi {#backup_restore_batch_size_for_keeper_multi}

Тип: UInt64

Значение по умолчанию: 1000

Максимальный размер пакета для многоразового запроса к [Zoo]Keeper во время резервного копирования или восстановления.

## backup_restore_batch_size_for_keeper_multiread {#backup_restore_batch_size_for_keeper_multiread}

Тип: UInt64

Значение по умолчанию: 10000

Максимальный размер пакета для многоразового чтения из [Zoo]Keeper во время резервного копирования или восстановления.

## backup_restore_failure_after_host_disconnected_for_seconds {#backup_restore_failure_after_host_disconnected_for_seconds}

Тип: UInt64

Значение по умолчанию: 3600

Если хост во время операции BACKUP ON CLUSTER или RESTORE ON CLUSTER не воссоздаст свой эфемерный узел 'alive' в ZooKeeper в течение этого времени, то вся операция резервного копирования или восстановления считается неудачной.
Это значение должно быть больше любого разумного времени для повторного подключения хоста к ZooKeeper после сбоя.
Ноль означает без ограничений.

## backup_restore_finish_timeout_after_error_sec {#backup_restore_finish_timeout_after_error_sec}

Тип: UInt64

Значение по умолчанию: 180

Как долго инициатор должен ждать, чтобы другие хосты отреагировали на узел 'error' и прекратили выполнение текущей операции BACKUP ON CLUSTER или RESTORE ON CLUSTER.

## backup_restore_keeper_fault_injection_probability {#backup_restore_keeper_fault_injection_probability}

Тип: Float

Значение по умолчанию: 0

Приблизительная вероятность сбоя для запроса к Keeper во время резервного копирования или восстановления. Допустимое значение находится в интервале [0.0f, 1.0f].

## backup_restore_keeper_fault_injection_seed {#backup_restore_keeper_fault_injection_seed}

Тип: UInt64

Значение по умолчанию: 0

0 - случайный семя, иначе значение настройки.

## backup_restore_keeper_max_retries {#backup_restore_keeper_max_retries}

Тип: UInt64

Значение по умолчанию: 1000

Максимальные повторные попытки для операций [Zoo]Keeper во время резервного копирования или восстановления.

Должно быть достаточно большим, чтобы вся операция не завершилась сбоем из-за временной ошибки [Zoo]Keeper.

## backup_restore_keeper_max_retries_while_handling_error {#backup_restore_keeper_max_retries_while_handling_error}

Тип: UInt64

Значение по умолчанию: 20

Максимальные повторные попытки для операций [Zoo]Keeper при обработке ошибки во время операции BACKUP ON CLUSTER или RESTORE ON CLUSTER.

## backup_restore_keeper_max_retries_while_initializing {#backup_restore_keeper_max_retries_while_initializing}

Тип: UInt64

Значение по умолчанию: 20

Максимальные повторные попытки для операций [Zoo]Keeper во время инициализации операции BACKUP ON CLUSTER или RESTORE ON CLUSTER.

## backup_restore_keeper_retry_initial_backoff_ms {#backup_restore_keeper_retry_initial_backoff_ms}

Тип: UInt64

Значение по умолчанию: 100

Начальный тайм-аут ожидания для операций [Zoo]Keeper во время резервного копирования или восстановления.

## backup_restore_keeper_retry_max_backoff_ms {#backup_restore_keeper_retry_max_backoff_ms}

Тип: UInt64

Значение по умолчанию: 5000

Максимальный тайм-аут ожидания для операций [Zoo]Keeper во время резервного копирования или восстановления.

## backup_restore_keeper_value_max_size {#backup_restore_keeper_value_max_size}

Тип: UInt64

Значение по умолчанию: 1048576

Максимальный размер данных узла [Zoo]Keeper во время резервного копирования.

## backup_restore_s3_retry_attempts {#backup_restore_s3_retry_attempts}

Тип: UInt64

Значение по умолчанию: 1000

Настройка для Aws::Client::RetryStrategy, Aws::Client выполняет повторы самостоятельно, 0 означает отсутствие повторов. Применяется только для резервного копирования/восстановления.

## cache_warmer_threads {#cache_warmer_threads}

<CloudAvailableBadge/>

Тип: UInt64

Значение по умолчанию: 4

Имеет эффект только в ClickHouse Cloud. Количество фоновых потоков для спекулятивной загрузки новых частей данных в кэш файлов, когда [cache_populated_by_fetch](merge-tree-settings.md/#cache_populated_by_fetch) включен. Ноль для отключения.

## calculate_text_stack_trace {#calculate_text_stack_trace}

Тип: Bool

Значение по умолчанию: 1

Вычислять текстовый стек вызовов в случае исключений во время выполнения запроса. Это значение по умолчанию. Требует поиска символов, который может замедлить тесты на фуззинг, когда выполняется большое количество неверных запросов. В нормальных условиях вы не должны отключать эту опцию.

## cancel_http_readonly_queries_on_client_close {#cancel_http_readonly_queries_on_client_close}

Тип: Bool

Значение по умолчанию: 0

Отменяет HTTP-запросы только для чтения (например, SELECT), когда клиент закрывает соединение, не дожидаясь ответа.

Значение по умолчанию для Cloud: `1`.

## cast_ipv4_ipv6_default_on_conversion_error {#cast_ipv4_ipv6_default_on_conversion_error}

Тип: Bool

Значение по умолчанию: 0

Оператор CAST в IPv4, оператор CAST в IPV6, функции toIPv4, toIPv6 будут возвращать значение по умолчанию вместо того, чтобы выдавать исключение при ошибке преобразования.

## cast_keep_nullable {#cast_keep_nullable}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает сохранение типа данных `Nullable` в операциях [CAST](/sql-reference/functions/type-conversion-functions#cast).

Когда настройка включена, а аргумент функции `CAST` является `Nullable`, результат также преобразуется в тип `Nullable`. Когда настройка отключена, результат всегда имеет точно указанный целевой тип.

Допустимые значения:

- 0 — Результат `CAST` имеет точно указанный целевой тип.
- 1 — Если тип аргумента является `Nullable`, результат `CAST` преобразуется в `Nullable(DestinationDataType)`.

**Примеры**

Следующий запрос дает точно указанный целевой тип данных:

```sql
SET cast_keep_nullable = 0;
SELECT CAST(toNullable(toInt32(0)) AS Int32) as x, toTypeName(x);
```

Результат:

```text
┌─x─┬─toTypeName(CAST(toNullable(toInt32(0)), 'Int32'))─┐
│ 0 │ Int32                                             │
└───┴───────────────────────────────────────────────────┘
```

Следующий запрос приводит к модификации `Nullable` целевого типа данных:

```sql
SET cast_keep_nullable = 1;
SELECT CAST(toNullable(toInt32(0)) AS Int32) as x, toTypeName(x);
```

Результат:

```text
┌─x─┬─toTypeName(CAST(toNullable(toInt32(0)), 'Int32'))─┐
│ 0 │ Nullable(Int32)                                   │
└───┴───────────────────────────────────────────────────┘
```

**Смотрите также**

- [CAST](/sql-reference/functions/type-conversion-functions#cast) функция.

## cast_string_to_dynamic_use_inference {#cast_string_to_dynamic_use_inference}

Тип: Bool

Значение по умолчанию: 0

Использовать вывод типов при преобразовании String в Dynamic.

## check_query_single_value_result {#check_query_single_value_result}

Тип: Bool

Значение по умолчанию: 1

Определяет уровень детализации для результата запроса [CHECK TABLE](/sql-reference/statements/check-table) для движков семейства `MergeTree`.

Допустимые значения:

- 0 — запрос показывает статус проверки для каждой отдельной части данных таблицы.
- 1 — запрос показывает общий статус проверки таблицы.

## check_referential_table_dependencies {#check_referential_table_dependencies}

Тип: Bool

Значение по умолчанию: 0

Проверка того, что DDL-запрос (например, DROP TABLE или RENAME) не сломает ссылочные зависимости.

## check_table_dependencies {#check_table_dependencies}

Тип: Bool

Значение по умолчанию: 1

Проверка того, что DDL-запрос (например, DROP TABLE или RENAME) не сломает зависимости.

## checksum_on_read {#checksum_on_read}

Тип: Bool

Значение по умолчанию: 1

Проверка контрольных сумм при чтении. Включено по умолчанию и всегда должно быть включено в производственной среде. Не ожидайте никаких выгод от отключения этой настройки. Она может использоваться только для экспериментов и бенчмарков. Настройка применима только для таблиц семейства MergeTree. Контрольные суммы всегда проверяются для других движков таблиц и при получении данных по сети.

## cloud_mode {#cloud_mode}

Тип: Bool

Значение по умолчанию: 0

Режим облака.

## cloud_mode_database_engine {#cloud_mode_database_engine}

Тип: UInt64

Значение по умолчанию: 1

Движок базы данных, разрешенный в Cloud. 1 - переписывать DDL для использования реплицированной базы данных, 2 - переписывать DDL для использования общей базы данных.

## cloud_mode_engine {#cloud_mode_engine}

Тип: UInt64

Значение по умолчанию: 1

Семейство движков, разрешенное в Cloud.

- 0 - разрешить все.
- 1 - переписывать DDL для использования *ReplicatedMergeTree.
- 2 - переписывать DDL для использования SharedMergeTree.
- 3 - переписывать DDL для использования SharedMergeTree, кроме случаев, когда явно указан удаленный диск.

UInt64 для минимизации публичной части.

## cluster_for_parallel_replicas {#cluster_for_parallel_replicas}
<BetaBadge/>

Тип: String

Значение по умолчанию: 

Кластер для шарда, в котором находится текущий сервер.

## collect_hash_table_stats_during_aggregation {#collect_hash_table_stats_during_aggregation}

Тип: Bool

Значение по умолчанию: 1

Включить сбор статистики хеш-таблицы для оптимизации распределения памяти.

## collect_hash_table_stats_during_joins {#collect_hash_table_stats_during_joins}

Тип: Bool

Значение по умолчанию: 1

Включить сбор статистики хеш-таблицы для оптимизации распределения памяти.

## compatibility {#compatibility}

Тип: String

Значение по умолчанию: 

Настройка `compatibility` заставляет ClickHouse использовать настройки по умолчанию предыдущей версии ClickHouse, где предыдущая версия предоставляется в качестве настройки.

Если настройки установлены на ненастройки по умолчанию, то эти настройки будут применены (только настройки, которые не были изменены, затрагиваются настройкой `compatibility`).

Эта настройка принимает номер версии ClickHouse в виде строки, например `22.3`, `22.8`. Пустое значение означает, что эта настройка отключена.

По умолчанию отключено.

:::note
В ClickHouse Cloud настройка совместимости должна быть установлена поддержкой ClickHouse Cloud. Пожалуйста, [откройте заявку](https://clickhouse.cloud/support), чтобы установить её.
:::

## compatibility_ignore_auto_increment_in_create_table {#compatibility_ignore_auto_increment_in_create_table}

Тип: Bool

Значение по умолчанию: 0

Игнорировать ключевое слово AUTO_INCREMENT в определении столбца, если true, иначе вернуть ошибку. Упрощает миграцию с MySQL.

## compatibility_ignore_collation_in_create_table {#compatibility_ignore_collation_in_create_table}

Тип: Bool

Значение по умолчанию: 1

Совместимость игнорировать сортировку при создании таблицы.

## compile_aggregate_expressions {#compile_aggregate_expressions}

Тип: Bool

Значение по умолчанию: 1

Включает или отключает JIT-компиляцию агрегатных функций в нативный код. Включение этой настройки может улучшить производительность.

Допустимые значения:

- 0 — Агрегация выполняется без JIT-компиляции.
- 1 — Агрегация выполняется с использованием JIT-компиляции.

**Смотрите также**

- [min_count_to_compile_aggregate_expression](#min_count_to_compile_aggregate_expression).

## compile_expressions {#compile_expressions}

Тип: Bool

Значение по умолчанию: 0

Компилировать некоторые скалярные функции и операторы в нативный код. Из-за ошибки в инфраструктуре компилятора LLVM на машинах AArch64 это может привести к разыменованию указателя null и, как следствие, аварийному завершению сервера. Не включайте эту настройку.

## compile_sort_description {#compile_sort_description}

Тип: Bool

Значение по умолчанию: 1

Компилировать описание сортировки в нативный код.

## connect_timeout {#connect_timeout}

Тип: Секунды

Значение по умолчанию: 10

Тайм-аут подключения, если нет реплик.

## connect_timeout_with_failover_ms {#connect_timeout_with_failover_ms}

Тип: Миллисекунды

Значение по умолчанию: 1000

Тайм-аут в миллисекундах для подключения к удаленному серверу для движка распределенной таблицы, если в определении кластера используются секции 'shard' и 'replica'.
Если попытка не удалась, то делается несколько попыток подключения к различным репликам.

## connect_timeout_with_failover_secure_ms {#connect_timeout_with_failover_secure_ms}

Тип: Миллисекунды

Значение по умолчанию: 1000

Тайм-аут подключения для выбора первой здоровой реплики (для безопасных соединений).

## connection_pool_max_wait_ms {#connection_pool_max_wait_ms}

Тип: Миллисекунды

Значение по умолчанию: 0

Время ожидания в миллисекундах для подключения, когда пул подключений полон.

Допустимые значения:

- Положительное целое число.
- 0 — Бесконечный тайм-аут.

## connections_with_failover_max_tries {#connections_with_failover_max_tries}

Тип: UInt64

Значение по умолчанию: 3

Максимальное количество попыток подключения к каждой реплике для движка распределенной таблицы.

## convert_query_to_cnf {#convert_query_to_cnf}

Тип: Bool

Значение по умолчанию: 0

Когда установлено в `true`, запрос `SELECT` будет преобразован в конъюнктивную нормальную форму (CNF). Есть сценарии, в которых переписывание запроса в CNF может выполнять быстрее (см. этот [вопрос на Github](https://github.com/ClickHouse/ClickHouse/issues/11749) для объяснения).

Например, обратите внимание, как следующий запрос `SELECT` не изменяется (поведение по умолчанию):

```sql
EXPLAIN SYNTAX
SELECT *
FROM
(
    SELECT number AS x
    FROM numbers(20)
) AS a
WHERE ((x >= 1) AND (x <= 5)) OR ((x >= 10) AND (x <= 15))
SETTINGS convert_query_to_cnf = false;
```

Результат:

```response
┌─explain────────────────────────────────────────────────────────┐
│ SELECT x                                                       │
│ FROM                                                           │
│ (                                                              │
│     SELECT number AS x                                         │
│     FROM numbers(20)                                           │
│     WHERE ((x >= 1) AND (x <= 5)) OR ((x >= 10) AND (x <= 15)) │
│ ) AS a                                                         │
│ WHERE ((x >= 1) AND (x <= 5)) OR ((x >= 10) AND (x <= 15))     │
│ SETTINGS convert_query_to_cnf = 0                              │
└────────────────────────────────────────────────────────────────┘
```

Давайте установим `convert_query_to_cnf` в `true` и посмотрим, что изменится:

```sql
EXPLAIN SYNTAX
SELECT *
FROM
(
    SELECT number AS x
    FROM numbers(20)
) AS a
WHERE ((x >= 1) AND (x <= 5)) OR ((x >= 10) AND (x <= 15))
SETTINGS convert_query_to_cnf = true;
```

Обратите внимание, что условие `WHERE` переписывается в CNF, но результирующий набор остается идентичным - логика логическая не изменена:

```response
┌─explain───────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ SELECT x                                                                                                              │
│ FROM                                                                                                                  │
│ (                                                                                                                     │
│     SELECT number AS x                                                                                                │
│     FROM numbers(20)                                                                                                  │
│     WHERE ((x <= 15) OR (x <= 5)) AND ((x <= 15) OR (x >= 1)) AND ((x >= 10) OR (x <= 5)) AND ((x >= 10) OR (x >= 1)) │
│ ) AS a                                                                                                                │
│ WHERE ((x >= 10) OR (x >= 1)) AND ((x >= 10) OR (x <= 5)) AND ((x <= 15) OR (x >= 1)) AND ((x <= 15) OR (x <= 5))     │
│ SETTINGS convert_query_to_cnf = 1                                                                                     │
└───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

Допустимые значения: true, false.

## count_distinct_implementation {#count_distinct_implementation}

Тип: String

Значение по умолчанию: uniqExact

Указывает, какая из функций `uniq*` должна использоваться для выполнения конструкции [COUNT(DISTINCT ...)](/sql-reference/aggregate-functions/reference/count).

Допустимые значения:

- [uniq](/sql-reference/aggregate-functions/reference/uniq).
- [uniqCombined](/sql-reference/aggregate-functions/reference/uniqcombined).
- [uniqCombined64](/sql-reference/aggregate-functions/reference/uniqcombined64).
- [uniqHLL12](/sql-reference/aggregate-functions/reference/uniqhll12).
- [uniqExact](/sql-reference/aggregate-functions/reference/uniqexact).

## count_distinct_optimization {#count_distinct_optimization}

Тип: Bool

Значение по умолчанию: 0

Переписать count distinct в подзапрос группировки.

## create_if_not_exists {#create_if_not_exists}

Тип: Bool

Значение по умолчанию: 0

Включить `IF NOT EXISTS` для операции `CREATE` по умолчанию. Если эта настройка или `IF NOT EXISTS` указаны, и таблица с указанным именем уже существует, исключение не будет выброшено.

## create_index_ignore_unique {#create_index_ignore_unique}

Тип: Bool

Значение по умолчанию: 0

Игнорировать уникальное ключевое слово в CREATE UNIQUE INDEX. Сделано для тестов совместимости SQL.

## create_replicated_merge_tree_fault_injection_probability {#create_replicated_merge_tree_fault_injection_probability}

Тип: Float

Значение по умолчанию: 0

Вероятность сбоя при инъекции ошибок во время создания таблицы после создания метаданных в ZooKeeper.

## create_table_empty_primary_key_by_default {#create_table_empty_primary_key_by_default}

Тип: Bool

Значение по умолчанию: 0

Разрешить создавать таблицы *MergeTree с пустым первичным ключом, когда ORDER BY и PRIMARY KEY не указаны.

## cross_join_min_bytes_to_compress {#cross_join_min_bytes_to_compress}

Тип: UInt64

Значение по умолчанию: 1073741824

Минимальный размер блока для сжатия в CROSS JOIN. Нулевое значение означает отключение этого порога. Блок будет сжат, когда будет достигнут любой из двух порогов (по строкам или по байтам).

## cross_join_min_rows_to_compress {#cross_join_min_rows_to_compress}

Тип: UInt64

Значение по умолчанию: 10000000

Минимальное количество строк для сжатия блока в CROSS JOIN. Нулевое значение означает отключение этого порога. Блок будет сжат, когда будет достигнут любой из двух порогов (по строкам или по байтам).

## data_type_default_nullable {#data_type_default_nullable}

Тип: Bool

Значение по умолчанию: 0

Разрешает типы данных без явных модификаторов [NULL или NOT NULL](/sql-reference/statements/create/table#null-or-not-null-modifiers) в определении столбца, быть [Nullable](/sql-reference/data-types/nullable).

Допустимые значения:

- 1 — Типы данных в определениях столбцов по умолчанию устанавливаются в `Nullable`.
- 0 — Типы данных в определениях столбцов по умолчанию устанавливаются не `Nullable`.

## database_atomic_wait_for_drop_and_detach_synchronously {#database_atomic_wait_for_drop_and_detach_synchronously}

Тип: Bool

Значение по умолчанию: 0

Добавляет модификатор `SYNC` ко всем запросам `DROP` и `DETACH`.

Допустимые значения:

- 0 — Запросы будут выполняться с задержкой.
- 1 — Запросы будут выполняться без задержки.

## database_replicated_allow_explicit_uuid {#database_replicated_allow_explicit_uuid}

Тип: UInt64

Значение по умолчанию: 0

0 - Не разрешать явно указывать UUID для таблиц в реплицированных базах данных. 1 - Разрешить. 2 - Разрешить, но игнорировать указанный UUID и сгенерировать случайный.

## database_replicated_allow_heavy_create {#database_replicated_allow_heavy_create}

Тип: Bool

Значение по умолчанию: 0

Разрешить долгосрочные DDL-запросы (CREATE AS SELECT и POPULATE) в реплицированном движке базы данных. Обратите внимание, что это может заблокировать очередь DDL на длительное время.

## database_replicated_allow_only_replicated_engine {#database_replicated_allow_only_replicated_engine}

Тип: Bool

Значение по умолчанию: 0

Разрешить создавать только реплицированные таблицы в базе данных с движком Replicated.

## database_replicated_allow_replicated_engine_arguments {#database_replicated_allow_replicated_engine_arguments}

Тип: UInt64

Значение по умолчанию: 0

0 - Не разрешать явно указывать путь к ZooKeeper и имя реплики для *MergeTree таблиц в реплицированных базах данных. 1 - Разрешить. 2 - Разрешить, но игнорировать указанный путь и использовать умолчания. 3 - Разрешить и не регистрировать предупреждение.

## database_replicated_always_detach_permanently {#database_replicated_always_detach_permanently}

Тип: Bool

Значение по умолчанию: 0

Выполнять DETACH TABLE как DETACH TABLE PERMANENTLY, если движок базы данных реплицирован.

## database_replicated_enforce_synchronous_settings {#database_replicated_enforce_synchronous_settings}

Тип: Bool

Значение по умолчанию: 0

Принуждает синхронное ожидание для некоторых запросов (см. также database_atomic_wait_for_drop_and_detach_synchronously, mutation_sync, alter_sync). Не рекомендуется включать эти настройки.

## database_replicated_initial_query_timeout_sec {#database_replicated_initial_query_timeout_sec}

Тип: UInt64

Значение по умолчанию: 300

Устанавливает, как долго начальный DDL-запрос должен ждать, пока реплицированная база данных обработает предыдущие записи очереди DDL в секундах.

Допустимые значения:

- Положительное целое число.
- 0 — Без ограничений.

## decimal_check_overflow {#decimal_check_overflow}

Тип: Bool

Значение по умолчанию: 1

Проверка переполнения арифметических/сравнительных операций для десятичных чисел.

## deduplicate_blocks_in_dependent_materialized_views {#deduplicate_blocks_in_dependent_materialized_views}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает проверку дедупликации для материализованных представлений, которые получают данные из таблиц Replicated*.

Допустимые значения:

      0 — Отключено.
      1 — Включено.

Использование

По умолчанию дедупликация не выполняется для материализованных представлений, а производится на более высоком уровне, в исходной таблице.
Если вставляемый блок пропущен из-за дедупликации в исходной таблице, то не произойдет вставки в прикрепленные материализованные представления. Такое поведение существует, чтобы разрешить вставку высокоагрегированных данных в материализованные представления, для случаев, когда вставленные блоки совпадают после агрегации в материализованном представлении, но происходят из разных вставок в исходную таблицу.
В то же время это поведение "ломает" идемпотентность `INSERT`. Если `INSERT` в основную таблицу был успешным, а `INSERT` в материализованное представление не удался (например, из-за сбоя связи с ClickHouse Keeper), клиент получит ошибку и сможет повторить операцию. Однако материализованное представление не получит вторую вставку, потому что она будет отброшена из-за дедупликации в главной (исходной) таблице. Настройка `deduplicate_blocks_in_dependent_materialized_views` позволяет изменить это поведение. При повторе материализованное представление получит повторную вставку и выполнит проверку дедупликации самостоятельно, игнорируя результат проверки для исходной таблицы, и вставит строки, которые утеряны из-за первой ошибки.

## default_materialized_view_sql_security {#default_materialized_view_sql_security}

Тип: SQLSecurityType

Значение по умолчанию: DEFINER

Позволяет установить значение по умолчанию для опции SQL SECURITY при создании материализованного представления. [Больше о безопасности SQL](../../sql-reference/statements/create/view.md/#sql_security).

Значение по умолчанию — `DEFINER`.

## default_max_bytes_in_join {#default_max_bytes_in_join}

Тип: UInt64

Значение по умолчанию: 1000000000

Максимальный размер правой стороны таблицы, если требуется ограничение, но max_bytes_in_join не установлен.

## default_normal_view_sql_security {#default_normal_view_sql_security}

Тип: SQLSecurityType

Значение по умолчанию: INVOKER

Позволяет установить значение по умолчанию для `SQL SECURITY` при создании нормального представления. [Больше о безопасности SQL](../../sql-reference/statements/create/view.md/#sql_security).

Значение по умолчанию — `INVOKER`.
```
```yaml
title: 'default_table_engine'
sidebar_label: 'default_table_engine'
keywords: ['default_table_engine', 'ClickHouse']
description: 'Общий механизм таблицы по умолчанию.'
```

## default_table_engine {#default_table_engine}

Type: DefaultTableEngine

Default value: MergeTree

Механизм таблицы по умолчанию, который используется, когда `ENGINE` не указан в операторе `CREATE`.

Possible values:

- строка, представляющая любое допустимое имя механизма таблицы

Cloud default value: `SharedMergeTree`.

**Пример**

Запрос:

```sql
SET default_table_engine = 'Log';

SELECT name, value, changed FROM system.settings WHERE name = 'default_table_engine';
```

Результат:

```response
┌─name─────────────────┬─value─┬─changed─┐
│ default_table_engine │ Log   │       1 │
└──────────────────────┴───────┴─────────┘
```

В этом примере любая новая таблица, которая не указывает `Engine`, будет использовать механизм таблицы `Log`:

Запрос:

```sql
CREATE TABLE my_table (
    x UInt32,
    y UInt32
);

SHOW CREATE TABLE my_table;
```

Результат:

```response
┌─statement────────────────────────────────────────────────────────────────┐
│ CREATE TABLE default.my_table
(
    `x` UInt32,
    `y` UInt32
)
ENGINE = Log
└──────────────────────────────────────────────────────────────────────────┘
```
## default_temporary_table_engine {#default_temporary_table_engine}

Type: DefaultTableEngine

Default value: Memory

Так же, как и [default_table_engine](#default_table_engine), но для временных таблиц.

В этом примере любая новая временная таблица, которая не указывает `Engine`, будет использовать механизм таблицы `Log`:

Запрос:

```sql
SET default_temporary_table_engine = 'Log';

CREATE TEMPORARY TABLE my_table (
    x UInt32,
    y UInt32
);

SHOW CREATE TEMPORARY TABLE my_table;
```

Результат:

```response
┌─statement────────────────────────────────────────────────────────────────┐
│ CREATE TEMPORARY TABLE default.my_table
(
    `x` UInt32,
    `y` UInt32
)
ENGINE = Log
└──────────────────────────────────────────────────────────────────────────┘
```
## default_view_definer {#default_view_definer}

Type: String

Default value: CURRENT_USER

Позволяет задать значение параметра `DEFINER` по умолчанию при создании представления. [Подробнее о безопасности SQL](../../sql-reference/statements/create/view.md/#sql_security).

Значение по умолчанию: `CURRENT_USER`.

## describe_compact_output {#describe_compact_output}

Type: Bool

Default value: 0

Если истинно, включает только имена столбцов и типы в результате запроса DESCRIBE.

## describe_extend_object_types {#describe_extend_object_types}

Type: Bool

Default value: 0

Определяет конкретный тип столбцов типа Object в запросе DESCRIBE.

## describe_include_subcolumns {#describe_include_subcolumns}

Type: Bool

Default value: 0

Включает описание подстолбцов для запроса [DESCRIBE](../../sql-reference/statements/describe-table.md). Например, элементы [Tuple](../../sql-reference/data-types/tuple.md) или подстолбцы типа [Map](/sql-reference/data-types/map#reading-subcolumns-of-map), [Nullable](../../sql-reference/data-types/nullable.md/#finding-null) или [Array](../../sql-reference/data-types/array.md/#array-size).

Possible values:

- 0 — Подстолбцы не включаются в запросы `DESCRIBE`.
- 1 — Подстолбцы включаются в запросы `DESCRIBE`.

**Пример**

Смотрите пример для оператора [DESCRIBE](../../sql-reference/statements/describe-table.md).

## describe_include_virtual_columns {#describe_include_virtual_columns}

Type: Bool

Default value: 0

Если истинно, виртуальные столбцы таблицы будут включены в результат запроса DESCRIBE.

## dialect {#dialect}

Type: Dialect

Default value: clickhouse

Какой диалект будет использоваться для анализа запроса.

## dictionary_validate_primary_key_type {#dictionary_validate_primary_key_type}

Type: Bool

Default value: 0

Проверка типа первичного ключа для словарей. По умолчанию тип id для простых схем будет неявно преобразован в UInt64.

## distinct_overflow_mode {#distinct_overflow_mode}

Type: OverflowMode

Default value: throw

Что делать, когда лимит превышен.

## distributed_aggregation_memory_efficient {#distributed_aggregation_memory_efficient}

Type: Bool

Default value: 1

Включен ли режим экономии памяти для распределенной агрегации.

## distributed_background_insert_batch {#distributed_background_insert_batch}

Type: Bool

Default value: 0

Включает/выключает отправку вставленных данных пакетами.

Когда пакетная отправка включена, движок таблицы [Distributed](../../engines/table-engines/special/distributed.md) пытается отправить несколько файлов вставленных данных в одной операции вместо отправки их по отдельности. Пакетная отправка улучшает производительность кластера, лучше используя ресурсы сервера и сети.

Possible values:

- 1 — Включено.
- 0 — Выключено.

## distributed_background_insert_max_sleep_time_ms {#distributed_background_insert_max_sleep_time_ms}

Type: Milliseconds

Default value: 30000

Максимальный интервал для движка таблицы [Distributed](../../engines/table-engines/special/distributed.md) для отправки данных. Ограничивает экспоненциальный рост интервала, установленных в настройке [distributed_background_insert_sleep_time_ms](#distributed_background_insert_sleep_time_ms).

Possible values:

- Положительное целое число миллисекунд.

## distributed_background_insert_sleep_time_ms {#distributed_background_insert_sleep_time_ms}

Type: Milliseconds

Default value: 100

Базовый интервал для движка таблицы [Distributed](../../engines/table-engines/special/distributed.md) для отправки данных. Фактический интервал растет экспоненциально в случае ошибок.

Possible values:

- Положительное целое число миллисекунд.

## distributed_background_insert_split_batch_on_failure {#distributed_background_insert_split_batch_on_failure}

Type: Bool

Default value: 0

Включает/выключает разделение пакетов в случае неудачи.

Иногда отправка конкретного пакета на удаленный шард может завершиться неудачей из-за сложного конвейера после (например, `MATERIALIZED VIEW` с `GROUP BY`) из-за `Memory limit exceeded` или подобных ошибок. В этом случае повторная попытка не поможет (и это заблокирует распределенную отправку для таблицы), но отправка файлов из этого пакета по одному может привести к успеху вставки.

Поэтому установка этой настройки в `1` отключит пакетную отправку для таких пакетов (то есть временно отключает `distributed_background_insert_batch` для неудачных пакетов).

Possible values:

- 1 — Включено.
- 0 — Выключено.

:::note
Эта настройка также влияет на неработающие пакеты (которые могут появляться из-за аномального завершения сервера (машины) и отсутствия `fsync_after_insert`/`fsync_directories` для таблицы [Distributed](../../engines/table-engines/special/distributed.md)).
:::

:::note
Вы не должны полагаться на автоматическое разделение пакетов, так как это может негативно сказаться на производительности.
:::

## distributed_background_insert_timeout {#distributed_background_insert_timeout}

Type: UInt64

Default value: 0

Таймаут для запросов вставки в распределенные. Настройка используется только с включенным insert_distributed_sync. Нулевое значение означает отсутствие таймаута.

## distributed_cache_bypass_connection_pool {#distributed_cache_bypass_connection_pool}

<CloudAvailableBadge/>

Type: Bool

Default value: 0

Действует только в ClickHouse Cloud. Позволяет обойти пул соединений к распределенному кэшу.

## distributed_cache_connect_max_tries {#distributed_cache_connect_max_tries}

<CloudAvailableBadge/>

Type: UInt64

Default value: 20

Действует только в ClickHouse Cloud. Количество попыток подключения к распределенному кэшу в случае неудачи.

## distributed_cache_data_packet_ack_window {#distributed_cache_data_packet_ack_window}

<CloudAvailableBadge/>

Type: UInt64

Default value: 5

Действует только в ClickHouse Cloud. Окно для отправки ACK для последовательности DataPacket в одном запросе на чтение из распределенного кэша.

## distributed_cache_discard_connection_if_unread_data {#distributed_cache_discard_connection_if_unread_data}

<CloudAvailableBadge/>

Type: Bool

Default value: 1

Действует только в ClickHouse Cloud. Отменяет соединение, если некоторые данные не считаны.

## distributed_cache_fetch_metrics_only_from_current_az {#distributed_cache_fetch_metrics_only_from_current_az}

<CloudAvailableBadge/>

Type: Bool

Default value: 1

Действует только в ClickHouse Cloud. Получает метрики только из текущей доступной зоны в system.distributed_cache_metrics, system.distributed_cache_events.

## distributed_cache_log_mode {#distributed_cache_log_mode}

<CloudAvailableBadge/>

Type: DistributedCacheLogMode

Default value: on_error

Действует только в ClickHouse Cloud. Режим записи в system.distributed_cache_log.

## distributed_cache_max_unacked_inflight_packets {#distributed_cache_max_unacked_inflight_packets}

<CloudAvailableBadge/>

Type: UInt64

Default value: 10

Действует только в ClickHouse Cloud. Максимальное количество неподтвержденных пакетов в одном запросе на чтение из распределенного кэша.

## distributed_cache_min_bytes_for_seek {#distributed_cache_min_bytes_for_seek}

<CloudAvailableBadge/>

Type: UInt64

Default value: 0

Действует только в ClickHouse Cloud. Минимальное количество байтов, необходимых для поиска в распределенном кэше.

## distributed_cache_pool_behaviour_on_limit {#distributed_cache_pool_behaviour_on_limit}

<CloudAvailableBadge/>

Type: DistributedCachePoolBehaviourOnLimit

Default value: wait

Действует только в ClickHouse Cloud. Определяет поведение подключения к распределенному кэшу при достижении предела пула.

## distributed_cache_read_alignment {#distributed_cache_read_alignment}

<CloudAvailableBadge/>

Type: UInt64

Default value: 0

Действует только в ClickHouse Cloud. Настройка для тестирования, не изменяйте ее.

## distributed_cache_receive_response_wait_milliseconds {#distributed_cache_receive_response_wait_milliseconds}

<CloudAvailableBadge/>

Type: UInt64

Default value: 60000

Действует только в ClickHouse Cloud. Время ожидания в миллисекундах для получения данных по запросу от распределенного кэша.

## distributed_cache_receive_timeout_milliseconds {#distributed_cache_receive_timeout_milliseconds}

<CloudAvailableBadge/>

Type: UInt64

Default value: 10000

Действует только в ClickHouse Cloud. Время ожидания в миллисекундах для получения любого ответа от распределенного кэша.

## distributed_cache_throw_on_error {#distributed_cache_throw_on_error}

<CloudAvailableBadge/>

Type: Bool

Default value: 0

Действует только в ClickHouse Cloud. Повторно выбрасывает исключение, произошедшее при взаимодействии с распределенным кэшем, или исключение, полученное от распределенного кэша. В противном случае переходит к пропуску распределенного кэша в случае ошибки.

## distributed_cache_wait_connection_from_pool_milliseconds {#distributed_cache_wait_connection_from_pool_milliseconds}

<CloudAvailableBadge/>

Type: UInt64

Default value: 100

Действует только в ClickHouse Cloud. Время ожидания в миллисекундах для получения соединения из пула соединений, если distributed_cache_pool_behaviour_on_limit равно wait.

## distributed_connections_pool_size {#distributed_connections_pool_size}

Type: UInt64

Default value: 1024

Максимальное количество одновременных соединений с удаленными серверами для распределенной обработки всех запросов к одной таблице Distributed. Рекомендуем устанавливать значение не менее количества серверов в кластере.

## distributed_ddl_entry_format_version {#distributed_ddl_entry_format_version}

Type: UInt64

Default value: 5

Версия совместимости распределенных DDL запросов (ON CLUSTER).

## distributed_ddl_output_mode {#distributed_ddl_output_mode}

Type: DistributedDDLOutputMode

Default value: throw

Устанавливает формат результата распределенного DDL запроса.

Possible values:

- `throw` — Возвращает набор результатов со статусом выполнения запроса для всех хостов, где запрос завершен. Если запрос завершился неудачей на некоторых хостах, он повторно выбрасывает первое исключение. Если запрос еще не завершен на некоторых хостах и превышен [distributed_ddl_task_timeout](#distributed_ddl_task_timeout), тогда выбрасывается исключение `TIMEOUT_EXCEEDED`.
- `none` — Похоже на `throw`, но распределенный DDL запрос не возвращает набор результатов.
- `null_status_on_timeout` — Возвращает `NULL` как статус выполнения в некоторых строках набора результатов вместо того, чтобы выбрасывать `TIMEOUT_EXCEEDED`, если запрос не завершен на соответствующих хостах.
- `never_throw` — Не выбрасывать `TIMEOUT_EXCEEDED` и не повторно выбрасывать исключения, если запрос завершился неудачей на некоторых хостах.
- `none_only_active` — аналогично `none`, но не дожидается неактивных реплик базы данных `Replicated`. Примечание: с этим режимом невозможно определить, что запрос не был выполнен на некоторых репликах и будет выполнен в фоновом режиме.
- `null_status_on_timeout_only_active` — аналогично `null_status_on_timeout`, но не дожидается неактивных реплик базы данных `Replicated`.
- `throw_only_active` — аналогично `throw`, но не дожидается неактивных реплик базы данных `Replicated`.

Cloud default value: `none`.

## distributed_ddl_task_timeout {#distributed_ddl_task_timeout}

Type: Int64

Default value: 180

Устанавливает таймаут для ответов DDL запросов от всех хостов в кластере. Если DDL запрос не был выполнен на всех хостах, ответ будет содержать ошибку таймаута, а запрос будет выполнен в асинхронном режиме. Отрицательное значение означает бесконечность.

Possible values:

- Положительное целое число.
- 0 — Асинхронный режим.
- Отрицательное целое число — бесконечный таймаут.

## distributed_foreground_insert {#distributed_foreground_insert}

Type: Bool

Default value: 0

Включает или отключает синхронную вставку данных в таблицу [Distributed](/engines/table-engines/special/distributed).

По умолчанию, при вставке данных в таблицу `Distributed`, сервер ClickHouse отправляет данные на узлы кластера в фоновом режиме. Когда `distributed_foreground_insert=1`, данные обрабатываются синхронно, и операция `INSERT` завершается успешно только после того, как все данные сохранены на всех шардах (по крайней мере, одна реплика для каждого шарда, если `internal_replication` равно true).

Possible values:

- 0 — Данные вставляются в фоновом режиме.
- 1 — Данные вставляются в синхронном режиме.

Cloud default value: `1`.

**См. также**

- [Distributed Table Engine](/engines/table-engines/special/distributed)
- [Управление распределенными таблицами](/sql-reference/statements/system#managing-distributed-tables)

## distributed_group_by_no_merge {#distributed_group_by_no_merge}

Type: UInt64

Default value: 0

Не объединять состояния агрегации с разных серверов для распределенной обработки запроса, вы можете использовать это, если уверены, что на разных шардах разные ключи.

Possible values:

- `0` — Выключено (финальная обработка запроса происходит на инициализаторе).
- `1` - Не объединять состояния агрегации с разных серверов для распределенной обработки запроса (запрос полностью обрабатывается на шарде, инициатор только проксирует данные), можно использовать, если уверены, что на разных шардах разные ключи.
- `2` - То же, что `1`, но применяет `ORDER BY` и `LIMIT` (это невозможно, когда запрос полностью обрабатывается на удаленном узле, как для `distributed_group_by_no_merge=1`) на инициализаторе (может использоваться для запросов с `ORDER BY` и/или `LIMIT`).

**Пример**

```sql
SELECT *
FROM remote('127.0.0.{2,3}', system.one)
GROUP BY dummy
LIMIT 1
SETTINGS distributed_group_by_no_merge = 1
FORMAT PrettyCompactMonoBlock

┌─dummy─┐
│     0 │
│     0 │
└───────┘
```

```sql
SELECT *
FROM remote('127.0.0.{2,3}', system.one)
GROUP BY dummy
LIMIT 1
SETTINGS distributed_group_by_no_merge = 2
FORMAT PrettyCompactMonoBlock

┌─dummy─┐
│     0 │
└───────┘
```

## distributed_insert_skip_read_only_replicas {#distributed_insert_skip_read_only_replicas}

Type: Bool

Default value: 0

Включает пропуск чтения только для реплик для запросов INSERT в Distributed.

Possible values:

- 0 — INSERT выполняется как обычно, если он попадает на только для чтения реплику, он завершится с ошибкой.
- 1 — Инициатор будет пропускать только для чтения реплики перед отправкой данных на шарды.

## distributed_product_mode {#distributed_product_mode}

Type: DistributedProductMode

Default value: deny

Изменяет поведение [распределенных подзапросов](../../sql-reference/operators/in.md).

ClickHouse применяет эту настройку, когда запрос содержит произведение распределенных таблиц, т.е. когда запрос для распределенной таблицы содержит неподходящий подзапрос для распределенной таблицы.

Ограничения:

- Применяется только для подзапросов IN и JOIN.
- Только если раздел FROM использует распределенную таблицу, содержащую более одного шарда.
- Если подзапрос касается распределенной таблицы, содержащей более одного шарда.
- Не используется для табличной функции [remote](../../sql-reference/table-functions/remote.md).

Possible values:

- `deny` — Значение по умолчанию. Запрещает использование этих типов подзапросов (возвращает исключение "Double-distributed in/JOIN subqueries is denied").
- `local` — Заменяет базу данных и таблицу в подзапросе на локальные для целевого сервера (шарда), оставляя обычные `IN`/`JOIN.`.
- `global` — Заменяет запрос `IN`/`JOIN` на `GLOBAL IN`/`GLOBAL JOIN.`.
- `allow` — Позволяет использование этих типов подзапросов.

## distributed_push_down_limit {#distributed_push_down_limit}

Type: UInt64

Default value: 1

Включает или отключает применение [LIMIT](#limit) на каждом шарде отдельно.

Это позволит избежать:
- Отправки лишних строк по сети;
- Обработки строк, превышающих лимит на инициализаторе.

Начиная с версии 21.9, вы больше не сможете получить неточные результаты, так как `distributed_push_down_limit` изменяет выполнение запроса, только если выполнено хотя бы одно из условий:
- [distributed_group_by_no_merge](#distributed_group_by_no_merge) > 0.
- Запрос **не имеет** `GROUP BY`/`DISTINCT`/`LIMIT BY`, но имеет `ORDER BY`/`LIMIT`.
- Запрос **имеет** `GROUP BY`/`DISTINCT`/`LIMIT BY` с `ORDER BY`/`LIMIT` и:
    - [optimize_skip_unused_shards](#optimize_skip_unused_shards) включена.
    - [optimize_distributed_group_by_sharding_key](#optimize_distributed_group_by_sharding_key) включена.

Possible values:

- 0 — Выключено.
- 1 — Включено.

См. также:

- [distributed_group_by_no_merge](#distributed_group_by_no_merge)
- [optimize_skip_unused_shards](#optimize_skip_unused_shards)
- [optimize_distributed_group_by_sharding_key](#optimize_distributed_group_by_sharding_key)

## distributed_replica_error_cap {#distributed_replica_error_cap}

Type: UInt64

Default value: 1000

- Type: unsigned int
- Default value: 1000

Количество ошибок каждой реплики ограничено этим значением, предотвращая накопление слишком большого количества ошибок в одной реплике.

См. также:

- [load_balancing](#load_balancing-round_robin)
- [Table engine Distributed](../../engines/table-engines/special/distributed.md)
- [distributed_replica_error_half_life](#distributed_replica_error_half_life)
- [distributed_replica_max_ignored_errors](#distributed_replica_max_ignored_errors)

## distributed_replica_error_half_life {#distributed_replica_error_half_life}

Type: Seconds

Default value: 60

- Type: seconds
- Default value: 60 seconds

Контролирует, как быстро ошибки в распределенных таблицах обнуляются. Если реплика недоступна в течение некоторого времени, накапливает 5 ошибок, и значение distributed_replica_error_half_life установлено на 1 секунду, то реплика считается нормальной через 3 секунды после последней ошибки.

См. также:

- [load_balancing](#load_balancing-round_robin)
- [Table engine Distributed](../../engines/table-engines/special/distributed.md)
- [distributed_replica_error_cap](#distributed_replica_error_cap)
- [distributed_replica_max_ignored_errors](#distributed_replica_max_ignored_errors)

## distributed_replica_max_ignored_errors {#distributed_replica_max_ignored_errors}

Type: UInt64

Default value: 0

- Type: unsigned int
- Default value: 0

Количество ошибок, которые будут игнорироваться при выборе реплик (в соответствии с алгоритмом `load_balancing`).

См. также:

- [load_balancing](#load_balancing-round_robin)
- [Table engine Distributed](../../engines/table-engines/special/distributed.md)
- [distributed_replica_error_cap](#distributed_replica_error_cap)
- [distributed_replica_error_half_life](#distributed_replica_error_half_life)

## do_not_merge_across_partitions_select_final {#do_not_merge_across_partitions_select_final}

Type: Bool

Default value: 0

Объединять части только в одном разделе в select final.

## empty_result_for_aggregation_by_constant_keys_on_empty_set {#empty_result_for_aggregation_by_constant_keys_on_empty_set}

Type: Bool

Default value: 1

Возвращает пустой результат при агрегации по постоянным ключам на пустом наборе.

## empty_result_for_aggregation_by_empty_set {#empty_result_for_aggregation_by_empty_set}

Type: Bool

Default value: 0

Возвращает пустой результат при агрегации без ключей на пустом наборе.

## enable_adaptive_memory_spill_scheduler {#enable_adaptive_memory_spill_scheduler}
<ExperimentalBadge/>

Type: Bool

Default value: 0

Срабатывает процессор для адаптивного сброса данных во внешнее хранилище. Поддерживается grace join в настоящее время.

## enable_blob_storage_log {#enable_blob_storage_log}

Type: Bool

Default value: 1

Записывает информацию об операциях хранилища блобов в таблицу system.blob_storage_log.

## enable_deflate_qpl_codec {#enable_deflate_qpl_codec}

Type: Bool

Default value: 0

Если включено, кодек DEFLATE_QPL может использоваться для сжатия столбцов.

## enable_early_constant_folding {#enable_early_constant_folding}

Type: Bool

Default value: 1

Включает оптимизацию запроса, в которой мы анализируем результаты функции и подзапросов и переписываем запрос, если там есть константы.

## enable_extended_results_for_datetime_functions {#enable_extended_results_for_datetime_functions}

Type: Bool

Default value: 0

Включает или отключает возврат результатов типа:
- `Date32` с расширенным диапазоном (в сравнении с типом `Date`) для функций [toStartOfYear](../../sql-reference/functions/date-time-functions.md/#tostartofyear), [toStartOfISOYear](../../sql-reference/functions/date-time-functions.md/#tostartofisoyear), [toStartOfQuarter](../../sql-reference/functions/date-time-functions.md/#tostartofquarter), [toStartOfMonth](../../sql-reference/functions/date-time-functions.md/#tostartofmonth), [toLastDayOfMonth](../../sql-reference/functions/date-time-functions.md/#tolastdayofmonth), [toStartOfWeek](../../sql-reference/functions/date-time-functions.md/#tostartofweek), [toLastDayOfWeek](../../sql-reference/functions/date-time-functions.md/#tolastdayofweek) и [toMonday](../../sql-reference/functions/date-time-functions.md/#tomonday).
- `DateTime64` с расширенным диапазоном (в сравнении с типом `DateTime`) для функций [toStartOfDay](../../sql-reference/functions/date-time-functions.md/#tostartofday), [toStartOfHour](../../sql-reference/functions/date-time-functions.md/#tostartofhour), [toStartOfMinute](../../sql-reference/functions/date-time-functions.md/#tostartofminute), [toStartOfFiveMinutes](../../sql-reference/functions/date-time-functions.md/#tostartoffiveminutes), [toStartOfTenMinutes](../../sql-reference/functions/date-time-functions.md/#tostartoftenminutes), [toStartOfFifteenMinutes](../../sql-reference/functions/date-time-functions.md/#tostartoffifteenminutes) и [timeSlot](../../sql-reference/functions/date-time-functions.md/#timeslot).

Possible values:

- 0 — Функции возвращают `Date` или `DateTime` для всех типов аргументов.
- 1 — Функции возвращают `Date32` или `DateTime64` для аргументов `Date32` или `DateTime64`, а `Date` или `DateTime` в противном случае.

## enable_filesystem_cache {#enable_filesystem_cache}

Type: Bool

Default value: 1

Используйте кэш для удаленной файловой системы. Эта настройка не включает/выключает кэш для дисков (это должно быть сделано через конфигурацию диска), но позволяет обойти кэш для некоторых запросов, если это нужно.

## enable_filesystem_cache_log {#enable_filesystem_cache_log}

Type: Bool

Default value: 0

Позволяет записывать журнал кэширования файловой системы для каждого запроса.

## enable_filesystem_cache_on_write_operations {#enable_filesystem_cache_on_write_operations}

Type: Bool

Default value: 0

Запись в кэш при операциях записи. Чтобы эта настройка заработала, ее также необходимо добавить в конфигурацию диска.

## enable_filesystem_read_prefetches_log {#enable_filesystem_read_prefetches_log}

Type: Bool

Default value: 0

Записывает в систему.filesystem prefetch_log во время запроса. Должно использоваться только для тестирования или отладки, не рекомендуется включать по умолчанию.

## enable_global_with_statement {#enable_global_with_statement}

Type: Bool

Default value: 1

Распространяет операторы WITH на объединенные запросы и все подзапросы.

## enable_hdfs_pread {#enable_hdfs_pread}

Type: Bool

Default value: 1

Включает или отключает pread для файлов HDFS. По умолчанию используется `hdfsPread`. Если отключено, для чтения файлов hdfs будут использоваться `hdfsRead` и `hdfsSeek`.

## enable_http_compression {#enable_http_compression}

Type: Bool

Default value: 0

Включает или отключает сжатие данных в ответе на HTTP-запрос.

Для получения дополнительной информации читайте [описание HTTP интерфейса](../../interfaces/http.md).

Possible values:

- 0 — Выключено.
- 1 — Включено.

## enable_job_stack_trace {#enable_job_stack_trace}

Type: Bool

Default value: 1

Выводит трассировку стека создателя задания, когда работа завершается исключением.

## enable_lightweight_delete {#enable_lightweight_delete}

Type: Bool

Default value: 1

Включает легковесные мутации DELETE для таблиц mergetree.

## enable_memory_bound_merging_of_aggregation_results {#enable_memory_bound_merging_of_aggregation_results}

Type: Bool

Default value: 1

Включает стратегию слияния, ограниченную памятью, для агрегации.

## enable_multiple_prewhere_read_steps {#enable_multiple_prewhere_read_steps}

Type: Bool

Default value: 1

Переносит больше условий из WHERE в PREWHERE и выполняет чтение с диска и фильтрацию в несколько этапов, если есть несколько условий, объединенных с AND.

## enable_named_columns_in_function_tuple {#enable_named_columns_in_function_tuple}

Type: Bool

Default value: 0

Генерирует именованные кортежи в функции tuple() когда все имена уникальны и могут рассматриваться как нецитируемые идентификаторы.

## enable_optimize_predicate_expression {#enable_optimize_predicate_expression}

Type: Bool

Default value: 1

Включает продвижение предикатов в запросах `SELECT`.

Продвижение предикатов может значительно снизить сетевой трафик для распределенных запросов.

Possible values:

- 0 — Выключено.
- 1 — Включено.

Использование

Рассмотрим следующие запросы:

1.  `SELECT count() FROM test_table WHERE date = '2018-10-10'`
2.  `SELECT count() FROM (SELECT * FROM test_table) WHERE date = '2018-10-10'`

Если `enable_optimize_predicate_expression = 1`, то время выполнения этих запросов будет одинаковым, так как ClickHouse применяет `WHERE` к подзапросу при его обработке.

Если `enable_optimize_predicate_expression = 0`, то время выполнения второго запроса будет намного дольше, так как условие `WHERE` применяется ко всем данным после завершения подзапроса.

## enable_optimize_predicate_expression_to_final_subquery {#enable_optimize_predicate_expression_to_final_subquery}

Type: Bool

Default value: 1

Разрешает продвижение предикатов к финальному подзапросу.

## enable_order_by_all {#enable_order_by_all}

Type: Bool

Default value: 1

Включает или отключает сортировку с использованием синтаксиса `ORDER BY ALL`, см. [ORDER BY](../../sql-reference/statements/select/order-by.md).

Possible values:

- 0 — Выключить ORDER BY ALL.
- 1 — Включить ORDER BY ALL.

**Пример**

Запрос:

```sql
CREATE TABLE TAB(C1 Int, C2 Int, ALL Int) ENGINE=Memory();

INSERT INTO TAB VALUES (10, 20, 30), (20, 20, 10), (30, 10, 20);

SELECT * FROM TAB ORDER BY ALL; -- возвращает ошибку, что ALL является неоднозначным.

SELECT * FROM TAB ORDER BY ALL SETTINGS enable_order_by_all = 0;
```

Результат:

```text
┌─C1─┬─C2─┬─ALL─┐
│ 20 │ 20 │  10 │
│ 30 │ 10 │  20 │
│ 10 │ 20 │  30 │
└────┴────┴─────┘
```

## enable_parsing_to_custom_serialization {#enable_parsing_to_custom_serialization}

Type: Bool

Default value: 1

Если истинно, данные могут быть разобраны непосредственно в столбцы с пользовательской сериализацией (например, Sparse) в соответствии с подсказками для сериализации, полученными из таблицы.

## enable_positional_arguments {#enable_positional_arguments}

Type: Bool

Default value: 1

Включает или отключает поддержку позиционных аргументов для [GROUP BY](/sql-reference/statements/select/group-by), [LIMIT BY](../../sql-reference/statements/select/limit-by.md), [ORDER BY](../../sql-reference/statements/select/order-by.md).

Possible values:

- 0 — Позиционные аргументы не поддерживаются.
- 1 — Позиционные аргументы поддерживаются: можно использовать номера столбцов вместо имен столбцов.

**Пример**

Запрос:

```sql
CREATE TABLE positional_arguments(one Int, two Int, three Int) ENGINE=Memory();

INSERT INTO positional_arguments VALUES (10, 20, 30), (20, 20, 10), (30, 10, 20);

SELECT * FROM positional_arguments ORDER BY 2,3;
```

Результат:

```text
┌─one─┬─two─┬─three─┐
│  30 │  10 │   20  │
│  20 │  20 │   10  │
│  10 │  20 │   30  │
└─────┴─────┴───────┘
```

## enable_reads_from_query_cache {#enable_reads_from_query_cache}

Type: Bool

Default value: 1

Если включено, результаты запросов `SELECT` извлекаются из [кэша запросов](../query-cache.md).

Possible values:

- 0 - Выключено.
- 1 - Включено.

## enable_s3_requests_logging {#enable_s3_requests_logging}

Type: Bool

Default value: 0

Включает очень детализированное логирование запросов S3. Имеет смысл только для отладки.

## enable_scalar_subquery_optimization {#enable_scalar_subquery_optimization}

Type: Bool

Default value: 1

Если установлено в истину, предотвращает (де)сериализацию больших скалярных значений подзапросов и, возможно, избегает выполнения одного и того же подзапроса более одного раза.

## enable_sharing_sets_for_mutations {#enable_sharing_sets_for_mutations}

Type: Bool

Default value: 1

Позволяет делиться объектами наборов, созданными для подзапросов IN, между различными задачами одной мутации. Это снижает использование памяти и расход CPU.

## enable_software_prefetch_in_aggregation {#enable_software_prefetch_in_aggregation}

Type: Bool

Default value: 1

Включает использование программного предвыборки в агрегации.

## enable_unaligned_array_join {#enable_unaligned_array_join}

Type: Bool

Default value: 0

Разрешает ARRAY JOIN с несколькими массивами, которые имеют разные размеры. Когда эта настройка включена, массивы будут изменяться по размеру к самому длинному.

## enable_url_encoding {#enable_url_encoding}

Type: Bool

Default value: 1

Позволяет включить/выключить декодирование/кодирование пути в uri в таблицах механизма [URL](../../engines/table-engines/special/url.md).

Включено по умолчанию.


## enable_vertical_final {#enable_vertical_final}

Тип: Bool

По умолчанию: 1

Если включено, удаляет дублированные строки во время FINAL, помечая строки как удаленные и фильтруя их позже, вместо слияния строк.
## enable_writes_to_query_cache {#enable_writes_to_query_cache}

Тип: Bool

По умолчанию: 1

Если включено, результаты запросов `SELECT` сохраняются в [кэше запросов](../query-cache.md).

Допустимые значения:

- 0 - Отключено
- 1 - Включено
## enable_zstd_qat_codec {#enable_zstd_qat_codec}

Тип: Bool

По умолчанию: 0

Если включено, кодек ZSTD_QAT может быть использован для сжатия столбцов.
## enforce_strict_identifier_format {#enforce_strict_identifier_format}

Тип: Bool

По умолчанию: 0

Если включено, разрешены только идентификаторы, содержащие буквенно-цифровые символы и подчеркивания.
## engine_file_allow_create_multiple_files {#engine_file_allow_create_multiple_files}

Тип: Bool

По умолчанию: 0

Включает или отключает создание нового файла при каждом вставке в таблицы файлового движка, если формат имеет суффикс (`JSON`, `ORC`, `Parquet` и т. д.). Если включено, при каждой вставке будет создан новый файл с именем, следуя этому шаблону:

`data.Parquet` -> `data.1.Parquet` -> `data.2.Parquet` и т. д.

Допустимые значения:
- 0 — Запрос `INSERT` добавляет новые данные в конец файла.
- 1 — Запрос `INSERT` создает новый файл.
## engine_file_empty_if_not_exists {#engine_file_empty_if_not_exists}

Тип: Bool

По умолчанию: 0

Позволяет выбирать данные из таблицы файлового движка без файла.

Допустимые значения:
- 0 — `SELECT` выбрасывает исключение.
- 1 — `SELECT` возвращает пустой результат.
## engine_file_skip_empty_files {#engine_file_skip_empty_files}

Тип: Bool

По умолчанию: 0

Включает или отключает пропуск пустых файлов в таблицах [File](../../engines/table-engines/special/file.md).

Допустимые значения:
- 0 — `SELECT` выбрасывает исключение, если пустой файл несовместим с запрашиваемым форматом.
- 1 — `SELECT` возвращает пустой результат для пустого файла.
## engine_file_truncate_on_insert {#engine_file_truncate_on_insert}

Тип: Bool

По умолчанию: 0

Включает или отключает обрезку перед вставкой в таблицы [File](../../engines/table-engines/special/file.md).

Допустимые значения:
- 0 — Запрос `INSERT` добавляет новые данные в конец файла.
- 1 — Запрос `INSERT` заменяет существующее содержимое файла новыми данными.
## engine_url_skip_empty_files {#engine_url_skip_empty_files}

Тип: Bool

По умолчанию: 0

Включает или отключает пропуск пустых файлов в таблицах [URL](../../engines/table-engines/special/url.md).

Допустимые значения:
- 0 — `SELECT` выбрасывает исключение, если пустой файл несовместим с запрашиваемым форматом.
- 1 — `SELECT` возвращает пустой результат для пустого файла.
## except_default_mode {#except_default_mode}

Тип: SetOperationMode

По умолчанию: ALL

Устанавливает режим по умолчанию в запросе EXCEPT. Допустимые значения: пустая строка, 'ALL', 'DISTINCT'. Если пусто, запрос без режима вызовет исключение.
## external_storage_connect_timeout_sec {#external_storage_connect_timeout_sec}

Тип: UInt64

По умолчанию: 10

Таймаут подключения в секундах. В настоящее время поддерживается только для MySQL.
## external_storage_max_read_bytes {#external_storage_max_read_bytes}

Тип: UInt64

По умолчанию: 0

Ограничивает максимальное количество байт, когда таблица с внешним движком должна сбросить исторические данные. В настоящее время поддерживается только для движка таблицы MySQL, движка базы данных и словаря. Если равно 0, эта настройка отключена.
## external_storage_max_read_rows {#external_storage_max_read_rows}

Тип: UInt64

По умолчанию: 0

Ограничивает максимальное количество строк, когда таблица с внешним движком должна сбросить исторические данные. В настоящее время поддерживается только для движка таблицы MySQL, движка базы данных и словаря. Если равно 0, эта настройка отключена.
## external_storage_rw_timeout_sec {#external_storage_rw_timeout_sec}

Тип: UInt64

По умолчанию: 300

Таймаут на чтение/запись в секундах. В настоящее время поддерживается только для MySQL.
## external_table_functions_use_nulls {#external_table_functions_use_nulls}

Тип: Bool

По умолчанию: 1

Определяет, как таблицы-функции [mysql](../../sql-reference/table-functions/mysql.md), [postgresql](../../sql-reference/table-functions/postgresql.md) и [odbc](../../sql-reference/table-functions/odbc.md) используют Nullable столбцы.

Допустимые значения:

- 0 — Табличная функция явно использует Nullable столбцы.
- 1 — Табличная функция неявно использует Nullable столбцы.

**Использование**

Если настройка установлена в `0`, табличная функция не создает Nullable столбцы и вставляет значения по умолчанию вместо NULL. Это также применимо к NULL значениям внутри массивов.
## external_table_strict_query {#external_table_strict_query}

Тип: Bool

По умолчанию: 0

Если установлено в true, запрещено преобразование выражений в локальный фильтр для запросов к внешним таблицам.
## extract_key_value_pairs_max_pairs_per_row {#extract_key_value_pairs_max_pairs_per_row}

Тип: UInt64

По умолчанию: 1000

Максимальное количество пар, которые могут быть созданы функцией `extractKeyValuePairs`. Используется в качестве предостережения против потребления слишком большого объема памяти.
## extremes {#extremes}

Тип: Bool

По умолчанию: 0

Определяет, следует ли учитывать крайние значения (минимумы и максимумы в столбцах результата запроса). Принимает 0 или 1. По умолчанию 0 (отключено).
Для получения дополнительной информации см. раздел «Крайние значения».
## fallback_to_stale_replicas_for_distributed_queries {#fallback_to_stale_replicas_for_distributed_queries}

Тип: Bool

По умолчанию: 1

Заставляет запрос использовать устаревшую реплику, если обновленные данные недоступны. См. [Репликация](../../engines/table-engines/mergetree-family/replication.md).

ClickHouse выбирает наиболее актуальную из устаревших реплик таблицы.

Используется при выполнении `SELECT` из распределенной таблицы, указывающей на реплицированные таблицы.

По умолчанию 1 (включено).
## filesystem_cache_boundary_alignment {#filesystem_cache_boundary_alignment}

Тип: UInt64

По умолчанию: 0

Выравнивание границ кэша файловой системы. Эта настройка применяется только для чтения, не использующего диск (например, для кэша удаленных движков таблиц/таблиц функций, но не для конфигурации хранения таблиц MergeTree). Значение 0 означает отсутствие выравнивания.
## filesystem_cache_enable_background_download_during_fetch {#filesystem_cache_enable_background_download_during_fetch}

<CloudAvailableBadge/>

Тип: Bool

По умолчанию: 1

Влияет только в ClickHouse Cloud. Время ожидания для блокировки кэша для резервирования пространства в кэше файловой системы.
## filesystem_cache_enable_background_download_for_metadata_files_in_packed_storage {#filesystem_cache_enable_background_download_for_metadata_files_in_packed_storage}

<CloudAvailableBadge/>

Тип: Bool

По умолчанию: 1

Влияет только в ClickHouse Cloud. Время ожидания для блокировки кэша для резервирования пространства в кэше файловой системы.
## filesystem_cache_max_download_size {#filesystem_cache_max_download_size}

Тип: UInt64

По умолчанию: 137438953472

Максимальный размер загрузки удаленного кэша файловой системы, который может быть загружен одним запросом.
## filesystem_cache_name {#filesystem_cache_name}

Тип: String

По умолчанию: 

Имя кэша файловой системы, которое следует использовать для безстатусных движков таблиц или озер данных.
## filesystem_cache_prefer_bigger_buffer_size {#filesystem_cache_prefer_bigger_buffer_size}

Тип: Bool

По умолчанию: 1

Предпочитать больший размер буфера, если кэш файловой системы включен, чтобы избежать записи небольших сегментов файлов, что ухудшает производительность кэша. С другой стороны, включение этой настройки может увеличить использование памяти.
## filesystem_cache_reserve_space_wait_lock_timeout_milliseconds {#filesystem_cache_reserve_space_wait_lock_timeout_milliseconds}

Тип: UInt64

По умолчанию: 1000

Время ожидания для блокировки кэша для резервирования пространства в кэше файловой системы.
## filesystem_cache_segments_batch_size {#filesystem_cache_segments_batch_size}

Тип: UInt64

По умолчанию: 20

Ограничение на размер одной партии сегментов файлов, которые буфер чтения может запросить из кэша. Слишком маленькое значение приведет к чрезмерным запросам к кэшу, слишком большое может замедлить выгрузку из кэша.
## filesystem_cache_skip_download_if_exceeds_per_query_cache_write_limit {#filesystem_cache_skip_download_if_exceeds_per_query_cache_write_limit}

Тип: Bool

По умолчанию: 1

Пропустить загрузку из удаленного файлового хранилища, если превышен лимит записи кэша запросов.
## filesystem_prefetch_max_memory_usage {#filesystem_prefetch_max_memory_usage}

Тип: UInt64

По умолчанию: 1073741824

Максимальное использование памяти для предзагрузки.
## filesystem_prefetch_step_bytes {#filesystem_prefetch_step_bytes}

Тип: UInt64

По умолчанию: 0

Шаг предзагрузки в байтах. Ноль означает `auto` - примерно лучший шаг предзагрузки будет автоматически определен, но может не быть 100% лучшим. Фактическое значение может отличаться из-за настройки filesystem_prefetch_min_bytes_for_single_read_task.
## filesystem_prefetch_step_marks {#filesystem_prefetch_step_marks}

Тип: UInt64

По умолчанию: 0

Шаг предзагрузки в метках. Ноль означает `auto` - примерно лучший шаг предзагрузки будет автоматически определен, но может не быть 100% лучшим. Фактическое значение может отличаться из-за настройки filesystem_prefetch_min_bytes_for_single_read_task.
## filesystem_prefetches_limit {#filesystem_prefetches_limit}

Тип: UInt64

По умолчанию: 200

Максимальное количество предзагрузок. Ноль означает неограниченно. Более рекомендованная настройка — `filesystem_prefetches_max_memory_usage`, если вы хотите ограничить количество предзагрузок.
## final {#final}

Тип: Bool

По умолчанию: 0

Автоматически применяет модификатор [FINAL](../../sql-reference/statements/select/from.md/#final-modifier) ко всем таблицам в запросе, к таблицам, где [FINAL](../../sql-reference/statements/select/from.md/#final-modifier) применим, включая присоединенные таблицы и таблицы в подзапросах, и распределенные таблицы.

Допустимые значения:

- 0 - отключено
- 1 - включено

Пример:

```sql
CREATE TABLE test
(
    key Int64,
    some String
)
ENGINE = ReplacingMergeTree
ORDER BY key;

INSERT INTO test FORMAT Values (1, 'first');
INSERT INTO test FORMAT Values (1, 'second');

SELECT * FROM test;
┌─key─┬─some───┐
│   1 │ second │
└─────┴────────┘
┌─key─┬─some──┐
│   1 │ first │
└─────┴───────┘

SELECT * FROM test SETTINGS final = 1;
┌─key─┬─some───┐
│   1 │ second │
└─────┴────────┘

SET final = 1;
SELECT * FROM test;
┌─key─┬─some───┐
│   1 │ second │
└─────┴────────┘
```
## flatten_nested {#flatten_nested}

Тип: Bool

По умолчанию: 1

Устанавливает формат данных для [вложенных](../../sql-reference/data-types/nested-data-structures/index.md) столбцов.

Допустимые значения:

- 1 — Вложенный столбец разравнивается в отдельные массивы.
- 0 — Вложенный столбец остается единым массивом кортежей.

**Использование**

Если настройка установлена в `0`, допускается произвольный уровень вложенности.

**Примеры**

Запрос:

```sql
SET flatten_nested = 1;
CREATE TABLE t_nest (`n` Nested(a UInt32, b UInt32)) ENGINE = MergeTree ORDER BY tuple();

SHOW CREATE TABLE t_nest;
```

Результат:

```text
┌─statement───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ CREATE TABLE default.t_nest
(
    `n.a` Array(UInt32),
    `n.b` Array(UInt32)
)
ENGINE = MergeTree
ORDER BY tuple()
SETTINGS index_granularity = 8192 │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

Запрос:

```sql
SET flatten_nested = 0;

CREATE TABLE t_nest (`n` Nested(a UInt32, b UInt32)) ENGINE = MergeTree ORDER BY tuple();

SHOW CREATE TABLE t_nest;
```

Результат:

```text
┌─statement──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ CREATE TABLE default.t_nest
(
    `n` Nested(a UInt32, b UInt32)
)
ENGINE = MergeTree
ORDER BY tuple()
SETTINGS index_granularity = 8192 │
└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```
## force_aggregate_partitions_independently {#force_aggregate_partitions_independently}

Тип: Bool

По умолчанию: 0

Заставляет использовать оптимизацию, когда это применимо, но эвристики решили не использовать ее.
## force_aggregation_in_order {#force_aggregation_in_order}

Тип: Bool

По умолчанию: 0

Эта настройка используется сервером для поддержки распределенных запросов. Не изменяйте ее вручную, так как это нарушит нормальную работу. (Принуждает использование агрегации в порядке на удаленных узлах во время распределенной агрегации).
## force_data_skipping_indices {#force_data_skipping_indices}

Тип: String

По умолчанию: 

Отключает выполнение запроса, если переданные индексы пропуска данных не были использованы.

Рассмотрим следующий пример:

```sql
CREATE TABLE data
(
    key Int,
    d1 Int,
    d1_null Nullable(Int),
    INDEX d1_idx d1 TYPE minmax GRANULARITY 1,
    INDEX d1_null_idx assumeNotNull(d1_null) TYPE minmax GRANULARITY 1
)
Engine=MergeTree()
ORDER BY key;

SELECT * FROM data_01515;
SELECT * FROM data_01515 SETTINGS force_data_skipping_indices=''; -- запрос вызовет ошибку CANNOT_PARSE_TEXT.
SELECT * FROM data_01515 SETTINGS force_data_skipping_indices='d1_idx'; -- запрос вызовет ошибку INDEX_NOT_USED.
SELECT * FROM data_01515 WHERE d1 = 0 SETTINGS force_data_skipping_indices='d1_idx'; -- Ок.
SELECT * FROM data_01515 WHERE d1 = 0 SETTINGS force_data_skipping_indices='`d1_idx`'; -- Ок (пример полного парсера).
SELECT * FROM data_01515 WHERE d1 = 0 SETTINGS force_data_skipping_indices='`d1_idx`, d1_null_idx'; -- запрос вызовет ошибку INDEX_NOT_USED, так как d1_null_idx не использовался.
SELECT * FROM data_01515 WHERE d1 = 0 AND assumeNotNull(d1_null) = 0 SETTINGS force_data_skipping_indices='`d1_idx`, d1_null_idx'; -- Ок.
```
## force_grouping_standard_compatibility {#force_grouping_standard_compatibility}

Тип: Bool

По умолчанию: 1

Заставляет функцию GROUPING возвращать 1, когда аргумент не используется в качестве ключа агрегации.
## force_index_by_date {#force_index_by_date}

Тип: Bool

По умолчанию: 0

Отключает выполнение запроса, если индекс не может быть использован по дате.

Работает с таблицами в семействе MergeTree.

Если `force_index_by_date=1`, ClickHouse проверяет, есть ли в запросе условие по ключу даты, которое может быть использовано для ограничения диапазонов данных. Если подходящего условия нет, выбрасывается исключение. Однако не проверяется, уменьшает ли условие объем данных для чтения. Например, условие `Date != ' 2000-01-01 '` приемлемо, даже если оно соответствует всем данным в таблице (т.е. выполнение запроса требует полного сканирования). Для получения дополнительной информации о диапазонах данных в таблицах MergeTree см. [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md).
## force_optimize_projection {#force_optimize_projection}

Тип: Bool

По умолчанию: 0

Включает или отключает обязательное использование [проекций](../../engines/table-engines/mergetree-family/mergetree.md/#projections) в запросах `SELECT`, когда оптимизация проекции включена (см. настройку [optimize_use_projections](#optimize_use_projections)).

Допустимые значения:

- 0 — Оптимизация проекции не является обязательной.
- 1 — Оптимизация проекции является обязательной.
## force_optimize_projection_name {#force_optimize_projection_name}

Тип: String

По умолчанию: 

Если установлено в непустую строку, проверьте, что эта проекция используется в запросе хотя бы один раз.

Допустимые значения:

- string: имя проекции, используемой в запросе.
## force_optimize_skip_unused_shards {#force_optimize_skip_unused_shards}

Тип: UInt64

По умолчанию: 0

Включает или отключает выполнение запроса, если [optimize_skip_unused_shards](#force_optimize_skip_unused_shards) включена и пропуск неиспользуемых шардов невозможен. Если пропуск невозможен и настройка включена, будет выброшено исключение.

Допустимые значения:

- 0 — Отключено. ClickHouse не выбрасывает исключение.
- 1 — Включено. Выполнение запроса отключается только, если у таблицы есть ключ шардирования.
- 2 — Включено. Выполнение запроса отключается независимо от того, определен ли ключ шардирования для таблицы.
## force_optimize_skip_unused_shards_nesting {#force_optimize_skip_unused_shards_nesting}

Тип: UInt64

По умолчанию: 0

Контролирует [`force_optimize_skip_unused_shards`](#force_optimize_skip_unused_shards) (так что все еще требует [`force_optimize_skip_unused_shards`](#force_optimize_skip_unused_shards)) в зависимости от уровня вложенности распределенного запроса (случай, когда у вас есть распределенная таблица, которая смотрит в другую распределенную таблицу).

Допустимые значения:

- 0 - Отключено, `force_optimize_skip_unused_shards` работает всегда.
- 1 — Включает `force_optimize_skip_unused_shards` только для первого уровня.
- 2 — Включает `force_optimize_skip_unused_shards` до второго уровня.
## force_primary_key {#force_primary_key}

Тип: Bool

По умолчанию: 0

Отключает выполнение запроса, если индексирование по первичному ключу невозможно.

Работает с таблицами в семействе MergeTree.

Если `force_primary_key=1`, ClickHouse проверяет, есть ли в запросе условие первичного ключа, которое может быть использовано для ограничения диапазонов данных. Если подходящего условия нет, выбрасывается исключение. Однако не проверяется, уменьшает ли условие объем данных для чтения. Для получения дополнительной информации о диапазонах данных в таблицах MergeTree см. [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md).
## force_remove_data_recursively_on_drop {#force_remove_data_recursively_on_drop}

Тип: Bool

По умолчанию: 0

Рекурсивно удаляет данные при выполнении запроса DROP. Избегает ошибки «Каталог не пуст», но может молча удалить отвязанные данные.
## formatdatetime_f_prints_scale_number_of_digits {#formatdatetime_f_prints_scale_number_of_digits}

Тип: Bool

По умолчанию: 0

Форматировщик '%f' в функции 'formatDateTime' печатает только количество десятичных разрядов для DateTime64 вместо фиксированных 6 разрядов.
## formatdatetime_f_prints_single_zero {#formatdatetime_f_prints_single_zero}

Тип: Bool

По умолчанию: 0

Форматировщик '%f' в функции 'formatDateTime' печатает ноль вместо шести нулей, если отформатированное значение не имеет дробных секунд.
## formatdatetime_format_without_leading_zeros {#formatdatetime_format_without_leading_zeros}

Тип: Bool

По умолчанию: 0

Форматировщики '%c', '%l' и '%k' в функции 'formatDateTime' печатают месяцы и часы без ведущих нулей.
## formatdatetime_parsedatetime_m_is_month_name {#formatdatetime_parsedatetime_m_is_month_name}

Тип: Bool

По умолчанию: 1

Форматировщик '%M' в функциях 'formatDateTime' и 'parseDateTime' печатает/разбирает название месяца вместо минут.
## fsync_metadata {#fsync_metadata}

Тип: Bool

По умолчанию: 1

Включает или отключает [fsync](http://pubs.opengroup.org/onlinepubs/9699919799/functions/fsync.html) при записи `.sql` файлов. Включен по умолчанию.

Имеет смысл отключить, если у сервера миллионы маленьких таблиц, которые постоянно создаются и удаляются.
## function_implementation {#function_implementation}

Тип: String

По умолчанию: 

Выберите реализацию функции для определенной цели или варианта (экспериментальный). Если пусто, включите их все.
## function_json_value_return_type_allow_complex {#function_json_value_return_type_allow_complex}

Тип: Bool

По умолчанию: 0

Контролирует, разрешено ли возвращать сложный тип (например: структура, массив, карта) для функции json_value.

```sql
SELECT JSON_VALUE('{"hello":{"world":"!"}}', '$.hello') settings function_json_value_return_type_allow_complex=true

┌─JSON_VALUE('{"hello":{"world":"!"}}', '$.hello')─┐
│ {"world":"!"}                                    │
└──────────────────────────────────────────────────┘

1 row in set. Elapsed: 0.001 sec.
```

Допустимые значения:

- true — Разрешено.
- false — Запрещено.
## function_json_value_return_type_allow_nullable {#function_json_value_return_type_allow_nullable}

Тип: Bool

По умолчанию: 0

Контролирует, разрешено ли возвращать `NULL`, когда значение не существует для функции JSON_VALUE.

```sql
SELECT JSON_VALUE('{"hello":"world"}', '$.b') settings function_json_value_return_type_allow_nullable=true;

┌─JSON_VALUE('{"hello":"world"}', '$.b')─┐
│ ᴺᵁᴸᴸ                                   │
└────────────────────────────────────────┘

1 row in set. Elapsed: 0.001 sec.
```

Допустимые значения:

- true — Разрешено.
- false — Запрещено.
## function_locate_has_mysql_compatible_argument_order {#function_locate_has_mysql_compatible_argument_order}

Тип: Bool

По умолчанию: 1

Контролирует порядок аргументов в функции [locate](../../sql-reference/functions/string-search-functions.md/#locate).

Допустимые значения:

- 0 — Функция `locate` принимает аргументы `(haystack, needle[, start_pos])`.
- 1 — Функция `locate` принимает аргументы `(needle, haystack, [, start_pos])` (поведение, совместимое с MySQL).
## function_range_max_elements_in_block {#function_range_max_elements_in_block}

Тип: UInt64

По умолчанию: 500000000

Устанавливает предельное значение для объема данных, генерируемых функцией [range](/sql-reference/functions/array-functions#rangeend-rangestart--end--step). Определяет максимальное количество значений, генерируемых функцией за блок данных (сумма размеров массивов для каждой строки в блоке).

Допустимые значения:

- Положительное целое число.

**Смотрите также**

- [max_block_size](#max_block_size)
- [min_insert_block_size_rows](#min_insert_block_size_rows)
## function_sleep_max_microseconds_per_block {#function_sleep_max_microseconds_per_block}

Тип: UInt64

По умолчанию: 3000000

Максимальное количество микросекунд, на которое функция `sleep` может "уснуть" для каждого блока. Если пользователь вызвал ее с большим значением, будет выброшено исключение. Это предельное значение.
## function_visible_width_behavior {#function_visible_width_behavior}

Тип: UInt64

По умолчанию: 1

Версия поведения `visibleWidth`. 0 - только считайте количество кодовых точек; 1 - правильно считая символы нулевой ширины и комбинирования, считайте полуширокие символы как два, оцените ширину табуляции, считайте символы удаления.
## geo_distance_returns_float64_on_float64_arguments {#geo_distance_returns_float64_on_float64_arguments}

Тип: Bool

По умолчанию: 1

Если все четыре аргумента для функций `geoDistance`, `greatCircleDistance`, `greatCircleAngle` Float64, возвращается Float64 и используется двойная точность для внутренних вычислений. В предыдущих версиях ClickHouse функции всегда возвращали Float32.
## glob_expansion_max_elements {#glob_expansion_max_elements}

Тип: UInt64

По умолчанию: 1000

Максимальное количество допустимых адресов (для внешних хранилищ, табличных функций и т. д.).
## grace_hash_join_initial_buckets {#grace_hash_join_initial_buckets}
<ExperimentalBadge/>

Тип: NonZeroUInt64

По умолчанию: 1

Начальное количество корзин для grace hash join.
## grace_hash_join_max_buckets {#grace_hash_join_max_buckets}
<ExperimentalBadge/>

Тип: NonZeroUInt64

По умолчанию: 1024

Ограничение на количество корзин для grace hash join.
## group_by_overflow_mode {#group_by_overflow_mode}

Тип: OverflowModeGroupBy

По умолчанию: throw

Что делать, когда лимит превышен.
## group_by_two_level_threshold {#group_by_two_level_threshold}

Тип: UInt64

По умолчанию: 100000

С какого количества ключей начинается двухуровневая агрегация. 0 - порог не установлен.
## group_by_two_level_threshold_bytes {#group_by_two_level_threshold_bytes}

Тип: UInt64

По умолчанию: 50000000

С какого размера состояния агрегации в байтах начинается использование двухуровневой агрегации. 0 - порог не установлен. Двухуровневая агрегация используется, когда срабатывает хотя бы один из порогов.
## group_by_use_nulls {#group_by_use_nulls}

Тип: Bool

По умолчанию: 0

Изменяет способ, которым [ORDER BY clause](/sql-reference/statements/select/group-by) обрабатывает типы ключей агрегации.
Когда используются спецификаторы `ROLLUP`, `CUBE` или `GROUPING SETS`, некоторые ключи агрегации могут не использоваться для получения определенных строк результата.
Столбцы для этих ключей заполняются либо значениями по умолчанию, либо `NULL` в соответствующих строках, в зависимости от этой настройки.

Допустимые значения:

- 0 — Используйте значение по умолчанию для типа ключа агрегации, чтобы получить отсутствующие значения.
- 1 — ClickHouse выполняет `GROUP BY` так же, как говорит стандарт SQL. Типы ключей агрегации преобразуются в [Nullable](/sql-reference/data-types/nullable). Столбцы для соответствующих ключей агрегации заполняются [NULL](/sql-reference/syntax#null) для строк, которые их не использовали.

Смотрите также:

- [GROUP BY clause](/sql-reference/statements/select/group-by)
## h3togeo_lon_lat_result_order {#h3togeo_lon_lat_result_order}

Тип: Bool

По умолчанию: 0

Функция 'h3ToGeo' возвращает (lon, lat), если true, иначе (lat, lon).
## handshake_timeout_ms {#handshake_timeout_ms}

Тип: Milliseconds

По умолчанию: 10000

Таймаут в миллисекундах для получения пакета Hello от реплик во время процесса рукопожатия.
## hdfs_create_new_file_on_insert {#hdfs_create_new_file_on_insert}

Тип: Bool

По умолчанию: 0

Включает или отключает создание нового файла при каждой вставке в таблицы HDFS. Если включено, при каждой вставке будет создан новый HDFS файл с именем, подобным этому шаблону:

начальный: `data.Parquet.gz` -> `data.1.Parquet.gz` -> `data.2.Parquet.gz` и т. д.

Допустимые значения:
- 0 — Запрос `INSERT` добавляет новые данные в конец файла.
- 1 — Запрос `INSERT` создает новый файл.
## hdfs_ignore_file_doesnt_exist {#hdfs_ignore_file_doesnt_exist}

Тип: Bool

По умолчанию: 0

Игнорировать отсутствие файла, если он не существует при чтении определенных ключей.

Допустимые значения:
- 1 — `SELECT` возвращает пустой результат.
- 0 — `SELECT` выбрасывает исключение.
## hdfs_replication {#hdfs_replication}

Тип: UInt64

По умолчанию: 0

Фактическое количество реплик можно указать при создании файла hdfs.
## hdfs_skip_empty_files {#hdfs_skip_empty_files}

Тип: Bool

По умолчанию: 0

Включает или отключает пропуск пустых файлов в [HDFS](../../engines/table-engines/integrations/hdfs.md) таблицах.

Допустимые значения:
- 0 — `SELECT` выбрасывает исключение, если пустой файл несовместим с запрашиваемым форматом.
- 1 — `SELECT` возвращает пустой результат для пустого файла.
## hdfs_throw_on_zero_files_match {#hdfs_throw_on_zero_files_match}

Тип: Bool

По умолчанию: 0

Выбрасывает ошибку, если по правилам глобального расширения найдены нулевые файлы.

Допустимые значения:
- 1 — `SELECT` выбрасывает исключение.
- 0 — `SELECT` возвращает пустой результат.
## hdfs_truncate_on_insert {#hdfs_truncate_on_insert}

Тип: Bool

По умолчанию: 0

Включает или отключает обрезку перед вставкой в таблицы hdfs. Если отключено, будет выброшено исключение при попытке вставки, если файл в HDFS уже существует.

Допустимые значения:
- 0 — Запрос `INSERT` добавляет новые данные в конец файла.
- 1 — Запрос `INSERT` заменяет существующее содержимое файла новыми данными.
## hedged_connection_timeout_ms {#hedged_connection_timeout_ms}

Тип: Milliseconds

По умолчанию: 50

Таймаут соединения для установления соединения с репликой для хеджированных запросов.
## hnsw_candidate_list_size_for_search {#hnsw_candidate_list_size_for_search}
<ExperimentalBadge/>

Тип: UInt64

По умолчанию: 256

Размер динамического списка кандидатов при поиске индексом векторного сходства, также известный как 'ef_search'.
## hsts_max_age {#hsts_max_age}

Тип: UInt64

По умолчанию: 0

Время истечения для HSTS. 0 означает отключение HSTS.
## http_connection_timeout {#http_connection_timeout}

Тип: Seconds

По умолчанию: 1

Таймаут соединения HTTP (в секундах).

Допустимые значения:

- Любое положительное целое число.
- 0 - Отключено (бессрочный таймаут).
## http_headers_progress_interval_ms {#http_headers_progress_interval_ms}

Тип: UInt64

По умолчанию: 100

Не отправляйте HTTP заголовки X-ClickHouse-Progress чаще, чем через указанное время.
## http_make_head_request {#http_make_head_request}

Тип: Bool

По умолчанию: 1

Настройка `http_make_head_request` позволяет выполнять `HEAD` запрос при чтении данных из HTTP для получения информации о файле, который будет прочитан, такой как его размер. Поскольку она включена по умолчанию, может быть желательно отключить эту настройку в случаях, когда сервер не поддерживает `HEAD` запросы.
## http_max_field_name_size {#http_max_field_name_size}

Тип: UInt64

По умолчанию: 131072

Максимальная длина имени поля в HTTP заголовке.
## http_max_field_value_size {#http_max_field_value_size}

Тип: UInt64

По умолчанию: 131072

Максимальная длина значения поля в HTTP заголовке.
## http_max_fields {#http_max_fields}

Тип: UInt64

По умолчанию: 1000000

Максимальное количество полей в HTTP заголовке.
## http_max_multipart_form_data_size {#http_max_multipart_form_data_size}

Тип: UInt64

По умолчанию: 1073741824

Ограничение на размер содержимого multipart/form-data. Эта настройка не может быть разобрана из параметров URL и должна быть установлена в пользовательском профиле. Учтите, что содержимое разбирается и внешние таблицы создаются в памяти до начала выполнения запроса. И это единственное ограничение, которое имеет значение на этом этапе (ограничения по максимальному использованию памяти и максимальному времени выполнения не влияют на чтение данных формы HTTP).
## http_max_request_param_data_size {#http_max_request_param_data_size}

Тип: UInt64

По умолчанию: 10485760

Ограничение на размер данных запроса, используемого в качестве параметра запроса в предопределенных HTTP запросах.
## http_max_tries {#http_max_tries}

Тип: UInt64

По умолчанию: 10

Максимальное количество попыток чтения через http.
## http_max_uri_size {#http_max_uri_size}

Тип: UInt64

По умолчанию: 1048576

Устанавливает максимальную длину URI HTTP запроса.

Допустимые значения:

- Положительное целое число.
## http_native_compression_disable_checksumming_on_decompress {#http_native_compression_disable_checksumming_on_decompress}

Тип: Bool

По умолчанию: 0

Включает или отключает проверку контрольной суммы при распаковке данных HTTP POST от клиента. Используется только для формата сжатия ClickHouse (не используется с `gzip` или `deflate`).

Для получения дополнительной информации прочтите [описание интерфейса HTTP](../../interfaces/http.md).

Допустимые значения:

- 0 — Отключено.
- 1 — Включено.
## http_receive_timeout {#http_receive_timeout}

Тип: Seconds

По умолчанию: 30

Таймаут получения HTTP (в секундах).

Допустимые значения:

- Любое положительное целое число.
- 0 - Отключено (бессрочный таймаут).
```
```yaml
title: 'Настройки HTTP'
sidebar_label: 'Настройки HTTP'
keywords: ['http_response_buffer_size', 'http_response_headers', 'http_retry_initial_backoff_ms', 'http_retry_max_backoff_ms', 'http_send_timeout']
description: 'Документация по настройкам HTTP в ClickHouse.'
```

## http_response_buffer_size {#http_response_buffer_size}



Тип: UInt64

Значение по умолчанию: 0

Число байтов для буферизации в памяти сервера перед отправкой HTTP-ответа клиенту или сбросом на диск (когда http_wait_end_of_query включен).

## http_response_headers {#http_response_headers}



Тип: Map

Значение по умолчанию: {}

Позволяет добавлять или переопределять HTTP-заголовки, которые сервер вернет в ответе с успешным результатом запроса. Это влияет только на HTTP-интерфейс.

Если заголовок уже установлен по умолчанию, предоставленное значение его переопределит. Если заголовок не был установлен по умолчанию, то он будет добавлен в список заголовков. Заголовки, установленные сервером по умолчанию и не переопределенные данной настройкой, останутся.

Настройка позволяет установить заголовок на фиксированное значение. В настоящее время нет возможности установить заголовок на динамически рассчитанное значение.

Ни имена, ни значения не могут содержать управляющие символы ASCII.

Если вы реализуете UI-приложение, которое позволяет пользователям изменять настройки, но в то же время принимает решения на основе возвращаемых заголовков, рекомендуется ограничить эту настройку для чтения.

Пример: `SET http_response_headers = '{"Content-Type": "image/png"}'`

## http_retry_initial_backoff_ms {#http_retry_initial_backoff_ms}



Тип: UInt64

Значение по умолчанию: 100

Минимум миллисекунд для задержки при повторной попытке чтения через http.

## http_retry_max_backoff_ms {#http_retry_max_backoff_ms}



Тип: UInt64

Значение по умолчанию: 10000

Максимум миллисекунд для задержки при повторной попытке чтения через http.

## http_send_timeout {#http_send_timeout}



Тип: Seconds

Значение по умолчанию: 30

Тайм-аут отправки HTTP (в секундах).

Возможные значения:

- Любое положительное целое число.
- 0 - Отключено (бесконечный тайм-аут).

:::note
Это применимо только к профилю по умолчанию. Перезагрузка сервера требуется для того, чтобы изменения вступили в силу.
:::

## http_skip_not_found_url_for_globs {#http_skip_not_found_url_for_globs}



Тип: Bool

Значение по умолчанию: 1

Пропустить URL-адреса для шаблонов с ошибкой HTTP_NOT_FOUND.

## http_wait_end_of_query {#http_wait_end_of_query}



Тип: Bool

Значение по умолчанию: 0

Включить буферизацию HTTP-ответа на стороне сервера.

## http_write_exception_in_output_format {#http_write_exception_in_output_format}



Тип: Bool

Значение по умолчанию: 1

Записывать исключения в выходном формате для получения корректного вывода. Работает с форматами JSON и XML.

## http_zlib_compression_level {#http_zlib_compression_level}



Тип: Int64

Значение по умолчанию: 3

Устанавливает уровень сжатия данных в ответе на HTTP-запрос, если [enable_http_compression = 1](#enable_http_compression).

Возможные значения: числа от 1 до 9.

## iceberg_snapshot_id {#iceberg_snapshot_id}



Тип: Int64

Значение по умолчанию: 0

Запрос к таблице Iceberg с использованием конкретного идентификатора снимка.

## iceberg_timestamp_ms {#iceberg_timestamp_ms}



Тип: Int64

Значение по умолчанию: 0

Запрос к таблице Iceberg с использованием снимка, который был актуален в конкретный момент времени.

## idle_connection_timeout {#idle_connection_timeout}



Тип: UInt64

Значение по умолчанию: 3600

Тайм-аут для закрытия неактивных TCP-соединений после указанного количества секунд.

Возможные значения:

- Положительное целое число (0 - закрыть немедленно, через 0 секунд).

## ignore_cold_parts_seconds {#ignore_cold_parts_seconds}


<CloudAvailableBadge/>

Тип: Int64

Значение по умолчанию: 0

Влияет только на ClickHouse Cloud. Исключает новые части данных из SELECT-запросов, пока они не будут предварительно прогреты (см. [cache_populated_by_fetch](merge-tree-settings.md/#cache_populated_by_fetch)) или пока им не исполнится указанное количество секунд. Только для Replicated-/SharedMergeTree.

## ignore_data_skipping_indices {#ignore_data_skipping_indices}



Тип: String

Значение по умолчанию: 

Игнорирует индексы пропуска, указанные, если они используются в запросе.

Рассмотрим следующий пример:

```sql
CREATE TABLE data
(
    key Int,
    x Int,
    y Int,
    INDEX x_idx x TYPE minmax GRANULARITY 1,
    INDEX y_idx y TYPE minmax GRANULARITY 1,
    INDEX xy_idx (x,y) TYPE minmax GRANULARITY 1
)
Engine=MergeTree()
ORDER BY key;

INSERT INTO data VALUES (1, 2, 3);

SELECT * FROM data;
SELECT * FROM data SETTINGS ignore_data_skipping_indices=''; -- запрос выдаст ошибку CANNOT_PARSE_TEXT.
SELECT * FROM data SETTINGS ignore_data_skipping_indices='x_idx'; -- Ок.
SELECT * FROM data SETTINGS ignore_data_skipping_indices='na_idx'; -- Ок.

SELECT * FROM data WHERE x = 1 AND y = 1 SETTINGS ignore_data_skipping_indices='xy_idx',force_data_skipping_indices='xy_idx' ; -- запрос выдаст ошибку INDEX_NOT_USED, так как xy_idx явно игнорируется.
SELECT * FROM data WHERE x = 1 AND y = 2 SETTINGS ignore_data_skipping_indices='xy_idx';
```

Запрос без игнорирования индексов:
```sql
EXPLAIN indexes = 1 SELECT * FROM data WHERE x = 1 AND y = 2;

Expression ((Projection + Before ORDER BY))
  Filter (WHERE)
    ReadFromMergeTree (default.data)
    Indexes:
      PrimaryKey
        Condition: true
        Parts: 1/1
        Granules: 1/1
      Skip
        Name: x_idx
        Description: minmax GRANULARITY 1
        Parts: 0/1
        Granules: 0/1
      Skip
        Name: y_idx
        Description: minmax GRANULARITY 1
        Parts: 0/0
        Granules: 0/0
      Skip
        Name: xy_idx
        Description: minmax GRANULARITY 1
        Parts: 0/0
        Granules: 0/0
```

Игнорирование индекса `xy_idx`:
```sql
EXPLAIN indexes = 1 SELECT * FROM data WHERE x = 1 AND y = 2 SETTINGS ignore_data_skipping_indices='xy_idx';

Expression ((Projection + Before ORDER BY))
  Filter (WHERE)
    ReadFromMergeTree (default.data)
    Indexes:
      PrimaryKey
        Condition: true
        Parts: 1/1
        Granules: 1/1
      Skip
        Name: x_idx
        Description: minmax GRANULARITY 1
        Parts: 0/1
        Granules: 0/1
      Skip
        Name: y_idx
        Description: minmax GRANULARITY 1
        Parts: 0/0
        Granules: 0/0
```

Работает с таблицами из семейства MergeTree.

## ignore_drop_queries_probability {#ignore_drop_queries_probability}



Тип: Float

Значение по умолчанию: 0

Если включено, сервер будет игнорировать все запросы DROP таблиц с указанной вероятностью (для Memory и JOIN движков заменит DROP на TRUNCATE). Используется в тестовых целях.

## ignore_materialized_views_with_dropped_target_table {#ignore_materialized_views_with_dropped_target_table}



Тип: Bool

Значение по умолчанию: 0

Игнорировать МП с удаленной целевой таблицей при отправке в представления.

## ignore_on_cluster_for_replicated_access_entities_queries {#ignore_on_cluster_for_replicated_access_entities_queries}



Тип: Bool

Значение по умолчанию: 0

Игнорировать клаузу ON CLUSTER для управленческих запросов реплицируемых объектов доступа.

## ignore_on_cluster_for_replicated_named_collections_queries {#ignore_on_cluster_for_replicated_named_collections_queries}



Тип: Bool

Значение по умолчанию: 0

Игнорировать клаузу ON CLUSTER для управленческих запросов реплицируемых именованных коллекций.

## ignore_on_cluster_for_replicated_udf_queries {#ignore_on_cluster_for_replicated_udf_queries}



Тип: Bool

Значение по умолчанию: 0

Игнорировать клаузу ON CLUSTER для управленческих запросов реплицируемых UDF.

## implicit_select {#implicit_select}



Тип: Bool

Значение по умолчанию: 0

Разрешить запись простых SELECT-запросов без предваряющего ключевого слова SELECT, что упрощает использование в стиле калькулятора, например `1 + 2` становится допустимым запросом.

В `clickhouse-local` это включено по умолчанию и может быть явно отключено.

## implicit_transaction {#implicit_transaction}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Если включено и запрос не находится внутри транзакции, оборачивает запрос в полную транзакцию (begin + commit или rollback).

## input_format_parallel_parsing {#input_format_parallel_parsing}



Тип: Bool

Значение по умолчанию: 1

Включает или отключает параллельный разбор форматов данных с сохранением порядка. Поддерживается только для форматов [TSV](../../interfaces/formats.md/#tabseparated), [TSKV](../../interfaces/formats.md/#tskv), [CSV](../../interfaces/formats.md/#csv) и [JSONEachRow](../../interfaces/formats.md/#jsoneachrow).

Возможные значения:

- 1 — Включено.
- 0 — Отключено.

## insert_allow_materialized_columns {#insert_allow_materialized_columns}



Тип: Bool

Значение по умолчанию: 0

Если настройка включена, разрешает использование материализованных столбцов при вставке.

## insert_deduplicate {#insert_deduplicate}



Тип: Bool

Значение по умолчанию: 1

Включает или отключает дедупликацию блоков при `INSERT` (для реплицируемых таблиц).

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

По умолчанию блоки, вставленные в реплицируемые таблицы с помощью оператора `INSERT`, дедуплицируются (см. [Репликация данных](../../engines/table-engines/mergetree-family/replication.md)). Для реплицируемых таблиц по умолчанию дедуплицируется только 100 самых последних блоков для каждой партиции (см. [replicated_deduplication_window](merge-tree-settings.md/#replicated-deduplication-window), [replicated_deduplication_window_seconds](merge-tree-settings.md/#replicated-deduplication-window-seconds)). Для не реплицируемых таблиц см. [non_replicated_deduplication_window](merge-tree-settings.md/#non-replicated-dedупликационное-окно).

## insert_deduplication_token {#insert_deduplication_token}



Тип: String

Значение по умолчанию: 

Настройка позволяет пользователю предоставить собственную семантику дедупликации в MergeTree/ReplicatedMergeTree. Например, предоставив уникальное значение для настройки в каждом операторе INSERT, пользователь может избежать дедупликации одинаковых вставленных данных.

Возможные значения:

- Любая строка.

`insert_deduplication_token` используется для дедупликации _только_ при ненулевом значении.

Для реплицируемых таблиц по умолчанию дедуплицируется только 100 самых последних вставок для каждой партиции (см. [replicated_deduplication_window](merge-tree-settings.md/#replicated-deduplication-window), [replicated_deduplication_window_seconds](merge-tree-settings.md/#replicated-deduplication-window-seconds)). Для не реплицируемых таблиц см. [non_replicated_deduplication_window](merge-tree-settings.md/#non-replicated-дедупликационное-окно).

:::note
`insert_deduplication_token` работает на уровне партиции (так же, как и `insert_deduplication` контрольная сумма). У нескольких партиций может быть одно и то же `insert_deduplication_token`.
:::

Пример:

```sql
CREATE TABLE test_table
( A Int64 )
ENGINE = MergeTree
ORDER BY A
SETTINGS non_replicated_deduplication_window = 100;

INSERT INTO test_table SETTINGS insert_deduplication_token = 'test' VALUES (1);

-- следующая вставка не будет дедуплицирована, потому что insert_deduplication_token другой
INSERT INTO test_table SETTINGS insert_deduplication_token = 'test1' VALUES (1);

-- следующая вставка будет дедуплицирована, потому что insert_deduplication_token
-- такой же, как у одной из предыдущих
INSERT INTO test_table SETTINGS insert_deduplication_token = 'test' VALUES (2);

SELECT * FROM test_table

┌─A─┐
│ 1 │
└───┘
┌─A─┐
│ 1 │
└───┘
```

## insert_keeper_fault_injection_probability {#insert_keeper_fault_injection_probability}



Тип: Float

Значение по умолчанию: 0

Приблизительная вероятность сбоя запроса keeper во время вставки. Допустимое значение находится в диапазоне [0.0f, 1.0f].

## insert_keeper_fault_injection_seed {#insert_keeper_fault_injection_seed}



Тип: UInt64

Значение по умолчанию: 0

0 - случайное значение, в противном случае значение настройки.

## insert_keeper_max_retries {#insert_keeper_max_retries}



Тип: UInt64

Значение по умолчанию: 20

Настройка задает максимальное количество повторных попыток запросов ClickHouse Keeper (или ZooKeeper) во время вставки в реплицируемый MergeTree. Только запросы Keeper, которые потерпели неудачу из-за сетевой ошибки, таймаута сессии Keeper или таймаута запроса, учитываются для повторных попыток.

Возможные значения:

- Положительное целое число.
- 0 — Повторы отключены.

Значение по умолчанию в облаке: `20`.

Повторные попытки запросов Keeper выполняются после некоторого таймаута. Тайм-аут контролируется следующими настройками: `insert_keeper_retry_initial_backoff_ms`, `insert_keeper_retry_max_backoff_ms`. Первая попытка выполняется после таймаута `insert_keeper_retry_initial_backoff_ms`. Последующие тайм-ауты будут рассчитаны следующим образом:
```
timeout = min(insert_keeper_retry_max_backoff_ms, latest_timeout * 2)
```

Например, если `insert_keeper_retry_initial_backoff_ms=100`, `insert_keeper_retry_max_backoff_ms=10000` и `insert_keeper_max_retries=8`, то тайм-ауты будут: `100, 200, 400, 800, 1600, 3200, 6400, 10000`.

Кроме отказоустойчивости, повторные попытки предлагают лучший пользовательский опыт - они позволяют избежать возвращения ошибки во время выполнения INSERT, если Keeper перезапускается, например, из-за обновления.

## insert_keeper_retry_initial_backoff_ms {#insert_keeper_retry_initial_backoff_ms}



Тип: UInt64

Значение по умолчанию: 100

Первоначальный тайм-аут (в миллисекундах) для повторной попытки неудавшегося запроса Keeper во время выполнения запроса INSERT.

Возможные значения:

- Положительное целое число.
- 0 — Нет тайм-аута.

## insert_keeper_retry_max_backoff_ms {#insert_keeper_retry_max_backoff_ms}



Тип: UInt64

Значение по умолчанию: 10000

Максимальный тайм-аут (в миллисекундах) для повторной попытки неудавшегося запроса Keeper во время выполнения запроса INSERT.

Возможные значения:

- Положительное целое число.
- 0 — Максимальный тайм-аут не ограничен.

## insert_null_as_default {#insert_null_as_default}



Тип: Bool

Значение по умолчанию: 1

Включает или отключает вставку [значений по умолчанию](/sql-reference/statements/create/table#default_values) вместо [NULL](/sql-reference/syntax#null) в столбцы с не [nullable](/sql-reference/data-types/nullable) типом данных. Если тип столбца не может быть null, и эта настройка отключена, то вставка `NULL` приведет к исключению. Если тип столбца может быть null, то значения `NULL` вставляются как есть, независимо от этой настройки.

Эта настройка применяется к запросам [INSERT ... SELECT](../../sql-reference/statements/insert-into.md/#inserting-the-results-of-select). Обратите внимание, что подзапросы `SELECT` могут быть объединены с помощью оператора `UNION ALL`.

Возможные значения:

- 0 — Вставка `NULL` в не null-столбец вызывает исключение.
- 1 — Вместо `NULL` вставляется значение по умолчанию столбца.

## insert_quorum {#insert_quorum}



Тип: UInt64Auto

Значение по умолчанию: 0

:::note
Эта настройка не применима к SharedMergeTree, см. [Последовательность SharedMergeTree](/cloud/reference/shared-merge-tree#consistency) для получения дополнительной информации.
:::

Включает записи по кворуму.

- Если `insert_quorum < 2`, записи по кворуму отключены.
- Если `insert_quorum >= 2`, записи по кворуму включены.
- Если `insert_quorum = 'auto'`, используется количество голосов большинства (`number_of_replicas / 2 + 1`) в качестве числа кворума.

Записи по кворуму

`INSERT` удается только в том случае, если ClickHouse смог правильно записать данные в `insert_quorum` реплик в течение времени `insert_quorum_timeout`. Если по какой-либо причине количество реплик с успешными записями не достигает `insert_quorum`, запись считается неудачной, и ClickHouse удалит вставленный блок из всех реплик, в которые данные уже были записаны.

Когда `insert_quorum_parallel` отключен, все реплики в кворуме согласованы, т.е. они содержат данные из всех предыдущих `INSERT` запросов (последовательность `INSERT` линеаризуется). При чтении данных, записанных с использованием `insert_quorum` и `insert_quorum_parallel`, можно включить последовательную согласованность для запросов SELECT, используя [select_sequential_consistency](#select_sequential_consistency).

ClickHouse генерирует исключение:

- Если количество доступных реплик в момент выполнения запроса меньше `insert_quorum`.
- Когда `insert_quorum_parallel` отключен и происходит попытка записи данных, когда предыдущий блок еще не был вставлен в `insert_quorum` реплик. Эта ситуация может возникнуть, если пользователь пытается выполнить другой запрос `INSERT` в ту же таблицу до завершения предыдущего с `insert_quorum`.

Смотрите также:

- [insert_quorum_timeout](#insert_quorum_timeout)
- [insert_quorum_parallel](#insert_quorum_parallel)
- [select_sequential_consistency](#select_sequential_consistency)

## insert_quorum_parallel {#insert_quorum_parallel}



Тип: Bool

Значение по умолчанию: 1

:::note
Эта настройка не применима к SharedMergeTree, см. [Последовательность SharedMergeTree](/cloud/reference/shared-merge-tree#consistency) для получения дополнительной информации.
:::

Включает или отключает параллелизм для запросов `INSERT` по кворуму. Если включено, могут быть отправлены дополнительные запросы `INSERT`, пока предыдущие запросы еще не завершены. Если отключено, дополнительные записи в ту же таблицу будут отклонены.

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

Смотрите также:

- [insert_quorum](#insert_quorum)
- [insert_quorum_timeout](#insert_quorum_timeout)
- [select_sequential_consistency](#select_sequential_consistency)

## insert_quorum_timeout {#insert_quorum_timeout}



Тип: Milliseconds

Значение по умолчанию: 600000

Тайм-аут записи по кворуму в миллисекундах. Если тайм-аут истек и запись еще не произошла, ClickHouse сгенерирует исключение, и клиент должен повторить запрос, чтобы записать тот же блок в ту же или любую другую реплику.

Смотрите также:

- [insert_quorum](#insert_quorum)
- [insert_quorum_parallel](#insert_quorum_parallel)
- [select_sequential_consistency](#select_sequential_consistency)

## insert_shard_id {#insert_shard_id}



Тип: UInt64

Значение по умолчанию: 0

Если не `0`, указывает шард [Distributed](/engines/table-engines/special/distributed) таблицы, в который данные будут вставляться синхронно.

Если значение `insert_shard_id` неправильное, сервер выдаст исключение.

Чтобы получить количество шардов на `requested_cluster`, вы можете проверить конфигурацию сервера или использовать этот запрос:

```sql
SELECT uniq(shard_num) FROM system.clusters WHERE cluster = 'requested_cluster';
```

Возможные значения:

- 0 — Отключено.
- Любое число от `1` до `shards_num` соответствующей [Distributed](/engines/table-engines/special/distributed) таблицы.

**Пример**

Запрос:

```sql
CREATE TABLE x AS system.numbers ENGINE = MergeTree ORDER BY number;
CREATE TABLE x_dist AS x ENGINE = Distributed('test_cluster_two_shards_localhost', currentDatabase(), x);
INSERT INTO x_dist SELECT * FROM numbers(5) SETTINGS insert_shard_id = 1;
SELECT * FROM x_dist ORDER BY number ASC;
```

Результат:

```text
┌─number─┐
│      0 │
│      0 │
│      1 │
│      1 │
│      2 │
│      2 │
│      3 │
│      3 │
│      4 │
│      4 │
└────────┘
```

## interactive_delay {#interactive_delay}



Тип: UInt64

Значение по умолчанию: 100000

Интервал в микросекундах для проверки того, отменено ли выполнение запроса, и отправки состояния выполнения.

## intersect_default_mode {#intersect_default_mode}



Тип: SetOperationMode

Значение по умолчанию: ALL

Устанавливает режим по умолчанию в запросе INTERSECT. Возможные значения: пустая строка, 'ALL', 'DISTINCT'. Если пусто, запрос без режима выдаст ошибку.

## join_algorithm {#join_algorithm}



Тип: JoinAlgorithm

Значение по умолчанию: direct,parallel_hash,hash

Указывает, какой алгоритм [JOIN](../../sql-reference/statements/select/join.md) используется.

Можно указать несколько алгоритмов, и для конкретного запроса будет выбран доступный на основе типа/строгости и движка таблицы.

Возможные значения:

- grace_hash

 Алгоритм [Grace hash join](https://en.wikipedia.org/wiki/Hash_join#Grace_hash_join) используется.  Grace hash предоставляет опцию алгоритма, которая обеспечивает производительные сложные объединения, при этом ограничивая использование памяти.

 Первая фаза градиентного объединения считывает правую таблицу и разбивает ее на N бакетов в зависимости от хеш-значения ключевых столбцов (сначала N задано значением `grace_hash_join_initial_buckets`). Это делается таким образом, чтобы гарантировать, что каждый бакет может быть обработан независимо. Строки из первого бакета добавляются в хеш-таблицу в памяти, в то время как остальные сохраняются на диске. Если хеш-таблица превышает предел памяти (например, как задается с помощью [`max_bytes_in_join`](/operations/settings/settings#max_bytes_in_join), количество бакетов увеличивается, и каждому ряду назначается соответствующий бакет. Любые строки, которые не принадлежат текущему бакету, сбрасываются и переназначаются.

 Поддерживает `INNER/LEFT/RIGHT/FULL ALL/ANY JOIN`.

- hash

 Используется [алгоритм hash join](https://en.wikipedia.org/wiki/Hash_join). Наиболее общее представление, которое поддерживает все комбинации типа и строгости, а также множественные ключи соединения, которые комбинируются с помощью `OR` в разделе `JOIN ON`.

 При использовании алгоритма `hash` правая часть `JOIN` загружается в ОЗУ.

- parallel_hash

 Вариация алгоритма `hash`, которая разбивает данные на бакеты и создает несколько хеш-таблиц одновременно, чтобы ускорить этот процесс.

 При использовании алгоритма `parallel_hash` правая часть `JOIN` загружается в ОЗУ.

- partial_merge

 Вариант алгоритма [sort-merge](https://en.wikipedia.org/wiki/Sort-merge_join), при котором только правая таблица полностью отсортирована.

 `RIGHT JOIN` и `FULL JOIN` поддерживаются только с `ALL` строгостью (`SEMI`, `ANTI`, `ANY` и `ASOF` не поддерживаются).

 При использовании алгоритма `partial_merge` ClickHouse сортирует данные и сбрасывает их на диск. Алгоритм `partial_merge` в ClickHouse немного отличается от классической реализации. Сначала ClickHouse сортирует правую таблицу по ключам объединения блоками и создает мин-макс индекс для отсортированных блоков. Затем он сортирует части левой таблицы по `join key` и объединяет их с правой таблицей. Мин-макс индекс также используется для пропуска ненужных блоков правой таблицы.

- direct

 Этот алгоритм может применяться, когда хранилище для правой таблицы поддерживает запросы по ключам.

 Алгоритм `direct` выполняет поиск в правой таблице, используя строки из левой таблицы в качестве ключей. Поддерживается только специальным хранилищем, таким как [Dictionary](/engines/table-engines/special/dictionary) или [EmbeddedRocksDB](../../engines/table-engines/integrations/embedded-rocksdb.md) и только для `LEFT` и `INNER` JOIN.

- auto

 При установке в значение `auto` сначала пробуется `hash` join, а алгоритм переключается на лету на другой алгоритм, если превышен лимит памяти.

- full_sorting_merge

 Алгоритм [sort-merge](https://en.wikipedia.org/wiki/Sort-merge_join) с полной сортировкой объединенных таблиц перед объединением.

- prefer_partial_merge

 ClickHouse всегда пытается использовать объединение `partial_merge`, если это возможно, иначе использует `hash`. *Устарело*, как и `partial_merge,hash`.

- default (устарело)

 Устаревшее значение, пожалуйста, больше не используйте.
 То же самое, что и `direct,hash`, т.е. пытайтесь использовать прямое соединение и хеш-соединение (в этом порядке).

## join_any_take_last_row {#join_any_take_last_row}



Тип: Bool

Значение по умолчанию: 0

Изменяет поведение операций объединения с `ANY` строгим режимом.

:::note
Эта настройка применима только к операциям `JOIN` с таблицами движка [Join](../../engines/table-engines/special/join.md).
:::

Возможные значения:

- 0 — Если у правой таблицы больше одной совпадающей строки, присоединяется только первая из найденных.
- 1 — Если у правой таблицы больше одной совпадающей строки, присоединяется только последняя из найденных.

Смотрите также:

- [JOIN clause](/sql-reference/statements/select/join)
- [Join table engine](../../engines/table-engines/special/join.md)
- [join_default_strictness](#join_default_strictness)

## join_default_strictness {#join_default_strictness}



Тип: JoinStrictness

Значение по умолчанию: ALL

Устанавливает строгость по умолчанию для [JOIN клауз](https://sql-reference/statements/select/join).

Возможные значения:

- `ALL` — Если у правой таблицы несколько совпадающих строк, ClickHouse создает [декартово произведение](https://en.wikipedia.org/wiki/Cartesian_product) из совпадающих строк. Это нормальное поведение `JOIN` в стандартном SQL.
- `ANY` — Если у правой таблицы несколько совпадающих строк, присоединяется только первая из найденных. Если у правой таблицы только одна совпадающая строка, результаты `ANY` и `ALL` совпадают.
- `ASOF` — Для объединения последовательностей с неопределенным совпадением.
- `Пустая строка` — Если `ALL` или `ANY` не указаны в запросе, ClickHouse выбрасывает исключение.

## join_on_disk_max_files_to_merge {#join_on_disk_max_files_to_merge}



Тип: UInt64

Значение по умолчанию: 64

Ограничивает количество файлов, разрешенных для параллельной сортировки в операциях MergeJoin, когда они выполняются на диске.

Чем больше значение настройки, тем больше используется ОЗУ и тем меньше требуется ввод-вывод диска.

Возможные значения:

- Любое положительное целое число, начиная с 2.

## join_output_by_rowlist_perkey_rows_threshold {#join_output_by_rowlist_perkey_rows_threshold}



Тип: UInt64

Значение по умолчанию: 5

Нижний предел среднего количества строк по ключу в правой таблице для определения, следует ли выводить по списку строк в хеш-объедининии.

## join_overflow_mode {#join_overflow_mode}



Тип: OverflowMode

Значение по умолчанию: throw

Что делать, когда лимит превышен.

## join_to_sort_maximum_table_rows {#join_to_sort_maximum_table_rows}
<ExperimentalBadge/>


Тип: UInt64

Значение по умолчанию: 10000

Максимальное количество строк в правой таблице для определения, следует ли перепорядочить правую таблицу по ключу в левых или внутренних соединениях.

## join_to_sort_minimum_perkey_rows {#join_to_sort_minimum_perkey_rows}
<ExperimentalBadge/>


Тип: UInt64

Значение по умолчанию: 40

Нижний предел среднего количества строк по ключу в правой таблице для определения, следует ли перепорядочить правую таблицу по ключу в левых или внутренних соединениях. Эта настройка гарантирует, что оптимизация не применяется для разреженных ключей таблицы.

## join_use_nulls {#join_use_nulls}



Тип: Bool

Значение по умолчанию: 0

Задает тип поведения [JOIN](../../sql-reference/statements/select/join.md). При объединении таблиц могут возникать пустые ячейки. ClickHouse заполняет их по-разному в зависимости от этой настройки.

Возможные значения:

- 0 — Пустые ячейки заполняются значением по умолчанию соответствующего типа поля.
- 1 — `JOIN` ведет себя так же, как в стандартном SQL. Тип соответствующего поля преобразуется в [Nullable](/sql-reference/data-types/nullable), и пустые ячейки заполняются [NULL](/sql-reference/syntax).

## joined_subquery_requires_alias {#joined_subquery_requires_alias}



Тип: Bool

Значение по умолчанию: 1

Обязывает присоединенные подзапросы и табличные функции иметь псевдонимы для корректной квалификации имен.

## kafka_disable_num_consumers_limit {#kafka_disable_num_consumers_limit}



Тип: Bool

Значение по умолчанию: 0

Отключает ограничение на kafka_num_consumers, которое зависит от числа доступных ядер CPU.

## kafka_max_wait_ms {#kafka_max_wait_ms}



Тип: Milliseconds

Значение по умолчанию: 5000

Время ожидания в миллисекундах для чтения сообщений из [Kafka](/engines/table-engines/integrations/kafka) перед повторной попыткой.

Возможные значения:

- Положительное целое число.
- 0 — Бесконечный тайм-аут.

Смотрите также:

- [Apache Kafka](https://kafka.apache.org/)

## keeper_map_strict_mode {#keeper_map_strict_mode}



Тип: Bool

Значение по умолчанию: 0

Принуждает дополнительные проверки во время операций KeeperMap. Например, выбрасывает исключение при вставке для уже существующего ключа.

## keeper_max_retries {#keeper_max_retries}



Тип: UInt64

Значение по умолчанию: 10

Максимальное количество повторных попыток для общих операций keeper.

## keeper_retry_initial_backoff_ms {#keeper_retry_initial_backoff_ms}



Тип: UInt64

Значение по умолчанию: 100

Первоначальный тайм-аут для повторных попыток общих операций keeper.

## keeper_retry_max_backoff_ms {#keeper_retry_max_backoff_ms}



Тип: UInt64

Значение по умолчанию: 5000

Максимальный тайм-аут для повторных попыток общих операций keeper.

## least_greatest_legacy_null_behavior {#least_greatest_legacy_null_behavior}



Тип: Bool

Значение по умолчанию: 0

Если включен, функции 'least' и 'greatest' возвращают NULL, если один из их аргументов равен NULL.

## legacy_column_name_of_tuple_literal {#legacy_column_name_of_tuple_literal}



Тип: Bool

Значение по умолчанию: 0

Перечисляет все имена элементов больших литералов кортежей в их названиях столбцов, а не хеш. Эта настройка существует только по 
соображениям совместимости. Есть смысл устанавливать ее в значение 'true', выполняя поэтапное обновление кластера с версии ниж, чем 21.7, на более высокую.

## lightweight_deletes_sync {#lightweight_deletes_sync}



Тип: UInt64

Значение по умолчанию: 2

То же самое, что и [`mutations_sync`](#mutations_sync), но контролирует только выполнение легковесных удалений.

Возможные значения:

- 0 - Мутации выполняются асинхронно.
- 1 - Запрос ожидает завершения легковесных удалений на текущем сервере.
- 2 - Запрос ожидает завершения легковесных удалений на всех репликах (если они существуют).

**Смотрите также**

- [Синхронность ALTER запросов](../../sql-reference/statements/alter/index.md/#synchronicity-of-alter-queries)
- [Мутации](../../sql-reference/statements/alter/index.md/#mutations)

## limit {#limit}



Тип: UInt64

Значение по умолчанию: 0

Устанавливает максимальное количество строк для получения из результата запроса. Он корректирует значение, установленное в условии [LIMIT](/sql-reference/statements/select/limit), так что лимит, указанный в запросе, не может превышать установленный этой настройкой.

Возможные значения:

- 0 — Количество строк не ограничено.
- Положительное целое число.

## live_view_heartbeat_interval {#live_view_heartbeat_interval}
<ExperimentalBadge/>


Тип: Seconds

Значение по умолчанию: 15

Интервал в секундах для индикатора активности живого запроса.

## load_balancing {#load_balancing}



Тип: LoadBalancing

Значение по умолчанию: random

Указывает алгоритм выбора реплик, который используется для обработки распределенных запросов.

ClickHouse поддерживает следующие алгоритмы выбора реплик:

- [Случайный](#load_balancing-random) (по умолчанию)
- [Ближайшее имя хоста](#load_balancing-nearest_hostname)
- [Расстояние Левенштейна по имени хоста](#load_balancing-hostname_levenshtein_distance)
- [По порядку](#load_balancing-in_order)
- [Первый или случайный](#load_balancing-first_or_random)
- [Круговой](#load_balancing-round_robin)

Смотрите также:

- [distributed_replica_max_ignored_errors](#distributed_replica_max_ignored_errors)

### Random (по умолчанию) {#load_balancing-random}

```sql
load_balancing = random
```

Количество ошибок считается для каждой реплики. Запрос отправляется на реплику с наименьшим количеством ошибок, а если таких несколько, — на любую из них. 
Недостатки: близость сервера не учитывается; если у реплик разные данные, вы также получите разные данные.
```
### Nearest Hostname {#load_balancing-nearest_hostname}

```sql
load_balancing = nearest_hostname
```

Количество ошибок подсчитывается для каждой реплики. Каждые 5 минут количество ошибок делится на 2. Таким образом, количество ошибок рассчитывается за недавнее время с экспоненциальным сглаживанием. Если есть одна реплика с минимальным количеством ошибок (т.е. ошибки произошли недавно на других репликах), запрос отправляется ей. Если несколько реплик имеют одинаковое минимальное количество ошибок, запрос отправляется реплике с именем хоста, которое наиболее похоже на имя хоста сервера в файле конфигурации (по количеству различных символов в идентичных позициях, до минимальной длины обоих имен хостов).

Например, example01-01-1 и example01-01-2 отличаются в одной позиции, в то время как example01-01-1 и example01-02-2 различаются в двух местах.
Этот метод может показаться примитивным, но он не требует внешних данных о топологии сети и не сравнивает IP-адреса, что было бы сложно для наших IPv6 адресов.

Таким образом, если есть эквивалентные реплики, предпочтение отдается наиболее близкой по имени.
Также можно предположить, что при отправке запроса на тот же сервер, при отсутствии сбоев, распределенный запрос также будет направлен на одни и те же серверы. Поэтому даже если на репликах располагаются различные данные, запрос будет возвращать в основном одни и те же результаты.
### Hostname levenshtein distance {#load_balancing-hostname_levenshtein_distance}

```sql
load_balancing = hostname_levenshtein_distance
```

Так же, как и `nearest_hostname`, но сравнивает имена хостов по методу [расстояния Левенштейна](https://en.wikipedia.org/wiki/Levenshtein_distance). Например:

```text
example-clickhouse-0-0 ample-clickhouse-0-0
1

example-clickhouse-0-0 example-clickhouse-1-10
2

example-clickhouse-0-0 example-clickhouse-12-0
3
```
### In Order {#load_balancing-in_order}

```sql
load_balancing = in_order
```

Реплики с одинаковым количеством ошибок обрабатываются в том порядке, в котором они указаны в конфигурации.
Этот метод подходит, когда точно известно, какая реплика предпочтительнее.
### First or Random {#load_balancing-first_or_random}

```sql
load_balancing = first_or_random
```

Этот алгоритм выбирает первую реплику в наборе или случайную реплику, если первая недоступна. Он эффективен в конфигурациях с перекрестной репликацией, но бесполезен в других настройках.

Алгоритм `first_or_random` решает проблему алгоритма `in_order`. С `in_order`, если одна реплика выходит из строя, на следующую ложится двойная нагрузка, в то время как оставшиеся реплики обрабатывают обычное количество трафика. При использовании алгоритма `first_or_random` нагрузка равномерно распределяется между репликами, которые все еще доступны.

Можно явно определить, какая реплика является первой, используя настройку `load_balancing_first_offset`. Это дает больше контроля для перераспределения нагрузки запросов между репликами.
### Round Robin {#load_balancing-round_robin}

```sql
load_balancing = round_robin
```

Этот алгоритм использует политику раунд-робина между репликами с одинаковым количеством ошибок (учитываются только запросы с политикой `round_robin`).
## load_balancing_first_offset {#load_balancing_first_offset}

Тип: UInt64

Значение по умолчанию: 0

Какую реплику предпочтительно отправлять запросы при использовании стратегии балансировки нагрузки FIRST_OR_RANDOM.
## load_marks_asynchronously {#load_marks_asynchronously}

Тип: Bool

Значение по умолчанию: 0

Асинхронная загрузка меток MergeTree
## local_filesystem_read_method {#local_filesystem_read_method}

Тип: String

Значение по умолчанию: pread_threadpool

Метод чтения данных из локальной файловой системы, один из: read, pread, mmap, io_uring, pread_threadpool. Метод 'io_uring' является экспериментальным и не работает для Log, TinyLog, StripeLog, File, Set и Join, и других таблиц с добавляемыми файлами в присутствии одновременных чтений и записей.
## local_filesystem_read_prefetch {#local_filesystem_read_prefetch}

Тип: Bool

Значение по умолчанию: 0

Следует ли использовать предварительную выборку при чтении данных из локальной файловой системы.
## lock_acquire_timeout {#lock_acquire_timeout}

Тип: Seconds

Значение по умолчанию: 120

Определяет, сколько секунд запрос блокировки ждет перед тем, как завершиться неудачей.

Таймаут блокировки используется для защиты от взаимных блокировок при выполнении операций чтения/записи с таблицами. Когда таймаут истекает и запрос блокировки завершается неудачей, сервер ClickHouse выдает исключение "Попытка блокировки истекла во времени! Возможная взаимная блокировка предотвращена. Клиент должен повторить." с кодом ошибки `DEADLOCK_AVOIDED`.

Возможные значения:

- Положительное целое число (в секундах).
- 0 — Нет таймаута блокировки.
## log_comment {#log_comment}

Тип: String

Значение по умолчанию: 

Указывает значение для поля `log_comment` таблицы [system.query_log](../system-tables/query_log.md) и текст комментария для серверного журнала.

Может использоваться для улучшения читаемости серверных журналов. Кроме того, он помогает выбрать запросы, связанные с тестом, из `system.query_log` после выполнения [clickhouse-test](../../development/tests.md).

Возможные значения:

- Любая строка длиной не более [max_query_size](#max_query_size). Если превышен max_query_size, сервер выдает исключение.

**Пример**

Запрос:

```sql
SET log_comment = 'log_comment test', log_queries = 1;
SELECT 1;
SYSTEM FLUSH LOGS;
SELECT type, query FROM system.query_log WHERE log_comment = 'log_comment test' AND event_date >= yesterday() ORDER BY event_time DESC LIMIT 2;
```

Результат:

```text
┌─type────────┬─query─────┐
│ QueryStart  │ SELECT 1; │
│ QueryFinish │ SELECT 1; │
└─────────────┴───────────┘
```
## log_formatted_queries {#log_formatted_queries}

Тип: Bool

Значение по умолчанию: 0

Позволяет записывать отформатированные запросы в системную таблицу [system.query_log](../../operations/system-tables/query_log.md) (заполняет столбец `formatted_query` в [system.query_log](../../operations/system-tables/query_log.md)).

Возможные значения:

- 0 — Отформатированные запросы не записываются в системную таблицу.
- 1 — Отформатированные запросы записываются в системную таблицу.
## log_processors_profiles {#log_processors_profiles}

Тип: Bool

Значение по умолчанию: 1

Записывать время, которое процессор провел во время выполнения/ожидания данных в таблицу `system.processors_profile_log`.

См. также:

- [`system.processors_profile_log`](../../operations/system-tables/processors_profile_log.md)
- [`EXPLAIN PIPELINE`](../../sql-reference/statements/explain.md/#explain-pipeline)
## log_profile_events {#log_profile_events}

Тип: Bool

Значение по умолчанию: 1

Записывать статистику производительности запросов в query_log, query_thread_log и query_views_log.
## log_queries {#log_queries}

Тип: Bool

Значение по умолчанию: 1

Настройка ведения журнала запросов.

Запросы, отправленные в ClickHouse с этой настройкой, регистрируются в соответствии с правилами параметра конфигурации сервера [query_log](../../operations/server-configuration-parameters/settings.md/#query-log).

Пример:

```text
log_queries=1
```
## log_queries_cut_to_length {#log_queries_cut_to_length}

Тип: UInt64

Значение по умолчанию: 100000

Если длина запроса превышает указанный порог (в байтах), то запрос обрезается при записи в журнал запросов. Также ограничивается длина напечатанного запроса в обычном текстовом журнале.
## log_queries_min_query_duration_ms {#log_queries_min_query_duration_ms}

Тип: Milliseconds

Значение по умолчанию: 0

Если включено (ноль не равен), запросы, быстрее значения этой установки, не будут записываться (вы можете думать об этом как о `long_query_time` для [MySQL Slow Query Log](https://dev.mysql.com/doc/refman/5.7/slow-query-log.html)), и это в основном означает, что вы не найдете их в следующих таблицах:

- `system.query_log`
- `system.query_thread_log`

Только запросы следующего типа попадут в журнал:

- `QUERY_FINISH`
- `EXCEPTION_WHILE_PROCESSING`

- Тип: миллисекунды
- Значение по умолчанию: 0 (любой запрос)
## log_queries_min_type {#log_queries_min_type}

Тип: LogQueriesType

Значение по умолчанию: QUERY_START

Минимальный тип `query_log` для ведения журнала.

Возможные значения:
- `QUERY_START` (`=1`)
- `QUERY_FINISH` (`=2`)
- `EXCEPTION_BEFORE_START` (`=3`)
- `EXCEPTION_WHILE_PROCESSING` (`=4`)

Может быть использован для ограничения типов сущностей, которые попадут в `query_log`, например, если вас интересуют только ошибки, тогда вы можете использовать `EXCEPTION_WHILE_PROCESSING`:

```text
log_queries_min_type='EXCEPTION_WHILE_PROCESSING'
```
## log_queries_probability {#log_queries_probability}

Тип: Float

Значение по умолчанию: 1

Позволяет пользователю записывать в системные таблицы [query_log](../../operations/system-tables/query_log.md), [query_thread_log](../../operations/system-tables/query_thread_log.md) и [query_views_log](../../operations/system-tables/query_views_log.md) только часть запросов, выбранных случайным образом с заданной вероятностью. Это помогает уменьшить нагрузку при большом объеме запросов за одну секунду.

Возможные значения:

- 0 — Запросы не записываются в системные таблицы.
- Положительное число с плавающей запятой в диапазоне [0..1]. Например, если значение настройки равно `0.5`, примерно половина запросов записывается в системные таблицы.
- 1 — Все запросы записываются в системные таблицы.
## log_query_settings {#log_query_settings}

Тип: Bool

Значение по умолчанию: 1

Записывать настройки запросов в query_log и журнал спанов OpenTelemetry.
## log_query_threads {#log_query_threads}

Тип: Bool

Значение по умолчанию: 0

Настройка ведения журнала потоков запросов.

Потоки запросов регистрируются в таблице [system.query_thread_log](../../operations/system-tables/query_thread_log.md). Эта настройка оказывает влияние только тогда, когда [log_queries](#log_queries) равно true. Потоки запросов, запускаемые ClickHouse с этой настройкой, записываются в соответствии с правилами параметра конфигурации сервера [query_thread_log](/operations/server-configuration-parameters/settings#query_thread_log).

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

**Пример**

```text
log_query_threads=1
```
## log_query_views {#log_query_views}

Тип: Bool

Значение по умолчанию: 1

Настройка ведения журнала представлений запросов.

Когда запрос, выполняемый ClickHouse с этой настройкой включенной, имеет связанные представления (материализованные или live), они записываются в [query_views_log](/operations/server-configuration-parameters/settings#query_views_log) параметр конфигурации сервера.

Пример:

```text
log_query_views=1
```
## low_cardinality_allow_in_native_format {#low_cardinality_allow_in_native_format}

Тип: Bool

Значение по умолчанию: 1

Разрешает или запрещает использовать тип данных [LowCardinality](../../sql-reference/data-types/lowcardinality.md) с форматом [Native](../../interfaces/formats.md/#native).

Если использование `LowCardinality` ограничено, сервер ClickHouse преобразует столбцы `LowCardinality` в обычные для запросов `SELECT`, и преобразует обычные столбцы в столбцы `LowCardinality` для запросов `INSERT`.

Эта настройка необходима в основном для сторонних клиентов, которые не поддерживают тип данных `LowCardinality`.

Возможные значения:

- 1 — Использование `LowCardinality` не ограничено.
- 0 — Использование `LowCardinality` ограничено.
## low_cardinality_max_dictionary_size {#low_cardinality_max_dictionary_size}

Тип: UInt64

Значение по умолчанию: 8192

Устанавливает максимальный размер в строках общего глобального словаря для типа данных [LowCardinality](../../sql-reference/data-types/lowcardinality.md), который может быть записан в файловую систему хранения. Эта настройка предотвращает проблемы с ОЗУ в случае неограниченного роста словаря. Все данные, которые не могут быть закодированы из-за ограничения максимального размера словаря, ClickHouse записывает обычным способом.

Возможные значения:

- Любое положительное целое число.
## low_cardinality_use_single_dictionary_for_part {#low_cardinality_use_single_dictionary_for_part}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает использование одного словаря для части данных.

По умолчанию сервер ClickHouse контролирует размер словарей, и если словарь переполняется, сервер начинает записывать следующий. Чтобы запретить создание нескольких словарей, установите `low_cardinality_use_single_dictionary_for_part = 1`.

Возможные значения:

- 1 — Создание нескольких словарей для части данных запрещено.
- 0 — Создание нескольких словарей для части данных не запрещено.
## low_priority_query_wait_time_ms {#low_priority_query_wait_time_ms}
<BetaBadge/>

Тип: Milliseconds

Значение по умолчанию: 1000

Время ожидания в миллисекундах, когда запрос с низким приоритетом сталкивается с запросом более высокого приоритета.
## materialize_skip_indexes_on_insert {#materialize_skip_indexes_on_insert}

Тип: Bool

Значение по умолчанию: 1

Строятся ли и сохраняются ли индексы пропуска при вставках. Если отключено, индексы пропуска будут строиться и сохраняться во время слияний или с помощью явной MATERIALIZE INDEX.
## materialize_statistics_on_insert {#materialize_statistics_on_insert}

Тип: Bool

Значение по умолчанию: 1

Строятся ли и вставляются ли статистические данные при вставках. Если отключено, статистика будет строиться и сохраняться во время слияний или с помощью явной MATERIALIZE STATISTICS.
## materialize_ttl_after_modify {#materialize_ttl_after_modify}

Тип: Bool

Значение по умолчанию: 1

Применить TTL для старых данных после запроса ALTER MODIFY TTL.
## materialized_views_ignore_errors {#materialized_views_ignore_errors}

Тип: Bool

Значение по умолчанию: 0

Позволяет игнорировать ошибки для MATERIALIZED VIEW и передавать оригинальный блок в таблицу независимо от MVs.
## max_analyze_depth {#max_analyze_depth}

Тип: UInt64

Значение по умолчанию: 5000

Максимальное количество анализов, выполняемых интерпретатором.
## max_ast_depth {#max_ast_depth}

Тип: UInt64

Значение по умолчанию: 1000

Максимальная глубина синтаксического дерева запроса. Проверяется после разбора.
## max_ast_elements {#max_ast_elements}

Тип: UInt64

Значение по умолчанию: 50000

Максимальный размер синтаксического дерева запроса в количестве узлов. Проверяется после разбора.
## max_autoincrement_series {#max_autoincrement_series}

Тип: UInt64

Значение по умолчанию: 1000

Ограничение на количество последовательностей, создаваемых функцией `generateSeriesID`.

Так как каждая последовательность представляет собой узел в Keeper, рекомендуется иметь не более нескольких миллионов из них.
## max_backup_bandwidth {#max_backup_bandwidth}

Тип: UInt64

Значение по умолчанию: 0

Максимальная скорость чтения в байтах в секунду для конкретной резервной копии на сервере. Ноль означает неограниченно.
## max_block_size {#max_block_size}

Тип: UInt64

Значение по умолчанию: 65409

В ClickHouse данные обрабатываются блоками, которые представляют собой наборы столбцовых частей. Внутренние циклы обработки для одного блока эффективны, но есть заметные затраты при обработке каждого блока.

Настройка `max_block_size` указывает рекомендуемое максимальное количество строк для включения в один блок при загрузке данных из таблиц. Блоки размером `max_block_size` не всегда загружаются из таблицы: если ClickHouse определяет, что требуется извлечь меньше данных, обрабатывается меньший блок.

Размер блока не должен быть слишком мал, чтобы избежать заметных затрат при обработке каждого блока. Он также не должен быть слишком большим, чтобы гарантировать, что запросы с условием LIMIT выполняются быстро после обработки первого блока. При настройке `max_block_size` целью должно быть предотвращение чрезмерного потребления памяти при извлечении большого количества столбцов в нескольких потоках и сохранение хотя бы некоторой локальности кэша.
## max_bytes_before_external_group_by {#max_bytes_before_external_group_by}

Тип: UInt64

Значение по умолчанию: 0

Если использование памяти во время операции GROUP BY превышает этот порог в байтах, активируется режим 'внешней агрегации' (сброс данных на диск). Рекомендуемое значение — половина доступной системной памяти.
## max_bytes_before_external_sort {#max_bytes_before_external_sort}

Тип: UInt64

Значение по умолчанию: 0

Если использование памяти во время операции ORDER BY превышает этот порог в байтах, активируется режим 'внешней сортировки' (сброс данных на диск). Рекомендуемое значение — половина доступной системной памяти.
## max_bytes_before_remerge_sort {#max_bytes_before_remerge_sort}

Тип: UInt64

Значение по умолчанию: 1000000000

В случае ORDER BY с LIMIT, когда использование памяти превышает указанный порог, выполняются дополнительные этапы слияния блоков перед окончательным слиянием, чтобы оставить только верхние LIMIT строки.
## max_bytes_in_distinct {#max_bytes_in_distinct}

Тип: UInt64

Значение по умолчанию: 0

Максимальный общий размер состояния (в несжатых байтах) в памяти для выполнения DISTINCT.
## max_bytes_in_join {#max_bytes_in_join}

Тип: UInt64

Значение по умолчанию: 0

Максимальный размер хеш-таблицы для JOIN (в байтах в памяти).
## max_bytes_in_set {#max_bytes_in_set}

Тип: UInt64

Значение по умолчанию: 0

Максимальный размер множества (в байтах в памяти), получаемого в результате выполнения секции IN.
## max_bytes_ratio_before_external_group_by {#max_bytes_ratio_before_external_group_by}

Тип: Double

Значение по умолчанию: 0.5

Соотношение использованной памяти перед активацией внешнего GROUP BY. Если вы установите его на 0.6, внешний GROUP BY будет использоваться, как только использование памяти достигнет 60% разрешенной памяти для запроса.
## max_bytes_ratio_before_external_sort {#max_bytes_ratio_before_external_sort}

Тип: Double

Значение по умолчанию: 0.5

Соотношение использованной памяти перед активацией внешнего ORDER BY. Если вы установите его на 0.6, внешний ORDER BY будет использоваться, как только использование памяти достигнет 60% разрешенной памяти для запроса.
## max_bytes_to_read {#max_bytes_to_read}

Тип: UInt64

Значение по умолчанию: 0

Ограничение на читаемые байты (после распаковки) из самых 'глубоких' источников. То есть, только в самой глубокой подзапросе. При чтении с удаленного сервера это проверяется только на удаленном сервере.
## max_bytes_to_read_leaf {#max_bytes_to_read_leaf}

Тип: UInt64

Значение по умолчанию: 0

Ограничение на читаемые байты (после распаковки) на листьях для распределенных запросов. Ограничение применяется только для локальных чтений, исключая конечную стадию слияния на корневом узле. Обратите внимание, что настройка нестабильна при prefer_localhost_replica=1.
## max_bytes_to_sort {#max_bytes_to_sort}

Тип: UInt64

Значение по умолчанию: 0

Если нужно обработать более указанного количества (несжатых) байтов для операции ORDER BY, поведение будет определяться 'mode_sort_overflow', который по умолчанию предполагает - выбросить исключение.
## max_bytes_to_transfer {#max_bytes_to_transfer}

Тип: UInt64

Значение по умолчанию: 0

Максимальный размер (в несжатых байтах) передаваемой внешней таблицы, полученной при выполнении секции GLOBAL IN/JOIN.
## max_columns_to_read {#max_columns_to_read}

Тип: UInt64

Значение по умолчанию: 0

Если запрос требует чтения более указанного количества столбцов, выбрасывается исключение. Значение ноль означает неограниченное количество. Эта настройка полезна для предотвращения слишком сложных запросов.
## max_compress_block_size {#max_compress_block_size}

Тип: UInt64

Значение по умолчанию: 1048576

Максимальный размер блоков несжатых данных перед сжатием для записи в таблицу. По умолчанию 1 048 576 (1 MiB). Указание меньшего размера блока, как правило, ведет к немного уменьшенному коэффициенту сжатия, скорость сжатия и распаковки немного увеличивается из-за локальности кэша, а потребление памяти уменьшается.

:::note
Это настройка уровня экспертов, и вам не следует ее изменять, если вы только начинаете использовать ClickHouse.
:::

Не путайте блоки для сжатия (кусок памяти, состоящий из байтов) с блоками для обработки запросов (набор строк из таблицы).
## max_concurrent_queries_for_all_users {#max_concurrent_queries_for_all_users}

Тип: UInt64

Значение по умолчанию: 0

Выбросить исключение, если значение этой настройки меньше или равно текущему количеству одновременно обрабатываемых запросов.

Пример: `max_concurrent_queries_for_all_users` может быть установлен на 99 для всех пользователей, а администратор базы данных может установить его на 100 для себя, чтобы выполнять запросы для расследования, даже когда сервер перегружен.

Изменение настройки для одного запроса или пользователя не влияет на другие запросы.

Возможные значения:

- Положительное целое число.
- 0 — Нет ограничения.

**Пример**

```xml
<max_concurrent_queries_for_all_users>99</max_concurrent_queries_for_all_users>
```

**Смотрите также**

- [max_concurrent_queries](/operations/server-configuration-parameters/settings#max_concurrent_queries)
## max_concurrent_queries_for_user {#max_concurrent_queries_for_user}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество одновременно обрабатываемых запросов для пользователя.

Возможные значения:

- Положительное целое число.
- 0 — Нет ограничения.

**Пример**

```xml
<max_concurrent_queries_for_user>5</max_concurrent_queries_for_user>
```
## max_distributed_connections {#max_distributed_connections}

Тип: UInt64

Значение по умолчанию: 1024

Максимальное количество одновременных подключений к удаленным серверам для распределенной обработки одного запроса к одной распределенной таблице. Рекомендуется устанавливать значение не меньше количества серверов в кластере.

Следующие параметры используются только при создании распределенных таблиц (и при запуске сервера), поэтому нет необходимости изменять их во время работы.
## max_distributed_depth {#max_distributed_depth}

Тип: UInt64

Значение по умолчанию: 5

Ограничивает максимальную глубину рекурсивных запросов для [Distributed](../../engines/table-engines/special/distributed.md) таблиц.

Если значение превышено, сервер выбрасывает исключение.

Возможные значения:

- Положительное целое число.
- 0 — Неограниченная глубина.
## max_download_buffer_size {#max_download_buffer_size}

Тип: UInt64

Значение по умолчанию: 10485760

Максимальный размер буфера для параллельного скачивания (например, для URL-движка) для каждого потока.
## max_download_threads {#max_download_threads}

Тип: MaxThreads

Значение по умолчанию: 4

Максимальное количество потоков для скачивания данных (например, для URL-движка).
## max_estimated_execution_time {#max_estimated_execution_time}

Тип: Seconds

Значение по умолчанию: 0

Максимальное время ожидаемого выполнения запроса в секундах.
## max_execution_speed {#max_execution_speed}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество выполняемых строк в секунду.
## max_execution_speed_bytes {#max_execution_speed_bytes}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество выполняемых байт в секунду.
## max_execution_time {#max_execution_time}

Тип: Seconds

Значение по умолчанию: 0

Если время выполнения запроса превышает указанное количество секунд, поведение будет определяться параметром 'timeout_overflow_mode', который по умолчанию предполагает - выбросить исключение. Обратите внимание, что таймаут проверяется, и запрос может остановиться только в предназначенных местах во время обработки данных. В настоящее время он не может остановиться во время слияния состояний агрегации или анализа запроса, и фактическое время выполнения будет выше значения этой настройки.
## max_execution_time_leaf {#max_execution_time_leaf}

Тип: Seconds

Значение по умолчанию: 0

Схожая семантика с max_execution_time, но применяется только на листьях для распределенных запросов, поведение таймаута будет определяться 'timeout_overflow_mode_leaf', который по умолчанию предполагает - выбросить исключение.
## max_expanded_ast_elements {#max_expanded_ast_elements}

Тип: UInt64

Значение по умолчанию: 500000

Максимальный размер синтаксического дерева запроса в количестве узлов после расширения псевдонимов и звездочки.
## max_fetch_partition_retries_count {#max_fetch_partition_retries_count}

Тип: UInt64

Значение по умолчанию: 5

Количество попыток при извлечении раздела с другого хоста.
## max_final_threads {#max_final_threads}

Тип: MaxThreads

Значение по умолчанию: 'auto(14)'

Устанавливает максимальное количество параллельных потоков для этапа чтения данных запроса `SELECT` с модификатором [FINAL](/sql-reference/statements/select/from#final-modifier).

Возможные значения:

- Положительное целое число.
- 0 или 1 — Отключено. Запросы `SELECT` выполняются в одном потоке.
## max_http_get_redirects {#max_http_get_redirects}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество перенаправлений HTTP GET, допустимых. Обеспечивает дополнительную безопасность для предотвращения перенаправления вашего запроса на неожиданные сервисы злонамеренным сервером.\n\nЭто может произойти, когда внешний сервер перенаправляет на другой адрес, но этот адрес кажется внутренним для инфраструктуры компании, и, отправив HTTP-запрос на внутренний сервер, вы могли бы запросить внутренний API из внутренней сети, обойдя аутентификацию, или даже выполнять запросы к другим сервисам, таким как Redis или Memcached. Когда у вас нет внутренней инфраструктуры (включая что-то, работающее на вашем локальном хосте), или вы доверяете серверу, разрешение перенаправлений безопасно. Тем не менее учтите, что если URL использует HTTP вместо HTTPS, вам придется доверять не только удаленному серверу, но и вашему интернет-провайдеру и всем сетям посередине.
## max_hyperscan_regexp_length {#max_hyperscan_regexp_length}

Тип: UInt64

Значение по умолчанию: 0

Определяет максимальную длину для каждого регулярного выражения в [мульти-матчах hyperscan](/sql-reference/functions/string-search-functions#multimatchany).

Возможные значения:

- Положительное целое число.
- 0 - Длина не ограничена.

**Пример**

Запрос:

```sql
SELECT multiMatchAny('abcd', ['ab','bcd','c','d']) SETTINGS max_hyperscan_regexp_length = 3;
```

Результат:

```text
┌─multiMatchAny('abcd', ['ab', 'bcd', 'c', 'd'])─┐
│                                              1 │
└────────────────────────────────────────────────┘
```

Запрос:

```sql
SELECT multiMatchAny('abcd', ['ab','bcd','c','d']) SETTINGS max_hyperscan_regexp_length = 2;
```

Результат:

```text
Exception: Regexp length too large.
```

**Смотрите также**

- [max_hyperscan_regexp_total_length](#max_hyperscan_regexp_total_length)
## max_hyperscan_regexp_total_length {#max_hyperscan_regexp_total_length}

Тип: UInt64

Значение по умолчанию: 0

Устанавливает максимальную общую длину всех регулярных выражений в каждой [мульти-матч функции hyperscan](/sql-reference/functions/string-search-functions#multimatchany).

Возможные значения:

- Положительное целое число.
- 0 - Длина не ограничена.

**Пример**

Запрос:

```sql
SELECT multiMatchAny('abcd', ['a','b','c','d']) SETTINGS max_hyperscan_regexp_total_length = 5;
```

Результат:

```text
┌─multiMatchAny('abcd', ['a', 'b', 'c', 'd'])─┐
│                                           1 │
└─────────────────────────────────────────────┘
```

Запрос:

```sql
SELECT multiMatchAny('abcd', ['ab','bc','c','d']) SETTINGS max_hyperscan_regexp_total_length = 5;
```

Результат:

```text
Exception: Total regexp lengths too large.
```

**Смотрите также**

- [max_hyperscan_regexp_length](#max_hyperscan_regexp_length)
## max_insert_block_size {#max_insert_block_size}

Тип: UInt64

Значение по умолчанию: 1048449

Размер блоков (в количестве строк), которые формируются для вставки в таблицу.
Эта настройка применяется только в тех случаях, когда сервер формирует блоки.
Например, для вставки через HTTP интерфейс сервер разбирает формат данных и формирует блоки заданного размера.
Но при использовании clickhouse-client клиент сам разбирает данные, и настройка 'max_insert_block_size' на сервере не влияет на размер вставляемых блоков.
Настройка также не имеет смысла при использовании INSERT SELECT, так как данные вставляются с использованием тех же блоков, которые формируются после SELECT.

По умолчанию это немного больше `max_block_size`. Причина в том, что некоторые движки таблиц (`*MergeTree`) формируют часть данных на диске для каждого вставленного блока, что является довольно крупной сущностью. Аналогично, таблицы `*MergeTree` сортируют данные во время вставки, и достаточно большой размер блока позволяет сортировать больше данных в ОЗУ.
## max_insert_delayed_streams_for_parallel_write {#max_insert_delayed_streams_for_parallel_write}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество потоков (столбцов), чтобы задержать окончательную сброску части. По умолчанию - автоматическая (100 в случае, если базовый хранилище поддерживает параллельную запись, например S3, и отключена в противном случае).
## max_insert_threads {#max_insert_threads}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество потоков для выполнения запроса `INSERT SELECT`.

Возможные значения:

- 0 (или 1) — `INSERT SELECT` без параллельного выполнения.
- Положительное целое число. Больше 1.

Облачное значение по умолчанию: от `2` до `4`, в зависимости от размера службы.

Параллельный `INSERT SELECT` имеет эффект только если часть `SELECT` выполняется параллельно, см. настройку [max_threads](#max_threads).
Высокие значения приведут к большему потреблению памяти.
## max_joined_block_size_rows {#max_joined_block_size_rows}

Тип: UInt64

Значение по умолчанию: 65409

Максимальный размер блока для результата JOIN (если алгоритм JOIN поддерживает это). 0 означает неограниченно.
## max_limit_for_ann_queries {#max_limit_for_ann_queries}
<ExperimentalBadge/>

Тип: UInt64

Значение по умолчанию: 1000000

SELECT запросы с LIMIT, превышающим это значение, не могут использовать индексы векторного сходства. Помогает предотвратить переполнение памяти в индексах векторного сходства.
## max_live_view_insert_blocks_before_refresh {#max_live_view_insert_blocks_before_refresh}
<ExperimentalBadge/>

Тип: UInt64

Значение по умолчанию: 64

Максимальное количество вставленных блоков после которого сливаемые блоки сбрасываются, и запрос повторно выполняется.
## max_local_read_bandwidth {#max_local_read_bandwidth}

Тип: UInt64

Значение по умолчанию: 0

Максимальная скорость локальных чтений в байтах в секунду.
## max_local_write_bandwidth {#max_local_write_bandwidth}

Тип: UInt64

Значение по умолчанию: 0

Максимальная скорость локальных записей в байтах в секунду.
## max_memory_usage {#max_memory_usage}

Тип: UInt64

Значение по умолчанию: 0

Максимальное использование памяти для обработки одного запроса. Ноль означает неограниченно.
## max_memory_usage_for_user {#max_memory_usage_for_user}

Тип: UInt64

Значение по умолчанию: 0

Максимальное использование памяти для одновременной обработки всех запросов пользователя. Ноль означает неограниченно.
## max_network_bandwidth {#max_network_bandwidth}

Тип: UInt64

Значение по умолчанию: 0

Ограничивает скорость обмена данными по сети в байтах в секунду. Эта настройка применяется к каждому запросу.

Возможные значения:

- Положительное целое число.
- 0 — Управление пропускной способностью отключено.
## max_network_bandwidth_for_all_users {#max_network_bandwidth_for_all_users}

Тип: UInt64

Значение по умолчанию: 0

Ограничивает скорость обмена данными по сети в байтах в секунду. Эта настройка применяется ко всем одновременно выполняющимся запросам на сервере.

Возможные значения:

- Положительное целое число.
- 0 — Управление скоростью данных отключено.
```yaml
title: 'max_network_bandwidth_for_user'
sidebar_label: 'max_network_bandwidth_for_user'
keywords: ['max_network_bandwidth_for_user', 'ClickHouse']
description: 'Максимальная скорость обмена данными по сети для пользователя.'
```

## max_network_bandwidth_for_user {#max_network_bandwidth_for_user}

Type: UInt64

Default value: 0

Ограничивает скорость обмена данными по сети в байтах в секунду. Этот параметр применяется ко всем одновременно выполняемым запросам, выполняемым одним пользователем.

Possible values:

- Положительное целое число.
- 0 — Контроль скорости данных отключен.

```yaml
title: 'max_network_bytes'
sidebar_label: 'max_network_bytes'
keywords: ['max_network_bytes', 'ClickHouse']
description: 'Максимальный объем данных, передаваемых по сети при выполнении запроса.'
```

## max_network_bytes {#max_network_bytes}

Type: UInt64

Default value: 0

Ограничивает объем данных (в байтах), который получает или отправляет по сети во время выполнения запроса. Этот параметр применяется к каждому отдельному запросу.

Possible values:

- Положительное целое число.
- 0 — Контроль объема данных отключен.

```yaml
title: 'max_number_of_partitions_for_independent_aggregation'
sidebar_label: 'max_number_of_partitions_for_independent_aggregation'
keywords: ['max_number_of_partitions_for_independent_aggregation', 'ClickHouse']
description: 'Максимальное количество разделов в таблице для применения оптимизации.'
```

## max_number_of_partitions_for_independent_aggregation {#max_number_of_partitions_for_independent_aggregation}

Type: UInt64

Default value: 128

Максимальное количество разделов в таблице для применения оптимизации.

```yaml
title: 'max_parallel_replicas'
sidebar_label: 'max_parallel_replicas'
keywords: ['max_parallel_replicas', 'ClickHouse']
description: 'Максимальное количество реплик для каждого шардирования при выполнении запроса.'
```

## max_parallel_replicas {#max_parallel_replicas}

Type: NonZeroUInt64

Default value: 1000

Максимальное количество реплик для каждого шардирования при выполнении запроса.

Possible values:

- Положительное целое число.

**Дополнительная информация**

Эта опция даст разные результаты в зависимости от используемых настроек.

:::note
Эта настройка будет давать некорректные результаты, когда в запросах задействованы соединения или подзапросы, и не все таблицы соответствуют определенным требованиям. Смотрите [Распределенные подзапросы и max_parallel_replicas](/operations/settings/settings#max_parallel_replicas) для получения дополнительных деталей.
:::

### Параллельная обработка с использованием `SAMPLE` ключа

Запрос может обрабатываться быстрее, если он выполняется на нескольких серверах параллельно. Но производительность запроса может ухудшиться в следующих случаях:

- Позиция ключа выборки в ключе разделения не позволяет эффективно выполнять сканирование диапазонов.
- Добавление ключа выборки к таблице делает фильтрацию по другим столбцам менее эффективной.
- Ключ выборки — это выражение, которое дорого вычислить.
- Распределение задержек в кластере имеет длинный хвост, поэтому запрос к большему количеству серверов увеличивает общую задержку запроса.

```yaml
title: 'max_parser_backtracks'
sidebar_label: 'max_parser_backtracks'
keywords: ['max_parser_backtracks', 'ClickHouse']
description: 'Максимальное количество возвратов парсера.'
```

## max_parser_backtracks {#max_parser_backtracks}

Type: UInt64

Default value: 1000000

Максимальное количество возвратов парсера (сколько раз он пытается разные альтернативы в процессе рекурсивного спуска парсинга).

```yaml
title: 'max_parser_depth'
sidebar_label: 'max_parser_depth'
keywords: ['max_parser_depth', 'ClickHouse']
description: 'Ограничивает максимальную глубину рекурсии для рекурсивного парсера.'
```

## max_parser_depth {#max_parser_depth}

Type: UInt64

Default value: 1000

Ограничивает максимальную глубину рекурсии в рекурсивном парсере. Позволяет контролировать объем памяти стека.

Possible values:

- Положительное целое число.
- 0 — Глубина рекурсии не ограничена.

```yaml
title: 'max_parsing_threads'
sidebar_label: 'max_parsing_threads'
keywords: ['max_parsing_threads', 'ClickHouse']
description: 'Максимальное количество потоков для разбора данных в входных форматах, поддерживающих параллельный разбор.'
```

## max_parsing_threads {#max_parsing_threads}

Type: MaxThreads

Default value: 'auto(14)'

Максимальное количество потоков для разбора данных в входных форматах, поддерживающих параллельный разбор. По умолчанию определяется автоматически.

```yaml
title: 'max_partition_size_to_drop'
sidebar_label: 'max_partition_size_to_drop'
keywords: ['max_partition_size_to_drop', 'ClickHouse']
description: 'Ограничение на удаление разделов во время выполнения запроса.'
```

## max_partition_size_to_drop {#max_partition_size_to_drop}

Type: UInt64

Default value: 50000000000

Ограничение на удаление разделов во время выполнения запроса. Значение 0 означает, что вы можете удалять разделы без каких-либо ограничений.

Cloud default value: 1 TB.

:::note
Этот параметр запроса перезаписывает соответствующий серверный параметр, см. [max_partition_size_to_drop](/operations/server-configuration-parameters/settings#max_partition_size_to_drop)
:::

```yaml
title: 'max_partitions_per_insert_block'
sidebar_label: 'max_partitions_per_insert_block'
keywords: ['max_partitions_per_insert_block', 'ClickHouse']
description: 'Максимальное количество разделов в одном добавляемом блоке.'
```

## max_partitions_per_insert_block {#max_partitions_per_insert_block}

Type: UInt64

Default value: 100

Ограничивает максимальное количество разделов в одном добавляемом блоке. Ноль означает неограниченно. Выдает исключение, если блок содержит слишком много разделов. Эта настройка является предохранительным механизмом, поскольку использование большого количества разделов является распространенным заблуждением.

```yaml
title: 'max_partitions_to_read'
sidebar_label: 'max_partitions_to_read'
keywords: ['max_partitions_to_read', 'ClickHouse']
description: 'Лимит на максимальное количество разделов, доступных в одном запросе.'
```

## max_partitions_to_read {#max_partitions_to_read}

Type: Int64

Default value: -1

Ограничивает максимальное количество разделов, доступных в одном запросе. &lt;= 0 означает неограниченно.

```yaml
title: 'max_parts_to_move'
sidebar_label: 'max_parts_to_move'
keywords: ['max_parts_to_move', 'ClickHouse']
description: 'Лимит на количество частей, которые могут быть перемещены в одном запросе.'
```

## max_parts_to_move {#max_parts_to_move}

Type: UInt64

Default value: 1000

Ограничивает количество частей, которые могут быть перемещены в одном запросе. Ноль означает неограниченно.

```yaml
title: 'max_query_size'
sidebar_label: 'max_query_size'
keywords: ['max_query_size', 'ClickHouse']
description: 'Максимальное количество байтов строка запроса, парсируемая SQL парсером.'
```

## max_query_size {#max_query_size}

Type: UInt64

Default value: 262144

Максимальное количество байтов строки запроса, парсируемое SQL парсером. Данные в разделе VALUES запросов INSERT обрабатываются отдельным парсером потока (который использует O(1) RAM) и не подпадает под это ограничение.

:::note
`max_query_size` не может быть установлен в SQL запросе (например, `SELECT now() SETTINGS max_query_size=10000`), потому что ClickHouse необходимо выделить буфер для парсинга запроса, и размер этого буфера определяется настройкой `max_query_size`, которая должна быть настроена перед выполнением запроса.
:::

```yaml
title: 'max_read_buffer_size'
sidebar_label: 'max_read_buffer_size'
keywords: ['max_read_buffer_size', 'ClickHouse']
description: 'Максимальный размер буфера для чтения из файловой системы.'
```

## max_read_buffer_size {#max_read_buffer_size}

Type: UInt64

Default value: 1048576

Максимальный размер буфера для чтения из файловой системы.

```yaml
title: 'max_read_buffer_size_local_fs'
sidebar_label: 'max_read_buffer_size_local_fs'
keywords: ['max_read_buffer_size_local_fs', 'ClickHouse']
description: 'Максимальный размер буфера для чтения из локальной файловой системы.'
```

## max_read_buffer_size_local_fs {#max_read_buffer_size_local_fs}

Type: UInt64

Default value: 131072

Максимальный размер буфера для чтения из локальной файловой системы. Если установлено в 0, то будет использоваться max_read_buffer_size.

```yaml
title: 'max_read_buffer_size_remote_fs'
sidebar_label: 'max_read_buffer_size_remote_fs'
keywords: ['max_read_buffer_size_remote_fs', 'ClickHouse']
description: 'Максимальный размер буфера для чтения из удаленной файловой системы.'
```

## max_read_buffer_size_remote_fs {#max_read_buffer_size_remote_fs}

Type: UInt64

Default value: 0

Максимальный размер буфера для чтения из удаленной файловой системы. Если установлено в 0, то будет использоваться max_read_buffer_size.

```yaml
title: 'max_recursive_cte_evaluation_depth'
sidebar_label: 'max_recursive_cte_evaluation_depth'
keywords: ['max_recursive_cte_evaluation_depth', 'ClickHouse']
description: 'Максимальное ограничение на глубину оценки рекурсивных CTE.'
```

## max_recursive_cte_evaluation_depth {#max_recursive_cte_evaluation_depth}

Type: UInt64

Default value: 1000

Максимальное ограничение на глубину оценки рекурсивных CTE.

```yaml
title: 'max_remote_read_network_bandwidth'
sidebar_label: 'max_remote_read_network_bandwidth'
keywords: ['max_remote_read_network_bandwidth', 'ClickHouse']
description: 'Максимальная скорость обмена данными по сети для чтения.'
```

## max_remote_read_network_bandwidth {#max_remote_read_network_bandwidth}

Type: UInt64

Default value: 0

Максимальная скорость обмена данными по сети в байтах в секунду для чтения.

```yaml
title: 'max_remote_write_network_bandwidth'
sidebar_label: 'max_remote_write_network_bandwidth'
keywords: ['max_remote_write_network_bandwidth', 'ClickHouse']
description: 'Максимальная скорость обмена данными по сети для записи.'
```

## max_remote_write_network_bandwidth {#max_remote_write_network_bandwidth}

Type: UInt64

Default value: 0

Максимальная скорость обмена данными по сети в байтах в секунду для записи.

```yaml
title: 'max_replica_delay_for_distributed_queries'
sidebar_label: 'max_replica_delay_for_distributed_queries'
keywords: ['max_replica_delay_for_distributed_queries', 'ClickHouse']
description: 'Отключает отстающие реплики для распределенных запросов.'
```

## max_replica_delay_for_distributed_queries {#max_replica_delay_for_distributed_queries}

Type: UInt64

Default value: 300

Отключает отстающие реплики для распределенных запросов. Смотрите [Репликация](../../engines/table-engines/mergetree-family/replication.md).

Устанавливает время в секундах. Если задержка реплики больше или равна установленному значению, эта реплика не используется.

Possible values:

- Положительное целое число.
- 0 — Задержки реплик не проверяются.

Чтобы предотвратить использование любой реплики с ненулевой задержкой, установите этот параметр в 1.

Используется при выполнении `SELECT` из распределенной таблицы, указывающей на реплицированные таблицы.

```yaml
title: 'max_result_bytes'
sidebar_label: 'max_result_bytes'
keywords: ['max_result_bytes', 'ClickHouse']
description: 'Ограничение на размер результата в байтах (не сжатый).'
```

## max_result_bytes {#max_result_bytes}

Type: UInt64

Default value: 0

Ограничение на размер результата в байтах (не сжатый). Запрос остановится после обработки блока данных, если будет достигнут порог, но не обрежет последний блок результата, поэтому размер результата может быть больше порога. Предостережения: размер результата в памяти учитывается для этого порога. Даже если размер результата мал, он может ссылаться на более крупные структуры данных в памяти, представляющие словари столбцов LowCardinality и Arenas столбцов AggregateFunction, поэтому порог может быть превышен, несмотря на небольшой размер результата. Эта настройка достаточно низкого уровня и должна использоваться с осторожностью.

```yaml
title: 'max_result_rows'
sidebar_label: 'max_result_rows'
keywords: ['max_result_rows', 'ClickHouse']
description: 'Ограничение на размер результата в строках.'
```

## max_result_rows {#max_result_rows}

Type: UInt64

Default value: 0

Ограничение на размер результата в строках. Запрос остановится после обработки блока данных, если будет достигнут порог, но не обрежет последний блок результата, поэтому размер результата может быть больше порога.

```yaml
title: 'max_rows_in_distinct'
sidebar_label: 'max_rows_in_distinct'
keywords: ['max_rows_in_distinct', 'ClickHouse']
description: 'Максимальное количество элементов при выполнении DISTINCT.'
```

## max_rows_in_distinct {#max_rows_in_distinct}

Type: UInt64

Default value: 0

Максимальное количество элементов во время выполнения DISTINCT.

```yaml
title: 'max_rows_in_join'
sidebar_label: 'max_rows_in_join'
keywords: ['max_rows_in_join', 'ClickHouse']
description: 'Максимальный размер хеш-таблицы для JOIN.'
```

## max_rows_in_join {#max_rows_in_join}

Type: UInt64

Default value: 0

Максимальный размер хеш-таблицы для JOIN (в количестве строк).

```yaml
title: 'max_rows_in_set'
sidebar_label: 'max_rows_in_set'
keywords: ['max_rows_in_set', 'ClickHouse']
description: 'Максимальный размер набора, получаемого в результате выполнения секции IN.'
```

## max_rows_in_set {#max_rows_in_set}

Type: UInt64

Default value: 0

Максимальный размер набора (в количестве элементов), получаемого в результате выполнения секции IN.

```yaml
title: 'max_rows_in_set_to_optimize_join'
sidebar_label: 'max_rows_in_set_to_optimize_join'
keywords: ['max_rows_in_set_to_optimize_join', 'ClickHouse']
description: 'Максимальный размер набора для фильтрации соединенных таблиц по наборам строк друг друга перед присоединением.'
```

## max_rows_in_set_to_optimize_join {#max_rows_in_set_to_optimize_join}

Type: UInt64

Default value: 0

Максимальный размер набора для фильтрации соединенных таблиц по наборам строк друг друга перед присоединением.

Possible values:

- 0 — Отключить.
- Любое положительное целое число.

```yaml
title: 'max_rows_to_group_by'
sidebar_label: 'max_rows_to_group_by'
keywords: ['max_rows_to_group_by', 'ClickHouse']
description: 'Если агрегация во время GROUP BY генерирует более указанного количества строк, поведение будет определяться "group_by_overflow_mode".'
```

## max_rows_to_group_by {#max_rows_to_group_by}

Type: UInt64

Default value: 0

Если агрегация во время GROUP BY генерирует более указанного количества строк (уникальных ключей GROUP BY), поведение будет определяться параметром 'group_by_overflow_mode', который по умолчанию равен - выкидывать исключение, но также может быть переключен в режим приблизительной агрегации GROUP BY.

```yaml
title: 'max_rows_to_read'
sidebar_label: 'max_rows_to_read'
keywords: ['max_rows_to_read', 'ClickHouse']
description: 'Ограничение на читаемые строки из самых "глубоких" источников.'
```

## max_rows_to_read {#max_rows_to_read}

Type: UInt64

Default value: 0

Ограничение на читаемые строки из самых "глубоких" источников. То есть, только в самом глубоком подзапросе. При чтении с удаленного сервера это проверяется только на удаленном сервере.

```yaml
title: 'max_rows_to_read_leaf'
sidebar_label: 'max_rows_to_read_leaf'
keywords: ['max_rows_to_read_leaf', 'ClickHouse']
description: 'Ограничение на читаемые строки на листовых узлах для распределенных запросов.'
```

## max_rows_to_read_leaf {#max_rows_to_read_leaf}

Type: UInt64

Default value: 0

Ограничение на читаемые строки на листовых узлах для распределенных запросов. Ограничение применяется только для локального чтения, исключая финальную стадию слияния на корневом узле. Обратите внимание, что настройка нестабильна при prefer_localhost_replica=1.

```yaml
title: 'max_rows_to_sort'
sidebar_label: 'max_rows_to_sort'
keywords: ['max_rows_to_sort', 'ClickHouse']
description: 'Если для операции ORDER BY необходимо обработать более указанного количества записей, поведение будет определяться "sort_overflow_mode".'
```

## max_rows_to_sort {#max_rows_to_sort}

Type: UInt64

Default value: 0

Если более указанного количества записей необходимо обработать для операции ORDER BY, поведение будет определяться параметром 'sort_overflow_mode', который по умолчанию равен - выкидывать исключение.

```yaml
title: 'max_rows_to_transfer'
sidebar_label: 'max_rows_to_transfer'
keywords: ['max_rows_to_transfer', 'ClickHouse']
description: 'Максимальный размер (в строках) переданной внешней таблицы, полученной при выполнении GLOBAL IN/JOIN.'
```

## max_rows_to_transfer {#max_rows_to_transfer}

Type: UInt64

Default value: 0

Максимальный размер (в строках) переданной внешней таблицы, полученной при выполнении GLOBAL IN/JOIN.

```yaml
title: 'max_sessions_for_user'
sidebar_label: 'max_sessions_for_user'
keywords: ['max_sessions_for_user', 'ClickHouse']
description: 'Максимальное количество одновременных сессий для пользователя.'
```

## max_sessions_for_user {#max_sessions_for_user}

Type: UInt64

Default value: 0

Максимальное количество одновременных сессий для пользователя.

```yaml
title: 'max_size_to_preallocate_for_aggregation'
sidebar_label: 'max_size_to_preallocate_for_aggregation'
keywords: ['max_size_to_preallocate_for_aggregation', 'ClickHouse']
description: 'На сколько элементов разрешено предварительно выделить место во всех хеш-таблицах в целом перед агрегацией.'
```

## max_size_to_preallocate_for_aggregation {#max_size_to_preallocate_for_aggregation}

Type: UInt64

Default value: 1000000000000

На сколько элементов разрешено предварительно выделить место во всех хеш-таблицах в целом перед агрегацией.

```yaml
title: 'max_size_to_preallocate_for_joins'
sidebar_label: 'max_size_to_preallocate_for_joins'
keywords: ['max_size_to_preallocate_for_joins', 'ClickHouse']
description: 'На сколько элементов разрешено предварительно выделить место во всех хеш-таблицах в целом перед соединением.'
```

## max_size_to_preallocate_for_joins {#max_size_to_preallocate_for_joins}

Type: UInt64

Default value: 1000000000000

На сколько элементов разрешено предварительно выделить место во всех хеш-таблицах в целом перед соединением.

```yaml
title: 'max_streams_for_merge_tree_reading'
sidebar_label: 'max_streams_for_merge_tree_reading'
keywords: ['max_streams_for_merge_tree_reading', 'ClickHouse']
description: 'Если не равно нулю, ограничивает количество потоков чтения для таблицы MergeTree.'
```

## max_streams_for_merge_tree_reading {#max_streams_for_merge_tree_reading}

Type: UInt64

Default value: 0

Если не равно нулю, ограничивает количество потоков чтения для таблицы MergeTree.

```yaml
title: 'max_streams_multiplier_for_merge_tables'
sidebar_label: 'max_streams_multiplier_for_merge_tables'
keywords: ['max_streams_multiplier_for_merge_tables', 'ClickHouse']
description: 'Запрашивает больше потоков при чтении из таблицы Merge.'
```

## max_streams_multiplier_for_merge_tables {#max_streams_multiplier_for_merge_tables}

Type: Float

Default value: 5

Запрашивает больше потоков при чтении из таблицы Merge. Потоки распределяются по таблицам, которые использует таблица Merge. Это позволяет более равномерно распределить работу по потокам и особенно полезно, когда объединяемые таблицы различаются по размеру.

```yaml
title: 'max_streams_to_max_threads_ratio'
sidebar_label: 'max_streams_to_max_threads_ratio'
keywords: ['max_streams_to_max_threads_ratio', 'ClickHouse']
description: 'Позволяет использовать больше источников, чем количество потоков.'
```

## max_streams_to_max_threads_ratio {#max_streams_to_max_threads_ratio}

Type: Float

Default value: 1

Позволяет использовать больше источников, чем количество потоков – для более равномерного распределения работы по потокам. Предполагается, что это временное решение, так как в будущем будет возможным сделать количество источников равным количеству потоков, но для каждого источника динамически выбирать доступную работу для себя.

```yaml
title: 'max_subquery_depth'
sidebar_label: 'max_subquery_depth'
keywords: ['max_subquery_depth', 'ClickHouse']
description: 'Если запрос содержит более указанного количества вложенных подзапросов, выбрасывается исключение.'
```

## max_subquery_depth {#max_subquery_depth}

Type: UInt64

Default value: 100

Если запрос содержит более указанного количества вложенных подзапросов, выбрасывается исключение. Это позволяет совершать проверку для защиты пользователей вашего кластера от чрезмерно сложных запросов.

```yaml
title: 'max_table_size_to_drop'
sidebar_label: 'max_table_size_to_drop'
keywords: ['max_table_size_to_drop', 'ClickHouse']
description: 'Ограничение на удаление таблиц во время выполнения запроса.'
```

## max_table_size_to_drop {#max_table_size_to_drop}

Type: UInt64

Default value: 50000000000

Ограничение на удаление таблиц во время выполнения запроса. Значение 0 означает, что вы можете удалять все таблицы без каких-либо ограничений.

Cloud default value: 1 TB.

:::note
Этот параметр запроса перезаписывает соответствующий серверный параметр, см. [max_table_size_to_drop](/operations/server-configuration-parameters/settings#max_table_size_to_drop)
:::

```yaml
title: 'max_temporary_columns'
sidebar_label: 'max_temporary_columns'
keywords: ['max_temporary_columns', 'ClickHouse']
description: 'Если запрос генерирует более указанного количества временных столбцов в памяти, выбрасывается исключение.'
```

## max_temporary_columns {#max_temporary_columns}

Type: UInt64

Default value: 0

Если запрос генерирует более указанного количества временных столбцов в памяти в результате промежуточных вычислений, выбрасывается исключение. Значение ноль означает неограниченно. Эта настройка полезна для предотвращения слишком сложных запросов.

```yaml
title: 'max_temporary_data_on_disk_size_for_query'
sidebar_label: 'max_temporary_data_on_disk_size_for_query'
keywords: ['max_temporary_data_on_disk_size_for_query', 'ClickHouse']
description: 'Максимальное количество данных, потребляемых временными файлами на диске для всех одновременно выполняемых запросов.'
```

## max_temporary_data_on_disk_size_for_query {#max_temporary_data_on_disk_size_for_query}

Type: UInt64

Default value: 0

Максимальное количество данных, потребляемых временными файлами на диске в байтах для всех одновременно выполняемых запросов. Значение ноль означает неограниченно.

```yaml
title: 'max_temporary_data_on_disk_size_for_user'
sidebar_label: 'max_temporary_data_on_disk_size_for_user'
keywords: ['max_temporary_data_on_disk_size_for_user', 'ClickHouse']
description: 'Максимальное количество данных, потребляемых временными файлами на диске для всех одновременно выполняемых пользовательских запросов.'
```

## max_temporary_data_on_disk_size_for_user {#max_temporary_data_on_disk_size_for_user}

Type: UInt64

Default value: 0

Максимальное количество данных, потребляемых временными файлами на диске в байтах для всех одновременно выполняемых пользовательских запросов. Значение ноль означает неограниченно.

```yaml
title: 'max_temporary_non_const_columns'
sidebar_label: 'max_temporary_non_const_columns'
keywords: ['max_temporary_non_const_columns', 'ClickHouse']
description: 'Похоже на настройку "max_temporary_columns", но применяется только к неконстантным столбцам.'
```

## max_temporary_non_const_columns {#max_temporary_non_const_columns}

Type: UInt64

Default value: 0

Похоже на настройку "max_temporary_columns", но применяется только к неконстантным столбцам. Это имеет смысл, поскольку константные столбцы дешевы, и разумно позволить их больше.

```yaml
title: 'max_threads'
sidebar_label: 'max_threads'
keywords: ['max_threads', 'ClickHouse']
description: 'Максимальное количество потоков обработки запросов, исключая потоки для извлечения данных с удаленных серверов.'
```

## max_threads {#max_threads}

Type: MaxThreads

Default value: 'auto(14)'

Максимальное количество потоков обработки запросов, исключая потоки для извлечения данных с удаленных серверов (см. параметр 'max_distributed_connections').

Этот параметр применяется к потокам, которые выполняют одни и те же этапы конвейера обработки запросов параллельно. Например, при чтении из таблицы, если возможно оценивать выражения с функциями, фильтровать по условиям WHERE и предварительно агрегировать для GROUP BY параллельно, используя как минимум 'max_threads' число потоков, то используются 'max_threads'.

Для запросов, которые завершаются быстро из-за LIMIT, вы можете установить меньший 'max_threads'. Например, если необходимое количество записей находится в каждом блоке и max_threads = 8, то извлекается 8 блоков, хотя было бы достаточно прочитать только один.

Чем меньше значение `max_threads`, тем меньше памяти потребляется.

```yaml
title: 'max_threads_for_indexes'
sidebar_label: 'max_threads_for_indexes'
keywords: ['max_threads_for_indexes', 'ClickHouse']
description: 'Максимальное количество потоков для обработки индексов.'
```

## max_threads_for_indexes {#max_threads_for_indexes}

Type: UInt64

Default value: 0

Максимальное количество потоков для обработки индексов.

```yaml
title: 'max_untracked_memory'
sidebar_label: 'max_untracked_memory'
keywords: ['max_untracked_memory', 'ClickHouse']
description: 'Малые выделения и освобождения группируются в локальную переменную потока и отслеживаются или профилируются только тогда, когда сумма (в абсолютном значении) становится больше указанного значения.'
```

## max_untracked_memory {#max_untracked_memory}

Type: UInt64

Default value: 4194304

Малые выделения и освобождения группируются в локальную переменную потока и отслеживаются или профилируются только тогда, когда сумма (в абсолютном значении) становится больше указанного значения. Если значение выше 'memory_profiler_step', оно будет эффективно уменьшено до 'memory_profiler_step'.

```yaml
title: 'memory_overcommit_ratio_denominator'
sidebar_label: 'memory_overcommit_ratio_denominator'
keywords: ['memory_overcommit_ratio_denominator', 'ClickHouse']
description: 'Представляет собой мягкий лимит памяти, когда жесткий лимит достигается на глобальном уровне.'
```

## memory_overcommit_ratio_denominator {#memory_overcommit_ratio_denominator}

Type: UInt64

Default value: 1073741824

Представляет собой мягкий лимит памяти, когда жесткий лимит достигается на глобальном уровне. Это значение используется для вычисления соотношения перерасхода для запроса. Значение ноль означает пропуск запроса. Читайте подробнее о [перерасходе памяти](memory-overcommit.md).

```yaml
title: 'memory_overcommit_ratio_denominator_for_user'
sidebar_label: 'memory_overcommit_ratio_denominator_for_user'
keywords: ['memory_overcommit_ratio_denominator_for_user', 'ClickHouse']
description: 'Представляет собой мягкий лимит памяти, когда жесткий лимит достигается на уровне пользователя.'
```

## memory_overcommit_ratio_denominator_for_user {#memory_overcommit_ratio_denominator_for_user}

Type: UInt64

Default value: 1073741824

Представляет собой мягкий лимит памяти, когда жесткий лимит достигается на уровне пользователя. Это значение используется для вычисления соотношения перерасхода для запроса. Значение ноль означает пропуск запроса. Читайте подробнее о [перерасходе памяти](memory-overcommit.md).

```yaml
title: 'memory_profiler_sample_max_allocation_size'
sidebar_label: 'memory_profiler_sample_max_allocation_size'
keywords: ['memory_profiler_sample_max_allocation_size', 'ClickHouse']
description: 'Собирает случайные выделения размера меньше или равного указанному значению.'
```

## memory_profiler_sample_max_allocation_size {#memory_profiler_sample_max_allocation_size}

Type: UInt64

Default value: 0

Собирает случайные выделения размера меньше или равного указанному значению с вероятностью, равной `memory_profiler_sample_probability`. 0 означает отключено. Возможно, стоит установить 'max_untracked_memory' в 0, чтобы этот порог работал как ожидается.

```yaml
title: 'memory_profiler_sample_min_allocation_size'
sidebar_label: 'memory_profiler_sample_min_allocation_size'
keywords: ['memory_profiler_sample_min_allocation_size', 'ClickHouse']
description: 'Собирает случайные выделения размера больше или равного указанному значению.'
```

## memory_profiler_sample_min_allocation_size {#memory_profiler_sample_min_allocation_size}

Type: UInt64

Default value: 0

Собирает случайные выделения размера больше или равного указанному значению с вероятностью, равной `memory_profiler_sample_probability`. 0 означает отключено. Возможно, стоит установить 'max_untracked_memory' в 0, чтобы этот порог работал как ожидается.

```yaml
title: 'memory_profiler_sample_probability'
sidebar_label: 'memory_profiler_sample_probability'
keywords: ['memory_profiler_sample_probability', 'ClickHouse']
description: 'Собирать случайные выделения и освобождения и записывать их в system.trace_log с 'MemorySample' trace_type.'
```

## memory_profiler_sample_probability {#memory_profiler_sample_probability}

Type: Float

Default value: 0

Собирать случайные выделения и освобождения и записывать их в system.trace_log с 'MemorySample' trace_type. Вероятность применяется ко всем выделениям/освобождениям независимо от размера выделения (может быть изменена с помощью `memory_profiler_sample_min_allocation_size` и `memory_profiler_sample_max_allocation_size`). Обратите внимание, что выборка происходит только тогда, когда количество неучтенной памяти превышает 'max_untracked_memory'. Возможно, стоит установить 'max_untracked_memory' в 0 для более тонкой выборки.

```yaml
title: 'memory_profiler_step'
sidebar_label: 'memory_profiler_step'
keywords: ['memory_profiler_step', 'ClickHouse']
description: 'Устанавливает шаг профилировщика памяти.'
```

## memory_profiler_step {#memory_profiler_step}

Type: UInt64

Default value: 4194304

Устанавливает шаг профилировщика памяти. Каждый раз, когда использование памяти запроса становится больше каждого следующего шага в байтах, профилировщик памяти соберет трассировку стека выделения и запишет ее в [trace_log](/operations/system-tables/trace_log).

Possible values:

- Положительное целое число байт.
- 0 для отключения профилировщика памяти.

```yaml
title: 'memory_tracker_fault_probability'
sidebar_label: 'memory_tracker_fault_probability'
keywords: ['memory_tracker_fault_probability', 'ClickHouse']
description: 'Для тестирования "безопасности исключений" - выбрасывать исключение каждый раз, когда выделяется память с указанной вероятностью.'
```

## memory_tracker_fault_probability {#memory_tracker_fault_probability}

Type: Float

Default value: 0

Для тестирования "безопасности исключений" - выбрасывать исключение каждый раз, когда выделяется память с указанной вероятностью.

```yaml
title: 'memory_usage_overcommit_max_wait_microseconds'
sidebar_label: 'memory_usage_overcommit_max_wait_microseconds'
keywords: ['memory_usage_overcommit_max_wait_microseconds', 'ClickHouse']
description: 'Максимальное время, в течение которого поток будет ждать освобождения памяти в случае перерасхода памяти на уровне пользователя.'
```

## memory_usage_overcommit_max_wait_microseconds {#memory_usage_overcommit_max_wait_microseconds}

Type: UInt64

Default value: 5000000

Максимальное время, в течение которого поток будет ждать освобождения памяти в случае перерасхода памяти на уровне пользователя. Если время ожидания достигнуто и память не освобождена, выбрасывается исключение. Читайте подробнее о [перерасходе памяти](memory-overcommit.md).

```yaml
title: 'merge_table_max_tables_to_look_for_schema_inference'
sidebar_label: 'merge_table_max_tables_to_look_for_schema_inference'
keywords: ['merge_table_max_tables_to_look_for_schema_inference', 'ClickHouse']
description: 'При создании таблицы "Merge" без явной схемы или при использовании табличной функции "merge", выводите схему как объединение не более указанного количества совпадающих таблиц.'
```

## merge_table_max_tables_to_look_for_schema_inference {#merge_table_max_tables_to_look_for_schema_inference}

Type: UInt64

Default value: 1000

При создании таблицы `Merge` без явной схемы или при использовании табличной функции `merge`, выводите схему как объединение не более указанного количества совпадающих таблиц. Если количество таблиц больше, схема будет выведена из первых указанного количества таблиц.

```yaml
title: 'merge_tree_coarse_index_granularity'
sidebar_label: 'merge_tree_coarse_index_granularity'
keywords: ['merge_tree_coarse_index_granularity', 'ClickHouse']
description: 'При поиске данных ClickHouse проверяет метки данных в файле индекса.'
```

## merge_tree_coarse_index_granularity {#merge_tree_coarse_index_granularity}

Type: UInt64

Default value: 8

При поиске данных ClickHouse проверяет метки данных в файле индекса. Если ClickHouse находит, что требуемые ключи находятся в некотором диапазоне, он делит этот диапазон на `merge_tree_coarse_index_granularity` поддиапазонов и ищет требуемые ключи там рекурсивно.

Possible values:

- Любое положительное четное число.

```yaml
title: 'merge_tree_compact_parts_min_granules_to_multibuffer_read'
sidebar_label: 'merge_tree_compact_parts_min_granules_to_multibuffer_read'
keywords: ['merge_tree_compact_parts_min_granules_to_multibuffer_read', 'ClickHouse']
description: 'Только имеет значение в ClickHouse Cloud.'
```

## merge_tree_compact_parts_min_granules_to_multibuffer_read {#merge_tree_compact_parts_min_granules_to_multibuffer_read}

<CloudAvailableBadge/>

Type: UInt64

Default value: 16

Только имеет значение в ClickHouse Cloud. Количество гранул в полосе компактной части таблиц MergeTree для использования многобуферного ридера, который поддерживает параллельное чтение и предварительную выборку. В случае чтения из удаленной файловой системы использование многобуферного ридера увеличивает количество запросов на чтение.

```yaml
title: 'merge_tree_determine_task_size_by_prewhere_columns'
sidebar_label: 'merge_tree_determine_task_size_by_prewhere_columns'
keywords: ['merge_tree_determine_task_size_by_prewhere_columns', 'ClickHouse']
description: 'Будет ли использоваться только размер предварительных столбцов для определения размера задачи чтения.'
```

## merge_tree_determine_task_size_by_prewhere_columns {#merge_tree_determine_task_size_by_prewhere_columns}

Type: Bool

Default value: 1

Будет ли использоваться только размер предварительных столбцов для определения размера задачи чтения.

```yaml
title: 'merge_tree_max_bytes_to_use_cache'
sidebar_label: 'merge_tree_max_bytes_to_use_cache'
keywords: ['merge_tree_max_bytes_to_use_cache', 'ClickHouse']
description: 'Если ClickHouse должен читать более `merge_tree_max_bytes_to_use_cache` байтов в одном запросе, он не использует кэш некорректированных блоков.'
```

## merge_tree_max_bytes_to_use_cache {#merge_tree_max_bytes_to_use_cache}

Type: UInt64

Default value: 2013265920

Если ClickHouse должен читать более `merge_tree_max_bytes_to_use_cache` байтов в одном запросе, он не использует кэш некорректированных блоков.

Кэш некорректированных блоков хранит данные, извлеченные для запросов. ClickHouse использует этот кэш, чтобы ускорить ответы на повторные маленькие запросы. Эта настройка защищает кэш от порчи запросами, которые читают большое количество данных. Параметр [uncompressed_cache_size](/operations/server-configuration-parameters/settings#uncompressed_cache_size) определяет размер кэша некорректированных блоков.

Possible values:

- Любое положительное целое число.

```yaml
title: 'merge_tree_max_rows_to_use_cache'
sidebar_label: 'merge_tree_max_rows_to_use_cache'
keywords: ['merge_tree_max_rows_to_use_cache', 'ClickHouse']
description: 'Если ClickHouse должен читать более `merge_tree_max_rows_to_use_cache` строк в одном запросе, он не использует кэш некорректированных блоков.'
```

## merge_tree_max_rows_to_use_cache {#merge_tree_max_rows_to_use_cache}

Type: UInt64

Default value: 1048576

Если ClickHouse должен читать более `merge_tree_max_rows_to_use_cache` строк в одном запросе, он не использует кэш некорректированных блоков.

Кэш некорректированных блоков хранит данные, извлеченные для запросов. ClickHouse использует этот кэш, чтобы ускорить ответы на повторные маленькие запросы. Эта настройка защищает кэш от порчи запросами, которые читают большое количество данных. Параметр [uncompressed_cache_size](/operations/server-configuration-parameters/settings#uncompressed_cache_size) определяет размер кэша некорректированных блоков.

Possible values:

- Любое положительное целое число.

```yaml
title: 'merge_tree_min_bytes_for_concurrent_read'
sidebar_label: 'merge_tree_min_bytes_for_concurrent_read'
keywords: ['merge_tree_min_bytes_for_concurrent_read', 'ClickHouse']
description: 'Если количество байтов, читаемых из одного файла таблицы [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md), превышает `merge_tree_min_bytes_for_concurrent_read`, тогда ClickHouse попытается одновременно читать из этого файла в нескольких потоках.'
```

## merge_tree_min_bytes_for_concurrent_read {#merge_tree_min_bytes_for_concurrent_read}

Type: UInt64

Default value: 251658240

Если количество байтов, читаемых из одного файла таблицы [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md), превышает `merge_tree_min_bytes_for_concurrent_read`, тогда ClickHouse попытается одновременно читать из этого файла в нескольких потоках.

Possible value:

- Положительное целое число.

```yaml
title: 'merge_tree_min_bytes_for_concurrent_read_for_remote_filesystem'
sidebar_label: 'merge_tree_min_bytes_for_concurrent_read_for_remote_filesystem'
keywords: ['merge_tree_min_bytes_for_concurrent_read_for_remote_filesystem', 'ClickHouse']
description: 'Минимальное количество байтов, которые нужно прочитать из одного файла перед тем, как [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md) может параллелизовать чтение, когда чтение из удаленной файловой системы.'
```

## merge_tree_min_bytes_for_concurrent_read_for_remote_filesystem {#merge_tree_min_bytes_for_concurrent_read_for_remote_filesystem}

Type: UInt64

Default value: 0

Минимальное количество байтов, которые нужно прочитать из одного файла перед тем, как [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md) может параллелизовать чтение, когда чтение из удаленной файловой системы. Мы не рекомендуем использовать эту настройку.

Possible values:

- Положительное целое число.

```yaml
title: 'merge_tree_min_bytes_for_seek'
sidebar_label: 'merge_tree_min_bytes_for_seek'
keywords: ['merge_tree_min_bytes_for_seek', 'ClickHouse']
description: 'Если расстояние между двумя блоками данных для чтения в одном файле меньше чем `merge_tree_min_bytes_for_seek` байтов, ClickHouse последовательно читает диапазон файла, который содержит оба блока, избегая тем самым дополнительного поиска.'
```

## merge_tree_min_bytes_for_seek {#merge_tree_min_bytes_for_seek}

Type: UInt64

Default value: 0

Если расстояние между двумя блоками данных для чтения в одном файле меньше чем `merge_tree_min_bytes_for_seek` байтов, ClickHouse последовательно читает диапазон файла, который содержит оба блока, избегая тем самым дополнительного поиска.

Possible values:

- Любое положительное целое число.

```yaml
title: 'merge_tree_min_bytes_per_task_for_remote_reading'
sidebar_label: 'merge_tree_min_bytes_per_task_for_remote_reading'
keywords: ['merge_tree_min_bytes_per_task_for_remote_reading', 'ClickHouse']
description: 'Минимально допустимое количество байтов для чтения в задаче.'
```

## merge_tree_min_bytes_per_task_for_remote_reading {#merge_tree_min_bytes_per_task_for_remote_reading}

Type: UInt64

Default value: 2097152

Минимально допустимое количество байтов для чтения в задаче.

```yaml
title: 'merge_tree_min_read_task_size'
sidebar_label: 'merge_tree_min_read_task_size'
keywords: ['merge_tree_min_read_task_size', 'ClickHouse']
description: 'Твердый нижний предел на размер задачи (даже когда количество гранул низкое, и количество доступных потоков высокое, мы не выделим меньшие задачи).'
```

## merge_tree_min_read_task_size {#merge_tree_min_read_task_size}

Type: UInt64

Default value: 8

Твердый нижний предел на размер задачи (даже когда количество гранул низкое, и количество доступных потоков высокое, мы не выделим меньшие задачи).

```yaml
title: 'merge_tree_min_rows_for_concurrent_read'
sidebar_label: 'merge_tree_min_rows_for_concurrent_read'
keywords: ['merge_tree_min_rows_for_concurrent_read', 'ClickHouse']
description: 'Если количество строк, читаемых из файла таблицы [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md), превышает `merge_tree_min_rows_for_concurrent_read`, тогда ClickHouse пытается выполнить параллельное чтение из этого файла в нескольких потоках.'
```

## merge_tree_min_rows_for_concurrent_read {#merge_tree_min_rows_for_concurrent_read}

Type: UInt64

Default value: 163840

Если количество строк, читаемых из файла таблицы [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md), превышает `merge_tree_min_rows_for_concurrent_read`, тогда ClickHouse пытается выполнить параллельное чтение из этого файла в нескольких потоках.

Possible values:

- Положительное целое число.

```yaml
title: 'merge_tree_min_rows_for_concurrent_read_for_remote_filesystem'
sidebar_label: 'merge_tree_min_rows_for_concurrent_read_for_remote_filesystem'
keywords: ['merge_tree_min_rows_for_concurrent_read_for_remote_filesystem', 'ClickHouse']
description: 'Минимальное количество строк для чтения из одного файла перед тем, как [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md) может параллелизовать чтение, когда чтение из удаленной файловой системы.'
```

## merge_tree_min_rows_for_concurrent_read_for_remote_filesystem {#merge_tree_min_rows_for_concurrent_read_for_remote_filesystem}

Type: UInt64

Default value: 0

Минимальное количество строк для чтения из одного файла перед тем, как [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md) может параллелизовать чтение, когда чтение из удаленной файловой системы. Мы не рекомендуем использовать эту настройку.

Possible values:

- Положительное целое число.

```yaml
title: 'merge_tree_min_rows_for_seek'
sidebar_label: 'merge_tree_min_rows_for_seek'
keywords: ['merge_tree_min_rows_for_seek', 'ClickHouse']
description: 'Если расстояние между двумя блоками данных для чтения в одном файле меньше чем `merge_tree_min_rows_for_seek` строк, то ClickHouse не выполняет поиск по файлу, а читает данные последовательно.'
```

## merge_tree_min_rows_for_seek {#merge_tree_min_rows_for_seek}

Type: UInt64

Default value: 0

Если расстояние между двумя блоками данных для чтения в одном файле меньше чем `merge_tree_min_rows_for_seek` строк, то ClickHouse не выполняет поиск по файлу, а читает данные последовательно.

Possible values:

- Любое положительное целое число.

```yaml
title: 'merge_tree_read_split_ranges_into_intersecting_and_non_intersecting_injection_probability'
sidebar_label: 'merge_tree_read_split_ranges_into_intersecting_and_non_intersecting_injection_probability'
keywords: ['merge_tree_read_split_ranges_into_intersecting_and_non_intersecting_injection_probability', 'ClickHouse']
description: 'Для тестирования "PartsSplitter" - разбить читаемые диапазоны на пересекающиеся и непересекающиеся всякий раз, когда вы читаете из MergeTree с указанной вероятностью.'
```

## merge_tree_read_split_ranges_into_intersecting_and_non_intersecting_injection_probability {#merge_tree_read_split_ranges_into_intersecting_and_non_intersecting_injection_probability}

Type: Float

Default value: 0

Для тестирования "PartsSplitter" - разбить читаемые диапазоны на пересекающиеся и непересекающиеся всякий раз, когда вы читаете из MergeTree с указанной вероятностью.

```yaml
title: 'merge_tree_use_const_size_tasks_for_remote_reading'
sidebar_label: 'merge_tree_use_const_size_tasks_for_remote_reading'
keywords: ['merge_tree_use_const_size_tasks_for_remote_reading', 'ClickHouse']
description: 'Будет ли использоваться фиксированный размер задач для чтения из удаленной таблицы.'
```

## merge_tree_use_const_size_tasks_for_remote_reading {#merge_tree_use_const_size_tasks_for_remote_reading}

Type: Bool

Default value: 1

Будет ли использоваться фиксированный размер задач для чтения из удаленной таблицы.

```yaml
title: 'merge_tree_use_deserialization_prefixes_cache'
sidebar_label: 'merge_tree_use_deserialization_prefixes_cache'
keywords: ['merge_tree_use_deserialization_prefixes_cache', 'ClickHouse']
description: 'Включает кэширование метаданных столбцов из файловых префиксов при чтении из широких частей в MergeTree.'
```

## merge_tree_use_deserialization_prefixes_cache {#merge_tree_use_deserialization_prefixes_cache}

Type: Bool

Default value: 1

Включает кэширование метаданных столбцов из файловых префиксов при чтении из широких частей в MergeTree.

```yaml
title: 'merge_tree_use_prefixes_deserialization_thread_pool'
sidebar_label: 'merge_tree_use_prefixes_deserialization_thread_pool'
keywords: ['merge_tree_use_prefixes_deserialization_thread_pool', 'ClickHouse']
description: 'Включает использование пула потоков для параллельного чтения префиксов в широких частях в MergeTree.'
```

## merge_tree_use_prefixes_deserialization_thread_pool {#merge_tree_use_prefixes_deserialization_thread_pool}

Type: Bool

Default value: 1

Включает использование пула потоков для параллельного чтения префиксов в широких частях в MergeTree. Размер этого пула потоков контролируется серверной настройкой `max_prefixes_deserialization_thread_pool_size`.

```yaml
title: 'merge_tree_use_v1_object_and_dynamic_serialization'
sidebar_label: 'merge_tree_use_v1_object_and_dynamic_serialization'
keywords: ['merge_tree_use_v1_object_and_dynamic_serialization', 'ClickHouse']
description: 'При включении будет использоваться версия сериализации V1 типов JSON и Dynamic в MergeTree вместо V2.'
```

## merge_tree_use_v1_object_and_dynamic_serialization {#merge_tree_use_v1_object_and_dynamic_serialization}

Type: Bool

Default value: 0

При включении будет использоваться версия сериализации V1 типов JSON и Dynamic в MergeTree вместо V2. Изменение этой настройки вступает в силу только после перезапуска сервера.

```yaml
title: 'metrics_perf_events_enabled'
sidebar_label: 'metrics_perf_events_enabled'
keywords: ['metrics_perf_events_enabled', 'ClickHouse']
description: 'Если включено, некоторые из производительных событий будут измеряться в процессе выполнения запросов.'
```

## metrics_perf_events_enabled {#metrics_perf_events_enabled}

Type: Bool

Default value: 0

Если включено, некоторые из производительных событий будут измеряться в процессе выполнения запросов.

```yaml
title: 'metrics_perf_events_list'
sidebar_label: 'metrics_perf_events_list'
keywords: ['metrics_perf_events_list', 'ClickHouse']
description: 'Список производственных метрик, которые будут измеряться в процессе выполнения запросов.'
```

## metrics_perf_events_list {#metrics_perf_events_list}

Type: String

Default value: 

Список производственных метрик, разделенный запятыми, которые будут измеряться в процессе выполнения запросов. Пустой означает все события. Смотрите PerfEventInfo в источниках для доступных событий.

```yaml
title: 'min_bytes_to_use_direct_io'
sidebar_label: 'min_bytes_to_use_direct_io'
keywords: ['min_bytes_to_use_direct_io', 'ClickHouse']
description: 'Минимальный объем данных, необходимый для использования прямого доступа к I/O на диске хранения.'
```

## min_bytes_to_use_direct_io {#min_bytes_to_use_direct_io}

Type: UInt64

Default value: 0

Минимальный объем данных, необходимый для использования прямого доступа к I/O на диске хранения.

ClickHouse использует эту настройку при чтении данных из таблиц. Если общий объем хранения всех данных, которые необходимо прочитать, превышает `min_bytes_to_use_direct_io` байтов, ClickHouse читает данные с диска хранения с опцией `O_DIRECT`.

Possible values:

- 0 — Прямой доступ к I/O отключен.
- Положительное целое число.

```yaml
title: 'min_bytes_to_use_mmap_io'
sidebar_label: 'min_bytes_to_use_mmap_io'
keywords: ['min_bytes_to_use_mmap_io', 'ClickHouse']
description: 'Это экспериментальная настройка. Устанавливает минимальное количество памяти для чтения больших файлов без копирования данных из ядра в пространство пользователей.'
```

## min_bytes_to_use_mmap_io {#min_bytes_to_use_mmap_io}

Type: UInt64

Default value: 0

Это экспериментальная настройка. Устанавливает минимальное количество памяти для чтения больших файлов без копирования данных из ядра в пространство пользователей. Рекомендуемый порог составляет около 64 МБ, поскольку [mmap/munmap](https://en.wikipedia.org/wiki/Mmap) медленно. Это имеет смысл только для больших файлов и помогает только если данные находятся в кэше страниц.

Possible values:

- Положительное целое число.
- 0 — Большие файлы читаются только с копированием данных из ядра в пространство пользователей.

```yaml
title: 'min_chunk_bytes_for_parallel_parsing'
sidebar_label: 'min_chunk_bytes_for_parallel_parsing'
keywords: ['min_chunk_bytes_for_parallel_parsing', 'ClickHouse']
description: 'Минимальный размер фрагмента в байтах, который каждый поток будет разбирать параллельно.'
```

## min_chunk_bytes_for_parallel_parsing {#min_chunk_bytes_for_parallel_parsing}

Type: NonZeroUInt64

Default value: 10485760

- Type: unsigned int
- Default value: 1 MiB

Минимальный размер фрагмента в байтах, который каждый поток будет разбирать параллельно.

```yaml
title: 'min_compress_block_size'
sidebar_label: 'min_compress_block_size'
keywords: ['min_compress_block_size', 'ClickHouse']
description: 'Для таблиц [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md).'
```

## min_compress_block_size {#min_compress_block_size}

Type: UInt64

Default value: 65536

Для таблиц [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md). Чтобы уменьшить задержки при обработке запросов, блок сжимается при записи следующей метки, если его размер составляет хотя бы `min_compress_block_size`. По умолчанию 65 536.

Фактический размер блока, если неупакованные данные меньше `max_compress_block_size`, не меньше этого значения и не меньше объема данных для одной метки.

Рассмотрим пример. Предположим, что `index_granularity` была установлена на 8192 во время создания таблицы.

Мы записываем столбец типа UInt32 (4 байта на значение). При записи 8192 строк общий объем данных составит 32 КБ. Поскольку min_compress_block_size = 65 536, сжатый блок будет сформирован для каждых двух меток.

Мы записываем столбец URL с типом String (средний размер 60 байт на значение). При записи 8192 строк в среднем получится чуть меньше 500 КБ данных. Поскольку это больше 65 536, сжатый блок будет сформирован для каждой метки. В этом случае, при чтении данных с диска в диапазоне одной метки дополнительные данные не будут распаковываться.

:::note
Это настройка для экспертов, и вам не следует изменять ее, если вы только начинаете работать с ClickHouse.
:::

```yaml
title: 'min_count_to_compile_aggregate_expression'
sidebar_label: 'min_count_to_compile_aggregate_expression'
keywords: ['min_count_to_compile_aggregate_expression', 'ClickHouse']
description: 'Минимальное количество идентичных агрегатных выражений для начала JIT-компиляции.'
```

## min_count_to_compile_aggregate_expression {#min_count_to_compile_aggregate_expression}

Type: UInt64

Default value: 3

Минимальное количество идентичных агрегатных выражений для начала JIT-компиляции. Работает только если включена настройка [compile_aggregate_expressions](#compile_aggregate_expressions).

Possible values:

- Положительное целое число.
- 0 — Идентичные агрегатные выражения всегда JIT-компилируются.

```yaml
title: 'min_count_to_compile_expression'
sidebar_label: 'min_count_to_compile_expression'
keywords: ['min_count_to_compile_expression', 'ClickHouse']
description: 'Минимальное количество исполнений одного и того же выражения перед его компиляцией.'
```

## min_count_to_compile_expression {#min_count_to_compile_expression}

Type: UInt64

Default value: 3

Минимальное количество исполнений одного и того же выражения перед его компиляцией.

```yaml
title: 'min_count_to_compile_sort_description'
sidebar_label: 'min_count_to_compile_sort_description'
keywords: ['min_count_to_compile_sort_description', 'ClickHouse']
description: 'Количество идентичных описаний сортировки перед тем, как они будут JIT-компилированы.'
```

## min_count_to_compile_sort_description {#min_count_to_compile_sort_description}

Type: UInt64

Default value: 3

Количество идентичных описаний сортировки перед тем, как они будут JIT-компилированы.

```yaml
title: 'min_execution_speed'
sidebar_label: 'min_execution_speed'
keywords: ['min_execution_speed', 'ClickHouse']
description: 'Минимальное количество выполняемых строк в секунду.'
```

## min_execution_speed {#min_execution_speed}

Type: UInt64

Default value: 0

Минимальное количество выполняемых строк в секунду.

```yaml
title: 'min_execution_speed_bytes'
sidebar_label: 'min_execution_speed_bytes'
keywords: ['min_execution_speed_bytes', 'ClickHouse']
description: 'Минимальное количество выполняемых байтов в секунду.'
```

## min_execution_speed_bytes {#min_execution_speed_bytes}

Type: UInt64

Default value: 0

Минимальное количество выполняемых байтов в секунду.

```yaml
title: 'min_external_sort_block_bytes'
sidebar_label: 'min_external_sort_block_bytes'
keywords: ['min_external_sort_block_bytes', 'ClickHouse']
description: 'Минимальный размер блока в байтах для внешней сортировки, который будет сброшен на диск.'
```

## min_external_sort_block_bytes {#min_external_sort_block_bytes}

Type: UInt64

Default value: 104857600

Минимальный размер блока в байтах для внешней сортировки, который будет сброшен на диск, чтобы избежать слишком большого количества файлов.

```yaml
title: 'min_external_table_block_size_bytes'
sidebar_label: 'min_external_table_block_size_bytes'
keywords: ['min_external_table_block_size_bytes', 'ClickHouse']
description: 'Сокращает блоки, передаваемые во внешнюю таблицу, до указанного размера в байтах.'
```

## min_external_table_block_size_bytes {#min_external_table_block_size_bytes}

Type: UInt64

Default value: 268402944

Сокращает блоки, передаваемые во внешнюю таблицу, до указанного размера в байтах, если блоки недостаточно большие.

```yaml
title: 'min_external_table_block_size_rows'
sidebar_label: 'min_external_table_block_size_rows'
keywords: ['min_external_table_block_size_rows', 'ClickHouse']
description: 'Сокращает блоки, передаваемые во внешнюю таблицу, до указанного размера в строках.'
```

## min_external_table_block_size_rows {#min_external_table_block_size_rows}

Type: UInt64

Default value: 1048449

Сокращает блоки, передаваемые во внешнюю таблицу, до указанного размера в строках, если блоки недостаточно большие.

```yaml
title: 'min_free_disk_bytes_to_perform_insert'
sidebar_label: 'min_free_disk_bytes_to_perform_insert'
keywords: ['min_free_disk_bytes_to_perform_insert', 'ClickHouse']
description: 'Минимальное количество свободного места на диске в байтах для выполнения вставки.'
```

## min_free_disk_bytes_to_perform_insert {#min_free_disk_bytes_to_perform_insert}

Type: UInt64

Default value: 0

Минимальное количество свободного места на диске в байтах для выполнения вставки.

```yaml
title: 'min_free_disk_ratio_to_perform_insert'
sidebar_label: 'min_free_disk_ratio_to_perform_insert'
keywords: ['min_free_disk_ratio_to_perform_insert', 'ClickHouse']
description: 'Минимальное отношение свободного места на диске для выполнения вставки.'
```

## min_free_disk_ratio_to_perform_insert {#min_free_disk_ratio_to_perform_insert}

Type: Float

Default value: 0

Минимальное отношение свободного места на диске для выполнения вставки.

```yaml
title: 'min_free_disk_space_for_temporary_data'
sidebar_label: 'min_free_disk_space_for_temporary_data'
keywords: ['min_free_disk_space_for_temporary_data', 'ClickHouse']
description: 'Минимальное пространство на диске, которое необходимо сохранить при записи временных данных, используемых во внешней сортировке и агрегации.'
```

## min_free_disk_space_for_temporary_data {#min_free_disk_space_for_temporary_data}

Type: UInt64

Default value: 0

Минимальное пространство на диске для хранения временных данных, используемых во внешней сортировке и агрегации.

```yaml
title: 'min_hit_rate_to_use_consecutive_keys_optimization'
sidebar_label: 'min_hit_rate_to_use_consecutive_keys_optimization'
keywords: ['min_hit_rate_to_use_consecutive_keys_optimization', 'золотой стандарт', 'оптимизация']
description: 'Минимальный коэффициент попадания кэша, используемого для оптимизации последовательных ключей в агрегации, чтобы поддерживать его включенным.'
```

## min_hit_rate_to_use_consecutive_keys_optimization {#min_hit_rate_to_use_consecutive_keys_optimization}

Type: Float

Default value: 0.5

Минимальный коэффициент попадания кэша, который используется для оптимизации последовательных ключей в агрегации, чтобы поддерживать его включенным.

## min_insert_block_size_bytes {#min_insert_block_size_bytes}

Type: UInt64

Default value: 268402944

Устанавливает минимальное количество байтов в блоке, который может быть вставлен в таблицу с помощью запроса `INSERT`. Более мелкие блоки объединяются в Bigger ones.

Possible values:

- Положительное целое число.
- 0 — Объединение отключено.

## min_insert_block_size_bytes_for_materialized_views {#min_insert_block_size_bytes_for_materialized_views}

Type: UInt64

Default value: 0

Устанавливает минимальное количество байтов в блоке, который может быть вставлен в таблицу с помощью запроса `INSERT`. Более мелкие блоки объединяются в Bigger ones. Эта настройка применяется только для блоков, вставляемых в [материализованное представление](../../sql-reference/statements/create/view.md). Настраивая эту настройку, вы контролируете объединение блоков при отправке в материализованное представление и избегаете чрезмерного использования памяти.

Possible values:

- Любое положительное целое число.
- 0 — Объединение отключено.

**See also**

- [min_insert_block_size_bytes](#min_insert_block_size_bytes)

## min_insert_block_size_rows {#min_insert_block_size_rows}

Type: UInt64

Default value: 1048449

Устанавливает минимальное количество строк в блоке, которые могут быть вставлены в таблицу с помощью запроса `INSERT`. Более мелкие блоки объединяются в Bigger ones.

Possible values:

- Положительное целое число.
- 0 — Объединение отключено.

## min_insert_block_size_rows_for_materialized_views {#min_insert_block_size_rows_for_materialized_views}

Type: UInt64

Default value: 0

Устанавливает минимальное число строк в блоке, который может быть вставлен в таблицу с помощью запроса `INSERT`. Более мелкие блоки объединяются в Bigger ones. Эта настройка применяется только для блоков, вставляемых в [материализованное представление](../../sql-reference/statements/create/view.md). Настраивая эту настройку, вы контролируете объединение блоков при отправке в материализованное представление и избегаете чрезмерного использования памяти.

Possible values:

- Любое положительное целое число.
- 0 — Объединение отключено.

**See Also**

- [min_insert_block_size_rows](#min_insert_block_size_rows)

## min_joined_block_size_bytes {#min_joined_block_size_bytes}

Type: UInt64

Default value: 524288

Минимальный размер блока для результата JOIN (если поддерживается алгоритмом соединения). 0 означает неограниченный.

## mongodb_throw_on_unsupported_query {#mongodb_throw_on_unsupported_query}

Type: Bool

Default value: 1

Если включено, таблицы MongoDB будут возвращать ошибку, когда запрос MongoDB не может быть построен. В противном случае ClickHouse читает всю таблицу и обрабатывает её локально. Эта опция не применяется, когда 'allow_experimental_analyzer=0'.

## move_all_conditions_to_prewhere {#move_all_conditions_to_prewhere}

Type: Bool

Default value: 1

Переместите все подходящие условия из WHERE в PREWHERE.

## move_primary_key_columns_to_end_of_prewhere {#move_primary_key_columns_to_end_of_prewhere}

Type: Bool

Default value: 1

Переместите условия PREWHERE, содержащие столбцы первичного ключа, в конец цепочки AND. Скорее всего, эти условия учитываются во время анализа первичного ключа и, таким образом, не внесут значительного вклада в фильтрацию PREWHERE.

## multiple_joins_try_to_keep_original_names {#multiple_joins_try_to_keep_original_names}

Type: Bool

Default value: 0

Не добавлять псевдонимы в верхнем уровне списка выражений при переработке нескольких соединений.

## mutations_execute_nondeterministic_on_initiator {#mutations_execute_nondeterministic_on_initiator}

Type: Bool

Default value: 0

Если true, постоянные недетерминированные функции (например, функция `now()`) выполняются на инициаторе и заменяются литералами в запросах `UPDATE` и `DELETE`. Это помогает поддерживать данные в синхронизации на репликах при выполнении мутаций с постоянными недетерминированными функциями. Значение по умолчанию: `false`.

## mutations_execute_subqueries_on_initiator {#mutations_execute_subqueries_on_initiator}

Type: Bool

Default value: 0

Если true, скалярные подзапросы выполняются на инициаторе и заменяются литералами в запросах `UPDATE` и `DELETE`. Значение по умолчанию: `false`.

## mutations_max_literal_size_to_replace {#mutations_max_literal_size_to_replace}

Type: UInt64

Default value: 16384

Максимальный размер сериализованного литерала в байтах для замены в запросах `UPDATE` и `DELETE`. Действует только если хотя бы одна из двух предыдущих настроек включена. Значение по умолчанию: 16384 (16 KiB).

## mutations_sync {#mutations_sync}

Type: UInt64

Default value: 0

Позволяет выполнять запросы `ALTER TABLE ... UPDATE|DELETE|MATERIALIZE INDEX|MATERIALIZE PROJECTION|MATERIALIZE COLUMN|MATERIALIZE STATISTICS` ([мутации](../../sql-reference/statements/alter/index.md/#mutations)) синхронно.

Possible values:

- 0 - Мутации выполняются асинхронно.
- 1 - Запрос ждет завершения всех мутаций на текущем сервере.
- 2 - Запрос ждет завершения всех мутаций на всех репликах (если таковые имеются).

## mysql_datatypes_support_level {#mysql_datatypes_support_level}

Type: MySQLDataTypesSupport

Default value: 

Определяет, как типы MySQL преобразуются в соответствующие типы ClickHouse. Список, разделенный запятыми, в любом сочетании `decimal`, `datetime64`, `date2Date32` или `date2String`.
- `decimal`: преобразовать типы `NUMERIC` и `DECIMAL` в `Decimal`, когда это позволяет точность.
- `datetime64`: преобразовать типы `DATETIME` и `TIMESTAMP` в `DateTime64`, вместо `DateTime`, когда точность не равна `0`.
- `date2Date32`: преобразовать `DATE` в `Date32`, вместо `Date`. Имеет более высокий приоритет, чем `date2String`.
- `date2String`: преобразовать `DATE` в `String`, вместо `Date`. Переопределяется `datetime64`.

## mysql_map_fixed_string_to_text_in_show_columns {#mysql_map_fixed_string_to_text_in_show_columns}

Type: Bool

Default value: 1

Когда включено, [FixedString](../../sql-reference/data-types/fixedstring.md) тип данных ClickHouse будет отображаться как `TEXT` в [SHOW COLUMNS](../../sql-reference/statements/show.md/#show_columns).

Это имеет эффект только когда соединение установлено через MySQL wire protocol.

- 0 - Использовать `BLOB`.
- 1 - Использовать `TEXT`.

## mysql_map_string_to_text_in_show_columns {#mysql_map_string_to_text_in_show_columns}

Type: Bool

Default value: 1

Когда включено, [String](../../sql-reference/data-types/string.md) тип данных ClickHouse будет отображаться как `TEXT` в [SHOW COLUMNS](../../sql-reference/statements/show.md/#show_columns).

Это имеет эффект только когда соединение установлено через MySQL wire protocol.

- 0 - Использовать `BLOB`.
- 1 - Использовать `TEXT`.

## mysql_max_rows_to_insert {#mysql_max_rows_to_insert}

Type: UInt64

Default value: 65536

Максимальное количество строк в пакетной вставке MySQL движка хранения.

## network_compression_method {#network_compression_method}

Type: String

Default value: LZ4

Устанавливает метод сжатия данных, который используется для связи между серверами и между сервером и [clickhouse-client](../../interfaces/cli.md).

Possible values:

- `LZ4` — устанавливает метод сжатия LZ4.
- `ZSTD` — устанавливает метод сжатия ZSTD.

**See Also**

- [network_zstd_compression_level](#network_zstd_compression_level)

## network_zstd_compression_level {#network_zstd_compression_level}

Type: Int64

Default value: 1

Настраивает уровень сжатия ZSTD. Используется только когда [network_compression_method](#network_compression_method) установлен в `ZSTD`.

Possible values:

- Положительное целое число от 1 до 15.

## normalize_function_names {#normalize_function_names}

Type: Bool

Default value: 1

Нормализует имена функций в их каноническую форму.

## number_of_mutations_to_delay {#number_of_mutations_to_delay}

Type: UInt64

Default value: 0

Если измененная таблица содержит по крайней мере столько незавершенных мутаций, искусственно замедляет мутации таблицы. 0 - отключено.

## number_of_mutations_to_throw {#number_of_mutations_to_throw}

Type: UInt64

Default value: 0

Если измененная таблица содержит по крайней мере столько незавершенных мутаций, выдает исключение 'Слишком много мутаций ...'. 0 - отключено.

## odbc_bridge_connection_pool_size {#odbc_bridge_connection_pool_size}

Type: UInt64

Default value: 16

Размер пула соединений для каждой строки настроек соединения в ODBC мосте.

## odbc_bridge_use_connection_pooling {#odbc_bridge_use_connection_pooling}

Type: Bool

Default value: 1

Использовать пул соединений в ODBC мосте. Если установлено значение false, новое соединение создается каждый раз.

## offset {#offset}

Type: UInt64

Default value: 0

Устанавливает количество строк для пропуска перед началом возврата строк из запроса. Это корректирует смещение, установленное оператором [OFFSET](/sql-reference/statements/select/offset), так что эти два значения складываются.

Possible values:

- 0 — Не пропускаются строки.
- Положительное целое число.

**Example**

Input table:

```sql
CREATE TABLE test (i UInt64) ENGINE = MergeTree() ORDER BY i;
INSERT INTO test SELECT number FROM numbers(500);
```

Query:

```sql
SET limit = 5;
SET offset = 7;
SELECT * FROM test LIMIT 10 OFFSET 100;
```

Result:

```text
┌───i─┐
│ 107 │
│ 108 │
│ 109 │
└─────┘
```

## opentelemetry_start_trace_probability {#opentelemetry_start_trace_probability}

Type: Float

Default value: 0

Устанавливает вероятность того, что ClickHouse может начать трассировку для выполняемых запросов (если не предоставлен родительский [контекст трассировки](https://www.w3.org/TR/trace-context/)).

Possible values:

- 0 — Трассировка для всех выполняемых запросов отключена (если не предоставлен родительский контекст трассировки).
- Положительное число с плавающей запятой в диапазоне [0..1]. Например, если значение параметра равно `0,5`, ClickHouse может начать трассировку в среднем для половины запросов.
- 1 — Трассировка для всех выполняемых запросов включена.

## opentelemetry_trace_processors {#opentelemetry_trace_processors}

Type: Bool

Default value: 0

Собирает OpenTelemetry спаны для процессоров.

## optimize_aggregation_in_order {#optimize_aggregation_in_order}

Type: Bool

Default value: 0

Включает оптимизацию [GROUP BY](/sql-reference/statements/select/group-by) в запросах [SELECT](../../sql-reference/statements/select/index.md) для агрегации данных в соответствующем порядке в таблицах [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md).

Possible values:

- 0 — Оптимизация `GROUP BY` отключена.
- 1 — Оптимизация `GROUP BY` включена.

**See Also**

- [Оптимизация GROUP BY](/sql-reference/statements/select/group-by#group-by-optimization-depending-on-table-sorting-key)

## optimize_aggregators_of_group_by_keys {#optimize_aggregators_of_group_by_keys}

Type: Bool

Default value: 1

Устранить агрегаторы min/max/any/anyLast ключей GROUP BY в разделе SELECT.

## optimize_and_compare_chain {#optimize_and_compare_chain}

Type: Bool

Default value: 1

Заполняет постоянное сравнение в цепочках AND для повышения способности фильтрации. Поддерживает операторы `<`, `<=`, `>`, `>=`, `=` и их комбинации. Например, `(a < b) AND (b < c) AND (c < 5)` будет `(a < b) AND (b < c) AND (c < 5) AND (b < 5) AND (a < 5)`.

## optimize_append_index {#optimize_append_index}

Type: Bool

Default value: 0

Использовать [ограничения](../../sql-reference/statements/create/table.md/#constraints) для добавления условия индекса. По умолчанию `false`.

Possible values:

- true, false

## optimize_arithmetic_operations_in_aggregate_functions {#optimize_arithmetic_operations_in_aggregate_functions}

Type: Bool

Default value: 1

Переместить арифметические операции за пределы агрегатных функций.

## optimize_count_from_files {#optimize_count_from_files}

Type: Bool

Default value: 1

Включает или отключает оптимизацию подсчета количества строк из файлов в различных входных форматах. Применяется к табличным функциям/движкам `file`/`s3`/`url`/`hdfs`/`azureBlobStorage`.

Possible values:

- 0 — Оптимизация отключена.
- 1 — Оптимизация включена.

## optimize_distinct_in_order {#optimize_distinct_in_order}

Type: Bool

Default value: 1

Включает оптимизацию DISTINCT, если некоторые столбцы в DISTINCT образуют префикс сортировки. Например, префикс сортировочного ключа в дереве слияния или операторе ORDER BY.

## optimize_distributed_group_by_sharding_key {#optimize_distributed_group_by_sharding_key}

Type: Bool

Default value: 1

Оптимизирует запросы `GROUP BY sharding_key`, избегая затратной агрегации на сервере инициаторе (что позволит сократить использование памяти для запроса на сервере инициаторе).

Поддерживаются следующие типы запросов (и все их комбинации):

- `SELECT DISTINCT [..., ]sharding_key[, ...] FROM dist`
- `SELECT ... FROM dist GROUP BY sharding_key[, ...]`
- `SELECT ... FROM dist GROUP BY sharding_key[, ...] ORDER BY x`
- `SELECT ... FROM dist GROUP BY sharding_key[, ...] LIMIT 1`
- `SELECT ... FROM dist GROUP BY sharding_key[, ...] LIMIT 1 BY x`

Следующие типы запросов не поддерживаются (поддержка некоторых из них может быть добавлена позже):

- `SELECT ... GROUP BY sharding_key[, ...] WITH TOTALS`
- `SELECT ... GROUP BY sharding_key[, ...] WITH ROLLUP`
- `SELECT ... GROUP BY sharding_key[, ...] WITH CUBE`
- `SELECT ... GROUP BY sharding_key[, ...] SETTINGS extremes=1`

Possible values:

- 0 — Отключено.
- 1 — Включено.

See also:

- [distributed_group_by_no_merge](#distributed_group_by_no_merge)
- [distributed_push_down_limit](#distributed_push_down_limit)
- [optimize_skip_unused_shards](#optimize_skip_unused_shards)

:::note
В настоящее время это требует `optimize_skip_unused_shards` (причина заключается в том, что однажды это может быть включено по умолчанию, и это будет работать правильно только если данные были вставлены через распределенную таблицу, т.е. данные распределены в соответствии с `sharding_key`).
:::

## optimize_extract_common_expressions {#optimize_extract_common_expressions}

Type: Bool

Default value: 1

Разрешает извлечение общих выражений из дизъюнкций в WHERE, PREWHERE, ON, HAVING и QUALIFY выражениях. Логическое выражение, такое как `(A AND B) OR (A AND C)` может быть переписано в `A AND (B OR C)`, что может помочь использовать:
- индексы в простых выражениях фильтрации
- оптимизацию пересечения с внутренним соединением.

## optimize_functions_to_subcolumns {#optimize_functions_to_subcolumns}

Type: Bool

Default value: 1

Включает или отключает оптимизацию, преобразуя некоторые функции в чтение подсубколонок. Это уменьшает объем данных для чтения.

Эти функции могут быть преобразованы:

- [length](/sql-reference/functions/array-functions#length) для чтения подсубколонки [size0](../../sql-reference/data-types/array.md/#array-size).
- [empty](/sql-reference/functions/array-functions#empty) для чтения подсубколонки [size0](../../sql-reference/data-types/array.md/#array-size).
- [notEmpty](/sql-reference/functions/array-functions#notempty) для чтения подсубколонки [size0](../../sql-reference/data-types/array.md/#array-size).
- [isNull](/sql-reference/functions/functions-for-nulls#isnull) для чтения подсубколонки [null](../../sql-reference/data-types/nullable.md/#finding-null).
- [isNotNull](/sql-reference/functions/functions-for-nulls#isnotnull) для чтения подсубколонки [null](../../sql-reference/data-types/nullable.md/#finding-null).
- [count](/sql-reference/aggregate-functions/reference/count) для чтения подсубколонки [null](../../sql-reference/data-types/nullable.md/#finding-null).
- [mapKeys](/sql-reference/functions/tuple-map-functions#mapkeys) для чтения подсубколонки [keys](/sql-reference/data-types/map#reading-subcolumns-of-map).
- [mapValues](/sql-reference/functions/tuple-map-functions#mapvalues) для чтения подсубколонки [values](/sql-reference/data-types/map#reading-subcolumns-of-map).

Possible values:

- 0 — Оптимизация отключена.
- 1 — Оптимизация включена.

## optimize_group_by_constant_keys {#optimize_group_by_constant_keys}

Type: Bool

Default value: 1

Оптимизирует GROUP BY, когда все ключи в блоке постоянны.

## optimize_group_by_function_keys {#optimize_group_by_function_keys}

Type: Bool

Default value: 1

Устраняет функции других ключей в разделе GROUP BY.

## optimize_if_chain_to_multiif {#optimize_if_chain_to_multiif}

Type: Bool

Default value: 0

Заменяет цепочки if(cond1, then1, if(cond2, ...)) на multiIf. В настоящее время это не выгодно для числовых типов.

## optimize_if_transform_strings_to_enum {#optimize_if_transform_strings_to_enum}

Type: Bool

Default value: 0

Заменяет аргументы строкового типа в If и Transform на enum. Отключено по умолчанию, поскольку это может вызвать неконсистентные изменения в распределенном запросе, что приведет к его сбою.

## optimize_injective_functions_in_group_by {#optimize_injective_functions_in_group_by}

Type: Bool

Default value: 1

Заменяет инъективные функции их аргументами в разделе GROUP BY.

## optimize_injective_functions_inside_uniq {#optimize_injective_functions_inside_uniq}

Type: Bool

Default value: 1

Удаляет инъективные функции одного аргумента внутри функций uniq*().

## optimize_min_equality_disjunction_chain_length {#optimize_min_equality_disjunction_chain_length}

Type: UInt64

Default value: 3

Минимальная длина выражения `expr = x1 OR ... expr = xN` для оптимизации.

## optimize_min_inequality_conjunction_chain_length {#optimize_min_inequality_conjunction_chain_length}

Type: UInt64 

Default value: 3

Минимальная длина выражения `expr <> x1 AND ... expr <> xN` для оптимизации.

## optimize_move_to_prewhere {#optimize_move_to_prewhere}

Type: Bool

Default value: 1

Включает или отключает автоматическую оптимизацию [PREWHERE](../../sql-reference/statements/select/prewhere.md) в запросах [SELECT](../../sql-reference/statements/select/index.md).

Работает только для таблиц [*MergeTree](../../engines/table-engines/mergetree-family/index.md).

Possible values:

- 0 — Автоматическая оптимизация `PREWHERE` отключена.
- 1 — Автоматическая оптимизация `PREWHERE` включена.

## optimize_move_to_prewhere_if_final {#optimize_move_to_prewhere_if_final}

Type: Bool

Default value: 0

Включает или отключает автоматическую оптимизацию [PREWHERE](../../sql-reference/statements/select/prewhere.md) в запросах [SELECT](../../sql-reference/statements/select/index.md) с модификатором [FINAL](/sql-reference/statements/select/from#final-modifier).

Работает только для таблиц [*MergeTree](../../engines/table-engines/mergetree-family/index.md).

Possible values:

- 0 — Автоматическая оптимизация `PREWHERE` в `SELECT` запросах с модификатором `FINAL` отключена.
- 1 — Автоматическая оптимизация `PREWHERE` в `SELECT` запросах с модификатором `FINAL` включена.

**See Also**

- [optimize_move_to_prewhere](#optimize_move_to_prewhere) 

## optimize_multiif_to_if {#optimize_multiif_to_if}

Type: Bool

Default value: 1

Заменяет 'multiIf' с только одним условием на 'if'.

## optimize_normalize_count_variants {#optimize_normalize_count_variants}

Type: Bool

Default value: 1

Переписывает агрегатные функции, которые семантически равны count(), как count().

## optimize_on_insert {#optimize_on_insert}

Type: Bool

Default value: 1

Включает или отключает преобразование данных перед вставкой, так, как если бы слияние было выполнено в этом блоке (в соответствии с движком таблицы).

Possible values:

- 0 — Отключено.
- 1 — Включено.

**Example**

Разница между включенным и отключенным:

Запрос:

```sql
SET optimize_on_insert = 1;

CREATE TABLE test1 (`FirstTable` UInt32) ENGINE = ReplacingMergeTree ORDER BY FirstTable;

INSERT INTO test1 SELECT number % 2 FROM numbers(5);

SELECT * FROM test1;

SET optimize_on_insert = 0;

CREATE TABLE test2 (`SecondTable` UInt32) ENGINE = ReplacingMergeTree ORDER BY SecondTable;

INSERT INTO test2 SELECT number % 2 FROM numbers(5);

SELECT * FROM test2;
```

Результат:

```text
┌─FirstTable─┐
│          0 │
│          1 │
└────────────┘

┌─SecondTable─┐
│           0 │
│           0 │
│           0 │
│           1 │
│           1 │
└─────────────┘
```

Обратите внимание, что эта настройка влияет на поведение [материализованного представления](/sql-reference/statements/create/view#materialized-view).

## optimize_or_like_chain {#optimize_or_like_chain}

Type: Bool

Default value: 0

Оптимизируйте несколько OR LIKE в multiMatchAny. Эта оптимизация не должна быть включена по умолчанию, потому что в некоторых случаях она нарушает анализ индекса.

## optimize_read_in_order {#optimize_read_in_order}

Type: Bool

Default value: 1

Включает оптимизацию [ORDER BY](/sql-reference/statements/select/order-by#optimization-of-data-reading) в запросах [SELECT](../../sql-reference/statements/select/index.md) для чтения данных из таблиц [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md).

Possible values:

- 0 — Оптимизация `ORDER BY` отключена.
- 1 — Оптимизация `ORDER BY` включена.

**See Also**

- [ORDER BY Clause](/sql-reference/statements/select/order-by#optimization-of-data-reading)

## optimize_read_in_window_order {#optimize_read_in_window_order}

Type: Bool

Default value: 1

Включает оптимизацию ORDER BY в окне для чтения данных в соответствующем порядке в таблицах MergeTree.

## optimize_redundant_functions_in_order_by {#optimize_redundant_functions_in_order_by}

Type: Bool

Default value: 1

Удаляет функции из ORDER BY, если их аргумент также присутствует в ORDER BY.

## optimize_respect_aliases {#optimize_respect_aliases}

Type: Bool

Default value: 1

Если установлено в true, будет уважать псевдонимы в WHERE/GROUP BY/ORDER BY, что поможет с обрезкой разделов/вторичными индексами/оптимизацией агрегации/оптимизацией чтения.

## optimize_rewrite_aggregate_function_with_if {#optimize_rewrite_aggregate_function_with_if}

Type: Bool

Default value: 1

Переписывает агрегатные функции с выражением if в качестве аргумента, когда логически эквивалентны.
Например, `avg(if(cond, col, null))` может быть переписан как `avgOrNullIf(cond, col)`. Это может повысить производительность.

:::note
Поддерживается только с анализатором (`enable_analyzer = 1`).
:::

## optimize_rewrite_array_exists_to_has {#optimize_rewrite_array_exists_to_has}

Type: Bool

Default value: 0

Переписывает функции arrayExists() в has() когда логически эквивалентны. Например, arrayExists(x -> x = 1, arr) можно переписать в has(arr, 1).

## optimize_rewrite_sum_if_to_count_if {#optimize_rewrite_sum_if_to_count_if}

Type: Bool

Default value: 1

Переписывает функции sumIf() и sum(if()) в функции countIf(), когда логически эквивалентны.

## optimize_skip_merged_partitions {#optimize_skip_merged_partitions}

Type: Bool

Default value: 0

Включает или отключает оптимизацию для запроса [OPTIMIZE TABLE ... FINAL](../../sql-reference/statements/optimize.md), если есть только одна часть с уровнем > 0 и она не имеет превышенного TTL.

- `OPTIMIZE TABLE ... FINAL SETTINGS optimize_skip_merged_partitions=1`

По умолчанию, запрос `OPTIMIZE TABLE ... FINAL` переписывает одну часть, даже если есть только одна часть.

Possible values:

- 1 - Включить оптимизацию.
- 0 - Отключить оптимизацию.

## optimize_skip_unused_shards {#optimize_skip_unused_shards}

Type: Bool

Default value: 0

Включает или отключает пропуск неиспользуемых шардов для запросов [SELECT](../../sql-reference/statements/select/index.md), которые имеют условие шардирования в `WHERE/PREWHERE` (при условии, что данные распределены по ключу шардирования, в противном случае запрос дает некорректный результат).

Possible values:

- 0 — Отключено.
- 1 — Включено.

## optimize_skip_unused_shards_limit {#optimize_skip_unused_shards_limit}

Type: UInt64

Default value: 1000

Лимит для количества значений ключа шардирования, отключает `optimize_skip_unused_shards`, если лимит достигнут.

Слишком много значений может потребовать значительного объема ресурсов для обработки, в то время как выгода сомнительна, так как если у вас большое количество значений в `IN (...)`, вероятно, запрос все равно будет отправлен на все шардов.

## optimize_skip_unused_shards_nesting {#optimize_skip_unused_shards_nesting}

Type: UInt64

Default value: 0

Управляет [`optimize_skip_unused_shards`](#optimize_skip_unused_shards) (поэтому все еще требует [`optimize_skip_unused_shards`](#optimize_skip_unused_shards)) в зависимости от уровня вложенности распределенного запроса (в случае, если у вас есть `Distributed` таблица, которая обращается к другой `Distributed` таблице).

Possible values:

- 0 — Отключено, `optimize_skip_unused_shards` всегда работает.
- 1 — Включает `optimize_skip_unused_shards` только для первого уровня.
- 2 — Включает `optimize_skip_unused_shards` до второго уровня.

## optimize_skip_unused_shards_rewrite_in {#optimize_skip_unused_shards_rewrite_in}

Type: Bool

Default value: 1

Переписывает IN в запросе для удаленных шардов, чтобы исключить значения, которые не принадлежат шарду (требуется optimize_skip_unused_shards).

Possible values:

- 0 — Отключено.
- 1 — Включено.

## optimize_sorting_by_input_stream_properties {#optimize_sorting_by_input_stream_properties}

Type: Bool

Default value: 1

Оптимизируйте сортировку по свойствам входного потока.

## optimize_substitute_columns {#optimize_substitute_columns}

Type: Bool

Default value: 0

Используйте [ограничения](../../sql-reference/statements/create/table.md/#constraints) для замены столбцов. По умолчанию это `false`.

Possible values:

- true, false

## optimize_syntax_fuse_functions {#optimize_syntax_fuse_functions}

Type: Bool

Default value: 0

Включает возможность объединения агрегатных функций с идентичным аргументом. Он переписывает запрос, содержащий как минимум две агрегатные функции из [sum](/sql-reference/aggregate-functions/reference/sum), [count](/sql-reference/aggregate-functions/reference/count) или [avg](/sql-reference/aggregate-functions/reference/avg) с идентичным аргументом в [sumCount](/sql-reference/aggregate-functions/reference/sumcount).

Possible values:

- 0 — Функции с идентичным аргументом не объединяются.
- 1 — Функции с идентичным аргументом объединяются.

**Example**

Запрос:

```sql
CREATE TABLE fuse_tbl(a Int8, b Int8) Engine = Log;
SET optimize_syntax_fuse_functions = 1;
EXPLAIN SYNTAX SELECT sum(a), sum(b), count(b), avg(b) from fuse_tbl FORMAT TSV;
```

Результат:

```text
SELECT
    sum(a),
    sumCount(b).1,
    sumCount(b).2,
    (sumCount(b).1) / (sumCount(b).2)
FROM fuse_tbl
```

## optimize_throw_if_noop {#optimize_throw_if_noop}

Type: Bool

Default value: 0

Включает или отключает выброс исключения, если запрос [OPTIMIZE](../../sql-reference/statements/optimize.md) не выполнил слияние.

По умолчанию, `OPTIMIZE` завершается успешно, даже если ничего не было сделано. Эта настройка позволяет вам различать эти ситуации и получать причину в сообщении об исключении.

Possible values:

- 1 — Выброс исключения включен.
- 0 — Выброс исключения отключен.

## optimize_time_filter_with_preimage {#optimize_time_filter_with_preimage}

Type: Bool

Default value: 1

Оптимизируйте предикаты Date и DateTime, преобразуя функции в эквивалентные сравнения без преобразований (например, `toYear(col) = 2023 -> col >= '2023-01-01' AND col <= '2023-12-31'`).

## optimize_trivial_approximate_count_query {#optimize_trivial_approximate_count_query}

Type: Bool

Default value: 0

Используйте приблизительное значение для тривиальной оптимизации подсчета для хранилищ, которые поддерживают такую оценку, например, EmbeddedRocksDB.

Possible values:

   - 0 — Оптимизация отключена.
   - 1 — Оптимизация включена.

## optimize_trivial_count_query {#optimize_trivial_count_query}

Type: Bool

Default value: 1

Включает или отключает оптимизацию для тривиального запроса `SELECT count() FROM table`, используя метаданные из MergeTree. Если вы хотите использовать безопасность на уровне строк, отключите эту настройку.

Possible values:

   - 0 — Оптимизация отключена.
   - 1 — Оптимизация включена.

See also:

- [optimize_functions_to_subcolumns](#optimize_functions_to_subcolumns)

## optimize_trivial_insert_select {#optimize_trivial_insert_select}

Type: Bool

Default value: 0

Оптимизировать тривиальный запрос 'INSERT INTO table SELECT ... FROM TABLES'.

## optimize_uniq_to_count {#optimize_uniq_to_count}

Type: Bool

Default value: 1

Переписывает uniq и его варианты (за исключением uniqUpTo) в count, если подзапрос имеет раздел DISTINCT или GROUP BY.

## optimize_use_implicit_projections {#optimize_use_implicit_projections}

Type: Bool

Default value: 1

Автоматически выбрать неявные проекции для выполнения запроса SELECT.

## optimize_use_projections {#optimize_use_projections}

Type: Bool

Default value: 1

Включает или отключает оптимизацию [проекции](../../engines/table-engines/mergetree-family/mergetree.md/#projections) при обработке запросов `SELECT`.

Possible values:

- 0 — Оптимизация проекций отключена.
- 1 — Оптимизация проекций включена.

## optimize_using_constraints {#optimize_using_constraints}

Type: Bool

Default value: 0

Используйте [ограничения](../../sql-reference/statements/create/table.md/#constraints) для оптимизации запросов. По умолчанию это `false`.

Possible values:

- true, false

## os_thread_priority {#os_thread_priority}

Type: Int64

Default value: 0

Устанавливает приоритет ([nice](https://en.wikipedia.org/wiki/Nice_(Unix))) для потоков, выполняющих запросы. Планировщик ОС учитывает этот приоритет, выбирая следующий поток для выполнения на каждом доступном ядре CPU.

:::note
Для использования этой настройки необходимо установить права `CAP_SYS_NICE`. Пакет `clickhouse-server` настраивает это во время установки. Некоторые виртуальные окружения не позволяют устанавливать права `CAP_SYS_NICE`. В этом случае `clickhouse-server` выдает сообщение об ошибке при запуске.
:::

Possible values:

- Вы можете установить значения в диапазоне `[-20, 19]`.

Низкие значения означают высокий приоритет. Потоки с низкими значениями приоритета выполняются чаще, чем потоки с высокими значениями. Высокие значения предпочтительны для длительных неинтерактивных запросов, поскольку они позволяют им быстро отдать ресурсы коротким интерактивным запросам, когда они приходят.

## output_format_compression_level {#output_format_compression_level}

Type: UInt64

Default value: 3

Стандартный уровень сжатия, если выходные данные запроса сжимаются. Настройка применяется, когда запрос `SELECT` имеет `INTO OUTFILE` или при записи в табличные функции `file`, `url`, `hdfs`, `s3` или `azureBlobStorage`.

Possible values: от `1` до `22`.
```
```yaml
title: 'output_format_compression_zstd_window_log'
sidebar_label: 'output_format_compression_zstd_window_log'
keywords: ['output_format_compression_zstd_window_log', 'compression', 'zstd']
description: 'Настройка размера окна сжатия для zstd'
```

## output_format_compression_zstd_window_log {#output_format_compression_zstd_window_log}



Тип: UInt64

Значение по умолчанию: 0

Может использоваться, когда метод сжатия вывода — `zstd`. Если значение больше `0`, эта настройка явно задает размер окна сжатия (степень `2`) и включает режим длительного диапазона для сжатия zstd. Это может помочь достичь лучшего коэффициента сжатия.

Возможные значения: неотрицательные числа. Обратите внимание, что если значение слишком маленькое или слишком большое, `zstdlib` вызовет исключение. Типичные значения от `20` (размер окна = `1MB`) до `30` (размер окна = `1GB`).
## output_format_parallel_formatting {#output_format_parallel_formatting}



Тип: Bool

Значение по умолчанию: 1

Включает или отключает параллельное форматирование форматов данных. Поддерживается только для форматов [TSV](../../interfaces/formats.md/#tabseparated), [TSKV](../../interfaces/formats.md/#tskv), [CSV](../../interfaces/formats.md/#csv) и [JSONEachRow](../../interfaces/formats.md/#jsoneachrow).

Возможные значения:

- 1 — Включено.
- 0 — Отключено.
## page_cache_inject_eviction {#page_cache_inject_eviction}



Тип: Bool

Значение по умолчанию: 0

Кэш страниц в пользовательском пространстве иногда будет случайным образом недействителен. Предназначено для тестирования.
## parallel_distributed_insert_select {#parallel_distributed_insert_select}



Тип: UInt64

Значение по умолчанию: 0

Включает параллельный распределенный запрос `INSERT ... SELECT`.

Если мы выполняем запросы `INSERT INTO distributed_table_a SELECT ... FROM distributed_table_b`, и обе таблицы используют один и тот же кластер, и обе таблицы либо [реплицированы](../../engines/table-engines/mergetree-family/replication.md), либо не реплицированы, то этот запрос обрабатывается локально на каждой шарде.

Возможные значения:

- 0 — Отключено.
- 1 — `SELECT` будет выполнен на каждой шарде из базовой таблицы распределенного движка.
- 2 — `SELECT` и `INSERT` будут выполнены на каждой шарде из/в базовую таблицу распределенного движка.
## parallel_replica_offset {#parallel_replica_offset}
<BetaBadge/>


Тип: UInt64

Значение по умолчанию: 0

Это внутренняя настройка, которую не следует использовать напрямую и которая представляет собой детали реализации режима "параллельные реплики". Эта настройка будет автоматически настроена сервером-инициатором для распределенных запросов к индексу реплики, участвующей в обработке запроса среди параллельных реплик.
## parallel_replicas_allow_in_with_subquery {#parallel_replicas_allow_in_with_subquery}
<BetaBadge/>


Тип: Bool

Значение по умолчанию: 1

Если true, подзапрос для IN будет выполнен на каждой реплике-ведущем.
## parallel_replicas_count {#parallel_replicas_count}
<BetaBadge/>


Тип: UInt64

Значение по умолчанию: 0

Это внутренняя настройка, которую не следует использовать напрямую и которая представляет собой детали реализации режима "параллельные реплики". Эта настройка будет автоматически настроена сервером-инициатором для распределенных запросов к количеству параллельных реплик, участвующих в обработке запроса.
## parallel_replicas_custom_key {#parallel_replicas_custom_key}
<BetaBadge/>


Тип: String

Значение по умолчанию: 

Произвольное целочисленное выражение, которое может быть использовано для разделения работы между репликами для конкретной таблицы. Значение может быть любым целочисленным выражением.

Предпочтительны простые выражения с использованием первичных ключей.

Если настройка используется на кластере, состоящем из одной шарды с несколькими репликами, эти реплики будут преобразованы в виртуальные шарды.
В противном случае, она будет работать так же, как для ключа `SAMPLE`, используя несколько реплик каждой шардой.
## parallel_replicas_custom_key_range_lower {#parallel_replicas_custom_key_range_lower}
<BetaBadge/>


Тип: UInt64

Значение по умолчанию: 0

Позволяет типу фильтра `range` равномерно разделять работу между репликами на основе пользовательского диапазона `[parallel_replicas_custom_key_range_lower, INT_MAX]`.

Когда используется вместе с [parallel_replicas_custom_key_range_upper](#parallel_replicas_custom_key_range_upper), это позволяет фильтру равномерно разделить работу по репликам для диапазона `[parallel_replicas_custom_key_range_lower, parallel_replicas_custom_key_range_upper]`.

Примечание: Эта настройка не приведет к фильтрации каких-либо дополнительных данных во время обработки запроса, она просто изменяет точки, на которых фильтр диапазона разделяет диапазон `[0, INT_MAX]` для параллельной обработки.
## parallel_replicas_custom_key_range_upper {#parallel_replicas_custom_key_range_upper}
<BetaBadge/>


Тип: UInt64

Значение по умолчанию: 0

Позволяет типу фильтра `range` равномерно разделять работу между репликами на основе пользовательского диапазона `[0, parallel_replicas_custom_key_range_upper]`. Значение `0` отключает верхнюю границу, устанавливая ее на максимальное значение выражения пользовательского ключа.

Когда используется вместе с [parallel_replicas_custom_key_range_lower](#parallel_replicas_custom_key_range_lower), это позволяет фильтру равномерно разделить работу по репликам для диапазона `[parallel_replicas_custom_key_range_lower, parallel_replicas_custom_key_range_upper]`.

Примечание: Эта настройка не приведет к фильтрации каких-либо дополнительных данных во время обработки запроса, она просто изменяет точки, на которых фильтр диапазона разделяет диапазон `[0, INT_MAX]` для параллельной обработки.
## parallel_replicas_for_cluster_engines {#parallel_replicas_for_cluster_engines}



Тип: Bool

Значение по умолчанию: 1

Заменить движки табличных функций их -Cluster альтернативами.
## parallel_replicas_for_non_replicated_merge_tree {#parallel_replicas_for_non_replicated_merge_tree}
<BetaBadge/>


Тип: Bool

Значение по умолчанию: 0

Если true, ClickHouse будет использовать алгоритм параллельных реплик также для не реплицированных таблиц MergeTree.
## parallel_replicas_index_analysis_only_on_coordinator {#parallel_replicas_index_analysis_only_on_coordinator}
<BetaBadge/>


Тип: Bool

Значение по умолчанию: 1

Анализ индекса выполняется только на реплике-координаторе и пропускается на других репликах. Эффективно только при включенной настройке parallel_replicas_local_plan.
## parallel_replicas_local_plan {#parallel_replicas_local_plan}
<BetaBadge/>


Тип: Bool

Значение по умолчанию: 1

Создать локальный план для локальной реплики.
## parallel_replicas_mark_segment_size {#parallel_replicas_mark_segment_size}
<BetaBadge/>


Тип: UInt64

Значение по умолчанию: 0

Части виртуально разделены на сегменты, которые будут распределены между репликами для параллельного чтения. Эта настройка контролирует размер этих сегментов. Не рекомендуется изменять, пока вы абсолютно не уверены в своих действиях. Значение должно находиться в диапазоне [128; 16384].
## parallel_replicas_min_number_of_rows_per_replica {#parallel_replicas_min_number_of_rows_per_replica}
<BetaBadge/>


Тип: UInt64

Значение по умолчанию: 0

Ограничить количество реплик, используемых в запросе, до (предполагаемое количество строк для чтения / min_number_of_rows_per_replica). Максимум по-прежнему ограничен 'max_parallel_replicas'.
## parallel_replicas_mode {#parallel_replicas_mode}
<BetaBadge/>


Тип: ParallelReplicasMode

Значение по умолчанию: read_tasks

Тип фильтра, который следует использовать с пользовательским ключом для параллельных реплик. по умолчанию - использовать операцию по модулю над пользовательским ключом, диапазон - использовать фильтр диапазона на пользовательском ключе, используя все возможные значения для типа значения пользовательского ключа.
## parallel_replicas_only_with_analyzer {#parallel_replicas_only_with_analyzer}
<BetaBadge/>


Тип: Bool

Значение по умолчанию: 1

Анализатор должен быть включен для использования параллельных реплик. При отключенном анализаторе выполнение запроса откатывается к локальному выполнению, даже если чтение из реплик по параллели включено. Использование параллельных реплик без включенного анализатора не поддерживается.
## parallel_replicas_prefer_local_join {#parallel_replicas_prefer_local_join}
<BetaBadge/>


Тип: Bool

Значение по умолчанию: 1

Если true, и JOIN может быть выполнен с алгоритмом параллельных реплик, и все хранилища правой части JOIN являются *MergeTree, будет использован локальный JOIN вместо GLOBAL JOIN.
## parallel_view_processing {#parallel_view_processing}



Тип: Bool

Значение по умолчанию: 0

Включает одновременную обработку привязанных представлений вместо последовательной.
## parallelize_output_from_storages {#parallelize_output_from_storages}



Тип: Bool

Значение по умолчанию: 1

Параллелизовать вывод для шага чтения из хранилища. Это позволяет параллелизовать обработку запроса сразу после чтения из хранилища, если это возможно.
## parsedatetime_parse_without_leading_zeros {#parsedatetime_parse_without_leading_zeros}



Тип: Bool

Значение по умолчанию: 1

Форматтеры '%c', '%l' и '%k' в функции 'parseDateTime' парсят месяцы и часы без ведущих нулей.
## partial_merge_join_left_table_buffer_bytes {#partial_merge_join_left_table_buffer_bytes}



Тип: UInt64

Значение по умолчанию: 0

Если не 0, группирует блоки левой таблицы в более крупные для левой таблицы в алгоритме частичного объединения. Использует до 2x запрошенной памяти на поток соединения.
## partial_merge_join_rows_in_right_blocks {#partial_merge_join_rows_in_right_blocks}



Тип: UInt64

Значение по умолчанию: 65536

Ограничивает размеры блоков данных правой стороны в алгоритме частичного объединения для [JOIN](../../sql-reference/statements/select/join.md) запросов.

Сервер ClickHouse:

1.  Разделяет данные правой стороны объединения на блоки с количеством строк, не превышающим указанное количество.
2.  Индексирует каждый блок по его минимальным и максимальным значениям.
3.  Выгружает подготовленные блоки на диск, если это возможно.

Возможные значения:

- Любое положительное целое число. Рекомендуемый диапазон значений: \[1000, 100000\].
## partial_result_on_first_cancel {#partial_result_on_first_cancel}



Тип: Bool

Значение по умолчанию: 0

Позволяет запросу вернуть частичный результат после отмены.
## parts_to_delay_insert {#parts_to_delay_insert}



Тип: UInt64

Значение по умолчанию: 0

Если целевая таблица содержит хотя бы столько активных частей в одном разделе, искусственно замедлить вставку в таблицу.
## parts_to_throw_insert {#parts_to_throw_insert}



Тип: UInt64

Значение по умолчанию: 0

Если в одном разделе целевой таблицы активных частей больше этого числа, выбросить исключение 'Слишком много частей...'.
## periodic_live_view_refresh {#periodic_live_view_refresh}



Тип: Seconds

Значение по умолчанию: 60

Интервал, после которого периодически обновляемое live представление принудительно обновляется.
## poll_interval {#poll_interval}



Тип: UInt64

Значение по умолчанию: 10

Блокировать цикл ожидания запроса на сервере в течение указанного числа секунд.
## postgresql_connection_attempt_timeout {#postgresql_connection_attempt_timeout}



Тип: UInt64

Значение по умолчанию: 2

Таймаут подключения в секундах для одной попытки подключения к PostgreSQL.
Значение передается как параметр `connect_timeout` URL подключения.
## postgresql_connection_pool_auto_close_connection {#postgresql_connection_pool_auto_close_connection}



Тип: Bool

Значение по умолчанию: 0

Закрыть соединение перед возвратом соединения в пул.
## postgresql_connection_pool_retries {#postgresql_connection_pool_retries}



Тип: UInt64

Значение по умолчанию: 2

Количество попыток в пуле соединений для движка таблицы PostgreSQL и движка базы данных.
## postgresql_connection_pool_size {#postgresql_connection_pool_size}



Тип: UInt64

Значение по умолчанию: 16

Размер пула соединений для движка таблицы PostgreSQL и движка базы данных.
## postgresql_connection_pool_wait_timeout {#postgresql_connection_pool_wait_timeout}



Тип: UInt64

Значение по умолчанию: 5000

Таймаут ожидания в пуле соединений для движка таблицы PostgreSQL и движка базы данных. По умолчанию он будет блокировать при пустом пуле.
## postgresql_fault_injection_probability {#postgresql_fault_injection_probability}



Тип: Float

Значение по умолчанию: 0

Приблизительная вероятность сбоя внутренних (для репликации) запросов PostgreSQL. Допустимое значение находится в интервале [0.0f, 1.0f].
## prefer_column_name_to_alias {#prefer_column_name_to_alias}



Тип: Bool

Значение по умолчанию: 0

Включает или отключает использование оригинальных имен столбцов вместо псевдонимов в выражениях и условиях запроса. Это особенно важно, когда псевдоним совпадает с именем столбца, см. [Псевдонимы выражений](/sql-reference/syntax#notes-on-usage). Включите эту настройку, чтобы сделать правила синтаксиса псевдонимов в ClickHouse более совместимыми с большинством других движков баз данных.

Возможные значения:

- 0 — Имя столбца заменяется псевдонимом.
- 1 — Имя столбца не заменяется псевдонимом.

**Пример**

Разница между включенным и отключенным:

Запрос:

```sql
SET prefer_column_name_to_alias = 0;
SELECT avg(number) AS number, max(number) FROM numbers(10);
```

Результат:

```text
Получено исключение от сервера (версия 21.5.1):
Код: 184. DB::Exception: Получено с localhost:9000. DB::Exception: Агрегатная функция avg(number) найдена внутри другой агрегатной функции в запросе: В процессе обработки avg(number) AS number.
```

Запрос:

```sql
SET prefer_column_name_to_alias = 1;
SELECT avg(number) AS number, max(number) FROM numbers(10);
```

Результат:

```text
┌─number─┬─max(number)─┐
│    4.5 │           9 │
└────────┴─────────────┘
```
## prefer_external_sort_block_bytes {#prefer_external_sort_block_bytes}



Тип: UInt64

Значение по умолчанию: 16744704

Предпочтительный максимальный размер блока байт для внешнего сортировки, уменьшает использование памяти во время слияния.
## prefer_global_in_and_join {#prefer_global_in_and_join}



Тип: Bool

Значение по умолчанию: 0

Включает замену операторов `IN`/`JOIN` на `GLOBAL IN`/`GLOBAL JOIN`.

Возможные значения:

- 0 — Отключено. Операторы `IN`/`JOIN` не заменяются на `GLOBAL IN`/`GLOBAL JOIN`.
- 1 — Включено. Операторы `IN`/`JOIN` заменяются на `GLOBAL IN`/`GLOBAL JOIN`.

**Использование**

Хотя `SET distributed_product_mode=global` может изменить поведение запросов для распределенных таблиц, он не подходит для локальных таблиц или таблиц из внешних ресурсов. Здесь на помощь приходит настройка `prefer_global_in_and_join`.

Например, у нас есть узлы запросов, которые содержат локальные таблицы, которые не подходят для распределения. Нам нужно разнести их данные на лету во время распределенной обработки с помощью ключевого слова `GLOBAL` — `GLOBAL IN`/`GLOBAL JOIN`.

Еще одним примером использования `prefer_global_in_and_join` является доступ к таблицам, созданным внешними движками. Эта настройка помогает сократить количество вызовов к внешним источникам при объединении таких таблиц: только один вызов на запрос.

**Смотрите также:**

- [Распределенные подзапросы](/sql-reference/operators/in#distributed-subqueries) для получения дополнительной информации о том, как использовать `GLOBAL IN`/`GLOBAL JOIN`.
## prefer_localhost_replica {#prefer_localhost_replica}



Тип: Bool

Значение по умолчанию: 1

Включает/отключает предпочтительное использование локальной реплики при обработке распределенных запросов.

Возможные значения:

- 1 — ClickHouse всегда отправляет запрос на локальную реплику, если она существует.
- 0 — ClickHouse использует стратегию балансировки, указанную в настройке [load_balancing](#load_balancing).

:::note
Отключите эту настройку, если вы используете [max_parallel_replicas](#max_parallel_replicas) без [parallel_replicas_custom_key](#parallel_replicas_custom_key).
Если [parallel_replicas_custom_key](#parallel_replicas_custom_key) установлено, отключите эту настройку только если она используется на кластере с несколькими шардами, содержащими несколько реплик.
Если она используется на кластере с одной шарда и несколькими репликами, отключение этой настройки будет иметь негативные последствия.
:::
## prefer_warmed_unmerged_parts_seconds {#prefer_warmed_unmerged_parts_seconds}


<CloudAvailableBadge/>

Тип: Int64

Значение по умолчанию: 0

Эта настройка имеет эффект только в ClickHouse Cloud. Если объединенная часть меньше этого количества секунд и не предварительно прогрета (см. [cache_populated_by_fetch](merge-tree-settings.md/#cache_populated_by_fetch)), но все ее исходные части доступны и предварительно прогреты, запросы SELECT будут читать из этих частей. Только для Replicated-/SharedMergeTree. Обратите внимание, что эта настройка проверяет только то, что CacheWarmer обработал часть; если часть была загружена в кэш чем-то другим, она по-прежнему будет считаться холодной, пока CacheWarmer не дойдет до нее; если она была прогрета, а затем выгнана из кэша, она по-прежнему будет считаться теплой.
## preferred_block_size_bytes {#preferred_block_size_bytes}



Тип: UInt64

Значение по умолчанию: 1000000

Эта настройка регулирует размер блока данных для обработки запросов и представляет собой дополнительную тонкую настройку для более грубой настройки 'max_block_size'. Если столбцы большие и с 'max_block_size' строк размер блока, вероятно, будет больше указанного количества байт, то его размер будет уменьшен для лучшей локальности кэша CPU.
## preferred_max_column_in_block_size_bytes {#preferred_max_column_in_block_size_bytes}



Тип: UInt64

Значение по умолчанию: 0

Ограничение на максимальный размер столбца в блоке во время чтения. Помогает уменьшить количество промахов в кэше. Должно быть близко к размеру кэша L2.
## preferred_optimize_projection_name {#preferred_optimize_projection_name}



Тип: String

Значение по умолчанию: 

Если установлено в непустую строку, ClickHouse попытается применить указанную проекцию в запросе.


Возможные значения:

- строка: имя предпочитаемой проекции.
## prefetch_buffer_size {#prefetch_buffer_size}



Тип: UInt64

Значение по умолчанию: 1048576

Максимальный размер буфера предзаказа для чтения из файловой системы.
## print_pretty_type_names {#print_pretty_type_names}



Тип: Bool

Значение по умолчанию: 1

Разрешает красиво выводить глубоко вложенные имена типов с отступами в запросе `DESCRIBE` и в функции `toTypeName()`.

Пример:

```sql
CREATE TABLE test (a Tuple(b String, c Tuple(d Nullable(UInt64), e Array(UInt32), f Array(Tuple(g String, h Map(String, Array(Tuple(i String, j UInt64))))), k Date), l Nullable(String))) ENGINE=Memory;
DESCRIBE TABLE test FORMAT TSVRaw SETTINGS print_pretty_type_names=1;
```

```
a   Tuple(
    b String,
    c Tuple(
        d Nullable(UInt64),
        e Array(UInt32),
        f Array(Tuple(
            g String,
            h Map(
                String,
                Array(Tuple(
                    i String,
                    j UInt64
                ))
            )
        )),
        k Date
    ),
    l Nullable(String)
)
```
## priority {#priority}



Тип: UInt64

Значение по умолчанию: 0

Приоритет запроса. 1 - самый высокий, более высокое значение - более низкий приоритет; 0 - не использовать приоритеты.
## push_external_roles_in_interserver_queries {#push_external_roles_in_interserver_queries}



Тип: Bool

Значение по умолчанию: 1

Включает передачу ролей пользователей от инициатора к другим узлам во время выполнения запроса.
## query_cache_compress_entries {#query_cache_compress_entries}



Тип: Bool

Значение по умолчанию: 1

Сжимает записи в [кэше запросов](../query-cache.md). Уменьшает потребление памяти кэша запросов за счет более медленных вставок в него / чтения из него.

Возможные значения:

- 0 - Отключено
- 1 - Включено
## query_cache_max_entries {#query_cache_max_entries}



Тип: UInt64

Значение по умолчанию: 0

Максимальное количество результатов запросов, которые текущий пользователь может хранить в [кэше запросов](../query-cache.md). 0 означает неограниченное количество.

Возможные значения:

- Положительное целое число >= 0.
## query_cache_max_size_in_bytes {#query_cache_max_size_in_bytes}



Тип: UInt64

Значение по умолчанию: 0

Максимальное количество памяти (в байтах), которое текущий пользователь может выделить в [кэше запросов](../query-cache.md). 0 означает неограниченное количество.

Возможные значения:

- Положительное целое число >= 0.
## query_cache_min_query_duration {#query_cache_min_query_duration}



Тип: Milliseconds

Значение по умолчанию: 0

Минимальная продолжительность в миллисекундах, которую запрос должен выполняться, чтобы его результат был сохранен в [кэше запросов](../query-cache.md).

Возможные значения:

- Положительное целое число >= 0.
## query_cache_min_query_runs {#query_cache_min_query_runs}



Тип: UInt64

Значение по умолчанию: 0

Минимальное количество раз, которое запрос `SELECT` должен выполниться, прежде чем его результат будет сохранен в [кэше запросов](../query-cache.md).

Возможные значения:

- Положительное целое число >= 0.
## query_cache_nondeterministic_function_handling {#query_cache_nondeterministic_function_handling}



Тип: QueryResultCacheNondeterministicFunctionHandling

Значение по умолчанию: throw

Контролирует, как [кэш запросов](../query-cache.md) обрабатывает запросы `SELECT` с недетерминированными функциями, такими как `rand()` или `now()`.

Возможные значения:

- `'throw'` - Выбросить исключение и не кэшировать результат запроса.
- `'save'` - Закэшировать результат запроса.
- `'ignore'` - Не кэшировать результат запроса и не выбрасывать исключение.
## query_cache_share_between_users {#query_cache_share_between_users}



Тип: Bool

Значение по умолчанию: 0

Если включено, результаты кэшированных запросов `SELECT`, сохраненные в [кэше запросов](../query-cache.md), могут быть прочитаны другими пользователями.
Не рекомендуется включать эту настройку по причинам безопасности.

Возможные значения:

- 0 - Отключено
- 1 - Включено
## query_cache_squash_partial_results {#query_cache_squash_partial_results}



Тип: Bool

Значение по умолчанию: 1

Сжимает частичные блоки результатов до блоков размера [max_block_size](#max_block_size). Уменьшает производительность вставок в [кэш запросов](../query-cache.md), но улучшает сжимаемость записей кэша (см. [query_cache_compress-entries](#query_cache_compress_entries)).

Возможные значения:

- 0 - Отключено
- 1 - Включено
## query_cache_system_table_handling {#query_cache_system_table_handling}



Тип: QueryResultCacheSystemTableHandling

Значение по умолчанию: throw

Контролирует, как [кэш запросов](../query-cache.md) обрабатывает запросы `SELECT`, направленные на системные таблицы, т.е. таблицы в базах данных `system.*` и `information_schema.*`.

Возможные значения:

- `'throw'` - Выбросить исключение и не кэшировать результат запроса.
- `'save'` - Закэшировать результат запроса.
- `'ignore'` - Не кэшировать результат запроса и не выбрасывать исключение.
## query_cache_tag {#query_cache_tag}



Тип: String

Значение по умолчанию: 

Строка, которая служит меткой для записей [кэша запросов](../query-cache.md).
Одни и те же запросы с различными метками считаются разными кэшем.

Возможные значения:

- Любая строка.
## query_cache_ttl {#query_cache_ttl}



Тип: Seconds

Значение по умолчанию: 60

После этого времени в секундах записи в [кэше запросов](../query-cache.md) становятся устаревшими.

Возможные значения:

- Положительное целое число >= 0.
## query_metric_log_interval {#query_metric_log_interval}



Тип: Int64

Значение по умолчанию: -1

Интервал в миллисекундах, через который собирается [журнал метрик запросов](../../operations/system-tables/query_metric_log.md) для отдельных запросов.

Если установлено любое отрицательное значение, будет взято значение `collect_interval_milliseconds` из настройки [query_metric_log](/operations/server-configuration-parameters/settings#query_metric_log) или по умолчанию 1000, если оно отсутствует.

Чтобы отключить сбор одного запроса, установите `query_metric_log_interval` в 0.

Значение по умолчанию: -1
## query_plan_aggregation_in_order {#query_plan_aggregation_in_order}



Тип: Bool

Значение по умолчанию: 1

Переключает оптимизацию уровня плана запроса по агрегации в порядке.
Эта настройка будет иметь эффект, только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка для экспертов, которую следует использовать только для отладки разработчиками. Эта настройка может измениться в будущем на несовместимые с обратной совместимостью способы или быть удалена.
:::

Возможные значения:

- 0 - Отключить
- 1 - Включить
## query_plan_convert_join_to_in {#query_plan_convert_join_to_in}



Тип: Bool

Значение по умолчанию: 0

Разрешить преобразование JOIN в подзапрос с IN, если выходные столбцы привязаны только к левой таблице.
## query_plan_convert_outer_join_to_inner_join {#query_plan_convert_outer_join_to_inner_join}



Тип: Bool

Значение по умолчанию: 1

Разрешить преобразование OUTER JOIN в INNER JOIN, если фильтр после JOIN всегда фильтрует значения по умолчанию.
## query_plan_enable_multithreading_after_window_functions {#query_plan_enable_multithreading_after_window_functions}



Тип: Bool

Значение по умолчанию: 1

Включить многопоточность после вычисления функций окна, чтобы позволить параллельную потоковую обработку.
## query_plan_enable_optimizations {#query_plan_enable_optimizations}



Тип: Bool

Значение по умолчанию: 1

Переключает оптимизацию запросов на уровне плана запроса.

:::note
Это настройка для экспертов, которую следует использовать только для отладки разработчиками. Эта настройка может измениться в будущем на несовместимые с обратной совместимостью способы или быть удалена.
:::

Возможные значения:

- 0 - Отключить все оптимизации на уровне плана запроса.
- 1 - Включить оптимизации на уровне плана запроса (но отдельные оптимизации все еще могут быть отключены через их индивидуальные настройки).
## query_plan_execute_functions_after_sorting {#query_plan_execute_functions_after_sorting}



Тип: Bool

Значение по умолчанию: 1

Переключает оптимизацию на уровне плана запроса, которая перемещает выражения после этапов сортировки.
Эта настройка будет иметь эффект, только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка для экспертов, которую следует использовать только для отладки разработчиками. Эта настройка может измениться в будущем на несовместимые с обратной совместимостью способы или быть удалена.
:::

Возможные значения:

- 0 - Отключить
- 1 - Включить
## query_plan_filter_push_down {#query_plan_filter_push_down}



Тип: Bool

Значение по умолчанию: 1

Переключает оптимизацию на уровне плана запроса, которая перемещает фильтры вниз в плане выполнения.
Эта настройка будет иметь эффект, только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка для экспертов, которую следует использовать только для отладки разработчиками. Эта настройка может измениться в будущем на несовместимые с обратной совместимостью способы или быть удалена.
:::

Возможные значения:

- 0 - Отключить
- 1 - Включить
## query_plan_join_shard_by_pk_ranges {#query_plan_join_shard_by_pk_ranges}



Тип: Bool

Значение по умолчанию: 0

Применить шардирование для JOIN, если ключи объединения содержат префикс ПЕРВИЧНОГО КЛЮЧА для обеих таблиц. Поддерживается алгоритмами hash, parallel_hash и full_sorting_merge.
## query_plan_join_swap_table {#query_plan_join_swap_table}



Тип: BoolAuto

Значение по умолчанию: auto

    Определите, какая сторона соединения должна быть таблицей построением (также называемой внутренней, той, которая вставляется в хеш-таблицу для хеш-объединения) в плане запроса. Эта настройка поддерживается только для строгих соединений `ALL` с условием `JOIN ON`. Возможные значения:
    - 'auto': Позвольте планировщику решить, какую таблицу использовать в качестве таблицы построением.
    - 'false': Никогда не менять местами таблицы (правая таблица — это таблица построением).
    - 'true': Всегда менять местами таблицы (левая таблица — это таблица построением).
## query_plan_lift_up_array_join {#query_plan_lift_up_array_join}



Тип: Bool

Значение по умолчанию: 1

Переключает оптимизацию на уровне плана запроса, которая перемещает ARRAY JOINs вверх в плане выполнения.
Эта настройка будет иметь эффект, только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка для экспертов, которую следует использовать только для отладки разработчиками. Эта настройка может измениться в будущем на несовместимые с обратной совместимостью способы или быть удалена.
:::

Возможные значения:

- 0 - Отключить
- 1 - Включить
## query_plan_lift_up_union {#query_plan_lift_up_union}



Тип: Bool

Значение по умолчанию: 1

Переключает оптимизацию на уровне плана запроса, которая перемещает более крупные поддеревья плана запроса в объединение для включения дальнейших оптимизаций.
Эта настройка будет иметь эффект, только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка для экспертов, которую следует использовать только для отладки разработчиками. Эта настройка может измениться в будущем на несовместимые с обратной совместимостью способы или быть удалена.
:::

Возможные значения:

- 0 - Отключить
- 1 - Включить
## query_plan_max_limit_for_lazy_materialization {#query_plan_max_limit_for_lazy_materialization}



Тип: UInt64

Значение по умолчанию: 10

Контролирует максимальное значение лимита, которое позволяет использовать план запроса для оптимизации ленивой материализации. Если ноль, нет лимита.
## query_plan_max_optimizations_to_apply {#query_plan_max_optimizations_to_apply}



Тип: UInt64

Значение по умолчанию: 10000

Ограничивает общее количество оптимизаций, применяемых к плану запроса, см. настройку [query_plan_enable_optimizations](#query_plan_enable_optimizations).
Полезно для избежания долгого времени оптимизации для сложных запросов.
В запросе EXPLAIN PLAN остановите применение оптимизаций после достижения этого лимита и верните план как есть.
Для обычного выполнения запроса, если фактическое количество оптимизаций превышает эту настройку, выбрасывается исключение.

:::note
Это настройка для экспертов, которую следует использовать только для отладки разработчиками. Эта настройка может измениться в будущем на несовместимые с обратной совместимостью способы или быть удалена.
:::
## query_plan_merge_expressions {#query_plan_merge_expressions}



Тип: Bool

Значение по умолчанию: 1

Переключает оптимизацию на уровне плана запроса, которая объединяет последовательные фильтры.
Эта настройка будет иметь эффект, только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка для экспертов, которую следует использовать только для отладки разработчиками. Эта настройка может измениться в будущем на несовместимые с обратной совместимостью способы или быть удалена.
:::

Возможные значения:

- 0 - Отключить
- 1 - Включить
## query_plan_merge_filters {#query_plan_merge_filters}



Тип: Bool

Значение по умолчанию: 1

Разрешить объединение фильтров в плане запроса.
## query_plan_optimize_lazy_materialization {#query_plan_optimize_lazy_materialization}



Тип: Bool

Значение по умолчанию: 1

Использовать план запроса для оптимизации ленивой материализации.
## query_plan_optimize_prewhere {#query_plan_optimize_prewhere}



Тип: Bool

Значение по умолчанию: 1

Разрешить перемещение фильтра вниз в выражение PREWHERE для поддерживаемых хранилищ.
## query_plan_push_down_limit {#query_plan_push_down_limit}



Тип: Bool

Значение по умолчанию: 1

Переключает оптимизацию на уровне плана запроса, которая перемещает LIMITs вниз в плане выполнения.
Эта настройка будет иметь эффект, только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка для экспертов, которую следует использовать только для отладки разработчиками. Эта настройка может измениться в будущем на несовместимые с обратной совместимостью способы или быть удалена.
:::

Возможные значения:

- 0 - Отключить
- 1 - Включить
## query_plan_read_in_order {#query_plan_read_in_order}



Тип: Bool

Значение по умолчанию: 1

Переключает оптимизацию чтения в порядке на уровне плана запроса.
Эта настройка будет иметь эффект, только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка для экспертов, которую следует использовать только для отладки разработчиками. Эта настройка может измениться в будущем на несовместимые с обратной совместимостью способы или быть удалена.
:::

Возможные значения:

- 0 - Отключить
- 1 - Включить
```

## query_plan_remove_redundant_distinct {#query_plan_remove_redundant_distinct}

Тип: Bool

Значение по умолчанию: 1

Включает оптимизацию на уровне плана запроса, которая удаляет избыточные DISTINCT шаги. 
Срабатывает только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка уровня эксперта, которая должна использоваться только для отладки разработчиками. Настройка может измениться в будущем несовместимым образом или быть удалена.
:::

Возможные значения:

- 0 - Отключить
- 1 - Включить

## query_plan_remove_redundant_sorting {#query_plan_remove_redundant_sorting}

Тип: Bool

Значение по умолчанию: 1

Включает оптимизацию на уровне плана запроса, которая удаляет избыточные шаги сортировки, например, в подзапросах. 
Срабатывает только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка уровня эксперта, которая должна использоваться только для отладки разработчиками. Настройка может измениться в будущем несовместимым образом или быть удалена.
:::

Возможные значения:

- 0 - Отключить
- 1 - Включить

## query_plan_reuse_storage_ordering_for_window_functions {#query_plan_reuse_storage_ordering_for_window_functions}

Тип: Bool

Значение по умолчанию: 1

Включает оптимизацию на уровне плана запроса, которая использует сортировку хранилища при сортировке для оконных функций. 
Срабатывает только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка уровня эксперта, которая должна использоваться только для отладки разработчиками. Настройка может измениться в будущем несовместимым образом или быть удалена.
:::

Возможные значения:

- 0 - Отключить
- 1 - Включить

## query_plan_split_filter {#query_plan_split_filter}

Тип: Bool

Значение по умолчанию: 1

:::note
Это настройка уровня эксперта, которая должна использоваться только для отладки разработчиками. Настройка может измениться в будущем несовместимым образом или быть удалена.
:::

Включает оптимизацию на уровне плана запроса, которая разбивает фильтры на выражения. 
Срабатывает только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

Возможные значения:

- 0 - Отключить
- 1 - Включить

## query_plan_try_use_vector_search {#query_plan_try_use_vector_search}

Тип: Bool

Значение по умолчанию: 1

Включает оптимизацию на уровне плана запроса, которая пытается использовать индекс векторной схожести. 
Срабатывает только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка уровня эксперта, которая должна использоваться только для отладки разработчиками. Настройка может измениться в будущем несовместимым образом или быть удалена.
:::

Возможные значения:

- 0 - Отключить
- 1 - Включить

## query_plan_use_new_logical_join_step {#query_plan_use_new_logical_join_step}

Тип: Bool

Значение по умолчанию: 1

Использовать новый логический шаг соединения в плане запроса

## query_profiler_cpu_time_period_ns {#query_profiler_cpu_time_period_ns}

Тип: UInt64

Значение по умолчанию: 1000000000

Устанавливает период для таймера часов процессора [профилировщика запросов](../../operations/optimizing-performance/sampling-query-profiler.md). Этот таймер учитывает только время процессора.

Возможные значения:

- Положительное целое число в наносекундах.

    Рекомендуемые значения:

            - 10000000 (100 раз в секунду) наносекунд и более для одиночных запросов.
            - 1000000000 (один раз в секунду) для профилирования на уровне кластера.

- 0 для отключения таймера.

**Временно отключено в ClickHouse Cloud.**

Смотрите также:

- Системная таблица [trace_log](/operations/system-tables/trace_log)

## query_profiler_real_time_period_ns {#query_profiler_real_time_period_ns}

Тип: UInt64

Значение по умолчанию: 1000000000

Устанавливает период для реального таймера часов [профилировщика запросов](../../operations/optimizing-performance/sampling-query-profiler.md). Реальный таймер считает время по часам.

Возможные значения:

- Положительное целое число, в наносекундах.

    Рекомендуемые значения:

            - 10000000 (100 раз в секунду) наносекунд и менее для одиночных запросов.
            - 1000000000 (один раз в секунду) для профилирования на уровне кластера.

- 0 для отключения таймера.

**Временно отключено в ClickHouse Cloud.**

Смотрите также:

- Системная таблица [trace_log](/operations/system-tables/trace_log)

## queue_max_wait_ms {#queue_max_wait_ms}

Тип: Миллисекунды

Значение по умолчанию: 0

Время ожидания в очереди запросов, если количество одновременных запросов превышает максимальное.

## rabbitmq_max_wait_ms {#rabbitmq_max_wait_ms}

Тип: Миллисекунды

Значение по умолчанию: 5000

Время ожидания для чтения из RabbitMQ перед повторной попыткой.

## read_backoff_max_throughput {#read_backoff_max_throughput}

Тип: UInt64

Значение по умолчанию: 1048576

Настройки для уменьшения числа потоков в случае медленного чтения. Считывает события, когда пропускная способность чтения меньше указанного числа байт в секунду.

## read_backoff_min_concurrency {#read_backoff_min_concurrency}

Тип: UInt64

Значение по умолчанию: 1

Настройки для попытки поддерживать минимальное количество потоков в случае медленного чтения.

## read_backoff_min_events {#read_backoff_min_events}

Тип: UInt64

Значение по умолчанию: 2

Настройки для уменьшения числа потоков в случае медленного чтения. Количество событий, после которого количество потоков будет уменьшено.

## read_backoff_min_interval_between_events_ms {#read_backoff_min_interval_between_events_ms}

Тип: Миллисекунды

Значение по умолчанию: 1000

Настройки для уменьшения числа потоков в случае медленного чтения. Не обращайте внимания на событие, если предыдущее прошло менее указанного промежутка времени.

## read_backoff_min_latency_ms {#read_backoff_min_latency_ms}

Тип: Миллисекунды

Значение по умолчанию: 1000

Настройка для уменьшения числа потоков в случае медленного чтения. Обращайте внимание только на чтения, которые заняли как минимум это время.

## read_from_filesystem_cache_if_exists_otherwise_bypass_cache {#read_from_filesystem_cache_if_exists_otherwise_bypass_cache}

Тип: Bool

Значение по умолчанию: 0

Позволяет использовать кэш файловой системы в пассивном режиме - извлекать выгоду из существующих записей кэша, но не добавлять новые записи в кэш. Если вы установите эту настройку для тяжелых ad-hoc запросов и оставите ее отключенной для коротких запросов в реальном времени, это поможет избежать избыточного использования кэша слишком тяжелыми запросами и улучшит общую эффективность системы.

## read_from_page_cache_if_exists_otherwise_bypass_cache {#read_from_page_cache_if_exists_otherwise_bypass_cache}

Тип: Bool

Значение по умолчанию: 0

Используйте кэш страниц пользовательского пространства в пассивном режиме, аналогично read_from_filesystem_cache_if_exists_otherwise_bypass_cache.

## read_in_order_two_level_merge_threshold {#read_in_order_two_level_merge_threshold}

Тип: UInt64

Значение по умолчанию: 100

Минимальное количество частей для чтения, чтобы запустить предварительный шаг слияния во время многопоточного чтения в порядке первичного ключа.

## read_in_order_use_buffering {#read_in_order_use_buffering}

Тип: Bool

Значение по умолчанию: 1

Используйте буферизацию перед слиянием при чтении в порядке первичного ключа. Это увеличивает параллелизм выполнения запроса.

## read_in_order_use_virtual_row {#read_in_order_use_virtual_row}

Тип: Bool

Значение по умолчанию: 0

Используйте виртуальную строку при чтении в порядке первичного ключа или его монотонной функции. Это полезно при поиске по нескольким частям, так как затрагиваются только соответствующие.

## read_overflow_mode {#read_overflow_mode}

Тип: OverflowMode

Значение по умолчанию: throw

Что делать, когда лимит превышен.

## read_overflow_mode_leaf {#read_overflow_mode_leaf}

Тип: OverflowMode

Значение по умолчанию: throw

Что делать, когда превышен лимит листа.

## read_priority {#read_priority}

Тип: Int64

Значение по умолчанию: 0

Приоритет чтения данных из локальной файловой системы или удалённой файловой системы. Поддерживается только для метода 'pread_threadpool' для локальной файловой системы и для метода `threadpool` для удалённой файловой системы.

## read_through_distributed_cache {#read_through_distributed_cache}

<CloudAvailableBadge/>

Тип: Bool

Значение по умолчанию: 0

Действует только в ClickHouse Cloud. Разрешает чтение из распределённого кэша.

## readonly {#readonly}

Тип: UInt64

Значение по умолчанию: 0

0 - без ограничений на чтение. 1 - только запросы на чтение, а также изменение явно разрешённых настроек. 2 - только запросы на чтение, а также изменение настроек, кроме настройки 'readonly'.

## receive_data_timeout_ms {#receive_data_timeout_ms}

Тип: Миллисекунды

Значение по умолчанию: 2000

Тайм-аут соединения для получения первого пакета данных или пакета с положительным прогрессом от реплики.

## receive_timeout {#receive_timeout}

Тип: Секунды

Значение по умолчанию: 300

Тайм-аут для получения данных из сети, в секундах. Если в этот интервал не были получены байты, выбрасывается исключение. Если вы установите эту настройку на клиенте, 'send_timeout' для сокета также будет установлен на соответствующем конце соединения на сервере.

## regexp_max_matches_per_row {#regexp_max_matches_per_row}

Тип: UInt64

Значение по умолчанию: 1000

Устанавливает максимальное количество совпадений для одного регулярного выражения на строку. Используйте его для защиты от перегрузки памяти при использовании жадного регулярного выражения в функции [extractAllGroupsHorizontal](/sql-reference/functions/string-search-functions#extractallgroupshorizontal).

Возможные значения:

- Положительное целое число.

## reject_expensive_hyperscan_regexps {#reject_expensive_hyperscan_regexps}

Тип: Bool

Значение по умолчанию: 1

Отклонять шаблоны, которые с большой вероятностью будут дорогостоящими для оценки с помощью hyperscan (из-за взрыва состояний NFA).

## remerge_sort_lowered_memory_bytes_ratio {#remerge_sort_lowered_memory_bytes_ratio}

Тип: Float

Значение по умолчанию: 2

Если использование памяти после повторного слияния не уменьшится в соответствии с этим коэффициентом, повторное слияние будет отключено.

## remote_filesystem_read_method {#remote_filesystem_read_method}

Тип: String

Значение по умолчанию: threadpool

Метод чтения данных из удалённой файловой системы, один из: read, threadpool.

## remote_filesystem_read_prefetch {#remote_filesystem_read_prefetch}

Тип: Bool

Значение по умолчанию: 1

Следует ли использовать предварительную выборку при чтении данных из удалённой файловой системы.

## remote_fs_read_backoff_max_tries {#remote_fs_read_backoff_max_tries}

Тип: UInt64

Значение по умолчанию: 5

Максимальное количество попыток чтения с повторными попытками.

## remote_fs_read_max_backoff_ms {#remote_fs_read_max_backoff_ms}

Тип: UInt64

Значение по умолчанию: 10000

Максимальное время ожидания при попытке прочитать данные для удалённого диска.

## remote_read_min_bytes_for_seek {#remote_read_min_bytes_for_seek}

Тип: UInt64

Значение по умолчанию: 4194304

Минимальное количество байт, необходимых для удалённого чтения (url, s3), чтобы выполнить поиск, вместо чтения с игнорированием.

## rename_files_after_processing {#rename_files_after_processing}

Тип: String

Значение по умолчанию:

- **Тип:** String

- **Значение по умолчанию:** Пустая строка

Эта настройка позволяет указать шаблон переименования для файлов, обработанных функцией `file`. Когда опция установлена, все файлы, прочитанные функцией `file`, будут переименованы в соответствии с указанным шаблоном с заполнителями, только если обработка файлов была успешной.

### Заполнители

- `%a` — Полное оригинальное имя файла (например, "sample.csv").
- `%f` — Оригинальное имя файла без расширения (например, "sample").
- `%e` — Оригинальное расширение файла с точкой (например, ".csv").
- `%t` — Метка времени (в микросекундах).
- `%%` — Знак процента ("%").

### Пример

- Опция: `--rename_files_after_processing="processed_%f_%t%e"`

- Запрос: `SELECT * FROM file('sample.csv')`

Если чтение `sample.csv` будет успешным, файл будет переименован в `processed_sample_1683473210851438.csv`.

## replace_running_query {#replace_running_query}

Тип: Bool

Значение по умолчанию: 0

При использовании HTTP интерфейса параметр 'query_id' может быть передан. Это любая строка, которая служит идентификатором запроса. 
Если в это время существует уже выполняемый запрос того же пользователя с тем же 'query_id', поведение зависит от параметра 'replace_running_query'.

`0` (по умолчанию) – Выбрасывает исключение (не позволяет запросу выполняться, если запрос с тем же 'query_id' уже выполняется).

`1` – Отменяет старый запрос и начинает выполнять новый.

Установите этот параметр на 1 для реализации предложений по условиям сегментации. После ввода следующего символа, если старый запрос еще не завершен, он должен быть отменён.

## replace_running_query_max_wait_ms {#replace_running_query_max_wait_ms}

Тип: Миллисекунды

Значение по умолчанию: 5000

Время ожидания для завершения запроса с тем же `query_id`, когда активна настройка [replace_running_query](#replace_running_query).

Возможные значения:

- Положительное целое число.
- 0 — Выбрасывание исключения, не позволяющего запустить новый запрос, если сервер уже выполняет запрос с тем же `query_id`.

## replication_wait_for_inactive_replica_timeout {#replication_wait_for_inactive_replica_timeout}

Тип: Int64

Значение по умолчанию: 120

Указывает, как долго (в секундах) ждать, пока неактивные реплики выполнят запросы [ALTER](../../sql-reference/statements/alter/index.md), [OPTIMIZE](../../sql-reference/statements/optimize.md) или [TRUNCATE](../../sql-reference/statements/truncate.md).

Возможные значения:

- 0 — Не ждать.
- Отрицательное целое число — Ждать неограниченное время.
- Положительное целое число — Количество секунд ожидания.

## restore_replace_external_dictionary_source_to_null {#restore_replace_external_dictionary_source_to_null}

Тип: Bool

Значение по умолчанию: 0

Заменяет источники внешних словарей на Null при восстановлении. Полезно для целей тестирования.

## restore_replace_external_engines_to_null {#restore_replace_external_engines_to_null}

Тип: Bool

Значение по умолчанию: 0

Для целей тестирования. Заменяет все внешние движки на Null, чтобы не инициировать внешние соединения.

## restore_replace_external_table_functions_to_null {#restore_replace_external_table_functions_to_null}

Тип: Bool

Значение по умолчанию: 0

Для целей тестирования. Заменяет все внешние табличные функции на Null, чтобы не инициировать внешние соединения.

## restore_replicated_merge_tree_to_shared_merge_tree {#restore_replicated_merge_tree_to_shared_merge_tree}

Тип: Bool

Значение по умолчанию: 0

Заменяет движок таблицы с Replicated*MergeTree на Shared*MergeTree во время ВОССТАНОВЛЕНИЯ.

## result_overflow_mode {#result_overflow_mode}

Тип: OverflowMode

Значение по умолчанию: throw

Что делать, когда лимит превышен.

## rewrite_count_distinct_if_with_count_distinct_implementation {#rewrite_count_distinct_if_with_count_distinct_implementation}

Тип: Bool

Значение по умолчанию: 0

Позволяет переписывать `countDistinctIf` с настройкой [count_distinct_implementation](#count_distinct_implementation).

Возможные значения:

- true — Разрешить.
- false — Запретить.

## s3_allow_multipart_copy {#s3_allow_multipart_copy}

Тип: Bool

Значение по умолчанию: 1

Разрешить многопартовое копирование в S3.

## s3_allow_parallel_part_upload {#s3_allow_parallel_part_upload}

Тип: Bool

Значение по умолчанию: 1

Используйте несколько потоков для многопартовой загрузки в S3. Это может привести к немного большему использованию памяти.

## s3_check_objects_after_upload {#s3_check_objects_after_upload}

Тип: Bool

Значение по умолчанию: 0

Проверьте каждый загруженный объект в S3 с помощью head-запроса, чтобы убедиться, что загрузка была успешной.

## s3_connect_timeout_ms {#s3_connect_timeout_ms}

Тип: UInt64

Значение по умолчанию: 1000

Тайм-аут соединения для хоста из дисков S3.

## s3_create_new_file_on_insert {#s3_create_new_file_on_insert}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает создание нового файла при каждом вставке в таблицы движка S3. Если включено, при каждой вставке будет создан новый объект S3 с ключом, похожим на следующую схему:

начальный: `data.Parquet.gz` -> `data.1.Parquet.gz` -> `data.2.Parquet.gz`, и так далее.

Возможные значения:
- 0 — запрос `INSERT` создает новый файл или завершится с ошибкой, если файл существует и s3_truncate_on_insert не установлен.
- 1 — запрос `INSERT` создает новый файл при каждой вставке, используя суффикс (со второго) в случае, если s3_truncate_on_insert не установлен.

Смотрите больше деталей [здесь](/integrations/s3#inserting-data).

## s3_disable_checksum {#s3_disable_checksum}

Тип: Bool

Значение по умолчанию: 0

Не вычислять контрольную сумму при отправке файла в S3. Это ускоряет записи, избегая излишних обработок файла. Это в основном безопасно, так как данные таблиц MergeTree всё равно проверяются ClickHouse, и когда S3 доступен через HTTPS, уровень TLS уже обеспечивает целостность при передаче по сети. Хотя дополнительные контрольные суммы на S3 обеспечивают защиту от вторжений.

## s3_ignore_file_doesnt_exist {#s3_ignore_file_doesnt_exist}

Тип: Bool

Значение по умолчанию: 0

Игнорировать отсутствие файла, если он не существует при чтении определенных ключей.

Возможные значения:
- 1 — `SELECT` возвращает пустой результат.
- 0 — `SELECT` выбрасывает исключение.

## s3_list_object_keys_size {#s3_list_object_keys_size}

Тип: UInt64

Значение по умолчанию: 1000

Максимальное количество файлов, которые могут быть возвращены в пакетном запросе ListObject.

## s3_max_connections {#s3_max_connections}

Тип: UInt64

Значение по умолчанию: 1024

Максимальное количество соединений на сервер.

## s3_max_get_burst {#s3_max_get_burst}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество запросов, которые могут быть выданы одновременно до достижения лимита запросов в секунду. По умолчанию (0) равно `s3_max_get_rps`.

## s3_max_get_rps {#s3_max_get_rps}

Тип: UInt64

Значение по умолчанию: 0

Лимит на скорость запросов S3 GET в секунду, прежде чем произойдёт ограничение. Ноль означает неограниченное.

## s3_max_inflight_parts_for_one_file {#s3_max_inflight_parts_for_one_file}

Тип: UInt64

Значение по умолчанию: 20

Максимальное количество одновременно загружаемых частей в запросе многопартовой загрузки. 0 означает неограниченное.

## s3_max_part_number {#s3_max_part_number}

Тип: UInt64

Значение по умолчанию: 10000

Максимальное число частей для загрузки в S3.

## s3_max_put_burst {#s3_max_put_burst}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество запросов, которые могут быть выданы одновременно до достижения лимита запросов в секунду. По умолчанию (0) равно `s3_max_put_rps`.

## s3_max_put_rps {#s3_max_put_rps}

Тип: UInt64

Значение по умолчанию: 0

Лимит на скорость запросов S3 PUT в секунду, прежде чем произойдёт ограничение. Ноль означает неограниченное.

## s3_max_redirects {#s3_max_redirects}

Тип: UInt64

Значение по умолчанию: 10

Максимальное количество разрешённых пересылок S3.

## s3_max_single_operation_copy_size {#s3_max_single_operation_copy_size}

Тип: UInt64

Значение по умолчанию: 33554432

Максимальный размер для однооперационной копии в S3. Эта настройка используется только если s3_allow_multipart_copy установлено в true.

## s3_max_single_part_upload_size {#s3_max_single_part_upload_size}

Тип: UInt64

Значение по умолчанию: 33554432

Максимальный размер объекта для загрузки с использованием одночастной загрузки в S3.

## s3_max_single_read_retries {#s3_max_single_read_retries}

Тип: UInt64

Значение по умолчанию: 4

Максимальное количество повторных попыток во время одного чтения из S3.

## s3_max_unexpected_write_error_retries {#s3_max_unexpected_write_error_retries}

Тип: UInt64

Значение по умолчанию: 4

Максимальное количество повторных попыток в случае неожиданных ошибок при записи в S3.

## s3_max_upload_part_size {#s3_max_upload_part_size}

Тип: UInt64

Значение по умолчанию: 5368709120

Максимальный размер части для загрузки во время многопартовой загрузки в S3.

## s3_min_upload_part_size {#s3_min_upload_part_size}

Тип: UInt64

Значение по умолчанию: 16777216

Минимальный размер части для загрузки во время многопартовой загрузки в S3.

## s3_request_timeout_ms {#s3_request_timeout_ms}

Тип: UInt64

Значение по умолчанию: 30000

Время бездействия для отправки и получения данных из / в S3. Ошибка, если одно обращение TCP для чтения или записи блокируется так долго.

## s3_retry_attempts {#s3_retry_attempts}

Тип: UInt64

Значение по умолчанию: 100

Настройка для Aws::Client::RetryStrategy, Aws::Client выполняет повторные попытки самостоятельно, 0 означает отсутствие повторных попыток.

## s3_skip_empty_files {#s3_skip_empty_files}

Тип: Bool

Значение по умолчанию: 1

Включает или отключает пропуск пустых файлов в таблицах движка [S3](../../engines/table-engines/integrations/s3.md).

Возможные значения:
- 0 — `SELECT` выбрасывает исключение, если пустой файл несовместим с запрашиваемым форматом.
- 1 — `SELECT` возвращает пустой результат для пустого файла.

## s3_strict_upload_part_size {#s3_strict_upload_part_size}

Тип: UInt64

Значение по умолчанию: 0

Точный размер части для загрузки во время многопартовой загрузки в S3 (некоторые реализации не поддерживают части с переменным размером).

## s3_throw_on_zero_files_match {#s3_throw_on_zero_files_match}

Тип: Bool

Значение по умолчанию: 0

Выбросить ошибку, когда запрос ListObjects не может сопоставить ни один файл.

## s3_truncate_on_insert {#s3_truncate_on_insert}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает обрезку перед вставками в таблицы движка S3. Если отключено, будет выброшено исключение при попытках вставки, если объект S3 уже существует.

Возможные значения:
- 0 — запрос `INSERT` создает новый файл или завершится с ошибкой, если файл существует и s3_create_new_file_on_insert не установлен.
- 1 — запрос `INSERT` заменяет существующее содержимое файла новыми данными.

Смотрите больше деталей [здесь](/integrations/s3#inserting-data).

## s3_upload_part_size_multiply_factor {#s3_upload_part_size_multiply_factor}

Тип: UInt64

Значение по умолчанию: 2

Умножьте s3_min_upload_part_size на этот множитель каждый раз, когда s3_multiply_parts_count_threshold частей были загружены из одного запроса в S3.

## s3_upload_part_size_multiply_parts_count_threshold {#s3_upload_part_size_multiply_parts_count_threshold}

Тип: UInt64

Значение по умолчанию: 500

Каждый раз, когда это количество частей было загружено в S3, s3_min_upload_part_size умножается на s3_upload_part_size_multiply_factor.

## s3_use_adaptive_timeouts {#s3_use_adaptive_timeouts}

Тип: Bool

Значение по умолчанию: 1

Когда установлено в `true`, для всех запросов S3 первые две попытки выполняются с низкими тайм-аутами на отправку и получение. 
Когда установлено в `false`, все попытки выполняются с одинаковыми тайм-аутами.

## s3_validate_request_settings {#s3_validate_request_settings}

Тип: Bool

Значение по умолчанию: 1

Включает валидацию настроек запросов S3.

Возможные значения:
- 1 — валидировать настройки.
- 0 — не валидировать настройки.

## s3queue_default_zookeeper_path {#s3queue_default_zookeeper_path}

Тип: String

Значение по умолчанию: /clickhouse/s3queue/

Префикс пути по умолчанию zookeeper для движка S3Queue.

## s3queue_enable_logging_to_s3queue_log {#s3queue_enable_logging_to_s3queue_log}

Тип: Bool

Значение по умолчанию: 0

Включает запись в system.s3queue_log. Значение может быть переопределено для каждой таблицы с помощью настроек таблицы.

## s3queue_migrate_old_metadata_to_buckets {#s3queue_migrate_old_metadata_to_buckets}

Тип: Bool

Значение по умолчанию: 0

Миграция старой структуры метаданных таблицы S3Queue на новую.

## schema_inference_cache_require_modification_time_for_url {#schema_inference_cache_require_modification_time_for_url}

Тип: Bool

Значение по умолчанию: 1

Используйте схему из кэша для URL с проверкой времени последнего изменения (для URL с заголовком Last-Modified).

## schema_inference_use_cache_for_azure {#schema_inference_use_cache_for_azure}

Тип: Bool

Значение по умолчанию: 1

Используйте кэш при выводе схемы с использованием функции табличного формата azure.

## schema_inference_use_cache_for_file {#schema_inference_use_cache_for_file}

Тип: Bool

Значение по умолчанию: 1

Используйте кэш при выводе схемы с использованием функции табличного формата file.

## schema_inference_use_cache_for_hdfs {#schema_inference_use_cache_for_hdfs}

Тип: Bool

Значение по умолчанию: 1

Используйте кэш при выводе схемы с использованием функции табличного формата hdfs.

## schema_inference_use_cache_for_s3 {#schema_inference_use_cache_for_s3}

Тип: Bool

Значение по умолчанию: 1

Используйте кэш при выводе схемы с использованием функции табличного формата s3.

## schema_inference_use_cache_for_url {#schema_inference_use_cache_for_url}

Тип: Bool

Значение по умолчанию: 1

Используйте кэш при выводе схемы с использованием функции табличного формата url.

## select_sequential_consistency {#select_sequential_consistency}

Тип: UInt64

Значение по умолчанию: 0

:::note
Эта настройка различается в поведении между SharedMergeTree и ReplicatedMergeTree, см. [Последовательность SharedMergeTree](/cloud/reference/shared-merge-tree#consistency) для получения дополнительной информации о поведении `select_sequential_consistency` в SharedMergeTree.
:::

Включает или отключает последовательную согласованность для запросов `SELECT`. Требует, чтобы `insert_quorum_parallel` был отключен (включен по умолчанию).

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

Использование

Когда последовательная согласованность включена, ClickHouse позволяет клиенту выполнять запрос `SELECT` только для тех реплик, которые содержат данные из всех предыдущих `INSERT` запросов, выполненных с использованием `insert_quorum`. Если клиент обращается к частичной реплике, ClickHouse сгенерирует исключение. Запрос `SELECT` не будет включать данные, которые ещё не были записаны в кворум реплик.

Когда `insert_quorum_parallel` включен (по умолчанию), то `select_sequential_consistency` не работает. Это связано с тем, что параллельные `INSERT` запросы могут записываться в разные наборы кворумов реплик, поэтому нет гарантии, что одна реплика получит все записи.

Смотрите также:

- [insert_quorum](#insert_quorum)
- [insert_quorum_timeout](#insert_quorum_timeout)
- [insert_quorum_parallel](#insert_quorum_parallel)

## send_logs_level {#send_logs_level}

Тип: LogsLevel

Значение по умолчанию: fatal

Отправить текстовые логи сервера с указанным минимальным уровнем клиенту. Допустимые значения: 'trace', 'debug', 'information', 'warning', 'error', 'fatal', 'none'.

## send_logs_source_regexp {#send_logs_source_regexp}

Тип: String

Значение по умолчанию:

Отправить текстовые логи сервера с указанным regexp для соответствия имени источника лога. Пустое значение означает все источники.

## send_progress_in_http_headers {#send_progress_in_http_headers}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает заголовки HTTP-ответов `X-ClickHouse-Progress` в ответах `clickhouse-server`.

Для получения дополнительной информации прочитайте [описание HTTP интерфейса](../../interfaces/http.md).

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

## send_timeout {#send_timeout}

Тип: Секунды

Значение по умолчанию: 300

Тайм-аут для отправки данных в сеть, в секундах. Если клиенту необходимо отправить данные, но он не может отправить никаких байтов в этом интервале, выбрасывается исключение. Если вы установите эту настройку на клиенте, 'receive_timeout' для сокета также будет установлен на соответствующем конце соединения на сервере.

## session_timezone {#session_timezone}
<BetaBadge/>

Тип: Часовой пояс

Значение по умолчанию:

Устанавливает неявный часовой пояс текущей сессии или запроса. 
Неявный часовой пояс применяется к значениям типа DateTime/DateTime64, у которых не указан явно часовой пояс. 
Эта настройка имеет приоритет над глобально настроенным (на уровне сервера) неявным часовым поясом. 
Значение '' (пустая строка) означает, что неявный часовой пояс текущей сессии или запроса равен [часовому поясу сервера](../server-configuration-parameters/settings.md/#timezone).

Вы можете использовать функции `timeZone()` и `serverTimeZone()`, чтобы получить часовой пояс сессии и часовой пояс сервера.

Возможные значения:

- Любое название часового пояса из `system.time_zones`, например `Europe/Berlin`, `UTC` или `Zulu`.

Примеры:

```sql
SELECT timeZone(), serverTimeZone() FORMAT CSV

"Europe/Berlin","Europe/Berlin"
```

```sql
SELECT timeZone(), serverTimeZone() SETTINGS session_timezone = 'Asia/Novosibirsk' FORMAT CSV

"Asia/Novosibirsk","Europe/Berlin"
```

Назначение часового пояса сессии 'America/Denver' для внутреннего DateTime без явно указанного часового пояса:

```sql
SELECT toDateTime64(toDateTime64('1999-12-12 23:23:23.123', 3), 3, 'Europe/Zurich') SETTINGS session_timezone = 'America/Denver' FORMAT TSV

1999-12-13 07:23:23.123
```

:::warning
Не все функции, которые разбирают DateTime/DateTime64, учитывают `session_timezone`. Это может привести к тонким ошибкам.
Смотрите следующий пример и объяснение.
:::

```sql
CREATE TABLE test_tz (`d` DateTime('UTC')) ENGINE = Memory AS SELECT toDateTime('2000-01-01 00:00:00', 'UTC');

SELECT *, timeZone() FROM test_tz WHERE d = toDateTime('2000-01-01 00:00:00') SETTINGS session_timezone = 'Asia/Novosibirsk'
0 rows in set.

SELECT *, timeZone() FROM test_tz WHERE d = '2000-01-01 00:00:00' SETTINGS session_timezone = 'Asia/Novosibirsk'
┌───────────────────d─┬─timeZone()───────┐
│ 2000-01-01 00:00:00 │ Asia/Novosibirsk │
└─────────────────────┴──────────────────┘
```

Это происходит из-за различных конвейеров разбора:

- `toDateTime()` без явного указанного часового пояса, использованного в первом запросе `SELECT`, учитывает настройку `session_timezone` и глобальный часовой пояс.
- Во втором запросе DateTime разбирается из строки и наследует тип и часовой пояс существующего столбца `d`. Таким образом, настройка `session_timezone` и глобальный часовой пояс не учитываются.

**Смотрите также**

- [timezone](../server-configuration-parameters/settings.md/#timezone)

## set_overflow_mode {#set_overflow_mode}

Тип: OverflowMode

Значение по умолчанию: throw

Что делать, когда лимит превышен.

## shared_merge_tree_sync_parts_on_partition_operations {#shared_merge_tree_sync_parts_on_partition_operations}

Тип: Bool

Значение по умолчанию: 1

Автоматически синхронизировать набор частей данных после операций MOVE|REPLACE|ATTACH с разделами в SMT таблицах. Только облачный.

## short_circuit_function_evaluation {#short_circuit_function_evaluation}

Тип: ShortCircuitFunctionEvaluation

Значение по умолчанию: enable

Позволяет вычислять функции [if](../../sql-reference/functions/conditional-functions.md/#if), [multiIf](../../sql-reference/functions/conditional-functions.md/#multiif), [and](/sql-reference/functions/logical-functions#and) и [or](/sql-reference/functions/logical-functions#or) по [короткой схеме](https://en.wikipedia.org/wiki/Short-circuit_evaluation). Это помогает оптимизировать выполнение сложных выражений в этих функциях и предотвращать возможные исключения (например, деление на ноль, когда это не ожидается).

Возможные значения:

- `enable` — Включает короткое вычисление функций для функций, которым это подходит (могут вызвать исключение или быть вычислительно тяжелыми).
- `force_enable` — Включает короткое вычисление функций для всех функций.
- `disable` — Отключает короткое вычисление функций.

## short_circuit_function_evaluation_for_nulls {#short_circuit_function_evaluation_for_nulls}

Тип: Bool

Значение по умолчанию: 1

Оптимизирует оценку функций, которые возвращают NULL, когда любой аргумент равен NULL. Когда процент значений NULL в аргументах функции превышает значение short_circuit_function_evaluation_for_nulls_threshold, система пропускает оценку функции по строкам. Вместо этого она немедленно возвращает NULL для всех строк, избегая ненужных вычислений.
```
```yaml
title: 'Краткая оценка функции для порога NULL'
sidebar_label: 'Краткая оценка функции для порога NULL'
keywords: ['короткая оценка', 'функции', 'NULL']
description: 'Параметры сервера для управления поведением функций при наличии значений NULL.'
```

## short_circuit_function_evaluation_for_nulls_threshold {#short_circuit_function_evaluation_for_nulls_threshold}

Type: Double

Default value: 1

Пороговое соотношение значений NULL для выполнения функций с аргументами Nullable только на строках с ненулевыми значениями во всех аргументах. Применяется, когда параметр short_circuit_function_evaluation_for_nulls включён. Когда соотношение строк с значениями NULL к общему числу строк превышает этот порог, строки с значениями NULL не будут оцениваться.

## show_table_uuid_in_table_create_query_if_not_nil {#show_table_uuid_in_table_create_query_if_not_nil}

Type: Bool

Default value: 0

Настраивает отображение запроса `SHOW TABLE`.

Возможные значения:

- 0 — Запрос будет отображен без UUID таблицы.
- 1 — Запрос будет отображен с UUID таблицы.

## single_join_prefer_left_table {#single_join_prefer_left_table}

Type: Bool

Default value: 1

Предпочитать левую таблицу в одиночном JOIN в случае неоднозначности идентификатора.

## skip_redundant_aliases_in_udf {#skip_redundant_aliases_in_udf}

Type: Bool

Default value: 0

Избыточные псевдонимы не используются (не подставляются) в пользовательских функциях для упрощения их использования.

Возможные значения:

- 1 — Псевдонимы пропускаются (подставляются) в UDF.
- 0 — Псевдонимы не пропускаются (не подставляются) в UDF.

**Пример**

Разница между включенным и выключенным:

Запрос:

```sql
SET skip_redundant_aliases_in_udf = 0;
CREATE FUNCTION IF NOT EXISTS test_03274 AS ( x ) -> ((x + 1 as y, y + 2));

EXPLAIN SYNTAX SELECT test_03274(4 + 2);
```

Результат:

```text
SELECT ((4 + 2) + 1 AS y, y + 2)
```

Запрос:

```sql
SET skip_redundant_aliases_in_udf = 1;
CREATE FUNCTION IF NOT EXISTS test_03274 AS ( x ) -> ((x + 1 as y, y + 2));

EXPLAIN SYNTAX SELECT test_03274(4 + 2);
```

Результат:

```text
SELECT ((4 + 2) + 1, ((4 + 2) + 1) + 2)
```

## skip_unavailable_shards {#skip_unavailable_shards}

Type: Bool

Default value: 0

Включает или отключает тихое пропускание недоступных шардов.

Шард считается недоступным, если все его реплики недоступны. Реплика недоступна в следующих случаях:

- ClickHouse не может подключиться к реплике по какой-либо причине.

    При подключении к реплике ClickHouse выполняет несколько попыток. Если все эти попытки не удаются, реплика считается недоступной.

- Реплика не может быть разрешена через DNS.

    Если имя хоста реплики не может быть разрешено через DNS, это может указывать на следующие ситуации:

    - У хоста реплики нет DNS записи. Это может происходить в системах с динамическим DNS, например, [Kubernetes](https://kubernetes.io), где узлы могут быть неразрешимыми во время простоя, и это не является ошибкой.

    - Ошибка конфигурации. Файл конфигурации ClickHouse содержит неправильное имя хоста.

Возможные значения:

- 1 — пропуск включён.

    Если шард недоступен, ClickHouse возвращает результат на основе частичных данных и не сообщает о проблемах с доступностью узлов.

- 0 — пропуск отключён.

    Если шард недоступен, ClickHouse вызывает исключение.

## sleep_after_receiving_query_ms {#sleep_after_receiving_query_ms}

Type: Milliseconds

Default value: 0

Время в миллисекундах, чтобы уснуть после получения запроса в TCPHandler.

## sleep_in_send_data_ms {#sleep_in_send_data_ms}

Type: Milliseconds

Default value: 0

Время в миллисекундах, чтобы уснуть при отправке данных в TCPHandler.

## sleep_in_send_tables_status_ms {#sleep_in_send_tables_status_ms}

Type: Milliseconds

Default value: 0

Время в миллисекундах, чтобы уснуть при отправке ответа о статусе таблиц в TCPHandler.

## sort_overflow_mode {#sort_overflow_mode}

Type: OverflowMode

Default value: throw

Что делать, когда лимит превышен.

## split_intersecting_parts_ranges_into_layers_final {#split_intersecting_parts_ranges_into_layers_final}

Type: Bool

Default value: 1

Разделять пересекающиеся диапазоны частей на слои во время финальной оптимизации.

## split_parts_ranges_into_intersecting_and_non_intersecting_final {#split_parts_ranges_into_intersecting_and_non_intersecting_final}

Type: Bool

Default value: 1

Разделять диапазоны частей на пересекающиеся и непересекающиеся во время финальной оптимизации.

## splitby_max_substrings_includes_remaining_string {#splitby_max_substrings_includes_remaining_string}

Type: Bool

Default value: 0

Управляет тем, будет ли функция [splitBy*()](../../sql-reference/functions/splitting-merging-functions.md) с аргументом `max_substrings` > 0 включать оставшуюся строку в последний элемент результирующего массива.

Возможные значения:

- `0` - Оставшаяся строка не будет включена в последний элемент результирующего массива.
- `1` - Оставшаяся строка будет включена в последний элемент результирующего массива. Это поведение функции Spark [`split()`](https://spark.apache.org/docs/3.1.2/api/python/reference/api/pyspark.sql.functions.split.html) и метода Python ['string.split()'](https://docs.python.org/3/library/stdtypes.html#str.split).

## stop_refreshable_materialized_views_on_startup {#stop_refreshable_materialized_views_on_startup}
<ExperimentalBadge/>

Type: Bool

Default value: 0

При запуске сервера предотвращает планирование обновляемых материализованных представлений, как если бы это было с SYSTEM STOP VIEWS. Вы можете вручную запустить их с помощью `SYSTEM START VIEWS` или `SYSTEM START VIEW <name>` позже. Также применяется к новым создаваемым представлениям. Не оказывает воздействия на не обновляемые материализованные представления.

## storage_file_read_method {#storage_file_read_method}

Type: LocalFSReadMethod

Default value: pread

Метод чтения данных из файла хранения, один из: `read`, `pread`, `mmap`. Метод mmap не применяется к clickhouse-server (он предназначен для clickhouse-local).

## storage_system_stack_trace_pipe_read_timeout_ms {#storage_system_stack_trace_pipe_read_timeout_ms}

Type: Milliseconds

Default value: 100

Максимальное время для чтения из трубы для получения информации от потоков при запросе таблицы `system.stack_trace`. Этот параметр используется в тестовых целях и не предназначен для изменения пользователями.

## stream_flush_interval_ms {#stream_flush_interval_ms}

Type: Milliseconds

Default value: 7500

Работает для таблиц со стримингом в случае таймаута или когда поток генерирует [max_insert_block_size](#max_insert_block_size) строк.

Значение по умолчанию — 7500.

Чем меньше значение, тем чаще данные сбрасываются в таблицу. Установка значения слишком низким приводит к плохой производительности.

## stream_like_engine_allow_direct_select {#stream_like_engine_allow_direct_select}

Type: Bool

Default value: 0

Разрешить непосредственный SELECT запрос для движков Kafka, RabbitMQ, FileLog, Redis Streams и NATS. Если есть прикреплённые материализованные представления, запрос SELECT не разрешен, даже если эта настройка включена.

## stream_like_engine_insert_queue {#stream_like_engine_insert_queue}

Type: String

Default value:

Когда движок, подобный потоку, читает из нескольких очередей, пользователю потребуется выбрать одну очередь для вставки при записи. Используется движками Redis Streams и NATS.

## stream_poll_timeout_ms {#stream_poll_timeout_ms}

Type: Milliseconds

Default value: 500

Таймаут для опроса данных из/в потоковые хранилища.

## system_events_show_zero_values {#system_events_show_zero_values}

Type: Bool

Default value: 0

Разрешает выбирать события с нулевыми значениями из [`system.events`](../../operations/system-tables/events.md).

Некоторые системы мониторинга требуют передачи всех значений метрик им для каждой контрольной точки, даже если значение метрики равно нулю.

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

**Примеры**

Запрос

```sql
SELECT * FROM system.events WHERE event='QueryMemoryLimitExceeded';
```

Результат

```text
Ok.
```

Запрос
```sql
SET system_events_show_zero_values = 1;
SELECT * FROM system.events WHERE event='QueryMemoryLimitExceeded';
```

Результат

```text
┌─event────────────────────┬─value─┬─description───────────────────────────────────────────┐
│ QueryMemoryLimitExceeded │     0 │ Количество случаев превышения предела памяти для запроса. │
└──────────────────────────┴───────┴───────────────────────────────────────────────────────┘
```

## table_function_remote_max_addresses {#table_function_remote_max_addresses}

Type: UInt64

Default value: 1000

Устанавливает максимальное количество адресов, генерируемых из шаблонов для функции [remote](../../sql-reference/table-functions/remote.md).

Возможные значения:

- Положительное целое число.

## tcp_keep_alive_timeout {#tcp_keep_alive_timeout}

Type: Seconds

Default value: 290

Время в секундах, в течение которого соединение должно оставаться неактивным, прежде чем TCP начнёт отправлять проверки на живучесть.

## temporary_data_in_cache_reserve_space_wait_lock_timeout_milliseconds {#temporary_data_in_cache_reserve_space_wait_lock_timeout_milliseconds}

Type: UInt64

Default value: 600000

Время ожидания для блокировки кеша для резервирования пространства для временных данных в файловом кеша.

## temporary_files_codec {#temporary_files_codec}

Type: String

Default value: LZ4

Устанавливает кодек сжатия для временных файлов, используемых в операциях сортировки и объединения на диске.

Возможные значения:

- LZ4 — Используется сжатие [LZ4](https://en.wikipedia.org/wiki/LZ4_(compression_algorithm)).
- NONE — Сжатие не применяется.

## throw_if_deduplication_in_dependent_materialized_views_enabled_with_async_insert {#throw_if_deduplication_in_dependent_materialized_views_enabled_with_async_insert}

Type: Bool

Default value: 1

Вызывать исключение на запрос INSERT, когда включена настройка `deduplicate_blocks_in_dependent_materialized_views` вместе с `async_insert`. Это гарантирует корректность, поскольку эти функции не могут работать вместе.

## throw_if_no_data_to_insert {#throw_if_no_data_to_insert}

Type: Bool

Default value: 1

Разрешает или запрещает пустые INSERT-запросы, включено по умолчанию (вызывает ошибку при пустом вставке). Применяется только к INSERT-запросам с использованием [`clickhouse-client`](/interfaces/cli) или с использованием [gRPC интерфейса](/interfaces/grpc).

## throw_on_error_from_cache_on_write_operations {#throw_on_error_from_cache_on_write_operations}

Type: Bool

Default value: 0

Игнорировать ошибку из кеша при кешировании на операциях записи (INSERT, слияния).

## throw_on_max_partitions_per_insert_block {#throw_on_max_partitions_per_insert_block}

Type: Bool

Default value: 1

Используется с max_partitions_per_insert_block. Если true (по умолчанию), исключение будет выброшено, когда будет достигнут max_partitions_per_insert_block. Если false, детали вставки, достигающей этого лимита, будут записываться в лог. Это может быть полезно, если вы пытаетесь понять влияние на пользователей при изменении max_partitions_per_insert_block.

## throw_on_unsupported_query_inside_transaction {#throw_on_unsupported_query_inside_transaction}
<ExperimentalBadge/>

Type: Bool

Default value: 1

Вызывать исключение, если неподдерживаемый запрос используется внутри транзакции.

## timeout_before_checking_execution_speed {#timeout_before_checking_execution_speed}

Type: Seconds

Default value: 10

Проверить, что скорость не слишком низка, после истечения указанного времени.

## timeout_overflow_mode {#timeout_overflow_mode}

Type: OverflowMode

Default value: throw

Что делать, когда лимит превышен.

## timeout_overflow_mode_leaf {#timeout_overflow_mode_leaf}

Type: OverflowMode

Default value: throw

Что делать, когда превышен лимит по листьями.

## totals_auto_threshold {#totals_auto_threshold}

Type: Float

Default value: 0.5

Порог для `totals_mode = 'auto'`.
См. раздел "Модификатор WITH TOTALS".

## totals_mode {#totals_mode}

Type: TotalsMode

Default value: after_having_exclusive

Как рассчитывать TOTALS, когда присутствует HAVING, а также когда max_rows_to_group_by и group_by_overflow_mode = 'any'.
См. раздел "Модификатор WITH TOTALS".

## trace_profile_events {#trace_profile_events}

Type: Bool

Default value: 0

Включает или отключает сбор трассировок для каждого обновления профильных событий вместе с именем профильного события и значением инкремента, отправляя их в [trace_log](/operations/system-tables/trace_log).

Возможные значения:

- 1 — Включена трассировка профильных событий.
- 0 — Отключена трассировка профильных событий.

## transfer_overflow_mode {#transfer_overflow_mode}

Type: OverflowMode

Default value: throw

Что делать, когда лимит превышен.

## transform_null_in {#transform_null_in}

Type: Bool

Default value: 0

Включает равенство значений [NULL](/sql-reference/syntax#null) для оператора [IN](../../sql-reference/operators/in.md).

По умолчанию значения `NULL` не могут быть сравнены, поскольку `NULL` означает неопределенное значение. Таким образом, сравнение `expr = NULL` всегда должно возвращать `false`. С этой настройкой `NULL = NULL` возвращает `true` для оператора IN.

Возможные значения:

- 0 — Сравнение значений `NULL` в операторе `IN` возвращает `false`.
- 1 — Сравнение значений `NULL` в операторе `IN` возвращает `true`.

**Пример**

Рассмотрим таблицу `null_in`:

```text
┌──idx─┬─────i─┐
│    1 │     1 │
│    2 │  NULL │
│    3 │     3 │
└──────┴───────┘
```

Запрос:

```sql
SELECT idx, i FROM null_in WHERE i IN (1, NULL) SETTINGS transform_null_in = 0;
```

Результат:

```text
┌──idx─┬────i─┐
│    1 │    1 │
└──────┴──────┘
```

Запрос:

```sql
SELECT idx, i FROM null_in WHERE i IN (1, NULL) SETTINGS transform_null_in = 1;
```

Результат:

```text
┌──idx─┬─────i─┐
│    1 │     1 │
│    2 │  NULL │
└──────┴───────┘
```

**Смотрите также**

- [Обработка NULL в операторах IN](/sql-reference/operators/in#null-processing)

## traverse_shadow_remote_data_paths {#traverse_shadow_remote_data_paths}

Type: Bool

Default value: 0

Перебирать замороженные данные (shadow directory) в дополнение к фактическим данным таблицы при запросе system.remote_data_paths.

## union_default_mode {#union_default_mode}

Type: SetOperationMode

Default value:

Устанавливает режим для объединения результатов запросов `SELECT`. Настройка используется только когда она совместно используется с [UNION](../../sql-reference/statements/select/union.md) без явного указания `UNION ALL` или `UNION DISTINCT`.

Возможные значения:

- `'DISTINCT'` — ClickHouse выводит строки в результате объединения запросов, удаляя дублирующиеся строки.
- `'ALL'` — ClickHouse выводит все строки в результате объединения запросов, включая дублирующиеся строки.
- `''` — ClickHouse генерирует исключение при использовании с `UNION`.

См. примеры в [UNION](../../sql-reference/statements/select/union.md).

## unknown_packet_in_send_data {#unknown_packet_in_send_data}

Type: UInt64

Default value: 0

Отправить неизвестный пакет вместо N-го пакета данных.

## use_async_executor_for_materialized_views {#use_async_executor_for_materialized_views}

Type: Bool

Default value: 0

Используйте асинхронное и потенциально многопоточное выполнение запроса для материализованных представлений, что может ускорить обработку представлений во время INSERT, но также потребляет больше памяти.

## use_cache_for_count_from_files {#use_cache_for_count_from_files}

Type: Bool

Default value: 1

Включает кэширование количества строк при подсчете из файлов в табличных функциях `file`/`s3`/`url`/`hdfs`/`azureBlobStorage`.

Включено по умолчанию.

## use_client_time_zone {#use_client_time_zone}

Type: Bool

Default value: 0

Используйте временную зону клиента для интерпретации значений DateTime строк, вместо принятия временной зоны сервера.

## use_compact_format_in_distributed_parts_names {#use_compact_format_in_distributed_parts_names}

Type: Bool

Default value: 1

Использует компактный формат для хранения блоков для фоновой вставки (`distributed_foreground_insert`) в таблицы с движком `Distributed`.

Возможные значения:

- 0 — Использует формат директории `user[:password]@host:port#default_database`.
- 1 — Использует формат директории `[shard{shard_index}[_replica{replica_index}]]`.

:::note
- При `use_compact_format_in_distributed_parts_names=0` изменения из определения кластера не будут применены для фоновой вставки.
- При `use_compact_format_in_distributed_parts_names=1` изменение порядка узлов в определении кластера изменит `shard_index`/`replica_index`, поэтому будьте осторожны.
:::

## use_concurrency_control {#use_concurrency_control}

Type: Bool

Default value: 1

Уважать контроль конкурентности сервера (см. глобальные параметры сервера `concurrent_threads_soft_limit_num` и `concurrent_threads_soft_limit_ratio_to_cores`). Если отключено, позволяет использовать большее количество потоков, даже если сервер перегружен (не рекомендуется для нормального использования и в основном необходимо для тестов).

## use_hedged_requests {#use_hedged_requests}

Type: Bool

Default value: 1

Включает логику хеджированных запросов для удалённых запросов. Это позволяет устанавливать много соединений с разными репликами для запроса. Новое соединение включается в случае, если существующее соединение с репликами не было установлено в течение `hedged_connection_timeout` или не было получено никаких данных в течение `receive_data_timeout`. Запрос использует первое соединение, которое отправляет непустой пакет (или пакет данных, если `allow_changing_replica_until_first_data_packet`); другие соединения отменяются. Запросы с `max_parallel_replicas > 1` поддерживаются.

Включено по умолчанию.

По умолчанию отключено в облаке.

## use_hive_partitioning {#use_hive_partitioning}

Type: Bool

Default value: 1

При включении, ClickHouse будет обнаруживать Hive-стиль партиционирования в пути (`/name=value/`) в таблицах вроде [File](/sql-reference/table-functions/file#hive-style-partitioning)/[S3](/sql-reference/table-functions/s3#hive-style-partitioning)/[URL](/sql-reference/table-functions/url#hive-style-partitioning)/[HDFS](/sql-reference/table-functions/hdfs#hive-style-partitioning)/[AzureBlobStorage](/sql-reference/table-functions/azureBlobStorage#hive-style-partitioning) и позволит использовать партиционные столбцы как виртуальные столбцы в запросе. Эти виртуальные столбцы будут иметь те же имена, что и в партиционированном пути, но будут начинаться с `_`.

## use_iceberg_partition_pruning {#use_iceberg_partition_pruning}

Type: Bool

Default value: 0

Использовать обрезку партиций Iceberg для таблиц Iceberg.

## use_index_for_in_with_subqueries {#use_index_for_in_with_subqueries}

Type: Bool

Default value: 1

Попробуйте использовать индекс, если на правой стороне оператора IN есть подзапрос или табличное выражение.

## use_index_for_in_with_subqueries_max_values {#use_index_for_in_with_subqueries_max_values}

Type: UInt64

Default value: 0

Максимальный размер набора на правой стороне оператора IN для использования индекс таблицы для фильтрации. Это позволяет избежать ухудшения производительности и большего использования памяти из-за подготовки дополнительных структур данных для больших запросов. Ноль означает отсутствие ограничения.

## use_json_alias_for_old_object_type {#use_json_alias_for_old_object_type}

Type: Bool

Default value: 0

Когда включено, будет использоваться псевдоним типа `JSON` для создания старого типа [Object('json')](../../sql-reference/data-types/json.md) вместо нового типа [JSON](../../sql-reference/data-types/newjson.md).

## use_page_cache_for_disks_without_file_cache {#use_page_cache_for_disks_without_file_cache}

Type: Bool

Default value: 0

Использовать кеш страниц в пользовательском пространстве для удалённых дисков, на которых не включен кеш файловой системы.

## use_page_cache_with_distributed_cache {#use_page_cache_with_distributed_cache}

Type: Bool

Default value: 0

Использовать кеш страниц в пользовательском пространстве при использовании распределенного кеша.

## use_query_cache {#use_query_cache}

Type: Bool

Default value: 0

Если включено, запросы `SELECT` могут использовать [кеш запросов](../query-cache.md). Параметры [enable_reads_from_query_cache](#enable_reads_from_query_cache) и [enable_writes_to_query_cache](#enable_writes_to_query_cache) более подробно управляют тем, как используется кеш.

Возможные значения:

- 0 - Отключено
- 1 - Включено

## use_query_condition_cache {#use_query_condition_cache}

Type: Bool

Default value: 0

Включить [кеш условий запроса](/operations/query-condition-cache). Кеш хранит диапазоны гранул в частях данных, которые не удовлетворяют условию в предложении `WHERE`, и повторно использует эту информацию в качестве эфемерного индекса для последующих запросов.

Возможные значения:

- 0 - Отключено
- 1 - Включено

## use_skip_indexes {#use_skip_indexes}

Type: Bool

Default value: 1

Использовать индексы пропуска данных во время выполнения запросов.

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

## use_skip_indexes_if_final {#use_skip_indexes_if_final}

Type: Bool

Default value: 0

Управляет тем, будут ли использоваться индексы пропуска при выполнении запроса с модификатором FINAL.

По умолчанию эта настройка отключена, поскольку индексы пропуска могут исключить строки (гранулы), содержащие последние данные, что может привести к неправильным результатам. При включении индексы пропуска применяются даже с модификатором FINAL, потенциально повышая производительность, но с риском пропустить недавние обновления.

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

## use_structure_from_insertion_table_in_table_functions {#use_structure_from_insertion_table_in_table_functions}

Type: UInt64

Default value: 2

Использовать структуру из таблицы вставки вместо вывода схемы. Возможные значения: 0 - отключено, 1 - включено, 2 - авто.

## use_uncompressed_cache {#use_uncompressed_cache}

Type: Bool

Default value: 0

Использовать кеш несжатых блоков. Принимает 0 или 1. По умолчанию 0 (отключено).
Использование несжатого кеша (только для таблиц в семействе MergeTree) может значительно уменьшить задержку и увеличить пропускную способность при работе с большим количеством коротких запросов. Включите эту настройку для пользователей, которые отправляют частые короткие запросы. Также обратите внимание на параметр конфигурации [uncompressed_cache_size](/operations/server-configuration-parameters/settings#uncompressed_cache_size) (устанавливается только в файле конфигурации) — размер несжатых кеш-блоков. По умолчанию это 8 GiB. Несжатый кеш заполняется по мере необходимости, а наименее используемые данные автоматически удаляются.

Для запросов, которые читают хотя бы некоторый объем данных (миллион строк или более), несжатый кеш автоматически отключается для экономии места для действительно небольших запросов. Это означает, что вы можете оставить настройку 'use_uncompressed_cache' всегда установленной на 1.

## use_variant_as_common_type {#use_variant_as_common_type}

Type: Bool

Default value: 0

Разрешает использовать тип `Variant` в качестве результирующего типа для [if](../../sql-reference/functions/conditional-functions.md/#if)/[multiIf](../../sql-reference/functions/conditional-functions.md/#multiif)/[array](../../sql-reference/functions/array-functions.md)/[map](../../sql-reference/functions/tuple-map-functions.md) функций, когда для типов аргументов нет общего типа.

Пример:

```sql
SET use_variant_as_common_type = 1;
SELECT toTypeName(if(number % 2, number, range(number))) as variant_type FROM numbers(1);
SELECT if(number % 2, number, range(number)) as variant FROM numbers(5);
```

```text
┌─variant_type───────────────────┐
│ Variant(Array(UInt64), UInt64) │
└────────────────────────────────┘
┌─variant───┐
│ []        │
│ 1         │
│ [0,1]     │
│ 3         │
│ [0,1,2,3] │
└───────────┘
```

```sql
SET use_variant_as_common_type = 1;
SELECT toTypeName(multiIf((number % 4) = 0, 42, (number % 4) = 1, [1, 2, 3], (number % 4) = 2, 'Hello, World!', NULL)) AS variant_type FROM numbers(1);
SELECT multiIf((number % 4) = 0, 42, (number % 4) = 1, [1, 2, 3], (number % 4) = 2, 'Hello, World!', NULL) AS variant FROM numbers(4);
```

```text
─variant_type─────────────────────────┐
│ Variant(Array(UInt8), String, UInt8) │
└──────────────────────────────────────┘

┌─variant───────┐
│ 42            │
│ [1,2,3]       │
│ Hello, World! │
│ ᴺᵁᴸᴸ          │
└───────────────┘
```

```sql
SET use_variant_as_common_type = 1;
SELECT toTypeName(array(range(number), number, 'str_' || toString(number))) as array_of_variants_type from numbers(1);
SELECT array(range(number), number, 'str_' || toString(number)) as array_of_variants FROM numbers(3);
```

```text
┌─array_of_variants_type────────────────────────┐
│ Array(Variant(Array(UInt64), String, UInt64)) │
└───────────────────────────────────────────────┘

┌─array_of_variants─┐
│ [[],0,'str_0']    │
│ [[0],1,'str_1']   │
│ [[0,1],2,'str_2'] │
└───────────────────┘
```

```sql
SET use_variant_as_common_type = 1;
SELECT toTypeName(map('a', range(number), 'b', number, 'c', 'str_' || toString(number))) as map_of_variants_type from numbers(1);
SELECT map('a', range(number), 'b', number, 'c', 'str_' || toString(number)) as map_of_variants FROM numbers(3);
```

```text
┌─map_of_variants_type────────────────────────────────┐
│ Map(String, Variant(Array(UInt64), String, UInt64)) │
└─────────────────────────────────────────────────────┘

┌─map_of_variants───────────────┐
│ {'a':[],'b':0,'c':'str_0'}    │
│ {'a':[0],'b':1,'c':'str_1'}   │
│ {'a':[0,1],'b':2,'c':'str_2'} │
└───────────────────────────────┘
```

## use_with_fill_by_sorting_prefix {#use_with_fill_by_sorting_prefix}

Type: Bool

Default value: 1

Столбцы, предшествующие столбцам WITH FILL в предложении ORDER BY, формируют префикс сортировки. Строки с различными значениями в префиксе сортировки заполняются независимо.

## validate_enum_literals_in_operators {#validate_enum_literals_in_operators}

Type: Bool

Default value: 0

Если включено, проверяет литералы перечислений в операторах, таких как `IN`, `NOT IN`, `==`, `!=` в соответствии с типом перечисления и вызывает исключение, если литерал не является допустимым значением перечисления.

## validate_mutation_query {#validate_mutation_query}

Type: Bool

Default value: 1

Проверяет запросы мутации перед их приемом. Мутации выполняются в фоновом режиме, и выполнение недопустимого запроса приведёт к застреванию мутаций, требуя ручного вмешательства.

Изменяйте эту настройку только в том случае, если вы сталкиваетесь с несовместимой ошибкой.

## validate_polygons {#validate_polygons}

Type: Bool

Default value: 1

Включает или отключает выброс исключения в функции [pointInPolygon](/sql-reference/functions/geo/coordinates#pointinpolygon), если многоугольник самопересекается или имеет самокасание.

Возможные значения:

- 0 — Выбрасывание исключения отключено. `pointInPolygon` принимает недопустимые многоугольники и возвращает, возможно, неправильные результаты для них.
- 1 — Выбрасывание исключения включено.

## wait_changes_become_visible_after_commit_mode {#wait_changes_become_visible_after_commit_mode}
<ExperimentalBadge/>

Type: TransactionsWaitCSNMode

Default value: wait_unknown

Ждать, пока подтверждённые изменения станут видимыми в последнем снимке.

## wait_for_async_insert {#wait_for_async_insert}

Type: Bool

Default value: 1

Если true, ждать обработки асинхронной вставки.

## wait_for_async_insert_timeout {#wait_for_async_insert_timeout}

Type: Seconds

Default value: 120

Таймаут на ожидание обработки асинхронной вставки.

## wait_for_window_view_fire_signal_timeout {#wait_for_window_view_fire_signal_timeout}
<ExperimentalBadge/>

Type: Seconds

Default value: 10

Таймаут на ожидание сигнала срабатывания оконного представления в процессе обработки временных событий.

## window_view_clean_interval {#window_view_clean_interval}
<ExperimentalBadge/>

Type: Seconds

Default value: 60

Интервал очистки оконного представления в секундах для освобождения устаревших данных.

## window_view_heartbeat_interval {#window_view_heartbeat_interval}
<ExperimentalBadge/>

Type: Seconds

Default value: 15

Интервал сердцебиения в секундах для указания на то, что запрос наблюдения активен.

## workload {#workload}

Type: String

Default value: default

Имя рабочей нагрузки, используемой для доступа к ресурсам.

## write_through_distributed_cache {#write_through_distributed_cache}

<CloudAvailableBadge/>

Type: Bool

Default value: 0

Влияет только на ClickHouse Cloud. Разрешает запись в распределенный кеш (запись в s3 также будет выполняться через распределенный кеш).

## zstd_window_log_max {#zstd_window_log_max}

Type: Int64

Default value: 0

Позволяет выбрать максимальный лог окна для ZSTD (не будет использоваться для семейства MergeTree).
