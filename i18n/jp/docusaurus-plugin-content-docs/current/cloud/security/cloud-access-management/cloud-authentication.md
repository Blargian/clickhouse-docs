---
sidebar_label: 'クラウド認証'
slug: /cloud/security/cloud-authentication
title: 'クラウド認証'
description: 'このガイドでは、認証を設定する際の良いプラクティスについて説明します。'
---

import ScalePlanFeatureBadge from '@theme/badges/ScalePlanFeatureBadge'
import EnterprisePlanFeatureBadge from '@theme/badges/EnterprisePlanFeatureBadge'


# クラウド認証

ClickHouse Cloudは、認証するためのいくつかの方法を提供しています。このガイドでは、認証を設定する際の良いプラクティスについて説明します。認証方法を選択する際には、常にセキュリティチームに確認してください。

## パスワード設定 {#password-settings}

現在、私たちのコンソールおよびサービス（データベース）の最小限のパスワード設定は、[NIST 800-63B](https://pages.nist.gov/800-63-3/sp800-63b.html#sec4) 認証者保証レベル1に準拠しています：
- 最小12文字
- 次の4つの項目のうち3つを含むこと：
   - 大文字のアルファベット1文字
   - 小文字のアルファベット1文字
   - 数字1桁
   - 特殊文字1文字

## メール + パスワード {#email--password}

ClickHouse Cloudでは、メールアドレスとパスワードを使用して認証できます。この方法を使用する際には、ClickHouseアカウントを保護するために強力なパスワードを使用することが最善です。記憶に残るパスワードを考案するための多くのオンラインリソースがあります。もしくは、ランダムパスワードジェネレーターを使用して、パスワードマネージャーにパスワードを保存することをお勧めします。

## GoogleまたはMicrosoftのソーシャル認証を使用したSSO {#sso-using-google-or-microsoft-social-authentication}

会社がGoogle WorkspaceまたはMicrosoft 365を使用している場合、ClickHouse Cloud内で現在のシングルサインオンセットアップを活用できます。これを行うには、会社のメールアドレスを使用してサインアップし、他のユーザーを会社のメールを使用して招待するだけです。その結果、ユーザーはClickHouse Cloudに認証する前に、アイデンティティプロバイダーやGoogle、Microsoft認証を通じて、会社のログインフローを使用してログインする必要があります。

## 多要素認証 {#multi-factor-authentication}

メール + パスワードまたはソーシャル認証のユーザーは、多要素認証（MFA）を使用してアカウントをさらに保護できます。MFAを設定するには：
1. console.clickhouse.cloud にログインします。
2. ClickHouseロゴの隣にある左上隅のイニシャルをクリックします。
3. プロフィールを選択します。
4. 左側のセキュリティを選択します。
5. 認証アプリタイルで、セットアップをクリックします。
6. Authy、1Password、Google Authenticatorなどの認証アプリを使用してQRコードをスキャンします。
7. コードを入力して確認します。
8. 次の画面で、回復コードをコピーして安全な場所に保管します。
9. `このコードを安全に記録した` というボックスにチェックを入れます。
10. 続行をクリックします。
    
## アカウント回復 {#account-recovery}

<details> 
   <summary>回復コードを取得</summary>

   以前にMFAに登録したが、回復コードを作成しなかったか、紛失した場合は、以下の手順に従って新しい回復コードを取得します：
   1. https://console.clickhouse.cloud にアクセスします。
   2. 資格情報とMFAでサインインします。
   3. 左上隅にあるプロフィールに移動します。
   4. 左側のセキュリティをクリックします。
   5. 認証アプリの横にあるゴミ箱をクリックします。
   6. 認証アプリを削除をクリックします。
   7. コードを入力し、続行をクリックします。
   8. 認証アプリセクションで、セットアップをクリックします。
   9. QRコードをスキャンし、新しいコードを入力します。
   10. 回復コードをコピーして安全な場所に保管します。
   11. `このコードを安全に記録した` というボックスにチェックを入れます。
   12. 続行をクリックします。
   
</details>
<details>
   <summary>パスワードを忘れた</summary>

   パスワードを忘れた場合は、セルフサービス回復の手順に従ってください：
   1. https://console.clickhouse.cloud にアクセスします。
   2. メールアドレスを入力し、続行をクリックします。
   3. パスワードをお忘れですか？をクリックします。
   4. パスワードリセットリンクを送信をクリックします。
   5. メールを確認し、メール内のパスワードのリセットをクリックします。
   6. 新しいパスワードを入力し、確認後、パスワードを更新をクリックします。
   7. サインインに戻るをクリックします。
   8. 新しいパスワードで通常通りサインインします。
            
</details>
<details>
   <summary>MFAデバイスまたはトークンを紛失</summary>

   MFAデバイスを紛失したり、トークンを削除した場合は、以下の手順に従って新しいトークンを回復および作成します：
   1. https://console.clickhouse.cloud にアクセスします。
   2. 資格情報を入力し、続行をクリックします。
   3. 多要素認証画面でキャンセルをクリックします。
   4. 回復コードをクリックします。
   5. コードを入力して続行を押します。
   6. 新しい回復コードをコピーして安全な場所に保管します。
   7. `このコードを安全に記録した` というボックスにチェックを入れ、続行をクリックします。
   8. サインインしたら、左上のプロフィールに移動します。
   9. 左上のセキュリティをクリックします。
   10. 認証アプリの隣にあるゴミ箱アイコンをクリックして古い認証アプリを削除します。
   11. 認証アプリを削除をクリックします。
   12. 多要素認証のプロンプトが表示されたら、キャンセルをクリックします。
   13. 回復コードをクリックします。
   14. 回復コードを入力し（これはステップ7で生成された新しいコードです）、続行をクリックします。
   15. 新しい回復コードをコピーして安全な場所に保管します - これは削除プロセス中に画面を離れた場合のフェイルセーフです。
   16. `このコードを安全に記録した` というボックスにチェックを入れ、続行をクリックします。
   17. 新しいMFA要素の設定のために上記のプロセスに従ってください。
       
</details>
<details>
   <summary>MFAと回復コードを紛失</summary>

   MFAデバイスと回復コードの両方を紛失した場合、またはMFAデバイスを紛失し、回復コードを取得したことがない場合は、以下の手順に従ってリセットをリクエストします：

   **チケットを提出**: 他の管理ユーザーがいる組織に所属している場合、たとえ単独ユーザー組織にアクセスしようとしている場合でも、管理者ロールに割り当てられた組織のメンバーに、組織にログインしてあなたの代理でMFAをリセットするサポートチケットを提出してもらってください。リクエストが認証されたことが確認でき次第、MFAをリセットし、管理者に通知します。通常通りMFAなしでサインインし、新しい要素を登録するためにプロフィール設定に移動します。

   **メール経由でリセット**: あなたが組織の唯一のユーザーである場合、口座に関連付けられたメールアドレスを使用して、サポートケースをメールで提出します (support@clickhouse.com)。リクエストが正しいメールアドレスから来ていることが確認でき次第、MFAとパスワードのリセットを行います。パスワードリセットリンクにアクセスするためにメールを確認してください。新しいパスワードを設定した後、希望する場合は新しい要素を登録するためにプロフィール設定に移動します。 
   
</details>

## SAML SSO {#saml-sso}

<EnterprisePlanFeatureBadge feature="SAML SSO"/>

ClickHouse Cloudは、セキュリティアサーションマークアップ言語（SAML）によるシングルサインオン（SSO）もサポートしています。詳細については、[SAML SSO設定](/cloud/security/saml-setup)をご覧ください。

## データベースユーザーID + パスワード {#database-user-id--password}

パスワードを保護するために、[ユーザーアカウントの作成](/sql-reference/statements/create/user.md)時にSHA256_hash方法を使用してください。

**ヒント:** 管理権限のないユーザーは自分のパスワードを設定できないため、アカウントをセットアップするために管理者に提供する前に、ユーザーに [こちら](https://tools.keycdn.com/sha256-online-generator) のようなジェネレーターを使用してパスワードをハッシュするように依頼してください。パスワードは上記に記載の [要件](#password-settings) に従う必要があります。

```sql
CREATE USER userName IDENTIFIED WITH sha256_hash BY 'hash';
```
