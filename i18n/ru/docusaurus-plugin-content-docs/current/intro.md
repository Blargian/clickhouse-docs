---
slug: /intro
sidebar_label: 'Что такое ClickHouse?'
description: 'ClickHouse® — это столбцовая система управления базами данных (СУБД) на основе SQL для онлайн-аналитической обработки (OLAP). Она доступна как в виде программного обеспечения с открытым исходным кодом, так и в виде облачного предложения.'
title: 'Что такое ClickHouse?'
---

import column_example from '@site/static/images/column-oriented-example-query.png';
import row_orientated from '@site/static/images/row-oriented.gif';
import column_orientated from '@site/static/images/column-oriented.gif';
import Image from '@theme/IdealImage';

ClickHouse® — это высокопроизводительная, столбцовая система управления базами данных (СУБД) на основе SQL для онлайн-аналитической обработки (OLAP). Она доступна как в [виде программного обеспечения с открытым исходным кодом](https://github.com/ClickHouse/ClickHouse), так и в [виде облачного предложения](https://clickhouse.com/cloud).

## Что такое аналитика? {#what-are-analytics}

Аналитика, также известная как OLAP (онлайн-аналитическая обработка), относится к SQL-запросам с сложными вычислениями (например, агрегациями, обработкой строк, арифметикой) над огромными наборами данных.

В отличие от транзакционных запросов (или OLTP, онлайн-транзакционной обработки), которые читают и записывают всего несколько строк за запрос и, следовательно, выполняются за миллисекунды, аналитические запросы обычно обрабатывают миллиарды и триллионы строк.

Во многих случаях [аналитические запросы должны быть "в реальном времени"](https://clickhouse.com/engineering-resources/what-is-real-time-analytics), т.е. возвращать результат менее чем за секунду.

## Хранение данных в строках и столбцах {#row-oriented-vs-column-oriented-storage}

Такой уровень производительности можно достичь только с правильной "ориентацией" данных.

Базы данных хранят данные либо [в строках, либо в столбцах](https://clickhouse.com/engineering-resources/what-is-columnar-database).

В строково-ориентированной базе данных последовательные строки таблицы хранятся одна за другой. Эта компоновка позволяет быстро извлекать строки, так как значения столбцов каждой строки хранятся вместе.

ClickHouse — это столбцовая база данных. В таких системах таблицы хранятся как коллекция столбцов, т.е. значения каждого столбца хранятся последовательно одно за другим. Эта компоновка затрудняет восстановление отдельных строк (так как между значениями строк теперь есть пробелы), но операции с столбцами, такие как фильтрация или агрегация, становятся значительно быстрее, чем в строково-ориентированной базе данных.

Различие лучше всего объясняется на примере запроса, выполняющегося на 100 миллионах строк [анонимизированных веб-аналитических данных из реальной жизни](/getting-started/example-datasets/metrica):

```sql
SELECT MobilePhoneModel, COUNT() AS c
FROM metrica.hits
WHERE
      RegionID = 229
  AND EventDate >= '2013-07-01'
  AND EventDate <= '2013-07-31'
  AND MobilePhone != 0
  AND MobilePhoneModel not in ['', 'iPad']
GROUP BY MobilePhoneModel
ORDER BY c DESC
LIMIT 8;
```

Вы можете [выполнить этот запрос на ClickHouse SQL Playground](https://sql.clickhouse.com?query=U0VMRUNUIE1vYmlsZVBob25lTW9kZWwsIENPVU5UKCkgQVMgYyAKRlJPTSBtZXRyaWNhLmhpdHMgCldIRVJFIAogICAgICBSZWdpb25JRCA9IDIyOSAKICBBTkQgRXZlbnREYXRlID49ICcyMDEzLTA3LTAxJyAKICBBTkQgRXZlbnREYXRlIDw9ICcyMDEzLTA3LTMxJyAKICBBTkQgTW9iaWxlUGhvbmUgIT0gMCAKICBBTkQgTW9iaWxlUGhvbmVNb2RlbCBub3QgaW4gWycnLCAnaVBhZCddIApHUk9VUCBCWSBNb2JpbGVQaG9uZU1vZGVsCk9SREVSIEJZIGMgREVTQyAKTElNSVQgODs&chart=eyJ0eXBlIjoicGllIiwiY29uZmlnIjp7InhheGlzIjoiTW9iaWxlUGhvbmVNb2RlbCIsInlheGlzIjoiYyJ9fQ&run_query=true), который выбирает и фильтрует [всего несколько из более чем 100](https://sql.clickhouse.com/?query=U0VMRUNUIG5hbWUKRlJPTSBzeXN0ZW0uY29sdW1ucwpXSEVSRSBkYXRhYmFzZSA9ICdtZXRyaWNhJyBBTkQgdGFibGUgPSAnaGl0cyc7&tab=results&run_query=true) существующих столбцов, возвращая результат за миллисекунды:

<Image img={column_example} alt="Пример запроса в столбцовой базе данных" size="lg"/>

Как видно в разделе статистики на приведенной выше диаграмме, запрос обработал 100 миллионов строк за 92 миллисекунды, что соответствует пропускной способности примерно 300 миллионов строк или чуть менее 7 ГБ в секунду.

**Строково-ориентированная СУБД**

В строково-ориентированной базе данных, даже если запрос выше обрабатывает только несколько из существующих столбцов, система все равно должна загрузить данные из других существующих столбцов с диска в память. Причина в том, что данные хранятся на диске в блоках, называемых [блоками](https://en.wikipedia.org/wiki/Block_(data_storage)) (обычно фиксированного размера, например, 4 КБ или 8 КБ). Блоки — это наименьшие единицы данных, считываемые с диска в память. Когда приложение или база данных запрашивают данные, подсистема ввода-вывода диска операционной системы считывает необходимые блоки с диска. Даже если требуется только часть блока, весь блок считывается в память (это связано с проектированием диска и файловой системы):

<Image img={row_orientated} alt="Структура строково-ориентированной базы данных" size="lg"/>

**Столбцовая СУБД**

Поскольку значения каждого столбца хранятся последовательно одно за другим на диске, лишние данные не загружаются, когда выполняется запрос из вышеуказанного примера.
Поскольку хранение и передача по блокам с диска в память согласуются с шаблоном доступа к данным аналитических запросов, только те столбцы, которые необходимы для запроса, считываются с диска, избегая ненужного ввода-вывода для неиспользуемых данных. Это [значительно быстрее](https://benchmark.clickhouse.com/) по сравнению со строковым хранилищем, где считываются целые строки (включая неуместные столбцы):

<Image img={column_orientated} alt="Структура столбцовой базы данных" size="lg"/>

## Репликация данных и целостность {#data-replication-and-integrity}

ClickHouse использует асинхронную многомастерную схему репликации, чтобы гарантировать, что данные хранятся с избыточностью на нескольких узлах. После записи в любую доступную реплику все оставшиеся реплики получают свою копию в фоновом режиме. Система поддерживает идентичные данные на разных репликах. Восстановление после большинства сбоев выполняется автоматически или полуаавтоматически в сложных случаях.

## Контроль доступа на основе ролей {#role-based-access-control}

ClickHouse реализует управление учетными записями пользователей с помощью SQL-запросов и позволяет настраивать контроль доступа на основе ролей, аналогично тому, что можно найти в ANSI SQL стандарте и популярных системах управления реляционными базами данных.

## Поддержка SQL {#sql-support}

ClickHouse поддерживает [декларативный язык запросов на основе SQL](/sql-reference), который в многих случаях идентичен стандарту ANSI SQL. Поддерживаемые клаузулы запросов включают [GROUP BY](/sql-reference/statements/select/group-by), [ORDER BY](/sql-reference/statements/select/order-by), подзапросы в [FROM](/sql-reference/statements/select/from), клаузу [JOIN](/sql-reference/statements/select/join), оператор [IN](/sql-reference/operators/in), [оконные функции](/sql-reference/window-functions) и скалярные подзапросы.

## Приближенные вычисления {#approximate-calculation}

ClickHouse предоставляет возможность торговать точностью ради производительности. Например, некоторые его агрегатные функции рассчитывают количество уникальных значений, медиану и квантиль приблизительно. Также запросы могут выполняться на выборке данных для быстрого вычисления приблизительного результата. Наконец, агрегации могут выполняться с ограниченным количеством ключей вместо всех ключей. В зависимости от того, насколько смещено распределение ключей, это может обеспечить довольно точный результат, который использует гораздо меньше ресурсов, чем точное вычисление.

## Адаптивные алгоритмы JOIN {#adaptive-join-algorithms}

ClickHouse выбирает алгоритм JOIN адаптивно, начиная с быстрых хеш-джойнов и переходя к слиянию джойнов, если имеется более одной крупной таблицы.

## Высокая производительность запросов {#superior-query-performance}

ClickHouse известен крайне высокой производительностью запросов.
Чтобы узнать, почему ClickHouse так быстр, смотрите [Почему ClickHouse быстрый?](/concepts/why-clickhouse-is-so-fast.md) руководство.
