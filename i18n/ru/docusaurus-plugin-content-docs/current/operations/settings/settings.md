---
title: 'Настройки сессии'
sidebar_label: 'Настройки сессии'
slug: /operations/settings/settings
toc_max_heading_level: 2
description: 'Настройки, которые находятся в таблице system.settings.'
---

import ExperimentalBadge from '@theme/badges/ExperimentalBadge';
import BetaBadge from '@theme/badges/BetaBadge';
import CloudAvailableBadge from '@theme/badges/CloudAvailableBadge';

<!-- Autogenerated -->
Все настройки приведены ниже и также доступны в таблице [system.settings](/docs/operations/system-tables/settings). Эти настройки автогенерируются из [source](https://github.com/ClickHouse/ClickHouse/blob/master/src/Core/Settings.cpp).
## add_http_cors_header {#add_http_cors_header}



Тип: Bool

Значение по умолчанию: 0

Записать заголовок http CORS.
## additional_result_filter {#additional_result_filter}



Тип: String

Значение по умолчанию: 

Дополнительное выражение фильтра, которое применяется к результату `SELECT` запроса.
Эта настройка не применяется к подзапросам.

**Пример**

```sql
INSERT INTO table_1 VALUES (1, 'a'), (2, 'bb'), (3, 'ccc'), (4, 'dddd');
SElECT * FROM table_1;
```
```response
┌─x─┬─y────┐
│ 1 │ a    │
│ 2 │ bb   │
│ 3 │ ccc  │
│ 4 │ dddd │
└───┴──────┘
```
```sql
SELECT *
FROM table_1
SETTINGS additional_result_filter = 'x != 2'
```
```response
┌─x─┬─y────┐
│ 1 │ a    │
│ 3 │ ccc  │
│ 4 │ dddd │
└───┴──────┘
```
## additional_table_filters {#additional_table_filters}



Тип: Map

Значение по умолчанию: {}

Дополнительное выражение фильтра, которое применяется после чтения из указанной таблицы.

**Пример**

```sql
INSERT INTO table_1 VALUES (1, 'a'), (2, 'bb'), (3, 'ccc'), (4, 'dddd');
SELECT * FROM table_1;
```
```response
┌─x─┬─y────┐
│ 1 │ a    │
│ 2 │ bb   │
│ 3 │ ccc  │
│ 4 │ dddd │
└───┴──────┘
```
```sql
SELECT *
FROM table_1
SETTINGS additional_table_filters = {'table_1': 'x != 2'}
```
```response
┌─x─┬─y────┐
│ 1 │ a    │
│ 3 │ ccc  │
│ 4 │ dddd │
└───┴──────┘
```
## aggregate_functions_null_for_empty {#aggregate_functions_null_for_empty}



Тип: Bool

Значение по умолчанию: 0

Включает или отключает переписывание всех агрегатных функций в запросе, добавляя суффикс [-OrNull](/sql-reference/aggregate-functions/combinators#-ornull) к ним. Включите его для совместимости со стандартом SQL.
Это реализовано через переписывание запроса (аналогично настройке [count_distinct_implementation](#count_distinct_implementation)), чтобы получить согласованные результаты для распределенных запросов.

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

**Пример**

Рассмотрим следующий запрос с агрегатными функциями:
```sql
SELECT SUM(-1), MAX(0) FROM system.one WHERE 0;
```

С `aggregate_functions_null_for_empty = 0` будет получен результат:
```text
┌─SUM(-1)─┬─MAX(0)─┐
│       0 │      0 │
└─────────┴────────┘
```

С `aggregate_functions_null_for_empty = 1` результат будет:
```text
┌─SUMOrNull(-1)─┬─MAXOrNull(0)─┐
│          NULL │         NULL │
└───────────────┴──────────────┘
```
## aggregation_in_order_max_block_bytes {#aggregation_in_order_max_block_bytes}



Тип: UInt64

Значение по умолчанию: 50000000

Максимальный размер блока в байтах, накапливаемого во время агрегации в порядке первичного ключа. Меньший размер блока позволяет параллелить более финальную стадию слияния агрегации.
## aggregation_memory_efficient_merge_threads {#aggregation_memory_efficient_merge_threads}



Тип: UInt64

Значение по умолчанию: 0

Количество потоков, используемых для слияния промежуточных результатов агрегации в режиме эффективного использования памяти. Если больше, то используется больше памяти. 0 означает - то же самое, что и 'max_threads'.
## allow_aggregate_partitions_independently {#allow_aggregate_partitions_independently}



Тип: Bool

Значение по умолчанию: 0

Включает независимую агрегацию партиций в отдельных потоках, когда ключ партиционирования соответствует ключу группировки. Полезно, когда количество партиций близко к количеству ядер, и партиции имеют приблизительно одинаковый размер.
## allow_archive_path_syntax {#allow_archive_path_syntax}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 1

Движки файлов/S3/табличные функции будут анализировать пути с '::' как `<archive> :: <file>\`, если архив имеет правильное расширение.
## allow_asynchronous_read_from_io_pool_for_merge_tree {#allow_asynchronous_read_from_io_pool_for_merge_tree}



Тип: Bool

Значение по умолчанию: 0

Использовать фоновый пул ввода-вывода для чтения из таблиц MergeTree. Эта настройка может увеличить производительность для запросов с ограничением по вводу-выводу.
## allow_changing_replica_until_first_data_packet {#allow_changing_replica_until_first_data_packet}



Тип: Bool

Значение по умолчанию: 0

Если включено, то в перегруженных запросах мы можем начать новое соединение до получения первого пакета данных, даже если уже был достигнут некоторый прогресс 
(но прогресс не обновился в течение таймаута `receive_data_timeout`), иначе мы отключаем изменение реплики после первого достижения прогресса.
## allow_create_index_without_type {#allow_create_index_without_type}



Тип: Bool

Значение по умолчанию: 0

Разрешить запрос CREATE INDEX без TYPE. Запрос будет проигнорирован. Сделано для тестов совместимости SQL.
## allow_custom_error_code_in_throwif {#allow_custom_error_code_in_throwif}



Тип: Bool

Значение по умолчанию: 0

Включить пользовательский код ошибки в функции throwIf(). Если true, выброшенные исключения могут иметь неожиданные коды ошибок.
## allow_ddl {#allow_ddl}



Тип: Bool

Значение по умолчанию: 1

Если настроено на true, то пользователю разрешено выполнение DDL запросов.
## allow_deprecated_database_ordinary {#allow_deprecated_database_ordinary}



Тип: Bool

Значение по умолчанию: 0

Разрешить создание баз данных с устаревшим Ordinary движком.
## allow_deprecated_error_prone_window_functions {#allow_deprecated_error_prone_window_functions}



Тип: Bool

Значение по умолчанию: 0

Разрешить использование устаревших функций окон, подверженных ошибкам (neighbor, runningAccumulate, runningDifferenceStartingWithFirstValue, runningDifference).
## allow_deprecated_snowflake_conversion_functions {#allow_deprecated_snowflake_conversion_functions}



Тип: Bool

Значение по умолчанию: 0

Функции `snowflakeToDateTime`, `snowflakeToDateTime64`, `dateTimeToSnowflake` и `dateTime64ToSnowflake` устарели и по умолчанию отключены.
Пожалуйста, используйте функции `snowflakeIDToDateTime`, `snowflakeIDToDateTime64`, `dateTimeToSnowflakeID` и `dateTime64ToSnowflakeID` вместо этого.

Чтобы повторно включить устаревшие функции (например, в переходный период), пожалуйста, установите эту настройку в `true`.
## allow_deprecated_syntax_for_merge_tree {#allow_deprecated_syntax_for_merge_tree}



Тип: Bool

Значение по умолчанию: 0

Разрешить создание *MergeTree таблиц с устаревшим синтаксисом определения движка.
## allow_distributed_ddl {#allow_distributed_ddl}



Тип: Bool

Значение по умолчанию: 1

Если установлено на true, то пользователю разрешено выполнение распределенных DDL запросов.
## allow_drop_detached {#allow_drop_detached}



Тип: Bool

Значение по умолчанию: 0

Разрешить выполнение ALTER TABLE ... DROP DETACHED PART[ITION] ... запросов.
## allow_execute_multiif_columnar {#allow_execute_multiif_columnar}



Тип: Bool

Значение по умолчанию: 1

Разрешить выполнение функции multiIf в столбцовом формате.
## allow_experimental_analyzer {#allow_experimental_analyzer}



Тип: Bool

Значение по умолчанию: 1

Разрешить новый анализатор запросов.
## allow_experimental_codecs {#allow_experimental_codecs}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Если установлено на true, разрешить указывать экспериментальные кодеки сжатия (но у нас их еще нет, и эта опция ничего не делает).
## allow_experimental_database_glue_catalog {#allow_experimental_database_glue_catalog}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Разрешить экспериментальный движок базы данных DataLakeCatalog с catalog_type = 'glue'.
## allow_experimental_database_iceberg {#allow_experimental_database_iceberg}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Разрешить экспериментальный движок базы данных DataLakeCatalog с catalog_type = 'iceberg'.
## allow_experimental_database_materialized_postgresql {#allow_experimental_database_materialized_postgresql}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Разрешить создание базы данных с Engine=MaterializedPostgreSQL(...).
## allow_experimental_database_unity_catalog {#allow_experimental_database_unity_catalog}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Разрешить экспериментальный движок базы данных DataLakeCatalog с catalog_type = 'unity'.
## allow_experimental_dynamic_type {#allow_experimental_dynamic_type}



Тип: Bool

Значение по умолчанию: 1

Разрешает создание типа данных [Dynamic](../../sql-reference/data-types/dynamic.md).
## allow_experimental_full_text_index {#allow_experimental_full_text_index}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Если установлено на true, разрешает использовать экспериментальный полнотекстовый индекс.
## allow_experimental_funnel_functions {#allow_experimental_funnel_functions}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Включает экспериментальные функции для анализа воронки.
## allow_experimental_hash_functions {#allow_experimental_hash_functions}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Включает экспериментальные хеш-функции.
## allow_experimental_inverted_index {#allow_experimental_inverted_index}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Если установлено на true, разрешает использовать экспериментальный инвертированный индекс.
## allow_experimental_join_condition {#allow_experimental_join_condition}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Поддержка соединения с неравенством условий, которые включают столбцы как из левой, так и из правой таблицы. например, `t1.y < t2.y`.
## allow_experimental_join_right_table_sorting {#allow_experimental_join_right_table_sorting}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Если установлено на true, и выполняются условия `join_to_sort_minimum_perkey_rows` и `join_to_sort_maximum_table_rows`, реорганизовать правую таблицу по ключу для улучшения производительности в левом или внутреннем хеш-соединении.
## allow_experimental_json_type {#allow_experimental_json_type}



Тип: Bool

Значение по умолчанию: 1

Разрешает создание типа данных [JSON](../../sql-reference/data-types/newjson.md).
## allow_experimental_kafka_offsets_storage_in_keeper {#allow_experimental_kafka_offsets_storage_in_keeper}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Разрешить экспериментальную функцию хранения связанных с Kafka смещений в ClickHouse Keeper. При включении можно указать путь ClickHouse Keeper и имя реплики для движка таблицы Kafka. В результате вместо обычного движка Kafka будет использоваться новый тип движка хранения, который хранит зафиксированные смещения в основном в ClickHouse Keeper.
## allow_experimental_kusto_dialect {#allow_experimental_kusto_dialect}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Включить язык запросов Kusto (KQL) - альтернативу SQL.
## allow_experimental_live_view {#allow_experimental_live_view}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Разрешает создание устаревшего LIVE VIEW.

Возможные значения:

- 0 — Работы с живыми представлениями отключены.
- 1 — Работы с живыми представлениями включены.
## allow_experimental_materialized_postgresql_table {#allow_experimental_materialized_postgresql_table}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Разрешает использование движка таблицы MaterializedPostgreSQL. Отключён по умолчанию, потому что эта функция экспериментальна.
## allow_experimental_nlp_functions {#allow_experimental_nlp_functions}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Включает экспериментальные функции для обработки естественного языка.
## allow_experimental_object_type {#allow_experimental_object_type}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Разрешает устаревший тип данных Object.
## allow_experimental_parallel_reading_from_replicas {#allow_experimental_parallel_reading_from_replicas}
<BetaBadge/>


Тип: UInt64

Значение по умолчанию: 0

Использовать до `max_parallel_replicas` количества реплик из каждой шарды для выполнения SELECT запроса. Чтение параллелизуется и координируется динамически. 0 - отключено, 1 - включено, беззвучно отключить в случае ошибки, 2 - включено, вызовет исключение в случае ошибки.
## allow_experimental_prql_dialect {#allow_experimental_prql_dialect}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Включить PRQL - альтернативу SQL.
## allow_experimental_query_deduplication {#allow_experimental_query_deduplication}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Экспериментальная дедупликация данных для SELECT запросов на основе UUID частей.
## allow_experimental_shared_set_join {#allow_experimental_shared_set_join}
<ExperimentalBadge/>

<CloudAvailableBadge/>

Тип: Bool

Значение по умолчанию: 1

Имеет эффект только в ClickHouse Cloud. Разрешить создать ShareSet и SharedJoin.
## allow_experimental_statistics {#allow_experimental_statistics}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Разрешает определение столбцов со [статистикой](../../engines/table-engines/mergetree-family/mergetree.md/#table_engine-mergetree-creating-a-table) и [редактирование статистики](../../engines/table-engines/mergetree-family/mergetree.md/#column-statistics).
## allow_experimental_time_series_table {#allow_experimental_time_series_table}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Позволяет создание таблиц с движком таблицы [TimeSeries](../../engines/table-engines/integrations/time-series.md).

Возможные значения:

- 0 — движок таблицы [TimeSeries](../../engines/table-engines/integrations/time-series.md) отключен.
- 1 — движок таблицы [TimeSeries](../../engines/table-engines/integrations/time-series.md) включен.
## allow_experimental_ts_to_grid_aggregate_function {#allow_experimental_ts_to_grid_aggregate_function}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Экспериментальная агрегатная функция tsToGrid для переоснащения временных рядов в стиле Prometheus. Только облачный.
## allow_experimental_variant_type {#allow_experimental_variant_type}



Тип: Bool

Значение по умолчанию: 1

Разрешает создание типа данных [Variant](../../sql-reference/data-types/variant.md).
## allow_experimental_vector_similarity_index {#allow_experimental_vector_similarity_index}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Разрешить экспериментальный индекс векторного сходства.
## allow_experimental_window_view {#allow_experimental_window_view}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Включить WINDOW VIEW. Не достаточно зрелый.
## allow_general_join_planning {#allow_general_join_planning}



Тип: Bool

Значение по умолчанию: 1

Разрешает более общий алгоритм планирования соединений, который может обрабатывать более сложные условия, но работает только с хеш-соединениями. Если хеш-соединение не включено, то используется обычный алгоритм планирования соединений независимо от значения этой настройки.
## allow_get_client_http_header {#allow_get_client_http_header}



Тип: Bool

Значение по умолчанию: 0

Разрешить использовать функцию `getClientHTTPHeader`, которая позволяет получить значение заголовка текущего HTTP запроса. Она по умолчанию не включена по соображениям безопасности, потому что некоторые заголовки, такие как `Cookie`, могут содержать чувствительную информацию. Обратите внимание, что заголовки `X-ClickHouse-*` и `Authentication` всегда ограничены и не могут быть получены с помощью этой функции.
## allow_hyperscan {#allow_hyperscan}



Тип: Bool

Значение по умолчанию: 1

Разрешить функции, использующие библиотеку Hyperscan. Отключите, чтобы избежать потенциально долгих времен компиляции и чрезмерного использования ресурсов.
## allow_introspection_functions {#allow_introspection_functions}



Тип: Bool

Значение по умолчанию: 0

Включает или отключает [интроспекционные функции](../../sql-reference/functions/introspection.md) для профилирования запросов.

Возможные значения:

- 1 — Интроспекционные функции включены.
- 0 — Интроспекционные функции отключены.

**См. также**

- [Профайлер выборки запросов](../../operations/optimizing-performance/sampling-query-profiler.md)
- Системная таблица [trace_log](/operations/system-tables/trace_log)
## allow_materialized_view_with_bad_select {#allow_materialized_view_with_bad_select}



Тип: Bool

Значение по умолчанию: 0

Разрешить создание MATERIALIZED VIEW с SELECT запросом, который ссылается на несуществующие таблицы или столбцы. Он все еще должен быть синтаксически допустим. Не применяется к обновляемым MV. Не применяется, если схема MV нуждается в выводе из SELECT запроса (т.е. если CREATE не имеет списка столбцов и не указывает таблицу TO). Может использоваться для создания MV перед его исходной таблицей.
## allow_named_collection_override_by_default {#allow_named_collection_override_by_default}



Тип: Bool

Значение по умолчанию: 1

Разрешить переопределение полей именованных коллекций по умолчанию.
## allow_non_metadata_alters {#allow_non_metadata_alters}



Тип: Bool

Значение по умолчанию: 1

Разрешить выполнение изменений, которые влияют не только на метаданные таблиц, но и на данные на диске.
## allow_nonconst_timezone_arguments {#allow_nonconst_timezone_arguments}



Тип: Bool

Значение по умолчанию: 0

Разрешить неконстантные аргументы временных зон в некоторых функциях, связанных со временем, таких как toTimeZone(), fromUnixTimestamp*(), snowflakeToDateTime*().
## allow_nondeterministic_mutations {#allow_nondeterministic_mutations}



Тип: Bool

Значение по умолчанию: 0

Настройка на уровне пользователя, которая позволяет мутациям в реплицируемых таблицах использовать недетерминированные функции, такие как `dictGet`.

Учитывая, что, например, словари могут быть несинхронизированы между узлами, мутации, которые извлекают значения из них, по умолчанию запрещены для реплицируемых таблиц. Включение этой настройки позволяет это поведение, оставляя за пользователем ответственность за то, чтобы убедиться, что данные, используемые, синхронизированы по всем узлам.

**Пример**

```xml
<profiles>
    <default>
        <allow_nondeterministic_mutations>1</allow_nondeterministic_mutations>

        <!-- ... -->
    </default>

    <!-- ... -->

</profiles>
```
## allow_nondeterministic_optimize_skip_unused_shards {#allow_nondeterministic_optimize_skip_unused_shards}



Тип: Bool

Значение по умолчанию: 0

Разрешить недетерминированные (например, `rand` или `dictGet`, поскольку позже есть некоторые нюансы с обновлениями) функции в ключе шардирования.

Возможные значения:

- 0 — Запрещено.
- 1 — Разрешено.
## allow_not_comparable_types_in_comparison_functions {#allow_not_comparable_types_in_comparison_functions}



Тип: Bool

Значение по умолчанию: 0

Разрешает или ограничивает использование несравнимых типов (таких как JSON/Object/AggregateFunction) в функциях сравнения `equal/less/greater/etc`.
## allow_not_comparable_types_in_order_by {#allow_not_comparable_types_in_order_by}



Тип: Bool

Значение по умолчанию: 0

Разрешает или ограничивает использование несравнимых типов (таких как JSON/Object/AggregateFunction) в ключах ORDER BY.
## allow_prefetched_read_pool_for_local_filesystem {#allow_prefetched_read_pool_for_local_filesystem}



Тип: Bool

Значение по умолчанию: 0

Предпочитать предзагруженный пул потоков, если все части находятся на локальной файловой системе.
## allow_prefetched_read_pool_for_remote_filesystem {#allow_prefetched_read_pool_for_remote_filesystem}



Тип: Bool

Значение по умолчанию: 1

Предпочитать предзагруженный пул потоков, если все части находятся на удаленной файловой системе.
## allow_push_predicate_ast_for_distributed_subqueries {#allow_push_predicate_ast_for_distributed_subqueries}



Тип: Bool

Значение по умолчанию: 1

Разрешить прокладывание предиката на уровне AST для распределенных подзапросов с включенным анализатором.
## allow_push_predicate_when_subquery_contains_with {#allow_push_predicate_when_subquery_contains_with}



Тип: Bool

Значение по умолчанию: 1

Разрешить прокладывание предиката, когда подзапрос содержит предложение WITH.
## allow_reorder_prewhere_conditions {#allow_reorder_prewhere_conditions}



Тип: Bool

Значение по умолчанию: 1

При перемещении условий из WHERE в PREWHERE разрешить их переупорядочение для оптимизации фильтрации.
## allow_settings_after_format_in_insert {#allow_settings_after_format_in_insert}



Тип: Bool

Значение по умолчанию: 0

Контролирует, разрешено ли использование `SETTINGS` после `FORMAT` в запросах `INSERT`. Не рекомендуется использовать это, так как это может интерпретировать часть `SETTINGS` как значения.

Пример:

```sql
INSERT INTO FUNCTION null('foo String') SETTINGS max_threads=1 VALUES ('bar');
```

Но следующий запрос будет работать только с `allow_settings_after_format_in_insert`:

```sql
SET allow_settings_after_format_in_insert=1;
INSERT INTO FUNCTION null('foo String') VALUES ('bar') SETTINGS max_threads=1;
```

Возможные значения:

- 0 — Запретить.
- 1 — Разрешить.

:::note
Используйте эту настройку только для обеспечения обратной совместимости, если ваши случаи использования зависят от старого синтаксиса.
:::
## allow_simdjson {#allow_simdjson}



Тип: Bool

Значение по умолчанию: 1

Разрешать использование библиотеки simdjson в функциях 'JSON*', если доступны инструкции AVX2. Если отключено, будет использован rapidjson.
## allow_statistics_optimize {#allow_statistics_optimize}
<ExperimentalBadge/>


Тип: Bool

Значение по умолчанию: 0

Разрешает использование статистики для оптимизации запросов.
## allow_suspicious_codecs {#allow_suspicious_codecs}



Тип: Bool

Значение по умолчанию: 0

Если установлено на true, разрешает указывать бессмысленные кодеки сжатия.
## allow_suspicious_fixed_string_types {#allow_suspicious_fixed_string_types}



Тип: Bool

Значение по умолчанию: 0

В выражении CREATE TABLE разрешает создание колонок типа FixedString(n) с n > 256. FixedString с длиной >= 256 вызывает подозрения и, скорее всего, указывает на неправильное использование.
## allow_suspicious_indices {#allow_suspicious_indices}



Тип: Bool

Значение по умолчанию: 0

Отклонить первичные/вторичные индексы и ключи сортировки с идентичными выражениями.
## allow_suspicious_low_cardinality_types {#allow_suspicious_low_cardinality_types}



Тип: Bool

Значение по умолчанию: 0

Разрешает или ограничивает использование [LowCardinality](../../sql-reference/data-types/lowcardinality.md) с типами данных фиксированного размера 8 байт или меньше: числовые типы данных и `FixedString(8_bytes_or_less)`.

Для небольших фиксированных значений использование `LowCardinality` обычно неэффективно, поскольку ClickHouse хранит числовой индекс для каждой строки. В результате:

- Использование дискового пространства может возрасти.
- Потребление ОП может быть выше, в зависимости от размера словаря.
- Некоторые функции могут работать медленнее из-за дополнительных операций кодирования/декодирования.

Время слияния в таблицах с движком [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md) может увеличиться по всем описанным выше причинам.

Возможные значения:

- 1 — Использование `LowCardinality` не ограничено.
- 0 — Использование `LowCardinality` ограничено.
## allow_suspicious_primary_key {#allow_suspicious_primary_key}



Тип: Bool

Значение по умолчанию: 0

Разрешить подозрительный `PRIMARY KEY`/`ORDER BY` для MergeTree (т.е. SimpleAggregateFunction).
## allow_suspicious_ttl_expressions {#allow_suspicious_ttl_expressions}



Тип: Bool

Значение по умолчанию: 0

Отклонить TTL выражения, которые не зависят от каких-либо столбцов таблицы. Это указывает на ошибку пользователя в большинстве случаев.
## allow_suspicious_types_in_group_by {#allow_suspicious_types_in_group_by}



Тип: Bool

Значение по умолчанию: 0

Разрешает или ограничивает использование типов [Variant](../../sql-reference/data-types/variant.md) и [Dynamic](../../sql-reference/data-types/dynamic.md) в ключах GROUP BY.
## allow_suspicious_types_in_order_by {#allow_suspicious_types_in_order_by}



Тип: Bool

Значение по умолчанию: 0

Разрешает или ограничивает использование типов [Variant](../../sql-reference/data-types/variant.md) и [Dynamic](../../sql-reference/data-types/dynamic.md) в ключах ORDER BY.
## allow_suspicious_variant_types {#allow_suspicious_variant_types}



Тип: Bool

Значение по умолчанию: 0

В выражении CREATE TABLE позволяет указывать тип Variant с аналогичными вариантными типами (например, с различными числовыми или.date типами). Включение этой настройки может внести некоторую неоднозначность при работе со значениями с аналогичными типами.
## allow_unrestricted_reads_from_keeper {#allow_unrestricted_reads_from_keeper}



Тип: Bool

Значение по умолчанию: 0

Разрешить неограниченные (без условий по пути) чтения из системной таблицы zookeeper, может быть полезно, но не безопасно для zookeeper.
## alter_move_to_space_execute_async {#alter_move_to_space_execute_async}



Тип: Bool

Значение по умолчанию: 0

Выполнение ALTER TABLE MOVE ... TO [DISK|VOLUME] асинхронно.
## alter_partition_verbose_result {#alter_partition_verbose_result}



Тип: Bool

Значение по умолчанию: 0

Включает или отключает отображение информации о частях, к которым были успешно применены операции с партициями и частями.
Применимо к [ATTACH PARTITION|PART](/sql-reference/statements/alter/partition#attach-partitionpart) и к [FREEZE PARTITION](/sql-reference/statements/alter/partition#freeze-partition).

Возможные значения:

- 0 — отключить подробный вывод.
- 1 — включить подробный вывод.

**Пример**

```sql
CREATE TABLE test(a Int64, d Date, s String) ENGINE = MergeTree PARTITION BY toYYYYMDECLARE(d) ORDER BY a;
INSERT INTO test VALUES(1, '2021-01-01', '');
INSERT INTO test VALUES(1, '2021-01-01', '');
ALTER TABLE test DETACH PARTITION ID '202101';

ALTER TABLE test ATTACH PARTITION ID '202101' SETTINGS alter_partition_verbose_result = 1;

┌─command_type─────┬─partition_id─┬─part_name────┬─old_part_name─┐
│ ATTACH PARTITION │ 202101       │ 202101_7_7_0 │ 202101_5_5_0  │
│ ATTACH PARTITION │ 202101       │ 202101_8_8_0 │ 202101_6_6_0  │
└──────────────────┴──────────────┴──────────────┴───────────────┘

ALTER TABLE test FREEZE SETTINGS alter_partition_verbose_result = 1;

┌─command_type─┬─partition_id─┬─part_name────┬─backup_name─┬─backup_path───────────────────┬─part_backup_path────────────────────────────────────────────┐
│ FREEZE ALL   │ 202101       │ 202101_7_7_0 │ 8           │ /var/lib/clickhouse/shadow/8/ │ /var/lib/clickhouse/shadow/8/data/default/test/202101_7_7_0 │
│ FREEZE ALL   │ 202101       │ 202101_8_8_0 │ 8           │ /var/lib/clickhouse/shadow/8/ │ /var/lib/clickhouse/shadow/8/data/default/test/202101_8_8_0 │
└──────────────┴──────────────┴──────────────┴─────────────┴───────────────────────────────┴─────────────────────────────────────────────────────────────┘
```
## alter_sync {#alter_sync}



Тип: UInt64

Значение по умолчанию: 1

Разрешает установить ожидание выполнения действий на репликах с помощью [ALTER](../../sql-reference/statements/alter/index.md), [OPTIMIZE](../../sql-reference/statements/optimize.md) или [TRUNCATE](../../sql-reference/statements/truncate.md) запросов.

Возможные значения:

- 0 — Не ждать.
- 1 — Ждать своей собственной реализации.
- 2 — Ждать всех.

Значение по умолчанию для облака: `0`.

:::note
`alter_sync` применяется только к `Replicated` таблицам, он не имеет эффекта на изменения не `Replicated` таблиц.
:::
## analyze_index_with_space_filling_curves {#analyze_index_with_space_filling_curves}



Тип: Bool

Значение по умолчанию: 1

Если таблица содержит кривую заполнения пространства в своем индексе, например, `ORDER BY mortonEncode(x, y)` или `ORDER BY hilbertEncode(x, y)`, и запрос имеет условия на его аргументах, например, `x >= 10 AND x <= 20 AND y >= 20 AND y <= 30`, использовать кривую заполнения пространства для анализа индекса.
## analyzer_compatibility_join_using_top_level_identifier {#analyzer_compatibility_join_using_top_level_identifier}



Тип: Bool

Значение по умолчанию: 0

Принудительное разрешение идентификатора в JOIN USING из проекции (например, в `SELECT a + 1 AS b FROM t1 JOIN t2 USING (b)` соединение будет выполнено по `t1.a + 1 = t2.b`, а не по `t1.b = t2.b`).
## any_join_distinct_right_table_keys {#any_join_distinct_right_table_keys}



Тип: Bool

Значение по умолчанию: 0

Включает поведение сервера ClickHouse в `ANY INNER|LEFT JOIN` операциях.

:::note
Используйте эту настройку только для обеспечения обратной совместимости, если ваши случаи использования зависят от устаревшего поведения `JOIN`.
:::

Когда включено устаревшее поведение:

- Результаты операций `t1 ANY LEFT JOIN t2` и `t2 ANY RIGHT JOIN t1` не равны, так как ClickHouse использует логику с множественным соответствием ключей таблиц слева направо.
- Результаты операций `ANY INNER JOIN` содержат все строки из левой таблицы, как делают операции `SEMI LEFT JOIN`.

Когда устаревшее поведение отключено:

- Результаты операций `t1 ANY LEFT JOIN t2` и `t2 ANY RIGHT JOIN t1` равны, так как ClickHouse использует логику, которая обеспечивает однозначное соответствие ключей в операциях `ANY RIGHT JOIN`.
- Результаты операций `ANY INNER JOIN` содержат одну строку на ключ из обеих левых и правых таблиц.

Возможные значения:

- 0 — Устаревшее поведение отключено.
- 1 — Устаревшее поведение включено.

См. также:

- [Строгость JOIN](/sql-reference/statements/select/join#settings)
## apply_deleted_mask {#apply_deleted_mask}



Тип: Bool

Значение по умолчанию: 1

Включает фильтрацию строк, удаленных с помощью легковесного DELETE. Если отключено, запрос сможет читать эти строки. Это полезно для отладки и сценариев "восстановления".
## apply_mutations_on_fly {#apply_mutations_on_fly}



Тип: Bool

Значение по умолчанию: 0

Если true, мутации (UPDATE и DELETE), которые не материализованы в части данных, будут применены к SELECT запросам.
## apply_settings_from_server {#apply_settings_from_server}



Тип: Bool

Значение по умолчанию: 1

Должен ли клиент принимать настройки с сервера.

Это влияет только на операции, выполняемые на стороне клиента, в частности, на разбор входных данных для вставки и форматирование результата запроса. Большая часть выполнения запроса происходит на сервере и не затрагивается этой настройкой.

Как правило, эта настройка должна устанавливаться в профиле пользователя (users.xml или запросы такие как `ALTER USER`), а не через клиент (аргументы командной строки клиента, запрос `SET` или секция `SETTINGS` в запросе `SELECT`). Через клиент это можно изменить на false, но нельзя изменить на true (потому что сервер не отправит настройки, если в профиле пользователя установлено `apply_settings_from_server = false`).

Обратите внимание, что изначально (24.12) существовала серверная настройка (`send_settings_to_client`), но позже она была заменена на эту клиентскую настройку для лучшей удобства.
## asterisk_include_alias_columns {#asterisk_include_alias_columns}



Тип: Bool

Значение по умолчанию: 0

Включить [ALIAS](../../sql-reference/statements/create/table.md/#alias) столбцы для запросов с подстановочными знаками (`SELECT *`).

Возможные значения:

- 0 - отключено
- 1 - включено
## asterisk_include_materialized_columns {#asterisk_include_materialized_columns}



Тип: Bool

Значение по умолчанию: 0

Включить [MATERIALIZED](/sql-reference/statements/create/view#materialized-view) столбцы для запросов с подстановочными знаками (`SELECT *`).

Возможные значения:

- 0 - отключено
- 1 - включено
## async_insert {#async_insert}



Тип: Bool

Значение по умолчанию: 0

Если true, данные из запроса INSERT хранятся в очереди и позже сбрасываются в таблицу в фоновом режиме. Если wait_for_async_insert равно false, запрос INSERT обрабатывается почти мгновенно, иначе клиент будет ждать, пока данные будут сброшены в таблицу.
```yaml
title: 'Параметры конфигурации ClickHouse'
sidebar_label: 'Параметры конфигурации'
keywords: ['async_insert', 'Azure', 'backup', 'replication']
description: 'Описание параметров конфигурации ClickHouse для записи и обработки данных.'
```

## async_insert_busy_timeout_decrease_rate {#async_insert_busy_timeout_decrease_rate}

Type: Double

Default value: 0.2

Экспоненциальная скорость роста, с которой адаптивный тайм-аут для асинхронной вставки уменьшается.

## async_insert_busy_timeout_increase_rate {#async_insert_busy_timeout_increase_rate}

Type: Double

Default value: 0.2

Экспоненциальная скорость роста, с которой адаптивный тайм-аут для асинхронной вставки увеличивается.

## async_insert_busy_timeout_max_ms {#async_insert_busy_timeout_max_ms}

Type: Milliseconds

Default value: 200

Максимальное время ожидания перед сбросом собранных данных по запросу с момента появления первых данных.

## async_insert_busy_timeout_min_ms {#async_insert_busy_timeout_min_ms}

Type: Milliseconds

Default value: 50

Если автонастройка включена через async_insert_use_adaptive_busy_timeout, минимальное время ожидания перед сбросом собранных данных по запросу с момента появления первых данных. Это также служит начальным значением для адаптивного алгоритма.

## async_insert_deduplicate {#async_insert_deduplicate}

Type: Bool

Default value: 0

Для асинхронных запросов INSERT в реплицированных таблицах указывает, что следует выполнять дедупликацию вставляемых блоков.

## async_insert_max_data_size {#async_insert_max_data_size}

Type: UInt64

Default value: 10485760

Максимальный размер в байтах непарсенных данных, собранных по запросу, перед вставкой.

## async_insert_max_query_number {#async_insert_max_query_number}

Type: UInt64

Default value: 450

Максимальное количество запросов вставки перед их вставкой.

## async_insert_poll_timeout_ms {#async_insert_poll_timeout_ms}

Type: Milliseconds

Default value: 10

Тайм-аут для опроса данных из очереди асинхронной вставки.

## async_insert_use_adaptive_busy_timeout {#async_insert_use_adaptive_busy_timeout}

Type: Bool

Default value: 1

Если установлено в true, использовать адаптивный тайм-аут для асинхронных вставок.

## async_query_sending_for_remote {#async_query_sending_for_remote}

Type: Bool

Default value: 1

Включает создание асинхронного соединения и отправку запроса во время выполнения удаленного запроса.

По умолчанию включено.

## async_socket_for_remote {#async_socket_for_remote}

Type: Bool

Default value: 1

Включает асинхронное чтение из сокета во время выполнения удаленного запроса.

По умолчанию включено.

## azure_allow_parallel_part_upload {#azure_allow_parallel_part_upload}

Type: Bool

Default value: 1

Использовать несколько потоков для многокомпонентной загрузки в Azure.

## azure_check_objects_after_upload {#azure_check_objects_after_upload}

Type: Bool

Default value: 0

Проверять каждый загруженный объект в хранилище Azure Blob, чтобы убедиться, что загрузка была успешной.

## azure_create_new_file_on_insert {#azure_create_new_file_on_insert}

Type: Bool

Default value: 0

Включает или отключает создание нового файла при каждой вставке в таблицы движка Azure.

## azure_ignore_file_doesnt_exist {#azure_ignore_file_doesnt_exist}

Type: Bool

Default value: 0

Игнорировать отсутствие файла, если он не существует, при чтении определенных ключей.

Возможные значения:
- 1 — `SELECT` возвращает пустой результат.
- 0 — `SELECT` вызывает исключение.

## azure_list_object_keys_size {#azure_list_object_keys_size}

Type: UInt64

Default value: 1000

Максимальное количество файлов, которые могут быть возвращены в пакетном запросе ListObject.

## azure_max_blocks_in_multipart_upload {#azure_max_blocks_in_multipart_upload}

Type: UInt64

Default value: 50000

Максимальное количество блоков в многокомпонентной загрузке для Azure.

## azure_max_inflight_parts_for_one_file {#azure_max_inflight_parts_for_one_file}

Type: UInt64

Default value: 20

Максимальное количество одновременно загружаемых частей в запросе многокомпонентной загрузки. 0 означает без ограничений.

## azure_max_single_part_copy_size {#azure_max_single_part_copy_size}

Type: UInt64

Default value: 268435456

Максимальный размер объекта для копирования с использованием одночастной копии в хранилище Azure Blob.

## azure_max_single_part_upload_size {#azure_max_single_part_upload_size}

Type: UInt64

Default value: 104857600

Максимальный размер объекта для загрузки с использованием одночастной загрузки в хранилище Azure Blob.

## azure_max_single_read_retries {#azure_max_single_read_retries}

Type: UInt64

Default value: 4

Максимальное количество попыток чтения объекта из хранилища Azure Blob.

## azure_max_unexpected_write_error_retries {#azure_max_unexpected_write_error_retries}

Type: UInt64

Default value: 4

Максимальное количество попыток в случае неожиданных ошибок при записи в хранилище Azure Blob.

## azure_max_upload_part_size {#azure_max_upload_part_size}

Type: UInt64

Default value: 5368709120

Максимальный размер части для загрузки во время многокомпонентной загрузки в хранилище Azure Blob.

## azure_min_upload_part_size {#azure_min_upload_part_size}

Type: UInt64

Default value: 16777216

Минимальный размер части для загрузки во время многокомпонентной загрузки в хранилище Azure Blob.

## azure_sdk_max_retries {#azure_sdk_max_retries}

Type: UInt64

Default value: 10

Максимальное количество попыток в Azure SDK.

## azure_sdk_retry_initial_backoff_ms {#azure_sdk_retry_initial_backoff_ms}

Type: UInt64

Default value: 10

Минимальная задержка между попытками в Azure SDK.

## azure_sdk_retry_max_backoff_ms {#azure_sdk_retry_max_backoff_ms}

Type: UInt64

Default value: 1000

Максимальная задержка между попытками в Azure SDK.

## azure_skip_empty_files {#azure_skip_empty_files}

Type: Bool

Default value: 0

Включает или отключает пропуск пустых файлов в движке S3.

Возможные значения:
- 0 — `SELECT` вызывает исключение, если пустой файл несовместим с запрашиваемым форматом.
- 1 — `SELECT` возвращает пустой результат для пустого файла.

## azure_strict_upload_part_size {#azure_strict_upload_part_size}

Type: UInt64

Default value: 0

Точный размер части для загрузки во время многокомпонентной загрузки в хранилище Azure Blob.

## azure_throw_on_zero_files_match {#azure_throw_on_zero_files_match}

Type: Bool

Default value: 0

Выбросить ошибку, если совпадений с нуля файлов согласно правилам расширения glob.

Возможные значения:
- 1 — `SELECT` вызывает исключение.
- 0 — `SELECT` возвращает пустой результат.

## azure_truncate_on_insert {#azure_truncate_on_insert}

Type: Bool

Default value: 0

Включает или отключает обрезку перед вставкой в таблицы движка Azure.

## azure_upload_part_size_multiply_factor {#azure_upload_part_size_multiply_factor}

Type: UInt64

Default value: 2

Умножает azure_min_upload_part_size на этот коэффициент каждый раз, когда azure_multiply_parts_count_threshold частей загружались из одной записи в хранилище Azure Blob.

## azure_upload_part_size_multiply_parts_count_threshold {#azure_upload_part_size_multiply_parts_count_threshold}

Type: UInt64

Default value: 500

Каждый раз, когда это количество частей загружено в хранилище Azure Blob, azure_min_upload_part_size умножается на azure_upload_part_size_multiply_factor.

## backup_restore_batch_size_for_keeper_multi {#backup_restore_batch_size_for_keeper_multi}

Type: UInt64

Default value: 1000

Максимальный размер пакета для многозапроса к [Zoo]Keeper во время резервного копирования или восстановления.

## backup_restore_batch_size_for_keeper_multiread {#backup_restore_batch_size_for_keeper_multiread}

Type: UInt64

Default value: 10000

Максимальный размер пакета для многозапроса с многочтением к [Zoo]Keeper во время резервного копирования или восстановления.

## backup_restore_failure_after_host_disconnected_for_seconds {#backup_restore_failure_after_host_disconnected_for_seconds}

Type: UInt64

Default value: 3600

Если хост во время операции BACKUP ON CLUSTER или RESTORE ON CLUSTER не восстановит свой эфемерный узел 'alive' в ZooKeeper в течение этого времени, то вся операция резервного копирования или восстановления считается неудачной. Это значение должно быть больше любого разумного времени для повторного подключения хоста к ZooKeeper после сбоя. Ноль означает без ограничений.

## backup_restore_finish_timeout_after_error_sec {#backup_restore_finish_timeout_after_error_sec}

Type: UInt64

Default value: 180

Как долго инициатор должен ожидать реакции другого хоста на узел 'error' и остановить свою работу по текущей операции BACKUP ON CLUSTER или RESTORE ON CLUSTER.

## backup_restore_keeper_fault_injection_probability {#backup_restore_keeper_fault_injection_probability}

Type: Float

Default value: 0

Приблизительная вероятность сбоя для запроса Keeper во время резервного копирования или восстановления. Допустимое значение находится в интервале [0.0f, 1.0f].

## backup_restore_keeper_fault_injection_seed {#backup_restore_keeper_fault_injection_seed}

Type: UInt64

Default value: 0

0 - случайное значение, иначе значение настройки.

## backup_restore_keeper_max_retries {#backup_restore_keeper_max_retries}

Type: UInt64

Default value: 1000

Максимальное количество попыток для операций [Zoo]Keeper в процессе операции BACKUP или RESTORE. Должно быть достаточно большим, чтобы вся операция не завершилась неудачей из-за временного сбоя [Zoo]Keeper.

## backup_restore_keeper_max_retries_while_handling_error {#backup_restore_keeper_max_retries_while_handling_error}

Type: UInt64

Default value: 20

Максимальное количество попыток для операций [Zoo]Keeper во время обработки ошибки операции BACKUP ON CLUSTER или RESTORE ON CLUSTER.

## backup_restore_keeper_max_retries_while_initializing {#backup_restore_keeper_max_retries_while_initializing}

Type: UInt64

Default value: 20

Максимальное количество попыток для операций [Zoo]Keeper во время инициализации операции BACKUP ON CLUSTER или RESTORE ON CLUSTER.

## backup_restore_keeper_retry_initial_backoff_ms {#backup_restore_keeper_retry_initial_backoff_ms}

Type: UInt64

Default value: 100

Начальный тайм-аут ожидания для операций [Zoo]Keeper во время резервного копирования или восстановления.

## backup_restore_keeper_retry_max_backoff_ms {#backup_restore_keeper_retry_max_backoff_ms}

Type: UInt64

Default value: 5000

Максимальный тайм-аут ожидания для операций [Zoo]Keeper во время резервного копирования или восстановления.

## backup_restore_keeper_value_max_size {#backup_restore_keeper_value_max_size}

Type: UInt64

Default value: 1048576

Максимальный размер данных узла [Zoo]Keeper во время резервного копирования.

## backup_restore_s3_retry_attempts {#backup_restore_s3_retry_attempts}

Type: UInt64

Default value: 1000

Настройка для Aws::Client::RetryStrategy, Aws::Client выполняет повторные попытки самостоятельно, 0 означает отсутствие повторных попыток. Это касается только резервного копирования/восстановления.

## cache_warmer_threads {#cache_warmer_threads}

<CloudAvailableBadge/>

Type: UInt64

Default value: 4

Имеет эффект только в ClickHouse Cloud. Количество фоновых потоков для спекулятивной загрузки новых частей данных в кеш файлов, когда [cache_populated_by_fetch](merge-tree-settings.md/#cache_populated_by_fetch) включен. Ноль для отключения.

## calculate_text_stack_trace {#calculate_text_stack_trace}

Type: Bool

Default value: 1

Вычислить текстовый стек вызовов в случае исключений во время выполнения запроса. Это значение по умолчанию. Оно требует поиска символов, что может замедлить тесты на фуззинг, когда выполняется огромное количество неверных запросов. В обычных случаях не рекомендуется отключать эту опцию.

## cancel_http_readonly_queries_on_client_close {#cancel_http_readonly_queries_on_client_close}

Type: Bool

Default value: 0

Отменяет HTTP-запросы только для чтения (например, SELECT), когда клиент закрывает соединение без ожидания ответа.

Значение по умолчанию для облака: `1`.

## cast_ipv4_ipv6_default_on_conversion_error {#cast_ipv4_ipv6_default_on_conversion_error}

Type: Bool

Default value: 0

Оператор CAST в тип IPv4, оператор CAST в тип IPV6, функции toIPv4, toIPv6 будут возвращать значение по умолчанию вместо выбрасывания исключения при ошибке преобразования.

## cast_keep_nullable {#cast_keep_nullable}

Type: Bool

Default value: 0

Включает или отключает сохранение типа данных `Nullable` в операциях [CAST](/sql-reference/functions/type-conversion-functions#cast).

Когда настройка включена и аргумент функции `CAST` является `Nullable`, результат также преобразуется в тип `Nullable`. Когда настройка отключена, результат всегда имеет точно указанный целевой тип.

Возможные значения:

- 0 — Результат `CAST` имеет точно указанный целевой тип.
- 1 — Если тип аргумента `Nullable`, результат `CAST` преобразуется в `Nullable(DestinationDataType)`.

**Примеры**

Следующий запрос дает точно целевой тип данных:

```sql
SET cast_keep_nullable = 0;
SELECT CAST(toNullable(toInt32(0)) AS Int32) as x, toTypeName(x);
```

Результат:

```text
┌─x─┬─toTypeName(CAST(toNullable(toInt32(0)), 'Int32'))─┐
│ 0 │ Int32                                             │
└───┴───────────────────────────────────────────────────┘
```

Следующий запрос дает модификацию `Nullable` на целевом типе данных:

```sql
SET cast_keep_nullable = 1;
SELECT CAST(toNullable(toInt32(0)) AS Int32) as x, toTypeName(x);
```

Результат:

```text
┌─x─┬─toTypeName(CAST(toNullable(toInt32(0)), 'Int32'))─┐
│ 0 │ Nullable(Int32)                                   │
└───┴───────────────────────────────────────────────────┘
```

**Смотрите также**

- [CAST](/sql-reference/functions/type-conversion-functions#cast) функция.

## cast_string_to_dynamic_use_inference {#cast_string_to_dynamic_use_inference}

Type: Bool

Default value: 0

Использовать вывод типов во время преобразования String в Dynamic.

## check_query_single_value_result {#check_query_single_value_result}

Type: Bool

Default value: 1

Определяет уровень детализации результата запроса [CHECK TABLE](/sql-reference/statements/check-table) для движков семейства `MergeTree`.

Возможные значения:

- 0 — запрос показывает статус проверки для каждой отдельной части данных таблицы.
- 1 — запрос показывает общий статус проверки таблицы.

## check_referential_table_dependencies {#check_referential_table_dependencies}

Type: Bool

Default value: 0

Проверяет, что запрос DDL (например, DROP TABLE или RENAME) не нарушит ссылочные зависимости.

## check_table_dependencies {#check_table_dependencies}

Type: Bool

Default value: 1

Проверяет, что запрос DDL (например, DROP TABLE или RENAME) не нарушит зависимости.

## checksum_on_read {#checksum_on_read}

Type: Bool

Default value: 1

Проверять контрольные суммы при чтении. Эта функция включена по умолчанию и всегда должна быть включена в продакшене. Пожалуйста, не ожидайте никаких преимуществ от отключения этой настройки. Она может использоваться только для экспериментов и бенчмарков. Настройка применяется только для таблиц семейства `MergeTree`. Контрольные суммы всегда проверяются для других движков таблиц и при получении данных по сети.

## cloud_mode {#cloud_mode}

Type: Bool

Default value: 0

Облачный режим.

## cloud_mode_database_engine {#cloud_mode_database_engine}

Type: UInt64

Default value: 1

Разрешенный движок базы данных в облаке. 1 - переписывать DDL в использовании реплицированной базы данных, 2 - переписывать DDL в использовании общей базы данных.

## cloud_mode_engine {#cloud_mode_engine}

Type: UInt64

Default value: 1

Разрешенная семейство движков в облаке.

- 0 - разрешить все
- 1 - переписывать DDL в использовании ReplicatedMergeTree
- 2 - переписывать DDL в использовании SharedMergeTree
- 3 - переписывать DDL в использовании SharedMergeTree, кроме когда явно указан удаленный диск.

UInt64 для минимизации публичной части.

## cluster_for_parallel_replicas {#cluster_for_parallel_replicas}

<BetaBadge/>

Type: String

Default value: 

Кластер для шард, в котором находится текущий сервер.

## collect_hash_table_stats_during_aggregation {#collect_hash_table_stats_during_aggregation}

Type: Bool

Default value: 1

Включает сбор статистики хеш-таблиц для оптимизации распределения памяти.

## collect_hash_table_stats_during_joins {#collect_hash_table_stats_during_joins}

Type: Bool

Default value: 1

Включает сбор статистики хеш-таблиц для оптимизации распределения памяти.

## compatibility {#compatibility}

Type: String

Default value: 

Настройка `compatibility` заставляет ClickHouse использовать настройки по умолчанию предыдущей версии ClickHouse, где предыдущая версия указана как настройка.

Если настройки установлены на ненастройки по умолчанию, то эти настройки принимаются во внимание (только настройки, которые не были изменены, затрагиваются настройкой `compatibility`).

Эта настройка принимает номер версии ClickHouse в виде строки, такой как `22.3`, `22.8`. Пустое значение означает, что эта настройка отключена.

По умолчанию отключено.

:::note
В ClickHouse Cloud настройка совместимости должна устанавливаться поддержкой ClickHouse Cloud. Пожалуйста, [откройте дело](https://clickhouse.cloud/support), чтобы установить её.
:::

## compatibility_ignore_auto_increment_in_create_table {#compatibility_ignore_auto_increment_in_create_table}

Type: Bool

Default value: 0

Игнорировать ключевое слово AUTO_INCREMENT в объявлении столбца, если true, иначе возвращать ошибку. Упрощает миграцию из MySQL.

## compatibility_ignore_collation_in_create_table {#compatibility_ignore_collation_in_create_table}

Type: Bool

Default value: 1

Совместимость игнорирует сортировку при создании таблицы.

## compile_aggregate_expressions {#compile_aggregate_expressions}

Type: Bool

Default value: 1

Включает или отключает JIT-компиляцию агрегатных функций в нативный код. Включение этой настройки может улучшить производительность.

Возможные значения:

- 0 — Агрегация выполняется без JIT-компиляции.
- 1 — Агрегация выполняется с использованием JIT-компиляции.

**Смотрите также**

- [min_count_to_compile_aggregate_expression](#min_count_to_compile_aggregate_expression).

## compile_expressions {#compile_expressions}

Type: Bool

Default value: 0

Компилирует некоторые скалярные функции и операторы в нативный код. Из-за ошибки в инфраструктуре компилятора LLVM на машинах AArch64 это может привести к разыменованию указателя и, следовательно, к сбою сервера. Не включайте эту настройку.

## compile_sort_description {#compile_sort_description}

Type: Bool

Default value: 1

Компилирует описание сортировки в нативный код.

## connect_timeout {#connect_timeout}

Type: Seconds

Default value: 10

Тайм-аут подключения, если нет реплик.

## connect_timeout_with_failover_ms {#connect_timeout_with_failover_ms}

Type: Milliseconds

Default value: 1000

Тайм-аут в миллисекундах для подключения к удаленному серверу для движка распределенной таблицы, если в определении кластера используются секции 'shard' и 'replica'. Если неудачно, выполняется несколько попыток подключения к различным репликам.

## connect_timeout_with_failover_secure_ms {#connect_timeout_with_failover_secure_ms}

Type: Milliseconds

Default value: 1000

Тайм-аут подключения для выбора первой здоровой реплики (для защищенных соединений).

## connection_pool_max_wait_ms {#connection_pool_max_wait_ms}

Type: Milliseconds

Default value: 0

Время ожидания в миллисекундах для подключения, когда пул подключений заполнен.

Возможные значения:

- Положительное целое число.
- 0 — бесконечный тайм-аут.

## connections_with_failover_max_tries {#connections_with_failover_max_tries}

Type: UInt64

Default value: 3

Максимальное количество попыток подключения к каждой реплике для движка распределенной таблицы.

## convert_query_to_cnf {#convert_query_to_cnf}

Type: Bool

Default value: 0

Когда установлено в `true`, запрос `SELECT` будет преобразован в конъюнктивную нормальную форму (CNF). Существуют сценарии, когда переписывание запроса в CNF может выполняться быстрее (посмотрите [этот Github issue](https://github.com/ClickHouse/ClickHouse/issues/11749) для объяснения).

Например, обратите внимание, что следующий запрос SELECT не модифицируется (стандартное поведение):

```sql
EXPLAIN SYNTAX
SELECT *
FROM
(
    SELECT number AS x
    FROM numbers(20)
) AS a
WHERE ((x >= 1) AND (x <= 5)) OR ((x >= 10) AND (x <= 15))
SETTINGS convert_query_to_cnf = false;
```

Результат:

```response
┌─explain────────────────────────────────────────────────────────┐
│ SELECT x                                                       │
│ FROM                                                           │
│ (                                                              │
│     SELECT number AS x                                         │
│     FROM numbers(20)                                           │
│     WHERE ((x >= 1) AND (x <= 5)) OR ((x >= 10) AND (x <= 15)) │
│ ) AS a                                                         │
│ WHERE ((x >= 1) AND (x <= 5)) OR ((x >= 10) AND (x <= 15))     │
│ SETTINGS convert_query_to_cnf = 0                              │
└────────────────────────────────────────────────────────────────┘
```

Давайте установим `convert_query_to_cnf` в `true` и посмотрим, какие изменения произойдут:

```sql
EXPLAIN SYNTAX
SELECT *
FROM
(
    SELECT number AS x
    FROM numbers(20)
) AS a
WHERE ((x >= 1) AND (x <= 5)) OR ((x >= 10) AND (x <= 15))
SETTINGS convert_query_to_cnf = true;
```

Обратите внимание, что условие `WHERE` переписано в CNF, но набор результатов остаётся идентичным - логика Boolean не изменена:

```response
┌─explain───────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ SELECT x                                                                                                              │
│ FROM                                                                                                                  │
│ (                                                                                                                     │
│     SELECT number AS x                                                                                                │
│     FROM numbers(20)                                                                                                  │
│     WHERE ((x <= 15) OR (x <= 5)) AND ((x <= 15) OR (x >= 1)) AND ((x >= 10) OR (x <= 5)) AND ((x >= 10) OR (x >= 1)) │
│ ) AS a                                                                                                                │
│ WHERE ((x >= 10) OR (x >= 1)) AND ((x >= 10) OR (x <= 5)) AND ((x <= 15) OR (x >= 1)) AND ((x <= 15) OR (x <= 5))     │
│ SETTINGS convert_query_to_cnf = 1                                                                                     │
└───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

Возможные значения: true, false.

## count_distinct_implementation {#count_distinct_implementation}

Type: String

Default value: uniqExact

Указывает, какая из функций `uniq*` должна использоваться для выполнения конструкции [COUNT(DISTINCT ...)](/sql-reference/aggregate-functions/reference/count).

Возможные значения:

- [uniq](/sql-reference/aggregate-functions/reference/uniq).
- [uniqCombined](/sql-reference/aggregate-functions/reference/uniqcombined).
- [uniqCombined64](/sql-reference/aggregate-functions/reference/uniqcombined64).
- [uniqHLL12](/sql-reference/aggregate-functions/reference/uniqhll12).
- [uniqExact](/sql-reference/aggregate-functions/reference/uniqexact).

## count_distinct_optimization {#count_distinct_optimization}

Type: Bool

Default value: 0

Переписывает count distinct в подзапрос для группировки.

## create_if_not_exists {#create_if_not_exists}

Type: Bool

Default value: 0

Включает `IF NOT EXISTS` для оператора `CREATE` по умолчанию. Если либо эта настройка, либо `IF NOT EXISTS` указаны, и таблица с указанным именем уже существует, исключение не будет выброшено.

## create_index_ignore_unique {#create_index_ignore_unique}

Type: Bool

Default value: 0

Игнорировать ключевое слово UNIQUE в создании уникального индекса. Сделано для тестов совместимости SQL.

## create_replicated_merge_tree_fault_injection_probability {#create_replicated_merge_tree_fault_injection_probability}

Type: Float

Default value: 0

Вероятность внедрения сбоя во время создания таблицы после создания метаданных в ZooKeeper.

## create_table_empty_primary_key_by_default {#create_table_empty_primary_key_by_default}

Type: Bool

Default value: 0

Позволяет создавать таблицы *MergeTree с пустым первичным ключом, когда ORDER BY и PRIMARY KEY не указаны.

## cross_join_min_bytes_to_compress {#cross_join_min_bytes_to_compress}

Type: UInt64

Default value: 1073741824

Минимальный размер блока для сжатия в CROSS JOIN. Значение ноль означает - отключить этот порог. Этот блок сжимается, когда достигнут любой из двух порогов (по строкам или по байтам).

## cross_join_min_rows_to_compress {#cross_join_min_rows_to_compress}

Type: UInt64

Default value: 10000000

Минимальное количество строк для сжатия блока в CROSS JOIN. Значение ноль означает - отключить этот порог. Этот блок сжимается, когда достигнут любой из двух порогов (по строкам или по байтам).

## data_type_default_nullable {#data_type_default_nullable}

Type: Bool

Default value: 0

Разрешает типам данных без явных модификаторов [NULL или NOT NULL](/sql-reference/statements/create/table#null-or-not-null-modifiers) в определении столбца быть [Nullable](/sql-reference/data-types/nullable).

Возможные значения:

- 1 — Типы данных в определениях столбцов по умолчанию устанавливаются как `Nullable`.
- 0 — Типы данных в определениях столбцов по умолчанию устанавливаются как не `Nullable`.

## database_atomic_wait_for_drop_and_detach_synchronously {#database_atomic_wait_for_drop_and_detach_synchronously}

Type: Bool

Default value: 0

Добавляет модификатор `SYNC` ко всем запросам `DROP` и `DETACH`.

Возможные значения:

- 0 — Запросы выполняются с задержкой.
- 1 — Запросы выполняются без задержки.

## database_replicated_allow_explicit_uuid {#database_replicated_allow_explicit_uuid}

Type: UInt64

Default value: 0

0 - Не разрешать явно указывать UUID для таблиц в реплицированных базах данных. 1 - Разрешить. 2 - Разрешить, но игнорировать указанный UUID и генерировать случайный вместо него.

## database_replicated_allow_heavy_create {#database_replicated_allow_heavy_create}

Type: Bool

Default value: 0

Разрешить длительные запросы DDL (CREATE AS SELECT и POPULATE) в реплицированном движке базы данных. Обратите внимание, что это может блокировать очередь DDL на длительное время.

## database_replicated_allow_only_replicated_engine {#database_replicated_allow_only_replicated_engine}

Type: Bool

Default value: 0

Разрешить создание только реплицированных таблиц в базе данных с движком Replicated.

## database_replicated_allow_replicated_engine_arguments {#database_replicated_allow_replicated_engine_arguments}

Type: UInt64

Default value: 0

0 - Не разрешать явно указывать путь в ZooKeeper и имя реплики для таблиц *MergeTree в реплицированных базах данных. 1 - Разрешить. 2 - Разрешить, но игнорировать указанный путь и использовать вместо него значение по умолчанию. 3 - Разрешить и не регистрировать предупреждение.

## database_replicated_always_detach_permanently {#database_replicated_always_detach_permanently}

Type: Bool

Default value: 0

Выполнить DETACH TABLE как DETACH TABLE PERMANENTLY, если движок базы данных является реплицированным.

## database_replicated_enforce_synchronous_settings {#database_replicated_enforce_synchronous_settings}

Type: Bool

Default value: 0

Принуждает синхронное ожидание для некоторых запросов (см. также database_atomic_wait_for_drop_and_detach_synchronously, mutations_sync, alter_sync). Не рекомендуется включать эти настройки.

## database_replicated_initial_query_timeout_sec {#database_replicated_initial_query_timeout_sec}

Type: UInt64

Default value: 300

Устанавливает, как долго начальный запрос DDL должен ожидать, чтобы реплицированная база данных обработала предыдущие записи в очереди DDL в секундах.

Возможные значения:

- Положительное целое число.
- 0 — Без ограничений.

## decimal_check_overflow {#decimal_check_overflow}

Type: Bool

Default value: 1

Проверять переполнение операций арифметики/сравнения с десятичными числами.

## deduplicate_blocks_in_dependent_materialized_views {#deduplicate_blocks_in_dependent_materialized_views}

Type: Bool

Default value: 0

Включает или отключает проверку дедупликации для материализованных представлений, которые получают данные из таблиц Replicated*.

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

Использование

По умолчанию дедупликация не выполняется для материализованных представлений, но выполняется на верхнем уровне, в исходной таблице. Если вставляемый блок пропущен из-за дедупликации в исходной таблице, то вставка в прикрепленные материализованные представления не произойдет. Это поведение существует для обеспечения вставки сильно агрегированных данных в материализованные представления, для случаев, когда вставляемые блоки идентичны после агрегации в материализованном представлении, но происходят из разных вставок в исходную таблицу. В то же время это поведение «ломает» идемпотентность `INSERT`. Если вставка в основную таблицу была успешной, а вставка в материализованное представление завершилась неудачей (например, из-за сбоя связи с ClickHouse Keeper), клиент получит ошибку и может повторить операцию. Однако материализованное представление не получит вторую вставку, потому что оно будет отвергнуто дедупликацией в основной (исходной) таблице. Настройка `deduplicate_blocks_in_dependent_materialized_views` позволяет изменить это поведение. При повторной попытке материализованное представление получит повторную вставку и выполнит проверку дедупликации самостоятельно, игнорируя результат проверки для исходной таблицы, и вставит строки, утерянные из-за первой ошибки.

## default_materialized_view_sql_security {#default_materialized_view_sql_security}

Type: SQLSecurityType

Default value: DEFINER

Позволяет установить значение по умолчанию для параметра SQL SECURITY при создании материализованного представления. [Подробнее о безопасности SQL](../../sql-reference/statements/create/view.md/#sql_security).

Значение по умолчанию — `DEFINER`.

## default_max_bytes_in_join {#default_max_bytes_in_join}

Type: UInt64

Default value: 1000000000

Максимальный размер правой таблицы, если необходим лимит, но `max_bytes_in_join` не установлен.

## default_normal_view_sql_security {#default_normal_view_sql_security}

Type: SQLSecurityType

Default value: INVOKER

Позволяет установить значение по умолчанию для параметра `SQL SECURITY` во время создания обычного представления. [Подробнее о безопасности SQL](../../sql-reference/statements/create/view.md/#sql_security).

Значение по умолчанию — `INVOKER`.

## default_table_engine {#default_table_engine}

Тип: DefaultTableEngine

Значение по умолчанию: MergeTree

Движок таблицы по умолчанию, который будет использоваться, когда `ENGINE` не установлен в операторе `CREATE`.

Возможные значения:

- строка, представляющая любое допустимое имя движка таблицы

Значение по умолчанию для Cloud: `SharedMergeTree`.

**Пример**

Запрос:

```sql
SET default_table_engine = 'Log';

SELECT name, value, changed FROM system.settings WHERE name = 'default_table_engine';
```

Результат:

```response
┌─name─────────────────┬─value─┬─changed─┐
│ default_table_engine │ Log   │       1 │
└──────────────────────┴───────┴─────────┘
```

В этом примере любая новая таблица, которая не указывает `Engine`, будет использовать движок таблицы `Log`:

Запрос:

```sql
CREATE TABLE my_table (
    x UInt32,
    y UInt32
);

SHOW CREATE TABLE my_table;
```

Результат:

```response
┌─statement────────────────────────────────────────────────────────────────┐
│ CREATE TABLE default.my_table
(
    `x` UInt32,
    `y` UInt32
)
ENGINE = Log
└──────────────────────────────────────────────────────────────────────────┘
```

## default_temporary_table_engine {#default_temporary_table_engine}

Тип: DefaultTableEngine

Значение по умолчанию: Memory

То же самое, что и [default_table_engine](#default_table_engine), но для временных таблиц.

В этом примере любая новая временная таблица, которая не указывает `Engine`, будет использовать движок таблицы `Log`:

Запрос:

```sql
SET default_temporary_table_engine = 'Log';

CREATE TEMPORARY TABLE my_table (
    x UInt32,
    y UInt32
);

SHOW CREATE TEMPORARY TABLE my_table;
```

Результат:

```response
┌─statement────────────────────────────────────────────────────────────────┐
│ CREATE TEMPORARY TABLE default.my_table
(
    `x` UInt32,
    `y` UInt32
)
ENGINE = Log
└──────────────────────────────────────────────────────────────────────────┘
```

## default_view_definer {#default_view_definer}

Тип: String

Значение по умолчанию: CURRENT_USER

Позволяет установить значение по умолчанию для параметра `DEFINER` при создании представления. [Подробнее о безопасности SQL](../../sql-reference/statements/create/view.md/#sql_security).

Значение по умолчанию: `CURRENT_USER`.

## describe_compact_output {#describe_compact_output}

Тип: Bool

Значение по умолчанию: 0

Если true, включает только имена колонок и типы в результат запроса DESCRIBE.

## describe_extend_object_types {#describe_extend_object_types}

Тип: Bool

Значение по умолчанию: 0

Выводит конкретный тип колонок типа Object в запросе DESCRIBE.

## describe_include_subcolumns {#describe_include_subcolumns}

Тип: Bool

Значение по умолчанию: 0

Включает описание подпроекций для запроса [DESCRIBE](../../sql-reference/statements/describe-table.md). Например, члены [Tuple](../../sql-reference/data-types/tuple.md) или подпроекции типа [Map](/sql-reference/data-types/map#reading-subcolumns-of-map), [Nullable](../../sql-reference/data-types/nullable.md/#finding-null) или [Array](../../sql-reference/data-types/array.md/#array-size).

Возможные значения:

- 0 — Подпроекции не включены в запросы `DESCRIBE`.
- 1 — Подпроекции включены в запросы `DESCRIBE`.

**Пример**

Смотрите пример для оператора [DESCRIBE](../../sql-reference/statements/describe-table.md).

## describe_include_virtual_columns {#describe_include_virtual_columns}

Тип: Bool

Значение по умолчанию: 0

Если true, виртуальные колонки таблицы будут включены в результат запроса DESCRIBE.

## dialect {#dialect}

Тип: Dialect

Значение по умолчанию: clickhouse

Какой диалект будет использоваться для разбора запроса.

## dictionary_validate_primary_key_type {#dictionary_validate_primary_key_type}

Тип: Bool

Значение по умолчанию: 0

Проверять тип первичного ключа для словарей. По умолчанию тип id для простых макетов будет неявно преобразован в UInt64.

## distinct_overflow_mode {#distinct_overflow_mode}

Тип: OverflowMode

Значение по умолчанию: throw

Устанавливает, что происходит, когда количество данных превышает один из лимитов.

Возможные значения:
- `throw`: выбросить исключение (значение по умолчанию).
- `break`: остановить выполнение запроса и вернуть частичный результат, словно
исходные данные исчерпаны.

## distributed_aggregation_memory_efficient {#distributed_aggregation_memory_efficient}

Тип: Bool

Значение по умолчанию: 1

Включен ли режим экономии памяти для распределенной агрегации.

## distributed_background_insert_batch {#distributed_background_insert_batch}

Тип: Bool

Значение по умолчанию: 0

Включает/отключает отправку вставленных данных пакетами.

Когда отправка пакетами включена, движок таблиц [Distributed](../../engines/table-engines/special/distributed.md) пытается отправлять несколько файлов вставленных данных в одной операции вместо отправки их по отдельности. Пакетная отправка улучшает производительность кластера за счет более эффективного использования ресурсов сервера и сети.

Возможные значения:

- 1 — Включено.
- 0 — Отключено.

## distributed_background_insert_max_sleep_time_ms {#distributed_background_insert_max_sleep_time_ms}

Тип: Milliseconds

Значение по умолчанию: 30000

Максимальный интервал для движка таблиц [Distributed](../../engines/table-engines/special/distributed.md) для отправки данных. Ограничивает экспоненциальный рост интервала, установленного в настройке [distributed_background_insert_sleep_time_ms](#distributed_background_insert_sleep_time_ms).

Возможные значения:

- Положительное целое число миллисекунд.

## distributed_background_insert_sleep_time_ms {#distributed_background_insert_sleep_time_ms}

Тип: Milliseconds

Значение по умолчанию: 100

Базовый интервал для движка таблиц [Distributed](../../engines/table-engines/special/distributed.md) для отправки данных. Фактический интервал растет экспоненциально в случае ошибок.

Возможные значения:

- Положительное целое число миллисекунд.

## distributed_background_insert_split_batch_on_failure {#distributed_background_insert_split_batch_on_failure}

Тип: Bool

Значение по умолчанию: 0

Включает/отключает разделение пакетов при сбоях.

Иногда отправка определенного пакета на удаленный шард может завершиться неудачей из-за сложной пайплайна после (т.е. `MATERIALIZED VIEW` с `GROUP BY`) из-за `Memory limit exceeded` или аналогичных ошибок. В этом случае повторная попытка не поможет (и это заблокирует распределенные отправки для таблицы), но отправка файлов из этого пакета по одному может оказаться успешной.

Таким образом, установка этой настройки на `1` отключит пакетирование для таких пакетов (т.е. временно отключает `distributed_background_insert_batch` для неудачных пакетов).

Возможные значения:

- 1 — Включено.
- 0 — Отключено.

:::note
Эта настройка также влияет на сломанные пакеты (которые могут появиться из-за ненормального завершения работы сервера (машины) и отсутствия `fsync_after_insert` / `fsync_directories` для движка таблиц [Distributed](../../engines/table-engines/special/distributed.md)).
:::

:::note
Не следует полагаться на автоматическое разделение пакетов, так как это может негативно сказаться на производительности.
:::

## distributed_background_insert_timeout {#distributed_background_insert_timeout}

Тип: UInt64

Значение по умолчанию: 0

Таймаут для вставки в распределенные таблицы. Настройка используется только с включенным insert_distributed_sync. Нулевое значение означает отсутствие таймаута.

## distributed_cache_bypass_connection_pool {#distributed_cache_bypass_connection_pool}

<CloudAvailableBadge/>

Тип: Bool

Значение по умолчанию: 0

Эта настройка влияет только в ClickHouse Cloud. Позволяет обойти пул соединений распределенного кэша.

## distributed_cache_connect_max_tries {#distributed_cache_connect_max_tries}

<CloudAvailableBadge/>

Тип: UInt64

Значение по умолчанию: 20

Эта настройка влияет только в ClickHouse Cloud. Количество попыток соединения с распределенным кэшем в случае неудачи.

## distributed_cache_data_packet_ack_window {#distributed_cache_data_packet_ack_window}

<CloudAvailableBadge/>

Тип: UInt64

Значение по умолчанию: 5

Эта настройка влияет только в ClickHouse Cloud. Окно для отправки ACK для последовательности DataPacket в одном запросе на чтение из распределенного кэша.

## distributed_cache_discard_connection_if_unread_data {#distributed_cache_discard_connection_if_unread_data}

<CloudAvailableBadge/>

Тип: Bool

Значение по умолчанию: 1

Эта настройка влияет только в ClickHouse Cloud. Отказ от соединения, если есть непрочитанные данные.

## distributed_cache_fetch_metrics_only_from_current_az {#distributed_cache_fetch_metrics_only_from_current_az}

<CloudAvailableBadge/>

Тип: Bool

Значение по умолчанию: 1

Эта настройка влияет только в ClickHouse Cloud. Получать метрики только из текущей зоны доступности в system.distributed_cache_metrics, system.distributed_cache_events. 

## distributed_cache_log_mode {#distributed_cache_log_mode}

<CloudAvailableBadge/>

Тип: DistributedCacheLogMode

Значение по умолчанию: on_error

Эта настройка влияет только в ClickHouse Cloud. Режим записи в system.distributed_cache_log.

## distributed_cache_max_unacked_inflight_packets {#distributed_cache_max_unacked_inflight_packets}

<CloudAvailableBadge/>

Тип: UInt64

Значение по умолчанию: 10

Эта настройка влияет только в ClickHouse Cloud. Максимальное количество неподтвержденных в пути пакетов в одном запросе на чтение из распределенного кэша.

## distributed_cache_min_bytes_for_seek {#distributed_cache_min_bytes_for_seek}

<CloudAvailableBadge/>

Тип: UInt64

Значение по умолчанию: 0

Эта настройка влияет только в ClickHouse Cloud. Минимальное количество байтов для осуществления поиска в распределенном кэше.

## distributed_cache_pool_behaviour_on_limit {#distributed_cache_pool_behaviour_on_limit}

<CloudAvailableBadge/>

Тип: DistributedCachePoolBehaviourOnLimit

Значение по умолчанию: wait

Эта настройка влияет только в ClickHouse Cloud. Определяет поведение соединения распределенного кэша при достижении лимита пула.

## distributed_cache_read_alignment {#distributed_cache_read_alignment}

<CloudAvailableBadge/>

Тип: UInt64

Значение по умолчанию: 0

Эта настройка влияет только в ClickHouse Cloud. Настройка для тестирования, не изменяйте её.

## distributed_cache_receive_response_wait_milliseconds {#distributed_cache_receive_response_wait_milliseconds}

<CloudAvailableBadge/>

Тип: UInt64

Значение по умолчанию: 60000

Эта настройка влияет только в ClickHouse Cloud. Время ожидания в миллисекундах для получения данных по запросу из распределенного кэша.

## distributed_cache_receive_timeout_milliseconds {#distributed_cache_receive_timeout_milliseconds}

<CloudAvailableBadge/>

Тип: UInt64

Значение по умолчанию: 10000

Эта настройка влияет только в ClickHouse Cloud. Время ожидания в миллисекундах для получения любого типа ответа от распределенного кэша.

## distributed_cache_throw_on_error {#distributed_cache_throw_on_error}

<CloudAvailableBadge/>

Тип: Bool

Значение по умолчанию: 0

Эта настройка влияет только в ClickHouse Cloud. Повторно выбрасывает исключение, возникшее во время общения с распределенным кэшем или исключение, полученное от распределенного кэша. В противном случае происходит пропуск распределенного кэша в случае ошибки.

## distributed_cache_wait_connection_from_pool_milliseconds {#distributed_cache_wait_connection_from_pool_milliseconds}

<CloudAvailableBadge/>

Тип: UInt64

Значение по умолчанию: 100

Эта настройка влияет только в ClickHouse Cloud. Время ожидания в миллисекундах для получения соединения из пула соединений, если distributed_cache_pool_behaviour_on_limit равно wait.

## distributed_connections_pool_size {#distributed_connections_pool_size}

Тип: UInt64

Значение по умолчанию: 1024

Максимальное количество одновременных соединений с удалёнными серверами для распределенной обработки всех запросов к одной распределенной таблице. Рекомендуется устанавливать значение не менее, чем количество серверов в кластере.

## distributed_ddl_entry_format_version {#distributed_ddl_entry_format_version}

Тип: UInt64

Значение по умолчанию: 5

Версия совместимости для распределенных DDL-запросов (ON CLUSTER).

## distributed_ddl_output_mode {#distributed_ddl_output_mode}

Тип: DistributedDDLOutputMode

Значение по умолчанию: throw

Устанавливает формат результата распределенного DDL-запроса.

Возможные значения:

- `throw` — Возвращает набор результатов с состоянием выполнения запроса для всех хостов, где запрос завершен. Если запрос не удался на некоторых хостах, будет повторно выброшено первое исключение. Если запрос еще не завершен на некоторых хостах и истекло время ожидания [distributed_ddl_task_timeout](#distributed_ddl_task_timeout), то выбрасывается исключение `TIMEOUT_EXCEEDED`.
- `none` — Похоже на выброс, но распределенный DDL-запрос не возвращает набор результатов.
- `null_status_on_timeout` — Возвращает `NULL` в качестве статуса выполнения в некоторых строках набора результатов вместо выбрасывания `TIMEOUT_EXCEEDED`, если запрос не завершен на соответствующих хостах.
- `never_throw` — Не выбрасывать `TIMEOUT_EXCEEDED` и не повторно выбрасывать исключения, если запрос не удался на некоторых хостах.
- `none_only_active` — похоже на `none`, но не ждет неактивных реплик базы данных `Replicated`. Примечание: с этим режимом невозможно выяснить, что запрос не был выполнен на какой-то реплике и будет выполнен в фоновом режиме.
- `null_status_on_timeout_only_active` — похоже на `null_status_on_timeout`, но не ждет неактивных реплик базы данных `Replicated`.
- `throw_only_active` — похоже на `throw`, но не ждет неактивных реплик базы данных `Replicated`.

Значение по умолчанию для Cloud: `none`.

## distributed_ddl_task_timeout {#distributed_ddl_task_timeout}

Тип: Int64

Значение по умолчанию: 180

Устанавливает таймаут для ответов DDL-запросов со всех хостов в кластере. Если DDL-запрос не был выполнен на всех хостах, ответ будет содержать ошибку таймаута, а запрос будет выполнен в асинхронном режиме. Отрицательное значение означает бесконечный таймаут.

Возможные значения:

- Положительное целое число.
- 0 — Асинхронный режим.
- Отрицательное целое число — бесконечный таймаут.

## distributed_foreground_insert {#distributed_foreground_insert}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает синхронную вставку данных в таблицу [Distributed](/engines/table-engines/special/distributed).

По умолчанию, при вставке данных в таблицу `Distributed`, сервер ClickHouse отправляет данные узлам кластера в фоновом режиме. Когда `distributed_foreground_insert=1`, данные обрабатываются синхронно, и операция `INSERT` завершается успешно только после того, как все данные сохранены на всех шардов (по крайней мере, одна реплика для каждого шарда, если `internal_replication` истина).

Возможные значения:

- 0 — Данные вставляются в фоновом режиме.
- 1 — Данные вставляются в синхронном режиме.

Значение по умолчанию для Cloud: `1`.

**Смотрите также**

- [Движок таблиц Distributed](/engines/table-engines/special/distributed)
- [Управление распределенными таблицами](/sql-reference/statements/system#managing-distributed-tables)

## distributed_group_by_no_merge {#distributed_group_by_no_merge}

Тип: UInt64

Значение по умолчанию: 0

Не объединять состояния агрегации с разных серверов для распределенной обработки запроса, это можно использовать, если совершенно точно известно, что на разных шардов разные ключи.

Возможные значения:

- `0` — Отключено (финальная обработка запроса выполняется на узле-инициаторе).
- `1` — Не объединять состояния агрегации с разных серверов для распределенной обработки запроса (запрос полностью обрабатывается на шарде, инициатор только проксирует данные), можно использовать, если совершенно точно известно, что на разных шардов разные ключи.
- `2` — То же самое, что и `1`, но применяет `ORDER BY` и `LIMIT` (это невозможно, когда запрос полностью обрабатывается на удаленном узле, как для `distributed_group_by_no_merge=1`) на инициаторе (можно использовать для запросов с `ORDER BY` и/или `LIMIT`).

**Пример**

```sql
SELECT *
FROM remote('127.0.0.{2,3}', system.one)
GROUP BY dummy
LIMIT 1
SETTINGS distributed_group_by_no_merge = 1
FORMAT PrettyCompactMonoBlock

┌─dummy─┐
│     0 │
│     0 │
└───────┘
```

```sql
SELECT *
FROM remote('127.0.0.{2,3}', system.one)
GROUP BY dummy
LIMIT 1
SETTINGS distributed_group_by_no_merge = 2
FORMAT PrettyCompactMonoBlock

┌─dummy─┐
│     0 │
└───────┘
```

## distributed_insert_skip_read_only_replicas {#distributed_insert_skip_read_only_replicas}

Тип: Bool

Значение по умолчанию: 0

Включает пропуск реплик только для чтения для запросов INSERT в Distributed.

Возможные значения:

- 0 — INSERT выполняется как обычно, если он попадает на реплику только для чтения, это завершится неудачей.
- 1 — Инициатор пропустит реплики только для чтения перед отправкой данных на шард.

## distributed_product_mode {#distributed_product_mode}

Тип: DistributedProductMode

Значение по умолчанию: deny

Меняет поведение [распределенных подзапросов](../../sql-reference/operators/in.md).

ClickHouse применяет эту настройку, когда запрос содержит произведение распределенных таблиц, т.е. когда запрос для распределенной таблицы содержит подзапрос для распределенной таблицы, не являющийся GLOBAL.

Ограничения:

- Применяется только для подзапросов IN и JOIN.
- Только если раздел FROM использует распределенную таблицу, содержащую более одного шард.
- Если подзапрос касается распределенной таблицы, содержащей более одного шард.
- Не используется для функции [remote](../../sql-reference/table-functions/remote.md) с таблицей.

Возможные значения:

- `deny` — Значение по умолчанию. Запрещает использование таких типов подзапросов (возвращает исключение "Double-distributed in/JOIN subqueries is denied").
- `local` — Заменяет базу данных и таблицу в подзапросе на локальные для сервера назначения (шарда), оставляя обычные `IN`/`JOIN`.
- `global` — Заменяет запрос `IN`/`JOIN` на `GLOBAL IN`/`GLOBAL JOIN`.
- `allow` — Позволяет использование этих типов подзапросов.

## distributed_push_down_limit {#distributed_push_down_limit}

Тип: UInt64

Значение по умолчанию: 1

Включает или отключает применение [LIMIT](#limit) на каждом шарде отдельно.

Это позволит избежать:
- Отправки лишних строк по сети;
- Обработки строк, превышающих лимит, на инициаторе.

Начиная с версии 21.9, вы больше не можете получать неточные результаты, так как `distributed_push_down_limit` изменяет выполнение запроса только в случае, если выполнено хотя бы одно из условий:
- [distributed_group_by_no_merge](#distributed_group_by_no_merge) > 0.
- Запрос **не содержит** `GROUP BY`/`DISTINCT`/`LIMIT BY`, но имеет `ORDER BY`/`LIMIT`.
- Запрос **содержит** `GROUP BY`/`DISTINCT`/`LIMIT BY` с `ORDER BY`/`LIMIT` и:
    - [optimize_skip_unused_shards](#optimize_skip_unused_shards) включен.
    - [optimize_distributed_group_by_sharding_key](#optimize_distributed_group_by_sharding_key) включен.

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

Смотрите также:

- [distributed_group_by_no_merge](#distributed_group_by_no_merge)
- [optimize_skip_unused_shards](#optimize_skip_unused_shards)
- [optimize_distributed_group_by_sharding_key](#optimize_distributed_group_by_sharding_key)

## distributed_replica_error_cap {#distributed_replica_error_cap}

Тип: UInt64

Значение по умолчанию: 1000

- Тип: беззнаковое целое
- Значение по умолчанию: 1000

Количество ошибок в каждой реплике ограничивается этим значением, что предотвращает накапливание слишком большого количества ошибок в одной реплике.

Смотрите также:

- [load_balancing](#load_balancing-round_robin)
- [Движок таблиц Distributed](../../engines/table-engines/special/distributed.md)
- [distributed_replica_error_half_life](#distributed_replica_error_half_life)
- [distributed_replica_max_ignored_errors](#distributed_replica_max_ignored_errors)

## distributed_replica_error_half_life {#distributed_replica_error_half_life}

Тип: Seconds

Значение по умолчанию: 60

- Тип: секунды
- Значение по умолчанию: 60 секунд

Контролирует, как быстро ошибки в распределенных таблицах обнуляются. Если реплика недоступна в течение некоторого времени, накапливает 5 ошибок, и значение distributed_replica_error_half_life установлено в 1 секунду, то реплика считается нормальной через 3 секунды после последней ошибки.

Смотрите также:

- [load_balancing](#load_balancing-round_robin)
- [Движок таблиц Distributed](../../engines/table-engines/special/distributed.md)
- [distributed_replica_error_cap](#distributed_replica_error_cap)
- [distributed_replica_max_ignored_errors](#distributed_replica_max_ignored_errors)

## distributed_replica_max_ignored_errors {#distributed_replica_max_ignored_errors}

Тип: UInt64

Значение по умолчанию: 0

- Тип: беззнаковое целое
- Значение по умолчанию: 0

Количество ошибок, которое будет игнорироваться при выборе реплик (в соответствии с алгоритмом `load_balancing`).

Смотрите также:

- [load_balancing](#load_balancing-round_robin)
- [Движок таблиц Distributed](../../engines/table-engines/special/distributed.md)
- [distributed_replica_error_cap](#distributed_replica_error_cap)
- [distributed_replica_error_half_life](#distributed_replica_error_half_life)

## do_not_merge_across_partitions_select_final {#do_not_merge_across_partitions_select_final}

Тип: Bool

Значение по умолчанию: 0

Объединять части только в одной партиции в select final.

## empty_result_for_aggregation_by_constant_keys_on_empty_set {#empty_result_for_aggregation_by_constant_keys_on_empty_set}

Тип: Bool

Значение по умолчанию: 1

Возвращать пустой результат при агрегации по постоянным ключам на пустом наборе.

## empty_result_for_aggregation_by_empty_set {#empty_result_for_aggregation_by_empty_set}

Тип: Bool

Значение по умолчанию: 0

Возвращать пустой результат при агрегации без ключей на пустом наборе.

## enable_adaptive_memory_spill_scheduler {#enable_adaptive_memory_spill_scheduler}
<ExperimentalBadge/>

Тип: Bool

Значение по умолчанию: 0

Активирует процессор для адаптивной выгрузки данных во внешнее хранилище. В настоящее время поддерживается grace join.

## enable_blob_storage_log {#enable_blob_storage_log}

Тип: Bool

Значение по умолчанию: 1

Записывать информацию о операциях хранилища blob в таблицу system.blob_storage_log.

## enable_deflate_qpl_codec {#enable_deflate_qpl_codec}

Тип: Bool

Значение по умолчанию: 0

Если включено, кодек DEFLATE_QPL может быть использован для сжатия колонок.

## enable_early_constant_folding {#enable_early_constant_folding}

Тип: Bool

Значение по умолчанию: 1

Включает оптимизацию запроса, где мы анализируем результаты функций и подзапросов и переписываем запрос, если там есть константы.

## enable_extended_results_for_datetime_functions {#enable_extended_results_for_datetime_functions}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает возврат результатов типа:
- `Date32` с расширенным диапазоном (по сравнению с типом `Date`) для функций [toStartOfYear](../../sql-reference/functions/date-time-functions.md/#tostartofyear), [toStartOfISOYear](../../sql-reference/functions/date-time-functions.md/#tostartofisoyear), [toStartOfQuarter](../../sql-reference/functions/date-time-functions.md/#tostartofquarter), [toStartOfMonth](../../sql-reference/functions/date-time-functions.md/#tostartofmonth), [toLastDayOfMonth](../../sql-reference/functions/date-time-functions.md/#tolastdayofmonth), [toStartOfWeek](../../sql-reference/functions/date-time-functions.md/#tostartofweek), [toLastDayOfWeek](../../sql-reference/functions/date-time-functions.md/#tolastdayofweek) и [toMonday](../../sql-reference/functions/date-time-functions.md/#tomonday).
- `DateTime64` с расширенным диапазоном (по сравнению с типом `DateTime`) для функций [toStartOfDay](../../sql-reference/functions/date-time-functions.md/#tostartofday), [toStartOfHour](../../sql-reference/functions/date-time-functions.md/#tostartofhour), [toStartOfMinute](../../sql-reference/functions/date-time-functions.md/#tostartofminute), [toStartOfFiveMinutes](../../sql-reference/functions/date-time-functions.md/#tostartoffiveminutes), [toStartOfTenMinutes](../../sql-reference/functions/date-time-functions.md/#tostartoftenminutes), [toStartOfFifteenMinutes](../../sql-reference/functions/date-time-functions.md/#tostartoffifteenminutes) и [timeSlot](../../sql-reference/functions/date-time-functions.md/#timeslot).

Возможные значения:

- 0 — Функции возвращают `Date` или `DateTime` для всех типов аргументов.
- 1 — Функции возвращают `Date32` или `DateTime64` для аргументов типа `Date32` или `DateTime64` и `Date` или `DateTime` в противном случае.

## enable_filesystem_cache {#enable_filesystem_cache}

Тип: Bool

Значение по умолчанию: 1

Использовать кэш для удаленной файловой системы. Эта настройка не включает и не выключает кэш для дисков (это должно быть сделано через конфигурацию диска), но позволяет обойти кэш для некоторых запросов, если это необходимо.

## enable_filesystem_cache_log {#enable_filesystem_cache_log}

Тип: Bool

Значение по умолчанию: 0

Разрешает записывать журнал кэширования файловой системы для каждого запроса.

## enable_filesystem_cache_on_write_operations {#enable_filesystem_cache_on_write_operations}

Тип: Bool

Значение по умолчанию: 0

Записывать в кэш при операциях записи. Для реальной работы эта настройка требует также быть добавленной в конфигурацию диска.

## enable_filesystem_read_prefetches_log {#enable_filesystem_read_prefetches_log}

Тип: Bool

Значение по умолчанию: 0

Записывать в system.filesystem prefetch_log во время запроса. Должен использоваться только для тестирования или отладки, не рекомендуется включать по умолчанию.

## enable_global_with_statement {#enable_global_with_statement}

Тип: Bool

Значение по умолчанию: 1

Распространять операторы WITH на запросы UNION и все подзапросы.

## enable_hdfs_pread {#enable_hdfs_pread}

Тип: Bool

Значение по умолчанию: 1

Включает или отключает функцию pread для файлов HDFS. По умолчанию используется `hdfsPread`. Если отключено, будут использованы `hdfsRead` и `hdfsSeek` для чтения файлов hdfs.

## enable_http_compression {#enable_http_compression}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает сжатие данных в ответе на HTTP-запрос.

Для получения дополнительной информации, читайте [описание HTTP интерфейса](../../interfaces/http.md).

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

## enable_job_stack_trace {#enable_job_stack_trace}

Тип: Bool

Значение по умолчанию: 1

Выводить стек вызовов создателя задания, когда задание вызывает исключение.

## enable_lightweight_delete {#enable_lightweight_delete}

Тип: Bool

Значение по умолчанию: 1

Включить легковесные мутации DELETE для таблиц MergeTree.

## enable_memory_bound_merging_of_aggregation_results {#enable_memory_bound_merging_of_aggregation_results}

Тип: Bool

Значение по умолчанию: 1

Включает стратегию объединения, ограниченную памятью, для агрегации.

## enable_multiple_prewhere_read_steps {#enable_multiple_prewhere_read_steps}

Тип: Bool

Значение по умолчанию: 1

Переместить больше условий из WHERE в PREWHERE и выполнять чтения с диска и фильтрацию в несколько этапов, если есть несколько условий, объединенных оператором AND.

## enable_named_columns_in_function_tuple {#enable_named_columns_in_function_tuple}

Тип: Bool

Значение по умолчанию: 0

Генерировать именованные кортежи в функции tuple(), когда все имена уникальны и могут считаться не заключенными в кавычки идентификаторами.

## enable_optimize_predicate_expression {#enable_optimize_predicate_expression}

Тип: Bool

Значение по умолчанию: 1

Включает сдвиг предикатов в запросах `SELECT`.

Сдвиг предикатов может значительно уменьшить сетевой трафик для распределенных запросов.

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

Использование

Рассмотрим следующие запросы:

1.  `SELECT count() FROM test_table WHERE date = '2018-10-10'`
2.  `SELECT count() FROM (SELECT * FROM test_table) WHERE date = '2018-10-10'`

Если `enable_optimize_predicate_expression = 1`, тогда время выполнения этих запросов будет равно, поскольку ClickHouse применяет `WHERE` к подзапросу во время его обработки.

Если `enable_optimize_predicate_expression = 0`, тогда время выполнения второго запроса будет намного больше, поскольку оператор `WHERE` применяется ко всем данным после завершения подзапроса.

## enable_optimize_predicate_expression_to_final_subquery {#enable_optimize_predicate_expression_to_final_subquery}

Тип: Bool

Значение по умолчанию: 1

Разрешает сдвиг предиката в финальный подзапрос.

## enable_order_by_all {#enable_order_by_all}

Тип: Bool

Значение по умолчанию: 1

Включает или отключает сортировку с синтаксисом `ORDER BY ALL`, смотрите [ORDER BY](../../sql-reference/statements/select/order-by.md).

Возможные значения:

- 0 — Отключить ORDER BY ALL.
- 1 — Включить ORDER BY ALL.

**Пример**

Запрос:

```sql
CREATE TABLE TAB(C1 Int, C2 Int, ALL Int) ENGINE=Memory();

INSERT INTO TAB VALUES (10, 20, 30), (20, 20, 10), (30, 10, 20);

SELECT * FROM TAB ORDER BY ALL; -- возвращает ошибку, что ALL неоднозначен

SELECT * FROM TAB ORDER BY ALL SETTINGS enable_order_by_all = 0;
```

Результат:

```text
┌─C1─┬─C2─┬─ALL─┐
│ 20 │ 20 │  10 │
│ 30 │ 10 │  20 │
│ 10 │ 20 │  30 │
└────┴────┴─────┘
```

## enable_parsing_to_custom_serialization {#enable_parsing_to_custom_serialization}

Тип: Bool

Значение по умолчанию: 1

Если true, данные могут быть разобраны непосредственно в колонки с пользовательской сериализацией (например, Sparse) в соответствии с подсказками для сериализации, полученными от таблицы.

## enable_positional_arguments {#enable_positional_arguments}

Тип: Bool

Значение по умолчанию: 1

Включает или отключает поддержку позиционных аргументов для операторов [GROUP BY](/sql-reference/statements/select/group-by), [LIMIT BY](../../sql-reference/statements/select/limit-by.md), [ORDER BY](../../sql-reference/statements/select/order-by.md).

Возможные значения:

- 0 — Позиционные аргументы не поддерживаются.
- 1 — Позиционные аргументы поддерживаются: номера колонок могут использоваться вместо имен колонок.

**Пример**

Запрос:

```sql
CREATE TABLE positional_arguments(one Int, two Int, three Int) ENGINE=Memory();

INSERT INTO positional_arguments VALUES (10, 20, 30), (20, 20, 10), (30, 10, 20);

SELECT * FROM positional_arguments ORDER BY 2,3;
```

Результат:

```text
┌─one─┬─two─┬─three─┐
│  30 │  10 │   20  │
│  20 │  20 │   10  │
│  10 │  20 │   30  │
└─────┴─────┴───────┘
```

## enable_reads_from_query_cache {#enable_reads_from_query_cache}

Тип: Bool

Значение по умолчанию: 1

Если включено, результаты запросов `SELECT` извлекаются из [кэша запросов](../query-cache.md).

Возможные значения:

- 0 - Отключено
- 1 - Включено

## enable_s3_requests_logging {#enable_s3_requests_logging}

Тип: Bool

Значение по умолчанию: 0

Включить очень явное логирование запросов S3. Имеет смысл только для отладки.

## enable_scalar_subquery_optimization {#enable_scalar_subquery_optimization}

Тип: Bool

Значение по умолчанию: 1

Если установлено в true, предотвращает (де)сериализацию больших скалярных значений из подзапросов и, возможно, избегает выполнения одного и того же подзапроса более одного раза.

## enable_sharing_sets_for_mutations {#enable_sharing_sets_for_mutations}

Тип: Bool

Значение по умолчанию: 1

Позволяет совместное использование объектов множеств, построенных для подзапросов IN, между различными задачами одной и той же мутации. Это снижает использование памяти и потребление CPU.

## enable_software_prefetch_in_aggregation {#enable_software_prefetch_in_aggregation}

Тип: Bool

Значение по умолчанию: 1

Включает использование программного предзагрузки в агрегации.

## enable_unaligned_array_join {#enable_unaligned_array_join}

Тип: Bool

Значение по умолчанию: 0

Разрешает ARRAY JOIN с несколькими массивами разного размера. Когда эта настройка включена, массивы будут изменены до самого длинного.

## enable_url_encoding {#enable_url_encoding}

Тип: Bool

Значение по умолчанию: 1

Позволяет включить/выключить декодирование/кодирование пути в uri в таблицах движка [URL](../../engines/table-engines/special/url.md).

Включено по умолчанию.
## enable_vertical_final {#enable_vertical_final}

Тип: Bool

Значение по умолчанию: 1

Если включено, удаляет дубликаты строк во время FINAL, помечая строки как удаленные и фильтруя их позже, вместо слияния строк.
## enable_writes_to_query_cache {#enable_writes_to_query_cache}

Тип: Bool

Значение по умолчанию: 1

Если включено, результаты запросов `SELECT` хранятся в [кэше запросов](../query-cache.md).

Возможные значения:

- 0 - Отключено
- 1 - Включено
## enable_zstd_qat_codec {#enable_zstd_qat_codec}

Тип: Bool

Значение по умолчанию: 0

Если включено, кодек ZSTD_QAT может быть использован для сжатия колонок.
## enforce_strict_identifier_format {#enforce_strict_identifier_format}

Тип: Bool

Значение по умолчанию: 0

Если включено, разрешено только использование идентификаторов, содержащих буквенно-цифровые символы и знаки подчеркивания.
## engine_file_allow_create_multiple_files {#engine_file_allow_create_multiple_files}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает создание нового файла при каждой вставке в таблицах файлового движка, если формат имеет суффикс (`JSON`, `ORC`, `Parquet` и т.д.). Если включено, при каждой вставке новый файл будет создан с именем, следуя этому шаблону:

`data.Parquet` -> `data.1.Parquet` -> `data.2.Parquet` и т.д.

Возможные значения:
- 0 — запрос `INSERT` добавляет новые данные в конец файла.
- 1 — запрос `INSERT` создает новый файл.
## engine_file_empty_if_not_exists {#engine_file_empty_if_not_exists}

Тип: Bool

Значение по умолчанию: 0

Позволяет выбирать данные из таблицы файлового движка без файла.

Возможные значения:
- 0 — запрос `SELECT` вызывает исключение.
- 1 — запрос `SELECT` возвращает пустой результат.
## engine_file_skip_empty_files {#engine_file_skip_empty_files}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает пропуск пустых файлов в таблицах движка [File](../../engines/table-engines/special/file.md).

Возможные значения:
- 0 — запрос `SELECT` вызывает исключение, если пустой файл несовместим с запрашиваемым форматом.
- 1 — запрос `SELECT` возвращает пустой результат для пустого файла.
## engine_file_truncate_on_insert {#engine_file_truncate_on_insert}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает обрезку перед вставкой в таблицы движка [File](../../engines/table-engines/special/file.md).

Возможные значения:
- 0 — запрос `INSERT` добавляет новые данные в конец файла.
- 1 — запрос `INSERT` заменяет существующее содержимое файла новыми данными.
## engine_url_skip_empty_files {#engine_url_skip_empty_files}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает пропуск пустых файлов в таблицах движка [URL](../../engines/table-engines/special/url.md).

Возможные значения:
- 0 — запрос `SELECT` вызывает исключение, если пустой файл несовместим с запрашиваемым форматом.
- 1 — запрос `SELECT` возвращает пустой результат для пустого файла.
## except_default_mode {#except_default_mode}

Тип: SetOperationMode

Значение по умолчанию: ALL

Устанавливает режим по умолчанию в запросе EXCEPT. Возможные значения: пустая строка, 'ALL', 'DISTINCT'. Если пустая, запрос без режима вызовет исключение.
## external_storage_connect_timeout_sec {#external_storage_connect_timeout_sec}

Тип: UInt64

Значение по умолчанию: 10

Тайм-аут подключения в секундах. СCurrently supported only for MySQL.
## external_storage_max_read_bytes {#external_storage_max_read_bytes}

Тип: UInt64

Значение по умолчанию: 0

Ограничивает максимальное количество байт, когда таблица с внешним движком должна сбрасывать исторические данные. В настоящее время поддерживается только для движка таблиц MySQL, движка базы данных и словаря. Если равно 0, этот параметр отключен.
## external_storage_max_read_rows {#external_storage_max_read_rows}

Тип: UInt64

Значение по умолчанию: 0

Ограничивает максимальное количество строк, когда таблица с внешним движком должна сбрасывать исторические данные. В настоящее время поддерживается только для движка таблиц MySQL, движка базы данных и словаря. Если равно 0, этот параметр отключен.
## external_storage_rw_timeout_sec {#external_storage_rw_timeout_sec}

Тип: UInt64

Значение по умолчанию: 300

Тайм-аут на чтение/запись в секундах. В настоящее время поддерживается только для MySQL.
## external_table_functions_use_nulls {#external_table_functions_use_nulls}

Тип: Bool

Значение по умолчанию: 1

Определяет, как таблицы функций [mysql](../../sql-reference/table-functions/mysql.md), [postgresql](../../sql-reference/table-functions/postgresql.md) и [odbc](../../sql-reference/table-functions/odbc.md) используют Nullable колонки.

Возможные значения:

- 0 — Табличная функция явно использует Nullable колонки.
- 1 — Табличная функция неявно использует Nullable колонки.

**Использование**

Если параметр установлен в `0`, табличная функция не создает Nullable колонки и вставляет значения по умолчанию вместо NULL. Это также применимо для NULL значений внутри массивов.
## external_table_strict_query {#external_table_strict_query}

Тип: Bool

Значение по умолчанию: 0

Если установлено в true, преобразование выражения в локальный фильтр запрещено для запросов к внешним таблицам.
## extract_key_value_pairs_max_pairs_per_row {#extract_key_value_pairs_max_pairs_per_row}

Тип: UInt64

Значение по умолчанию: 1000

Максимальное количество пар, которые могут быть сгенерированы функцией `extractKeyValuePairs`. Используется как защитный механизм против избыточного потребления памяти.
## extremes {#extremes}

Тип: Bool

Значение по умолчанию: 0

Указывает на необходимость подсчета крайних значений (минимумов и максимумов в колонках результата запроса). Принимает 0 или 1. По умолчанию 0 (отключено).
Дополнительную информацию смотрите в разделе "Крайние значения".
## fallback_to_stale_replicas_for_distributed_queries {#fallback_to_stale_replicas_for_distributed_queries}

Тип: Bool

Значение по умолчанию: 1

Принудительно выполняет запрос к устаревшей реплике, если обновленные данные недоступны. См. [Репликация](../../engines/table-engines/mergetree-family/replication.md).

ClickHouse выбирает наиболее актуальную среди устаревших реплик таблицы.

Используется при выполнении `SELECT` из распределенной таблицы, указывающей на реплицированные таблицы.

По умолчанию 1 (включено).
## filesystem_cache_boundary_alignment {#filesystem_cache_boundary_alignment}

Тип: UInt64

Значение по умолчанию: 0

Выравнивание границ кэша файловой системы. Этот параметр применяется только для н-дискового чтения (например, для кэша удаленных движков таблиц / табличных функций, но не для конфигурации хранилища таблиц MergeTree). Значение 0 означает отсутствие выравнивания.
## filesystem_cache_enable_background_download_during_fetch {#filesystem_cache_enable_background_download_during_fetch}

<CloudAvailableBadge/>

Тип: Bool

Значение по умолчанию: 1

Действует только в ClickHouse Cloud. Время ожидания для блокировки кэша для резервирования пространства в кэше файловой системы.
## filesystem_cache_enable_background_download_for_metadata_files_in_packed_storage {#filesystem_cache_enable_background_download_for_metadata_files_in_packed_storage}

<CloudAvailableBadge/>

Тип: Bool

Значение по умолчанию: 1

Действует только в ClickHouse Cloud. Время ожидания для блокировки кэша для резервирования пространства в кэше файловой системы.
## filesystem_cache_max_download_size {#filesystem_cache_max_download_size}

Тип: UInt64

Значение по умолчанию: 137438953472

Максимальный размер удаленного кэша файловой системы, который может быть загружен одним запросом.
## filesystem_cache_name {#filesystem_cache_name}

Тип: String

Значение по умолчанию: 

Имя кэша файловой системы, используемого для статeless движков таблиц или озер данных.
## filesystem_cache_prefer_bigger_buffer_size {#filesystem_cache_prefer_bigger_buffer_size}

Тип: Bool

Значение по умолчанию: 1

Предпочитайте больший размер буфера, если кэш файловой системы включен, чтобы избегать записи маленьких сегментов файлов, которые ухудшают производительность кэша. С другой стороны, включение этого параметра может увеличить потребление памяти.
## filesystem_cache_reserve_space_wait_lock_timeout_milliseconds {#filesystem_cache_reserve_space_wait_lock_timeout_milliseconds}

Тип: UInt64

Значение по умолчанию: 1000

Время ожидания для блокировки кэша для резервирования пространства в кэше файловой системы.
## filesystem_cache_segments_batch_size {#filesystem_cache_segments_batch_size}

Тип: UInt64

Значение по умолчанию: 20

Ограничение на размер одной партии сегментов файлов, которую буфер чтения может запросить из кэша. Слишком низкое значение приведет к избыточным запросам к кэшу, слишком большое может замедлить вытеснение из кэша.
## filesystem_cache_skip_download_if_exceeds_per_query_cache_write_limit {#filesystem_cache_skip_download_if_exceeds_per_query_cache_write_limit}

Тип: Bool

Значение по умолчанию: 1

Пропустить загрузку из удаленной файловой системы, если превышен размер кэша запроса.
## filesystem_prefetch_max_memory_usage {#filesystem_prefetch_max_memory_usage}

Тип: UInt64

Значение по умолчанию: 1073741824

Максимальное потребление памяти для предвыборок.
## filesystem_prefetch_step_bytes {#filesystem_prefetch_step_bytes}

Тип: UInt64

Значение по умолчанию: 0

Шаг предвыборки в байтах. Ноль означает `auto` - приближенный лучший шаг предвыборки будет автоматически определен, но может не быть точно лучшим. Фактическое значение может отличаться из-за параметра filesystem_prefetch_min_bytes_for_single_read_task.
## filesystem_prefetch_step_marks {#filesystem_prefetch_step_marks}

Тип: UInt64

Значение по умолчанию: 0

Шаг предвыборки в метках. Ноль означает `auto` - приближенный лучший шаг предвыборки будет автоматически определен, но может не быть точно лучшим. Фактическое значение может отличаться из-за параметра filesystem_prefetch_min_bytes_for_single_read_task.
## filesystem_prefetches_limit {#filesystem_prefetches_limit}

Тип: UInt64

Значение по умолчанию: 200

Максимальное количество предвыборок. Ноль означает без ограничений. Параметр `filesystem_prefetches_max_memory_usage` более рекомендуется, если вы хотите ограничить количество предвыборок.
## final {#final}

Тип: Bool

Значение по умолчанию: 0

Автоматически применяет модификатор [FINAL](../../sql-reference/statements/select/from.md/#final-modifier) ко всем таблицам в запросе, к таблицам, к которым применим [FINAL](../../sql-reference/statements/select/from.md/#final-modifier), включая присоединенные таблицы и таблицы в подзапросах, а также распределенным таблицам.

Возможные значения:

- 0 - отключено
- 1 - включено

Пример:

```sql
CREATE TABLE test
(
    key Int64,
    some String
)
ENGINE = ReplacingMergeTree
ORDER BY key;

INSERT INTO test FORMAT Values (1, 'first');
INSERT INTO test FORMAT Values (1, 'second');

SELECT * FROM test;
┌─key─┬─some───┐
│   1 │ second │
└─────┴────────┘
┌─key─┬─some──┐
│   1 │ first │
└─────┴───────┘

SELECT * FROM test SETTINGS final = 1;
┌─key─┬─some───┐
│   1 │ second │
└─────┴────────┘

SET final = 1;
SELECT * FROM test;
┌─key─┬─some───┐
│   1 │ second │
└─────┴────────┘
```
## flatten_nested {#flatten_nested}

Тип: Bool

Значение по умолчанию: 1

Устанавливает формат данных сложных [nested](../../sql-reference/data-types/nested-data-structures/index.md) колонок.

Возможные значения:

- 1 — Сложная колонка преобразуется в отдельные массивы.
- 0 — Сложная колонка остается одним массивом кортежей.

**Использование**

Если параметр установлен в `0`, можно использовать произвольный уровень вложенности.

**Примеры**

Запрос:

```sql
SET flatten_nested = 1;
CREATE TABLE t_nest (`n` Nested(a UInt32, b UInt32)) ENGINE = MergeTree ORDER BY tuple();

SHOW CREATE TABLE t_nest;
```

Результат:

```text
┌─statement───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ CREATE TABLE default.t_nest
(
    `n.a` Array(UInt32),
    `n.b` Array(UInt32)
)
ENGINE = MergeTree
ORDER BY tuple()
SETTINGS index_granularity = 8192 │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

Запрос:

```sql
SET flatten_nested = 0;

CREATE TABLE t_nest (`n` Nested(a UInt32, b UInt32)) ENGINE = MergeTree ORDER BY tuple();

SHOW CREATE TABLE t_nest;
```

Результат:

```text
┌─statement──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ CREATE TABLE default.t_nest
(
    `n` Nested(a UInt32, b UInt32)
)
ENGINE = MergeTree
ORDER BY tuple()
SETTINGS index_granularity = 8192 │
└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```
## force_aggregate_partitions_independently {#force_aggregate_partitions_independently}

Тип: Bool

Значение по умолчанию: 0

Принуждает к применению оптимизации, когда это возможно, но эвристика решила ее не применять.
## force_aggregation_in_order {#force_aggregation_in_order}

Тип: Bool

Значение по умолчанию: 0

Настройка используется самим сервером для поддержки распределенных запросов. Не изменяйте его вручную, поскольку это нарушит нормальную работу. (Принуждает к использованию агрегации по порядку на удаленных узлах во время распределенной агрегации).
## force_data_skipping_indices {#force_data_skipping_indices}

Тип: String

Значение по умолчанию: 

Отключает выполнение запроса, если переданные индексы пропуска данных не были использованы.

Рассмотрим следующий пример:

```sql
CREATE TABLE data
(
    key Int,
    d1 Int,
    d1_null Nullable(Int),
    INDEX d1_idx d1 TYPE minmax GRANULARITY 1,
    INDEX d1_null_idx assumeNotNull(d1_null) TYPE minmax GRANULARITY 1
)
Engine=MergeTree()
ORDER BY key;

SELECT * FROM data_01515;
SELECT * FROM data_01515 SETTINGS force_data_skipping_indices=''; -- запрос вызовет ошибку CANNOT_PARSE_TEXT.
SELECT * FROM data_01515 SETTINGS force_data_skipping_indices='d1_idx'; -- запрос вызовет ошибку INDEX_NOT_USED.
SELECT * FROM data_01515 WHERE d1 = 0 SETTINGS force_data_skipping_indices='d1_idx'; -- Ок.
SELECT * FROM data_01515 WHERE d1 = 0 SETTINGS force_data_skipping_indices='`d1_idx`'; -- Ок (пример полного парсера).
SELECT * FROM data_01515 WHERE d1 = 0 AND assumeNotNull(d1_null) = 0 SETTINGS force_data_skipping_indices='`d1_idx`, d1_null_idx'; -- Ок.
```
## force_grouping_standard_compatibility {#force_grouping_standard_compatibility}

Тип: Bool

Значение по умолчанию: 1

Заставляет функцию GROUPING возвращать 1, когда аргумент не используется в качестве ключа агрегации.
## force_index_by_date {#force_index_by_date}

Тип: Bool

Значение по умолчанию: 0

Отключает выполнение запроса, если индекс не может быть использован по дате.

Работает с таблицами в семье MergeTree.

Если `force_index_by_date=1`, ClickHouse проверяет, есть ли в запросе условие по дате, которое может быть использовано для ограничения диапазонов данных. Если нет подходящего условия, будет выброшено исключение. Однако не проверяется, уменьшает ли условие количество данных для чтения. Например, условие `Date != ' 2000-01-01 '` допустимо, даже если оно соответствует всем данным в таблице (т.е. выполнение запроса требует полного сканирования). Дополнительную информацию о диапазонах данных в таблицах MergeTree см. в [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md).
## force_optimize_projection {#force_optimize_projection}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает обязательное использование [проекций](../../engines/table-engines/mergetree-family/mergetree.md/#projections) в запросах `SELECT`, когда оптимизация проекций включена (см. параметр [optimize_use_projections](#optimize_use_projections)).

Возможные значения:

- 0 — Оптимизация проекций не является обязательной.
- 1 — Оптимизация проекций обязательна.
## force_optimize_projection_name {#force_optimize_projection_name}

Тип: String

Значение по умолчанию: 

Если установлено в непустую строку, проверьте, что эта проекция используется в запросе хотя бы раз.

Возможные значения:

- строка: название проекции, которая используется в запросе.
## force_optimize_skip_unused_shards {#force_optimize_skip_unused_shards}

Тип: UInt64

Значение по умолчанию: 0

Включает или отключает выполнение запроса, если включен [optimize_skip_unused_shards](#optimize_skip_unused_shards) и пропуск неиспользуемых шардов невозможен. Если пропуск невозможен и настройка включена, будет выброшено исключение.

Возможные значения:

- 0 — Отключено. ClickHouse не выбрасывает исключение.
- 1 — Включено. Выполнение запроса отключается только в случае, если у таблицы есть ключ шардирования.
- 2 — Включено. Выполнение запроса отключается независимо от того, определен ли ключ шардирования для таблицы.
## force_optimize_skip_unused_shards_nesting {#force_optimize_skip_unused_shards_nesting}

Тип: UInt64

Значение по умолчанию: 0

Контролирует [`force_optimize_skip_unused_shards`](#force_optimize_skip_unused_shards) (тем самым все еще требует [`force_optimize_skip_unused_shards`](#force_optimize_skip_unused_shards)) в зависимости от уровня вложенности распределенного запроса (в случае, если у вас есть `Distributed` таблица, которая обращается к другой `Distributed` таблице).

Возможные значения:

- 0 - Отключено, `force_optimize_skip_unused_shards` работает всегда.
- 1 — Включает `force_optimize_skip_unused_shards` только для первого уровня.
- 2 — Включает `force_optimize_skip_unused_shards` до второго уровня.
## force_primary_key {#force_primary_key}

Тип: Bool

Значение по умолчанию: 0

Отключает выполнение запроса, если индексация по первичному ключу невозможна.

Работает с таблицами в семье MergeTree.

Если `force_primary_key=1`, ClickHouse проверяет, есть ли в запросе условие по первичному ключу, которое может быть использовано для ограничения диапазонов данных. Если нет подходящего условия, будет выброшено исключение. Однако не проверяется, уменьшает ли условие количество данных для чтения. Дополнительную информацию о диапазонах данных в таблицах MergeTree см. в [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md).
## force_remove_data_recursively_on_drop {#force_remove_data_recursively_on_drop}

Тип: Bool

Значение по умолчанию: 0

Рекурсивно удаляет данные по запросу DROP. Избегает ошибки 'Директория не пуста', но может незаметно удалить отвязанные данные.
## formatdatetime_f_prints_scale_number_of_digits {#formatdatetime_f_prints_scale_number_of_digits}

Тип: Bool

Значение по умолчанию: 0

Форматтер '%f' в функции 'formatDateTime' печатает только количество цифр масштаба для DateTime64 вместо фиксированных 6 цифр.
## formatdatetime_f_prints_single_zero {#formatdatetime_f_prints_single_zero}

Тип: Bool

Значение по умолчанию: 0

Форматтер '%f' в функции 'formatDateTime' печатает одиночный ноль вместо шести нулей, если отформатированное значение не имеет дробных секунд.
## formatdatetime_format_without_leading_zeros {#formatdatetime_format_without_leading_zeros}

Тип: Bool

Значение по умолчанию: 0

Форматтеры '%c', '%l' и '%k' в функции 'formatDateTime' печатают месяцы и часы без лидирующих нулей.
## formatdatetime_parsedatetime_m_is_month_name {#formatdatetime_parsedatetime_m_is_month_name}

Тип: Bool

Значение по умолчанию: 1

Форматтер '%M' в функциях 'formatDateTime' и 'parseDateTime' печатает/разбирает имя месяца вместо минут.
## fsync_metadata {#fsync_metadata}

Тип: Bool

Значение по умолчанию: 1

Включает или отключает [fsync](http://pubs.opengroup.org/onlinepubs/9699919799/functions/fsync.html) при записи `.sql` файлов. Включено по умолчанию.

Имеет смысл отключать его, если сервер имеет миллионы маленьких таблиц, которые постоянно создаются и удаляются.
## function_implementation {#function_implementation}

Тип: String

Значение по умолчанию: 

Выбор реализации функции для конкретной цели или варианта (экспериментального). Если пусто, включите все из них.
## function_json_value_return_type_allow_complex {#function_json_value_return_type_allow_complex}

Тип: Bool

Значение по умолчанию: 0

Контроль, разрешено ли возвращать сложный тип (например: struct, array, map) для функции json_value.

```sql
SELECT JSON_VALUE('{"hello":{"world":"!"}}', '$.hello') settings function_json_value_return_type_allow_complex=true

┌─JSON_VALUE('{"hello":{"world":"!"}}', '$.hello')─┐
│ {"world":"!"}                                    │
└──────────────────────────────────────────────────┘

1 row in set. Elapsed: 0.001 sec.
```

Возможные значения:

- true — Разрешить.
- false — Запретить.
## function_json_value_return_type_allow_nullable {#function_json_value_return_type_allow_nullable}

Тип: Bool

Значение по умолчанию: 0

Контроль, разрешено ли возвращать `NULL`, когда значение не существует для функции JSON_VALUE.

```sql
SELECT JSON_VALUE('{"hello":"world"}', '$.b') settings function_json_value_return_type_allow_nullable=true;

┌─JSON_VALUE('{"hello":"world"}', '$.b')─┐
│ ᴺᵁᴸᴸ                                   │
└────────────────────────────────────────┘

1 row in set. Elapsed: 0.001 sec.
```

Возможные значения:

- true — Разрешить.
- false — Запретить.
## function_locate_has_mysql_compatible_argument_order {#function_locate_has_mysql_compatible_argument_order}

Тип: Bool

Значение по умолчанию: 1

Контролирует порядок аргументов в функции [locate](../../sql-reference/functions/string-search-functions.md/#locate).

Возможные значения:

- 0 — Функция `locate` принимает аргументы `(haystack, needle[, start_pos])`.
- 1 — Функция `locate` принимает аргументы `(needle, haystack[, start_pos])` (совместимое с MySQL поведение).
## function_range_max_elements_in_block {#function_range_max_elements_in_block}

Тип: UInt64

Значение по умолчанию: 500000000

Устанавливает предельное значение для объема данных, генерируемых функцией [range](/sql-reference/functions/array-functions#rangeend-rangestart--end--step). Определяет максимальное количество значений, создаваемых функцией на блок данных (сумма размеров массивов для каждой строки в блоке).

Возможные значения:

- Положительное целое число.

**См. также**

- [max_block_size](#max_block_size)
- [min_insert_block_size_rows](#min_insert_block_size_rows)
## function_sleep_max_microseconds_per_block {#function_sleep_max_microseconds_per_block}

Тип: UInt64

Значение по умолчанию: 3000000

Максимальное количество микросекунд, в течение которых функция `sleep` может спать за каждую блок. Если пользователь вызвал ее с большим значением, будет вызвано исключение. Это предельное значение.
## function_visible_width_behavior {#function_visible_width_behavior}

Тип: UInt64

Значение по умолчанию: 1

Версия поведения `visibleWidth`. 0 - только считать количество символов; 1 - правильно считать символы нулевой ширины и комбинирующие символы, считать полуширокие символы как два, оценивать ширину табуляции, учитывать символы удаления.
## geo_distance_returns_float64_on_float64_arguments {#geo_distance_returns_float64_on_float64_arguments}

Тип: Bool

Значение по умолчанию: 1

Если все четыре аргумента для `geoDistance`, `greatCircleDistance`, `greatCircleAngle` функции являются Float64, возвращать Float64 и использовать двойную точность для внутренних вычислений. В предыдущих версиях ClickHouse функции всегда возвращали Float32.
## glob_expansion_max_elements {#glob_expansion_max_elements}

Тип: UInt64

Значение по умолчанию: 1000

Максимальное количество допустимых адресов (для внешних хранилищ, табличных функций и т.д.).
## grace_hash_join_initial_buckets {#grace_hash_join_initial_buckets}
<ExperimentalBadge/>

Тип: NonZeroUInt64

Значение по умолчанию: 1

Начальное число ведер для грациозного хеш-джойна.
## grace_hash_join_max_buckets {#grace_hash_join_max_buckets}
<ExperimentalBadge/>

Тип: NonZeroUInt64

Значение по умолчанию: 1024

Лимит на количество ведер для грациозного хеш-джойна.
## group_by_overflow_mode {#group_by_overflow_mode}

Тип: OverflowModeGroupBy

Значение по умолчанию: throw

Устанавливает, что происходит, когда количество уникальных ключей для агрегации превышает лимит:
- `throw`: выбросить исключение
- `break`: остановить выполнение запроса и вернуть частичный результат
- `any`: продолжать агрегацию для ключей, которые попали в набор, но не добавлять новые ключи в набор.

Использование значения 'any' позволяет вам выполнить приближенную агрегацию GROUP BY. Качество
этого приближения зависит от статистической природы данных.
## group_by_two_level_threshold {#group_by_two_level_threshold}

Тип: UInt64

Значение по умолчанию: 100000

С какого числа ключей начинается двухуровневая агрегация. 0 - порог не установлен.
## group_by_two_level_threshold_bytes {#group_by_two_level_threshold_bytes}

Тип: UInt64

Значение по умолчанию: 50000000

С какого объема состояния агрегации в байтах начинается использование двухуровневой агрегации. 0 - порог не установлен. Двухуровневая агрегация используется, когда хотя бы один из порогов срабатывает.
## group_by_use_nulls {#group_by_use_nulls}

Тип: Bool

Значение по умолчанию: 0

Изменяет способ, которым [GROUP BY](https://sql-reference/statements/select/group-by) обрабатывает типы ключей агрегации.
Когда используются спецификаторы `ROLLUP`, `CUBE` или `GROUPING SETS`, некоторые ключи агрегации могут не использоваться для создания некоторых строк результата.
Столбцы для этих ключей заполняются либо значением по умолчанию, либо `NULL` в соответствующих строках в зависимости от этой настройки.

Возможные значения:

- 0 — По умолчанию используется значение для типа ключа агрегации для получения отсутствующих значений.
- 1 — ClickHouse выполняет `GROUP BY` так же, как это говорит стандарт SQL. Типы ключей агрегации преобразуются в [Nullable](/sql-reference/data-types/nullable). Столбцы для соответствующих ключей агрегации заполняются [NULL](/sql-reference/syntax#null) для строк, которые их не использовали.

См. также:

- [Клауза GROUP BY](/sql-reference/statements/select/group-by)
## h3togeo_lon_lat_result_order {#h3togeo_lon_lat_result_order}

Тип: Bool

Значение по умолчанию: 0

Функция 'h3ToGeo' возвращает (lon, lat), если true, иначе (lat, lon).
## handshake_timeout_ms {#handshake_timeout_ms}

Тип: Milliseconds

Значение по умолчанию: 10000

Тайм-аут в миллисекундах для получения пакета Hello от реплик во время рукопожатия.
## hdfs_create_new_file_on_insert {#hdfs_create_new_file_on_insert}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает создание нового файла при каждой вставке в таблицах движка HDFS. Если включено, при каждой вставке будет создан новый файл HDFS с именем, похожим на этот шаблон:

начальный: `data.Parquet.gz` -> `data.1.Parquet.gz` -> `data.2.Parquet.gz` и т.д.

Возможные значения:
- 0 — запрос `INSERT` добавляет новые данные в конец файла.
- 1 — запрос `INSERT` создает новый файл.
## hdfs_ignore_file_doesnt_exist {#hdfs_ignore_file_doesnt_exist}

Тип: Bool

Значение по умолчанию: 0

Игнорировать отсутствие файла, если он не существует при чтении определенных ключей.

Возможные значения:
- 1 — запрос `SELECT` возвращает пустой результат.
- 0 — запрос `SELECT` вызывает исключение.
## hdfs_replication {#hdfs_replication}

Тип: UInt64

Значение по умолчанию: 0

Фактическое количество репликаций можно указать при создании файла hdfs.
## hdfs_skip_empty_files {#hdfs_skip_empty_files}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает пропуск пустых файлов в таблицах движка [HDFS](../../engines/table-engines/integrations/hdfs.md).

Возможные значения:
- 0 — запрос `SELECT` вызывает исключение, если пустой файл несовместим с запрашиваемым форматом.
- 1 — запрос `SELECT` возвращает пустой результат для пустого файла.
## hdfs_throw_on_zero_files_match {#hdfs_throw_on_zero_files_match}

Тип: Bool

Значение по умолчанию: 0

Выбросить ошибку, если не найдено ни одного соответствия файлов согласно правилам расширения glob.

Возможные значения:
- 1 — запрос `SELECT` вызывает исключение.
- 0 — запрос `SELECT` возвращает пустой результат.
## hdfs_truncate_on_insert {#hdfs_truncate_on_insert}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает обрезку перед вставкой в таблицы движка hdfs. Если отключено, на попытку вставки в существующий файл hdfs будет выброшено исключение.

Возможные значения:
- 0 — запрос `INSERT` добавляет новые данные в конец файла.
- 1 — запрос `INSERT` заменяет существующее содержимое файла новыми данными.
## hedged_connection_timeout_ms {#hedged_connection_timeout_ms}

Тип: Milliseconds

Значение по умолчанию: 50

Тайм-аут соединения для установления соединения с репликой для хеджированных запросов.
## hnsw_candidate_list_size_for_search {#hnsw_candidate_list_size_for_search}
<ExperimentalBadge/>

Тип: UInt64

Значение по умолчанию: 256

Размер динамического списка кандидатов при поиске индекса схожести векторов, также известного как 'ef_search'.
## hsts_max_age {#hsts_max_age}

Тип: UInt64

Значение по умолчанию: 0

Время истечения для HSTS. 0 означает отключение HSTS.
## http_connection_timeout {#http_connection_timeout}

Тип: Seconds

Значение по умолчанию: 1

Тайм-аут соединения HTTP (в секундах).

Возможные значения:

- Любое положительное целое число.
- 0 - Отключено (бессрочный тайм-аут).
## http_headers_progress_interval_ms {#http_headers_progress_interval_ms}

Тип: UInt64

Значение по умолчанию: 100

Не отправлять HTTP заголовки X-ClickHouse-Progress чаще, чем на каждом указанном интервале.
## http_make_head_request {#http_make_head_request}

Тип: Bool

Значение по умолчанию: 1

Параметр `http_make_head_request` позволяет выполнять запрос `HEAD` при чтении данных по HTTP для получения информации о файле, который будет прочитан, такую как его размер. Поскольку он включен по умолчанию, может быть желательным отключить этот параметр в случаях, когда сервер не поддерживает запросы `HEAD`.
## http_max_field_name_size {#http_max_field_name_size}

Тип: UInt64

Значение по умолчанию: 131072

Максимальная длина имени поля в HTTP заголовке.
## http_max_field_value_size {#http_max_field_value_size}

Тип: UInt64

Значение по умолчанию: 131072

Максимальная длина значения поля в HTTP заголовке.
## http_max_fields {#http_max_fields}

Тип: UInt64

Значение по умолчанию: 1000000

Максимальное количество полей в HTTP заголовке.
## http_max_multipart_form_data_size {#http_max_multipart_form_data_size}

Тип: UInt64

Значение по умолчанию: 1073741824

Ограничение на размер содержимого multipart/form-data. Этот параметр не может быть разобран из параметров URL и должен быть установлен в пользовательском профиле. Обратите внимание, что содержимое разбирается, и внешние таблицы создаются в памяти перед началом выполнения запроса. И это единственный лимит, который влияет на этот этап (лимиты на максимальное потребление памяти и максимальное время выполнения не влияют на чтение данных формы HTTP).
## http_max_request_param_data_size {#http_max_request_param_data_size}

Тип: UInt64

Значение по умолчанию: 10485760

Ограничение на размер данных запроса, используемых как параметр в предопределенных HTTP запросах.
## http_max_tries {#http_max_tries}

Тип: UInt64

Значение по умолчанию: 10

Максимальное количество попыток чтения через http.
## http_max_uri_size {#http_max_uri_size}

Тип: UInt64

Значение по умолчанию: 1048576

Устанавливает максимальную длину URI HTTP запроса.

Возможные значения:

- Положительное целое число.
```
## http_native_compression_disable_checksumming_on_decompress {#http_native_compression_disable_checksumming_on_decompress}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает проверку контрольной суммы при распаковке данных HTTP POST от клиента. Используется только для нативного формата сжатия ClickHouse (не применяется к `gzip` или `deflate`).

Для получения дополнительной информации см. [описание HTTP интерфейса](../../interfaces/http.md).

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

## http_receive_timeout {#http_receive_timeout}

Тип: Seconds

Значение по умолчанию: 30

Тайм-аут получения HTTP (в секундах).

Возможные значения:

- Любое положительное целое число.
- 0 - Отключено (бесконечный тайм-аут).

## http_response_buffer_size {#http_response_buffer_size}

Тип: UInt64

Значение по умолчанию: 0

Количество байт, которые нужно буферизовать в памяти сервера перед отправкой HTTP ответа клиенту или сбросом на диск (когда включен http_wait_end_of_query).

## http_response_headers {#http_response_headers}

Тип: Map

Значение по умолчанию: {}

Позволяет добавлять или переопределять HTTP заголовки, которые сервер вернет в ответе с успешным результатом запроса. Это влияет только на HTTP интерфейс.

Если заголовок уже установлен по умолчанию, предоставленное значение перезапишет его. Если заголовок не был установлен по умолчанию, он будет добавлен в список заголовков. Заголовки, которые устанавливает сервер по умолчанию и не переопределены этой настройкой, останутся.

Эта настройка позволяет установить заголовок на постоянное значение. В настоящее время нет возможности установить заголовок на динамически вычисляемое значение.

Ни имена, ни значения не могут содержать управляющие символы ASCII.

Если вы реализуете пользовательское приложение, которое позволяет пользователям изменять настройки, но одновременно принимает решения на основе возвращаемых заголовков, рекомендуется ограничить эту настройку только для чтения.

Пример: `SET http_response_headers = '{"Content-Type": "image/png"}'`

## http_retry_initial_backoff_ms {#http_retry_initial_backoff_ms}

Тип: UInt64

Значение по умолчанию: 100

Минимальное время в миллисекундах для отката, при повторной попытке чтения через http.

## http_retry_max_backoff_ms {#http_retry_max_backoff_ms}

Тип: UInt64

Значение по умолчанию: 10000

Максимальное время в миллисекундах для отката, при повторной попытке чтения через http.

## http_send_timeout {#http_send_timeout}

Тип: Seconds

Значение по умолчанию: 30

Тайм-аут отправки HTTP (в секундах).

Возможные значения:

- Любое положительное целое число.
- 0 - Отключено (бесконечный тайм-аут).

:::note
Это применимо только к профилю по умолчанию. Для применения изменений требуется перезагрузка сервера.
:::

## http_skip_not_found_url_for_globs {#http_skip_not_found_url_for_globs}

Тип: Bool

Значение по умолчанию: 1

Пропуск URL для глобусов с ошибкой HTTP_NOT_FOUND.

## http_wait_end_of_query {#http_wait_end_of_query}

Тип: Bool

Значение по умолчанию: 0

Включает буферизацию HTTP ответа на стороне сервера.

## http_write_exception_in_output_format {#http_write_exception_in_output_format}

Тип: Bool

Значение по умолчанию: 1

Записывает исключение в выходном формате, чтобы создать корректный вывод. Работает с форматами JSON и XML.

## http_zlib_compression_level {#http_zlib_compression_level}

Тип: Int64

Значение по умолчанию: 3

Устанавливает уровень сжатия данных в ответе на HTTP запрос, если [enable_http_compression = 1](#enable_http_compression).

Возможные значения: числа от 1 до 9.

## iceberg_snapshot_id {#iceberg_snapshot_id}

Тип: Int64

Значение по умолчанию: 0

Запрос таблицы Iceberg, используя конкретный идентификатор снимка.

## iceberg_timestamp_ms {#iceberg_timestamp_ms}

Тип: Int64

Значение по умолчанию: 0

Запрос таблицы Iceberg, используя снимок, который был актуален на определенный момент времени.

## idle_connection_timeout {#idle_connection_timeout}

Тип: UInt64

Значение по умолчанию: 3600

Тайм-аут закрытия неактивных TCP соединений после указанного количества секунд.

Возможные значения:

- Положительное целое число (0 - закрыть немедленно, после 0 секунд).

## ignore_cold_parts_seconds {#ignore_cold_parts_seconds}

<CloudAvailableBadge/>

Тип: Int64

Значение по умолчанию: 0

Влияет только в ClickHouse Cloud. Исключает новые части данных из SELECT запросов, пока они не будут предварительно прогреты (см. [cache_populated_by_fetch](merge-tree-settings.md/#cache_populated_by_fetch)) или не исполнилось указанное количество секунд. Только для Replicated-/SharedMergeTree.

## ignore_data_skipping_indices {#ignore_data_skipping_indices}

Тип: String

Значение по умолчанию: 

Игнорирует указанные индексы пропуска, если используются в запросе.

Рассмотрим следующий пример:

```sql
CREATE TABLE data
(
    key Int,
    x Int,
    y Int,
    INDEX x_idx x TYPE minmax GRANULARITY 1,
    INDEX y_idx y TYPE minmax GRANULARITY 1,
    INDEX xy_idx (x,y) TYPE minmax GRANULARITY 1
)
Engine=MergeTree()
ORDER BY key;

INSERT INTO data VALUES (1, 2, 3);

SELECT * FROM data;
SELECT * FROM data SETTINGS ignore_data_skipping_indices=''; -- запрос вызовет ошибку CANNOT_PARSE_TEXT.
SELECT * FROM data SETTINGS ignore_data_skipping_indices='x_idx'; -- ок.
SELECT * FROM data SETTINGS ignore_data_skipping_indices='na_idx'; -- ок.

SELECT * FROM data WHERE x = 1 AND y = 1 SETTINGS ignore_data_skipping_indices='xy_idx',force_data_skipping_indices='xy_idx' ; -- запрос вызовет ошибку INDEX_NOT_USED, так как xy_idx явно игнорируется.
SELECT * FROM data WHERE x = 1 AND y = 2 SETTINGS ignore_data_skipping_indices='xy_idx';
```

Запрос без игнорирования индексов:
```sql
EXPLAIN indexes = 1 SELECT * FROM data WHERE x = 1 AND y = 2;

Expression ((Projection + Before ORDER BY))
  Filter (WHERE)
    ReadFromMergeTree (default.data)
    Indexes:
      PrimaryKey
        Condition: true
        Parts: 1/1
        Granules: 1/1
      Skip
        Name: x_idx
        Description: minmax GRANULARITY 1
        Parts: 0/1
        Granules: 0/1
      Skip
        Name: y_idx
        Description: minmax GRANULARITY 1
        Parts: 0/0
        Granules: 0/0
      Skip
        Name: xy_idx
        Description: minmax GRANULARITY 1
        Parts: 0/0
        Granules: 0/0
```

Игнорирование индекса `xy_idx`:
```sql
EXPLAIN indexes = 1 SELECT * FROM data WHERE x = 1 AND y = 2 SETTINGS ignore_data_skipping_indices='xy_idx';

Expression ((Projection + Before ORDER BY))
  Filter (WHERE)
    ReadFromMergeTree (default.data)
    Indexes:
      PrimaryKey
        Condition: true
        Parts: 1/1
        Granules: 1/1
      Skip
        Name: x_idx
        Description: minmax GRANULARITY 1
        Parts: 0/1
        Granules: 0/1
      Skip
        Name: y_idx
        Description: minmax GRANULARITY 1
        Parts: 0/0
        Granules: 0/0
```

Работает с таблицами семейства MergeTree.

## ignore_drop_queries_probability {#ignore_drop_queries_probability}

Тип: Float

Значение по умолчанию: 0

Если включено, сервер будет игнорировать все запросы на DROP таблицы с указанной вероятностью (для Memory и JOIN движков заменит DROP на TRUNCATE). Используется в тестовых целях.

## ignore_materialized_views_with_dropped_target_table {#ignore_materialized_views_with_dropped_target_table}

Тип: Bool

Значение по умолчанию: 0

Игнорирует MVs с удаленной целевой таблицей при отправке в представления.

## ignore_on_cluster_for_replicated_access_entities_queries {#ignore_on_cluster_for_replicated_access_entities_queries}

Тип: Bool

Значение по умолчанию: 0

Игнорирует клаузу ON CLUSTER для запросов управления реплицированными сущностями доступа.

## ignore_on_cluster_for_replicated_named_collections_queries {#ignore_on_cluster_for_replicated_named_collections_queries}

Тип: Bool

Значение по умолчанию: 0

Игнорирует клаузу ON CLUSTER для запросов управления реплицированными именованными коллекциями.

## ignore_on_cluster_for_replicated_udf_queries {#ignore_on_cluster_for_replicated_udf_queries}

Тип: Bool

Значение по умолчанию: 0

Игнорирует клаузу ON CLUSTER для запросов управления реплицированными UDF.

## implicit_select {#implicit_select}

Тип: Bool

Значение по умолчанию: 0

Разрешает писать простые SELECT запросы без ключевого слова SELECT, что делает использование подобным калькуляторов простым, например, `1 + 2` становится допустимым запросом.

В `clickhouse-local` это включено по умолчанию и может быть явно отключено.

## implicit_transaction {#implicit_transaction}
<ExperimentalBadge/>

Тип: Bool

Значение по умолчанию: 0

Если включено и находитесь не внутри транзакции, оборачивает запрос в полную транзакцию (начало + завершение или откат).

## input_format_parallel_parsing {#input_format_parallel_parsing}

Тип: Bool

Значение по умолчанию: 1

Включает или отключает параллельный разбор форматов данных с сохранением порядка. Поддерживается только для форматов [TSV](../../interfaces/formats.md/#tabseparated), [TSKV](../../interfaces/formats.md/#tskv), [CSV](../../interfaces/formats.md/#csv) и [JSONEachRow](../../interfaces/formats.md/#jsoneachrow).

Возможные значения:

- 1 — Включено.
- 0 — Отключено.

## insert_allow_materialized_columns {#insert_allow_materialized_columns}

Тип: Bool

Значение по умолчанию: 0

Если настройка включена, разрешает использование материализованных колонок в INSERT.

## insert_deduplicate {#insert_deduplicate}

Тип: Bool

Значение по умолчанию: 1

Включает или отключает дедупликацию блоков при `INSERT` (для Replicated* таблиц).

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

По умолчанию блоки, вставленные в реплицированные таблицы с помощью оператора `INSERT`, дедуплицируются (см. [Репликация данных](../../engines/table-engines/mergetree-family/replication.md)). Для реплицированных таблиц по умолчанию только 100 самых недавних блоков для каждой партиции дедуплицируются (см. [replicated_deduplication_window](merge-tree-settings.md/#replicated-deduplication-window), [replicated_deduplication_window_seconds](merge-tree-settings.md/#replicated-deduplication-window-seconds)). Для нереплицированных таблиц см. [non_replicated_deduplication_window](merge-tree-settings.md/#non-replicated-dедупликация-окна).

## insert_deduplication_token {#insert_deduplication_token}

Тип: String

Значение по умолчанию: 

Настройка позволяет пользователю задать свою семантику дедупликации в MergeTree/ReplicatedMergeTree. Например, путем предоставления уникального значения для настройки в каждом операторе INSERT, пользователь может избежать дедупликации одинаковых вставленных данных.

Возможные значения:

- Любая строка.

`insert_deduplication_token` используется для дедупликации _только_ в случае, если он не пуст.

Для реплицированных таблиц по умолчанию только 100 самых недавних вставок для каждой партиции дедуплицируются (см. [replicated_deduplication_window](merge-tree-settings.md/#replicated-deduplication-window), [replicated_deduplication_window_seconds](merge-tree-settings.md/#replicated-deduplication-window-seconds)). Для нереплицированных таблиц см. [non_replicated_deduplication_window](merge-tree-settings.md/#non_replicated_deduplication-window).

:::note
`insert_deduplication_token` работает на уровне партиции (так же как и контрольная сумма `insert_deduplication`). Несколько партиций могут иметь одинаковый `insert_deduplication_token`.
:::

Пример:

```sql
CREATE TABLE test_table
( A Int64 )
ENGINE = MergeTree
ORDER BY A
SETTINGS non_replicated_deduplication_window = 100;

INSERT INTO test_table SETTINGS insert_deduplication_token = 'test' VALUES (1);

-- следующая вставка не будет дедуплицирована, потому что insert_deduplication_token отличается
INSERT INTO test_table SETTINGS insert_deduplication_token = 'test1' VALUES (1);

-- следующая вставка будет дедуплицирована, потому что insert_deduplication_token
-- совпадает с одним из предыдущих
INSERT INTO test_table SETTINGS insert_deduplication_token = 'test' VALUES (2);

SELECT * FROM test_table

┌─A─┐
│ 1 │
└───┘
┌─A─┐
│ 1 │
└───┘
```

## insert_keeper_fault_injection_probability {#insert_keeper_fault_injection_probability}

Тип: Float

Значение по умолчанию: 0

Приблизительная вероятность сбоя для запроса keeper во время вставки. Допустимое значение находится в диапазоне [0.0f, 1.0f].

## insert_keeper_fault_injection_seed {#insert_keeper_fault_injection_seed}

Тип: UInt64

Значение по умолчанию: 0

0 - случайное семя, иначе значение настройки.

## insert_keeper_max_retries {#insert_keeper_max_retries}

Тип: UInt64

Значение по умолчанию: 20

Настройка задает максимальное количество повторных попыток для запросов ClickHouse Keeper (или ZooKeeper) во время вставки в реплицированный MergeTree. Учитываются только запросы Keeper, которые не удались из-за сетевой ошибки, таймаута сессии Keeper или таймаута запроса.

Возможные значения:

- Положительное целое число.
- 0 — Повторные попытки отключены.

Значение по умолчанию для Cloud: `20`.

Повторные попытки запросов Keeper выполняются после определенного таймаута. Таймаут контролируется следующими настройками: `insert_keeper_retry_initial_backoff_ms`, `insert_keeper_retry_max_backoff_ms`. Первая повторная попытка выполняется после таймаута `insert_keeper_retry_initial_backoff_ms`. Последующие таймауты будут рассчитываться следующим образом:
```
timeout = min(insert_keeper_retry_max_backoff_ms, latest_timeout * 2)
```

Например, если `insert_keeper_retry_initial_backoff_ms=100`, `insert_keeper_retry_max_backoff_ms=10000` и `insert_keeper_max_retries=8`, тогда таймауты будут составлять `100, 200, 400, 800, 1600, 3200, 6400, 10000`.

Кроме отказоустойчивости, повторные попытки направлены на обеспечение лучшего пользовательского опыта - они позволяют избежать возврата ошибки во время выполнения INSERT, если Keeper, например, перезапускается из-за обновления.

## insert_keeper_retry_initial_backoff_ms {#insert_keeper_retry_initial_backoff_ms}

Тип: UInt64

Значение по умолчанию: 100

Начальный таймаут (в миллисекундах) для повторной попытки неудачного запроса Keeper во время выполнения запроса INSERT.

Возможные значения:

- Положительное целое число.
- 0 — Без таймаута.

## insert_keeper_retry_max_backoff_ms {#insert_keeper_retry_max_backoff_ms}

Тип: UInt64

Значение по умолчанию: 10000

Максимальный таймаут (в миллисекундах) для повторной попытки неудачного запроса Keeper во время выполнения запроса INSERT.

Возможные значения:

- Положительное целое число.
- 0 — Максимальный таймаут не ограничен.

## insert_null_as_default {#insert_null_as_default}

Тип: Bool

Значение по умолчанию: 1

Включает или отключает вставку [значений по умолчанию](/sql-reference/statements/create/table#default_values) вместо [NULL](/sql-reference/syntax#null) в колонки с не [nullable](/sql-reference/data-types/nullable) типом данных.
Если тип колонки не допускает NULL и эта настройка отключена, то вставка `NULL` вызывает исключение. Если тип колонки допускает NULL, то значения NULL вставляются как есть, независимо от этой настройки.

Эта настройка применима к запросам [INSERT ... SELECT](../../sql-reference/statements/insert-into.md/#inserting-the-results-of-select). Обратите внимание, что подзапросы `SELECT` могут быть объединены с клаузой `UNION ALL`.

Возможные значения:

- 0 — Вставка `NULL` в не допускаемую колонку вызывает исключение.
- 1 — Вставляется значение по умолчанию колонки вместо `NULL`.

## insert_quorum {#insert_quorum}

Тип: UInt64Auto

Значение по умолчанию: 0

:::note
Эта настройка не применяется к SharedMergeTree, смотрите [целостность SharedMergeTree](/cloud/reference/shared-merge-tree#consistency) для получения дополнительной информации.
:::

Включает записи по кворуму.

- Если `insert_quorum < 2`, записи по кворуму отключены.
- Если `insert_quorum >= 2`, записи по кворуму включены.
- Если `insert_quorum = 'auto'`, используйте число большинства (`number_of_replicas / 2 + 1`) в качестве числа кворума.

Записи по кворуму

`INSERT` успешен только при условии, что ClickHouse успевает корректно записать данные в `insert_quorum` реплик в течение `insert_quorum_timeout`. Если по любой причине количество реплик с успешными записями не достигает `insert_quorum`, запись считается неудачной, и ClickHouse удалит вставленный блок из всех реплик, куда данные уже были записаны.

Когда `insert_quorum_parallel` отключен, все реплики в кворуме согласованы, т.е. они содержат данные из всех предыдущих запросов `INSERT` (последовательность `INSERT` линеаризуется). При чтении данных, записанных с использованием `insert_quorum`, и `insert_quorum_parallel` отключен, вы можете включить последовательную согласованность для запросов `SELECT`, используя [select_sequential_consistency](#select_sequential_consistency).

ClickHouse генерирует исключение:

- Если количество доступных реплик во время запроса меньше, чем `insert_quorum`.
- Когда `insert_quorum_parallel` отключен и сделана попытка записи данных, когда предыдущий блок еще не был вставлен в `insert_quorum` реплик. Эта ситуация может возникнуть, если пользователь пытается выполнить другой запрос `INSERT` в ту же таблицу до завершения предыдущего с `insert_quorum`.

Смотрите также:

- [insert_quorum_timeout](#insert_quorum_timeout)
- [insert_quorum_parallel](#insert_quorum_parallel)
- [select_sequential_consistency](#select_sequential_consistency)

## insert_quorum_parallel {#insert_quorum_parallel}

Тип: Bool

Значение по умолчанию: 1

:::note
Эта настройка не применяется к SharedMergeTree, смотрите [целостность SharedMergeTree](/cloud/reference/shared-merge-tree#consistency) для получения дополнительной информации.
:::

Включает или отключает параллелизм для запросов `INSERT` с кворумом. Если включено, дополнительный запросы `INSERT` могут быть отправлены в то время, как предыдущие запросы еще не завершены. Если отключено, дополнительные записи в ту же таблицу будут отклонены.

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

Смотрите также:

- [insert_quorum](#insert_quorum)
- [insert_quorum_timeout](#insert_quorum_timeout)
- [select_sequential_consistency](#select_sequential_consistency)

## insert_quorum_timeout {#insert_quorum_timeout}

Тип: Milliseconds

Значение по умолчанию: 600000

Тайм-аут записи в кворум в миллисекундах. Если тайм-аут истекает и запись еще не произведена, ClickHouse сгенерирует исключение, и клиент должен повторить запрос, чтобы записать тот же блок в ту же или любую другую реплику.

Смотрите также:

- [insert_quorum](#insert_quorum)
- [insert_quorum_parallel](#insert_quorum_parallel)
- [select_sequential_consistency](#select_sequential_consistency)

## insert_shard_id {#insert_shard_id}

Тип: UInt64

Значение по умолчанию: 0

Если не `0`, указывает шард [распределенной](/engines/table-engines/special/distributed) таблицы, в которую данные будут вставлены синхронно.

Если значение `insert_shard_id` некорректно, сервер выбрасывает исключение.

Чтобы получить количество шардов на `requested_cluster`, вы можете проверить конфигурацию сервера или использовать следующий запрос:

```sql
SELECT uniq(shard_num) FROM system.clusters WHERE cluster = 'requested_cluster';
```

Возможные значения:

- 0 — Отключено.
- Любое число от `1` до `shards_num` соответствующей [распределенной](/engines/table-engines/special/distributed) таблицы.

**Пример**

Запрос:

```sql
CREATE TABLE x AS system.numbers ENGINE = MergeTree ORDER BY number;
CREATE TABLE x_dist AS x ENGINE = Distributed('test_cluster_two_shards_localhost', currentDatabase(), x);
INSERT INTO x_dist SELECT * FROM numbers(5) SETTINGS insert_shard_id = 1;
SELECT * FROM x_dist ORDER BY number ASC;
```

Результат:

```text
┌─number─┐
│      0 │
│      0 │
│      1 │
│      1 │
│      2 │
│      2 │
│      3 │
│      3 │
│      4 │
│      4 │
└────────┘
```

## interactive_delay {#interactive_delay}

Тип: UInt64

Значение по умолчанию: 100000

Интервал в микросекундах для проверки, отменено ли выполнение запроса и отправка прогресса.

## intersect_default_mode {#intersect_default_mode}

Тип: SetOperationMode

Значение по умолчанию: ALL

Устанавливает режим по умолчанию в запросе INTERSECT. Возможные значения: пустая строка, 'ALL', 'DISTINCT'. Если пусто, запрос без режима вызовет исключение.

## join_algorithm {#join_algorithm}

Тип: JoinAlgorithm

Значение по умолчанию: direct,parallel_hash,hash

Указывает, какой алгоритм [JOIN](../../sql-reference/statements/select/join.md) используется.

Можно указать несколько алгоритмов, и доступный будет выбран для конкретного запроса в зависимости от типа/строгости и движка таблицы.

Возможные значения:

- grace_hash

 Используется [Grace hash join](https://en.wikipedia.org/wiki/Hash_join#Grace_hash_join). Grace hash предоставляет вариант алгоритма, который обеспечивает производительные сложные соединения при ограничении использования памяти.

 Первый этап соединения grace считывает правую таблицу и разбивает ее на N бакетов в зависимости от хеш-значения ключевых столбцов (изначально N равно `grace_hash_join_initial_buckets`). Это делается так, чтобы гарантировать, что каждый бакет может обрабатываться независимо. Строки из первого бакета добавляются в хеш-таблицу в памяти, в то время как остальные сохраняются на диске. Если хеш-таблица превышает предел памяти (например, как установлено [max_bytes_in_join](/operations/settings/settings#max_bytes_in_join)), количество бакетов увеличивается, и для каждой строки назначается бакет. Любые строки, которые не принадлежат текущему бакету, сливаются и переназначаются.

 Поддерживает `INNER/LEFT/RIGHT/FULL ALL/ANY JOIN`.

- hash

 Используется [алгоритм Hash join](https://en.wikipedia.org/wiki/Hash_join). Это самая универсальная реализация, которая поддерживает все комбинации типа и строгости и несколько ключей соединения, которые объединяются с помощью `OR` в разделе `JOIN ON`.

 При использовании алгоритма `hash` правая часть `JOIN` загружается в ОЗУ.

- parallel_hash

 Вариация алгоритма `hash` join, которая разбивает данные на бакеты и строит несколько хеш-таблиц одновременно, чтобы ускорить этот процесс.

 При использовании алгоритма `parallel_hash` правая часть `JOIN` загружается в ОЗУ.

- partial_merge

 Вариация [алгоритма sort-merge](https://en.wikipedia.org/wiki/Sort-merge_join), где только правая таблица полностью отсортирована.

 `RIGHT JOIN` и `FULL JOIN` поддерживаются только со строгостью `ALL` (`SEMI`, `ANTI`, `ANY` и `ASOF` не поддерживаются).

 При использовании алгоритма `partial_merge` ClickHouse сортирует данные и сбрасывает их на диск. Алгоритм `partial_merge` в ClickHouse немного отличается от классической реализации. Сначала ClickHouse сортирует правую таблицу по ключам соединения в блоках и создает минимально-максимальный индекс для отсортированных блоков. Затем он сортирует части левой таблицы по `join key` и объединяет их с правой таблицей. Минимально-максимальный индекс также используется для пропуска ненужных блоков правой таблицы.

- direct

 Этот алгоритм может быть применен, когда хранилище для правой таблицы поддерживает запросы ключ-значение.

 Алгоритм `direct` выполняет поиск в правой таблице, используя строки из левой таблицы в качестве ключей. Его поддерживают только специальные хранилища, такие как [Dictionary](/engines/table-engines/special/dictionary) или [EmbeddedRocksDB](../../engines/table-engines/integrations/embedded-rocksdb.md) и только `LEFT` и `INNER` JOIN.

- auto

 При установке на `auto` сначала пробуется `hash` join, а алгоритм переключается на другой алгоритм, если нарушается предел памяти.

- full_sorting_merge

 [Алгоритм sort-merge](https://en.wikipedia.org/wiki/Sort-merge_join) с полной сортировкой соединенных таблиц перед объединением.

- prefer_partial_merge

 ClickHouse всегда старается использовать соединение `partial_merge`, если это возможно, в противном случае использует `hash`. *Устарело*, то же самое, что и `partial_merge,hash`.

- default (устарело)

 Устаревшее значение, пожалуйста, не используйте больше.
 То же самое, что и `direct,hash`, т.е. попытаться использовать прямое соединение и хеш-соединение (в этом порядке).

## join_any_take_last_row {#join_any_take_last_row}

Тип: Bool

Значение по умолчанию: 0

Изменяет поведение операций соединения с `ANY` строгим.

:::note
Эта настройка применяется только для операций `JOIN` с таблицами движка [Join](../../engines/table-engines/special/join.md).
:::

Возможные значения:

- 0 — Если правая таблица имеет более одной совпадающей строки, то соединяется только первая найденная.
- 1 — Если правая таблица имеет более одной совпадающей строки, то соединяется только последняя найденная.

Смотрите также:

- [Клауза JOIN](/sql-reference/statements/select/join)
- [Join table engine](../../engines/table-engines/special/join.md)
- [join_default_strictness](#join_default_strictness)

## join_default_strictness {#join_default_strictness}

Тип: JoinStrictness

Значение по умолчанию: ALL

Устанавливает строгость по умолчанию для [JOIN клауз](/sql-reference/statements/select/join).

Возможные значения:

- `ALL` — Если правая таблица имеет несколько совпадающих строк, ClickHouse создает [декартово произведение](https://en.wikipedia.org/wiki/Cartesian_product) из совпадающих строк. Это обычное поведение `JOIN` в стандартном SQL.
- `ANY` — Если правая таблица имеет несколько совпадающих строк, соединяется только первая найденная. Если правая таблица имеет только одну совпадающую строку, результаты `ANY` и `ALL` одинаковы.
- `ASOF` — Для соединения последовательностей с неопределенным совпадением.
- `Пустая строка` — Если `ALL` или `ANY` не указаны в запросе, ClickHouse вызывает исключение.

## join_on_disk_max_files_to_merge {#join_on_disk_max_files_to_merge}

Тип: UInt64

Значение по умолчанию: 64

Ограничивает количество файлов, разрешенных для параллельной сортировки в операциях MergeJoin, когда они выполняются на диске.

Чем больше значение настройки, тем больше используется ОЗУ и тем меньше требуется ввод-вывод на диске.

Возможные значения:

- Любое положительное целое число, начиная с 2.

## join_output_by_rowlist_perkey_rows_threshold {#join_output_by_rowlist_perkey_rows_threshold}

Тип: UInt64

Значение по умолчанию: 5

Нижний предел среднего количества строк по ключу в правой таблице, чтобы определить, следует ли выводить по списку строк в хеш-соединении.

## join_overflow_mode {#join_overflow_mode}

Тип: OverflowMode

Значение по умолчанию: throw

Определяет, какое действие ClickHouse выполняет, когда достигается любое из следующих ограничений соединения:

- [max_bytes_in_join](/operations/settings/settings#max_bytes_in_join)
- [max_rows_in_join](/operations/settings/settings#max_rows_in_join)

Возможные значения:

- `THROW` — ClickHouse генерирует исключение и завершает операцию.
- `BREAK` — ClickHouse завершает операцию и не генерирует исключение.

Значение по умолчанию: `THROW`.

**Смотрите также**

- [Клауза JOIN](/sql-reference/statements/select/join)
- [Join table engine](/engines/table-engines/special/join)

## join_to_sort_maximum_table_rows {#join_to_sort_maximum_table_rows}
<ExperimentalBadge/>

Тип: UInt64

Значение по умолчанию: 10000

Максимальное количество строк в правой таблице для определения, следует ли перераспределить правую таблицу по ключу в левом или внутреннем соединении.

## join_to_sort_minimum_perkey_rows {#join_to_sort_minimum_perkey_rows}
<ExperimentalBadge/>

Тип: UInt64

Значение по умолчанию: 40

Нижний предел среднего количества строк по ключу в правой таблице, чтобы определить, следует ли перераспределить правую таблицу по ключу в левом или внутреннем соединении. Эта настройка гарантирует, что оптимизация не применяется для разреженных ключей таблицы.

## join_use_nulls {#join_use_nulls}

Тип: Bool

Значение по умолчанию: 0

Устанавливает тип поведения [JOIN](../../sql-reference/statements/select/join.md). При объединении таблиц могут возникать пустые ячейки. ClickHouse заполняет их по-разному в зависимости от этой настройки.

Возможные значения:

- 0 — Пустые ячейки заполняются значением по умолчанию соответствующего типа поля.
- 1 — `JOIN` ведет себя так же, как в стандартном SQL. Тип соответствующего поля преобразуется в [Nullable](/sql-reference/data-types/nullable), и пустые ячейки заполняются [NULL](/sql-reference/syntax).

## joined_subquery_requires_alias {#joined_subquery_requires_alias}

Тип: Bool

Значение по умолчанию: 1

Заставляет присоединенные подзапросы и табличные функции иметь алиасы для корректной квализации имен.

## kafka_disable_num_consumers_limit {#kafka_disable_num_consumers_limit}

Тип: Bool

Значение по умолчанию: 0

Отключает ограничение на kafka_num_consumers, которое зависит от количества доступных CPU ядер.

## kafka_max_wait_ms {#kafka_max_wait_ms}

Тип: Milliseconds

Значение по умолчанию: 5000

Время ожидания в миллисекундах для чтения сообщений из [Kafka](/engines/table-engines/integrations/kafka) перед повторной попыткой.

Возможные значения:

- Положительное целое число.
- 0 — Бесконечный тайм-аут.

Смотрите также:

- [Apache Kafka](https://kafka.apache.org/)

## keeper_map_strict_mode {#keeper_map_strict_mode}

Тип: Bool

Значение по умолчанию: 0

Принуждает дополнительные проверки при операциях с KeeperMap. Например, выбрасывает исключение при вставке уже существующего ключа.

## keeper_max_retries {#keeper_max_retries}

Тип: UInt64

Значение по умолчанию: 10

Максимальное количество повторных попыток для общих операций keeper.

## keeper_retry_initial_backoff_ms {#keeper_retry_initial_backoff_ms}

Тип: UInt64

Значение по умолчанию: 100

Начальный таймаут перед повторной попыткой для общих операций keeper.

## keeper_retry_max_backoff_ms {#keeper_retry_max_backoff_ms}

Тип: UInt64

Значение по умолчанию: 5000

Максимальный таймаут перед повторной попыткой для общих операций keeper.

## least_greatest_legacy_null_behavior {#least_greatest_legacy_null_behavior}

Тип: Bool

Значение по умолчанию: 0

Если включено, функции 'least' и 'greatest' возвращают NULL, если один из их аргументов NULL.

## legacy_column_name_of_tuple_literal {#legacy_column_name_of_tuple_literal}

Тип: Bool

Значение по умолчанию: 0

Перечисляет все имена элементов больших кортежей в их именах колонок вместо хеша. Эта настройка существует только по совместимости. Имеет смысл установить в 'true', во время поэтапного обновления кластера с версии ниже 21.7 на более высокую.

## lightweight_deletes_sync {#lightweight_deletes_sync}

Тип: UInt64

Значение по умолчанию: 2

То же самое, что и [`mutations_sync`](#mutations_sync), но контролирует только выполнение легковесных удалений.

Возможные значения:

- 0 - Мутации выполняются асинхронно.
- 1 - Запрос ожидает завершения легковесных удалений на текущем сервере.
- 2 - Запрос ожидает завершения легковесных удалений на всех репликах (если они существуют).

**Смотрите также**

- [Синхронность запросов ALTER](../../sql-reference/statements/alter/index.md/#synchronicity-of-alter-queries)
- [Мутации](../../sql-reference/statements/alter/index.md/#mutations)

## limit {#limit}

Тип: UInt64

Значение по умолчанию: 0

Устанавливает максимальное количество строк, которые можно получить из результата запроса. Он корректирует значение, установленное в клаузе [LIMIT](/sql-reference/statements/select/limit), так что лимит, указанный в запросе, не может превышать лимит, установленный этой настройкой.

Возможные значения:

- 0 — Количество строк не ограничено.
- Положительное целое число.

## live_view_heartbeat_interval {#live_view_heartbeat_interval}
<ExperimentalBadge/>

Тип: Seconds

Значение по умолчанию: 15

Интервал проверки (heartbeat) в секундах, чтобы указать, что живой запрос активен.

## балансировка_нагрузки {#load_balancing}

Тип: LoadBalancing

Значение по умолчанию: random

Указывает алгоритм выбора реплик, который используется для распределенной обработки запросов.

ClickHouse поддерживает следующие алгоритмы выбора реплик:

- [Случайный](#load_balancing-random) (по умолчанию)
- [Ближайший по имени хоста](#load_balancing-nearest_hostname)
- [Левенштейново расстояние имени хоста](#load_balancing-hostname_levenshtein_distance)
- [По порядку](#load_balancing-in_order)
- [Первый или случайный](#load_balancing-first_or_random)
- [Циклический](#load_balancing-round_robin)

Смотрите также:

- [distributed_replica_max_ignored_errors](#distributed_replica_max_ignored_errors)
### Случайный (по умолчанию) {#load_balancing-random}

```sql
load_balancing = random
```

Количество ошибок считается для каждой реплики. Запрос отправляется той реплике, у которой наименьшее количество ошибок, а если таких несколько, то любой из них.
Недостатки: Близость сервера не учитывается; если реплики содержат разные данные, вы также получите разные данные.
### Ближайший по имени хоста {#load_balancing-nearest_hostname}

```sql
load_balancing = nearest_hostname
```

Количество ошибок считается для каждой реплики. Каждые 5 минут количество ошибок делится на 2. Таким образом, количество ошибок рассчитывается за недавнее время с экспоненциальным сглаживанием. Если есть одна реплика с минимальным количеством ошибок (т.е. ошибки происходили недавно на других репликах), запрос отправляется ей. Если несколько реплик имеют одинаковое минимальное количество ошибок, запрос отправляется реплике с именем хоста, наиболее похожим на имя хоста сервера в конфигурационном файле (по количеству различных символов в идентичных позициях, до минимальной длины обоих имен хостов).

Например, example01-01-1 и example01-01-2 различаются на одну позицию, в то время как example01-01-1 и example01-02-2 различаются в двух местах.
Этот метод может показаться примитивным, но он не требует внешних данных о сетевой топологии, и не сравнивает IP-адреса, что было бы усложнено для наших IPv6 адресов.

Таким образом, если есть эквивалентные реплики, предпочтение отдается ближайшей по имени.
Мы также можем предположить, что при отправке запроса на один и тот же сервер, в отсутствие сбоев, распределенный запрос также будет поступать на те же серверы. Поэтому, даже если на репликах находятся разные данные, запрос вернет в основном одни и те же результаты.
### Левенштейново расстояние имени хоста {#load_balancing-hostname_levenshtein_distance}

```sql
load_balancing = hostname_levenshtein_distance
```

Как и `nearest_hostname`, но сравнивает имя хоста по методу [левенштейнового расстояния](https://en.wikipedia.org/wiki/Levenshtein_distance). Например:

```text
example-clickhouse-0-0 ample-clickhouse-0-0
1

example-clickhouse-0-0 example-clickhouse-1-10
2

example-clickhouse-0-0 example-clickhouse-12-0
3
```
### По порядку {#load_balancing-in_order}

```sql
load_balancing = in_order
```

Реплики с одинаковым количеством ошибок обрабатываются в том порядке, в котором они указаны в конфигурации.
Этот метод подходит, когда вы точно знаете, какая реплика предпочтительнее.
### Первый или случайный {#load_balancing-first_or_random}

```sql
load_balancing = first_or_random
```

Этот алгоритм выбирает первую реплику в наборе или случайную реплику, если первая недоступна. Эффективен в кросс-репликационных топологиях, но бесполезен в других конфигурациях.

Алгоритм `first_or_random` решает проблему алгоритма `in_order`. При использовании `in_order`, если одна реплика выходит из строя, следующая получает двойную нагрузку, в то время как оставшиеся реплики обрабатывают обычный объем трафика. При использовании алгоритма `first_or_random`, нагрузка равномерно распределяется между репликами, которые все еще доступны.

Можно явно определить, какая реплика является первой, с помощью настройки `load_balancing_first_offset`. Это дает больше контроля для перераспределения нагрузки запросов между репликами.
### Циклический {#load_balancing-round_robin}

```sql
load_balancing = round_robin
```

Этот алгоритм использует политику циклического распределения среди реплик с одинаковым количеством ошибок (учитываются только запросы с политикой `round_robin`).
## load_balancing_first_offset {#load_balancing_first_offset}

Тип: UInt64

Значение по умолчанию: 0

Какая реплика предпочтительно должна обрабатывать запрос, когда используется стратегия балансировки нагрузки FIRST_OR_RANDOM.
## load_marks_asynchronously {#load_marks_asynchronously}

Тип: Bool

Значение по умолчанию: 0

Загружать метки MergeTree асинхронно.
## local_filesystem_read_method {#local_filesystem_read_method}

Тип: String

Значение по умолчанию: pread_threadpool

Метод чтения данных из локальной файловой системы, один из: read, pread, mmap, io_uring, pread_threadpool. Метод 'io_uring' является экспериментальным и не работает для Log, TinyLog, StripeLog, File, Set и Join, и других таблиц с добавляемыми файлами в присутствии одновременных чтений и записей.
## local_filesystem_read_prefetch {#local_filesystem_read_prefetch}

Тип: Bool

Значение по умолчанию: 0

Следует ли использовать предварительную выборку при чтении данных из локальной файловой системы.
## lock_acquire_timeout {#lock_acquire_timeout}

Тип: Seconds

Значение по умолчанию: 120

Определяет, сколько секунд запрос блокировки ждет перед сбоем.

Тайм-аут блокировки используется для защиты от взаимных блокировок при выполнении операций чтения/записи с таблицами. Когда время ожидания истекает и запрос блокировки не удался, сервер ClickHouse выдает исключение "Попытка блокировки истекла! Возможная взаимная блокировка предотвращена. Клиент должен повторить попытку." с кодом ошибки `DEADLOCK_AVOIDED`.

Возможные значения:

- Положительное целое число (в секундах).
- 0 — Нет тайм-аута блокировки.
## log_comment {#log_comment}

Тип: String

Значение по умолчанию: 

Указывает значение для поля `log_comment` таблицы [system.query_log](../system-tables/query_log.md) и текст комментария для серверного лога.

Это может быть использовано для повышения читаемости серверных журналов. Кроме того, это помогает выбирать запросы, связанные с тестом из `system.query_log` после запуска [clickhouse-test](../../development/tests.md).

Возможные значения:

- Любая строка не длиннее [max_query_size](#max_query_size). Если превышен max_query_size, сервер выдает исключение.

**Пример**

Запрос:

```sql
SET log_comment = 'log_comment test', log_queries = 1;
SELECT 1;
SYSTEM FLUSH LOGS;
SELECT type, query FROM system.query_log WHERE log_comment = 'log_comment test' AND event_date >= yesterday() ORDER BY event_time DESC LIMIT 2;
```

Результат:

```text
┌─type────────┬─query─────┐
│ QueryStart  │ SELECT 1; │
│ QueryFinish │ SELECT 1; │
└─────────────┴───────────┘
```
## log_formatted_queries {#log_formatted_queries}

Тип: Bool

Значение по умолчанию: 0

Позволяет регистрировать форматированные запросы в системной таблице [system.query_log](../../operations/system-tables/query_log.md) (заполняет колонку `formatted_query` в [system.query_log](../../operations/system-tables/query_log.md)).

Возможные значения:

- 0 — Форматированные запросы не регистрируются в системной таблице.
- 1 — Форматированные запросы регистрируются в системной таблице.
## log_processors_profiles {#log_processors_profiles}

Тип: Bool

Значение по умолчанию: 1

Записывать время, которое процессор потратил на выполнение/ожидание данных в таблицу `system.processors_profile_log`.

Смотрите также:

- [`system.processors_profile_log`](../../operations/system-tables/processors_profile_log.md)
- [`EXPLAIN PIPELINE`](../../sql-reference/statements/explain.md/#explain-pipeline)
## log_profile_events {#log_profile_events}

Тип: Bool

Значение по умолчанию: 1

Регистрация статистики производительности запросов в query_log, query_thread_log и query_views_log.
## log_queries {#log_queries}

Тип: Bool

Значение по умолчанию: 1

Настройка регистрации запросов.

Запросы, отправленные в ClickHouse с этой настройкой, регистрируются в соответствии с правилами в параметре конфигурации сервера [query_log](../../operations/server-configuration-parameters/settings.md/#query_log).

Пример:

```text
log_queries=1
```
## log_queries_cut_to_length {#log_queries_cut_to_length}

Тип: UInt64

Значение по умолчанию: 100000

Если длина запроса превышает заданный порог (в байтах), то запрос обрезается при записи в журнал запросов. Также ограничивается длина напечатанного запроса в обычном текстовом журнале.
## log_queries_min_query_duration_ms {#log_queries_min_query_duration_ms}

Тип: Milliseconds

Значение по умолчанию: 0

Если включено (не равно нулю), запросы быстрее, чем значение этой настройки, не будут регистрироваться (вы можете рассматривать это как `long_query_time` для [MySQL Slow Query Log](https://dev.mysql.com/doc/refman/5.7/slow-query-log.html)), и это, в основном, означает, что вы не найдете их в следующих таблицах:

- `system.query_log`
- `system.query_thread_log`

Только запросы следующего типа будут попадать в журнал:

- `QUERY_FINISH`
- `EXCEPTION_WHILE_PROCESSING`

- Тип: миллисекунды
- Значение по умолчанию: 0 (любой запрос)
## log_queries_min_type {#log_queries_min_type}

Тип: LogQueriesType

Значение по умолчанию: QUERY_START

Минимальный тип `query_log` для регистрации.

Возможные значения:
- `QUERY_START` (`=1`)
- `QUERY_FINISH` (`=2`)
- `EXCEPTION_BEFORE_START` (`=3`)
- `EXCEPTION_WHILE_PROCESSING` (`=4`)

Может быть использовано для ограничения того, какие сущности будут попадать в `query_log`, скажем, вы интересуетесь только ошибками, тогда вы можете использовать `EXCEPTION_WHILE_PROCESSING`:

```text
log_queries_min_type='EXCEPTION_WHILE_PROCESSING'
```
## log_queries_probability {#log_queries_probability}

Тип: Float

Значение по умолчанию: 1

Позволяет пользователю записывать в [query_log](../../operations/system-tables/query_log.md), [query_thread_log](../../operations/system-tables/query_thread_log.md) и [query_views_log](../../operations/system-tables/query_views_log.md) системные таблицы только выборку запросов, выбранных случайным образом с заданной вероятностью. Это помогает снизить нагрузку при большом объеме запросов в секунду.

Возможные значения:

- 0 — Запросы не регистрируются в системных таблицах.
- Положительное число с плавающей запятой в диапазоне [0..1]. Например, если значение настройки равно `0.5`, примерно половина запросов регистрируется в системных таблицах.
- 1 — Все запросы регистрируются в системных таблицах.
## log_query_settings {#log_query_settings}

Тип: Bool

Значение по умолчанию: 1

Регистрация настроек запроса в query_log и журнале открытых временных интервалов.
## log_query_threads {#log_query_threads}

Тип: Bool

Значение по умолчанию: 0

Настройка регистрации потоков запросов.

Потоки запросов записываются в таблицу [system.query_thread_log](../../operations/system-tables/query_thread_log.md). Эта настройка имеет эффект только тогда, когда [log_queries](#log_queries) равно true. Потоки запросов, выполняемые ClickHouse с этой настройкой, регистрируются в соответствии с правилами в параметре конфигурации сервера [query_thread_log](/operations/server-configuration-parameters/settings#query_thread_log).

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

**Пример**

```text
log_query_threads=1
```
## log_query_views {#log_query_views}

Тип: Bool

Значение по умолчанию: 1

Настройка регистрации представлений запросов.

Когда запрос, выполняемый ClickHouse с этой настройкой, имеет связанные представления (материализованные или живые представления), они регистрируются в параметре конфигурации сервера [query_views_log](/operations/server-configuration-parameters/settings#query_views_log).

Пример:

```text
log_query_views=1
```
## low_cardinality_allow_in_native_format {#low_cardinality_allow_in_native_format}

Тип: Bool

Значение по умолчанию: 1

Позволяет или ограничивает использование типа данных [LowCardinality](../../sql-reference/data-types/lowcardinality.md) с форматом [Native](../../interfaces/formats.md/#native).

Если использование `LowCardinality` ограничено, сервер ClickHouse преобразует столбцы типа `LowCardinality` в обычные для запросов `SELECT`, и преобразует обычные столбцы в столбцы типа `LowCardinality` для запросов `INSERT`.

Эта настройка необходима в основном для сторонних клиентов, которые не поддерживают тип данных `LowCardinality`.

Возможные значения:

- 1 — Использование `LowCardinality` не ограничено.
- 0 — Использование `LowCardinality` ограничено.
## low_cardinality_max_dictionary_size {#low_cardinality_max_dictionary_size}

Тип: UInt64

Значение по умолчанию: 8192

Устанавливает максимальный размер в строках для общего глобального словаря для типа данных [LowCardinality](../../sql-reference/data-types/lowcardinality.md), который может быть записан в файловую систему хранения. Эта настройка предотвращает проблемы с RAM в случае неограниченного роста словаря. Все данные, которые не могут быть закодированы из-за ограничения максимального размера словаря, ClickHouse записывает обычным образом.

Возможные значения:

- Любое положительное целое число.
## low_cardinality_use_single_dictionary_for_part {#low_cardinality_use_single_dictionary_for_part}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает использование единственного словаря для части данных.

По умолчанию сервер ClickHouse отслеживает размер словарей, и если словарь переполняется, сервер начинает записывать следующий. Чтобы запретить создание нескольких словарей, установите `low_cardinality_use_single_dictionary_for_part = 1`.

Возможные значения:

- 1 — Создание нескольких словарей для части данных запрещено.
- 0 — Создание нескольких словарей для части данных не запрещено.
## low_priority_query_wait_time_ms {#low_priority_query_wait_time_ms}
<BetaBadge/>

Тип: Milliseconds

Значение по умолчанию: 1000

Время ожидания в миллисекундах, когда запрос низкого приоритета сталкивается с запросом высокого приоритета.
## materialize_skip_indexes_on_insert {#materialize_skip_indexes_on_insert}

Тип: Bool

Значение по умолчанию: 1

Если INSERT создают и сохраняют индексы пропуска. Если отключено, индексы пропуска будут создаваться и сохраняться во время слияний или по явному MATERIALIZE INDEX.
## materialize_statistics_on_insert {#materialize_statistics_on_insert}

Тип: Bool

Значение по умолчанию: 1

Если INSERT создают и вставляют статистику. Если отключено, статистика будет создаваться и сохраняться во время слияний или по явному MATERIALIZE STATISTICS.
## materialize_ttl_after_modify {#materialize_ttl_after_modify}

Тип: Bool

Значение по умолчанию: 1

Применить TTL для старых данных после запроса ALTER MODIFY TTL.
## materialized_views_ignore_errors {#materialized_views_ignore_errors}

Тип: Bool

Значение по умолчанию: 0

Позволяет игнорировать ошибки для МАТЕРИАЛИЗОВАННОГО ВИДА и доставлять оригинальный блок в таблицу независимо от MV.
## max_analyze_depth {#max_analyze_depth}

Тип: UInt64

Значение по умолчанию: 5000

Максимальное количество анализов, выполняемых интерпретатором.
## max_ast_depth {#max_ast_depth}

Тип: UInt64

Значение по умолчанию: 1000

Максимальная глубина вложенности синтаксического дерева запроса. Если превышена, выбрасывается исключение.

:::note
На данный момент это не проверяется во время парсинга, а только после разбора запроса.
Это означает, что во время парсинга может быть создано слишком глубокое синтаксическое дерево,
но запрос завершится с ошибкой.
:::
## max_ast_elements {#max_ast_elements}

Тип: UInt64

Значение по умолчанию: 50000

Максимальное количество элементов в синтаксическом дереве запроса. Если превышено, выбрасывается исключение.

:::note
На данный момент это не проверяется во время парсинга, а только после разбора запроса.
Это означает, что во время парсинга может быть создано слишком глубокое синтаксическое дерево,
но запрос завершится с ошибкой.
:::
## max_autoincrement_series {#max_autoincrement_series}

Тип: UInt64

Значение по умолчанию: 1000

Предел на количество серий, создаваемых функцией `generateSeriesID`.

Поскольку каждая серия представляет собой узел в Keeper, рекомендуется иметь их не более нескольких миллионов.
## max_backup_bandwidth {#max_backup_bandwidth}

Тип: UInt64

Значение по умолчанию: 0

Максимальная скорость чтения в байтах в секунду для конкретной резервной копии на сервере. Ноль означает без ограничений.
## max_block_size {#max_block_size}

Тип: UInt64

Значение по умолчанию: 65409

В ClickHouse данные обрабатываются блоками, которые представляют собой наборы частей столбцов. Внутренние циклы обработки для одного блока эффективны, но существуют заметные затраты при обработке каждого блока.

Настройка `max_block_size` указывает рекомендуемое максимальное количество строк, которые следует включить в один блок при загрузке данных из таблиц. Блоки размером `max_block_size` не всегда загружаются из таблицы: если ClickHouse определяет, что необходимо извлечь меньше данных, обрабатывается более мелкий блок.

Размер блока не должен быть слишком маленьким, чтобы избежать заметных затрат при обработке каждого блока. Также он не должен быть слишком большим, чтобы обеспечить быстрое выполнение запросов с условием LIMIT после обработки первого блока. При установке `max_block_size` цель должна заключаться в том, чтобы избежать излишнего потребления памяти при извлечении большого количества столбцов в нескольких потоках и сохранить как минимум некоторую кэш-локальность.
## max_bytes_before_external_group_by {#max_bytes_before_external_group_by}

Тип: UInt64

Значение по умолчанию: 0

Облачное значение по умолчанию: половина объема памяти на каждую реплику.

Включает или отключает выполнение операторов `GROUP BY` во внешней памяти.
(Смотрите [GROUP BY в внешней памяти](/sql-reference/statements/select/group-by#group-by-in-external-memory))

Возможные значения:

- Максимальный объем RAM (в байтах), который может быть использован одним оператором [GROUP BY](/sql-reference/statements/select/group-by).
- `0` — `GROUP BY` во внешней памяти отключен.

:::note
Если использование памяти во время операций GROUP BY превышает этот порог в байтах,
активируется режим 'внешней агрегации' (сброс данных на диск).

Рекомендуемое значение — половина доступной системной памяти.
:::
## max_bytes_before_external_sort {#max_bytes_before_external_sort}

Тип: UInt64

Значение по умолчанию: 0

Облачное значение по умолчанию: половина объема памяти на каждую реплику.

Включает или отключает выполнение операторов `ORDER BY` во внешней памяти. См. [Подробности реализации ORDER BY](../../sql-reference/statements/select/order-by.md#implementation-details)
Если использование памяти во время операции ORDER BY превышает этот порог в байтах, активируется режим 'внешней сортировки' (сброс данных на диск).

Возможные значения:

- Максимальный объем RAM (в байтах), который может быть использован одним оператором [ORDER BY](../../sql-reference/statements/select/order-by).
  Рекомендуемое значение — половина доступной системной памяти
- `0` — `ORDER BY` во внешней памяти отключен.
## max_bytes_before_remerge_sort {#max_bytes_before_remerge_sort}

Тип: UInt64

Значение по умолчанию: 1000000000

В случае ORDER BY с LIMIT, при использовании памяти больше указанного порога, выполняются дополнительные шаги слияния блоков перед финальным слиянием, чтобы сохранить только верхние строки LIMIT.
## max_bytes_in_distinct {#max_bytes_in_distinct}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество байтов состояния (в несжатых байтах) в памяти, которое
используется хеш-таблицей при использовании DISTINCT.
## max_bytes_in_join {#max_bytes_in_join}

Тип: UInt64

Значение по умолчанию: 0

Максимальный размер в байтах хеш-таблицы, используемой при соединении таблиц.

Эта настройка применяется к операциям [SELECT ... JOIN](/sql-reference/statements/select/join)
и движку [Join](https://clickhouse.com/engines/table-engines/special/join).

Если запрос содержит соединения, ClickHouse проверяет эту настройку для каждого промежуточного результата.

ClickHouse может производить различные действия, когда достигнут лимит. Используйте
настройки [join_overflow_mode](/operations/settings/settings#join_overflow_mode), чтобы выбрать действие.

Возможные значения:

- Положительное целое число.
- 0 — Контроль памяти отключен.
## max_bytes_in_set {#max_bytes_in_set}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество байтов (несжатых данных), используемых набором в операторе IN,
созданным из подзапроса.
## max_bytes_ratio_before_external_group_by {#max_bytes_ratio_before_external_group_by}

Тип: Double

Значение по умолчанию: 0.5

Соотношение доступной памяти, которое разрешено для `GROUP BY`. Как только оно будет достигнуто,
будет использована внешняя память для агрегации.

Например, если установлено значение `0.6`, `GROUP BY` будет разрешено использовать 60% доступной памяти
(для сервера/пользователя/слияний) в начале выполнения, а затем начнется использование внешней агрегации.
## max_bytes_ratio_before_external_sort {#max_bytes_ratio_before_external_sort}

Тип: Double

Значение по умолчанию: 0.5

Соотношение доступной памяти, которое разрешено для `ORDER BY`. Как только оно будет достигнуто,
будет использована внешняя сортировка.

Например, если установлено значение `0.6`, `ORDER BY` будет разрешено использовать `60%` доступной памяти
(для сервера/пользователя/слияний) в начале выполнения, а затем начнется использование внешней сортировки.
## max_bytes_to_read {#max_bytes_to_read}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество байтов (несжатых данных), которые могут быть прочитаны из таблицы при выполнении запроса.
Ограничение проверяется для каждого обрабатываемого блока данных, применяется только к
глубочайшему выражению таблицы и при чтении с удаленного сервера, проверяется только на
удаленном сервере.
## max_bytes_to_read_leaf {#max_bytes_to_read_leaf}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество байтов (несжатых данных), которые могут быть прочитаны из локальной
таблицы на узле-листе при выполнении распределенного запроса. В то время как распределенные запросы
могут выдавать несколько подзапросов к каждому шард (лист) - это ограничение будет
проверяться только на этапе чтения на узлах-листьях и будет проигнорировано на этапе
слияния результатов на корневом узле.

Например, кластер состоит из 2 шардов и каждый шард содержит таблицу с
100 байтами данных. Распределенный запрос, который должен прочитать все данные
из обоих таблиц с настройкой `max_bytes_to_read=150`, завершится неудачей, так как в итоге это
будет 200 байт. Запрос с `max_bytes_to_read_leaf=150` будет успешным, поскольку
узлы-листы прочитают максимум 100 байт.

Ограничение проверяется для каждого обрабатываемого блока данных.

:::note
Эта настройка нестабильна с `prefer_localhost_replica=1`.
:::
## max_bytes_to_sort {#max_bytes_to_sort}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество байтов перед сортировкой. Если для операции ORDER BY требуется обработать больше,
чем указанное количество несжатых байт, поведение будет определяться `sort_overflow_mode`, который по умолчанию установлен в `throw`.
## max_bytes_to_transfer {#max_bytes_to_transfer}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество байтов (несжатых данных), которые могут быть переданы на удаленный
сервер или сохранены во временной таблице при выполнении секции GLOBAL IN/JOIN.
## max_columns_to_read {#max_columns_to_read}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество столбцов, которые могут быть прочитаны из таблицы в одном запросе.
Если запрос требует чтения большего количества столбцов, будет выброшено исключение.

:::tip
Эта настройка полезна для предотвращения чрезмерно сложных запросов.
:::

Значение `0` означает неограниченное количество.
## max_compress_block_size {#max_compress_block_size}

Тип: UInt64

Значение по умолчанию: 1048576

Максимальный размер блоков несжатых данных перед сжатием для записи в таблицу. По умолчанию 1 048 576 (1 МиБ). Указание меньшего размера блока обычно приводит к немного более низкому коэффициенту сжатия, скорость сжатия и распаковки немного увеличивается благодаря кэш-локальности, и снижается потребление памяти.

:::note
Это настройка для экспертов, и вам не следует ее менять, если вы только начинаете работать с ClickHouse.
:::

Не путайте блоки для сжатия (часть памяти, состоящая из байтов) с блоками для обработки запросов (набор строк из таблицы).
## max_concurrent_queries_for_all_users {#max_concurrent_queries_for_all_users}

Тип: UInt64

Значение по умолчанию: 0

Выбросить исключение, если значение этой настройки меньше или равно текущему количеству одновременно обрабатываемых запросов.

Пример: `max_concurrent_queries_for_all_users` можно установить на 99 для всех пользователей, а администратор базы данных может установить его на 100 для себя, чтобы выполнять запросы для расследования, даже когда сервер перегружен.

Изменение настройки для одного запроса или пользователя не влияет на другие запросы.

Возможные значения:

- Положительное целое число.
- 0 — Без ограничений.

**Пример**

```xml
<max_concurrent_queries_for_all_users>99</max_concurrent_queries_for_all_users>
```

**Смотрите также**

- [max_concurrent_queries](/operations/server-configuration-parameters/settings#max_concurrent_queries)
## max_concurrent_queries_for_user {#max_concurrent_queries_for_user}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество одновременно обрабатываемых запросов для каждого пользователя.

Возможные значения:

- Положительное целое число.
- 0 — Без ограничений.

**Пример**

```xml
<max_concurrent_queries_for_user>5</max_concurrent_queries_for_user>
```
## max_distributed_connections {#max_distributed_connections}

Тип: UInt64

Значение по умолчанию: 1024

Максимальное количество одновременных соединений с удаленными серверами для распределенной обработки одного запроса к одной распределенной таблице. Рекомендуется устанавливать значение не менее количества серверов в кластере.

Следующие параметры используются только при создании распределенных таблиц (и при запуске сервера), поэтому нет необходимости изменять их во время выполнения.
## max_distributed_depth {#max_distributed_depth}

Тип: UInt64

Значение по умолчанию: 5

Ограничивает максимальную глубину рекурсивных запросов для [Distributed](../../engines/table-engines/special/distributed.md) таблиц.

Если значение превышено, сервер выбрасывает исключение.

Возможные значения:

- Положительное целое число.
- 0 — Без ограничений.
## max_download_buffer_size {#max_download_buffer_size}

Тип: UInt64

Значение по умолчанию: 10485760

Максимальный размер буфера для параллельной загрузки (например, для URL движка) на каждый поток.
## max_download_threads {#max_download_threads}

Тип: MaxThreads

Значение по умолчанию: 4

Максимальное количество потоков для загрузки данных (например, для URL движка).
## max_estimated_execution_time {#max_estimated_execution_time}

Тип: Seconds

Значение по умолчанию: 0

Максимальное оценочное время выполнения запроса в секундах. Проверяется на каждом блоке данных,
когда истекает [`timeout_before_checking_execution_speed`](/operations/settings/settings#timeout_before_checking_execution_speed).
## max_execution_speed {#max_execution_speed}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество строк, обрабатываемых в секунду. Проверяется на каждом блоке данных, когда
истекает [`timeout_before_checking_execution_speed`](/operations/settings/settings#timeout_before_checking_execution_speed). Если скорость выполнения высокая, скорость выполнения будет снижена.
## max_execution_speed_bytes {#max_execution_speed_bytes}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество байтов, обрабатываемых в секунду. Проверяется на каждом блоке данных, когда
истекает [`timeout_before_checking_execution_speed`](/operations/settings/settings#timeout_before_checking_execution_speed). Если скорость выполнения высокая, скорость выполнения будет снижена.
## max_execution_time {#max_execution_time}

Тип: Seconds

Значение по умолчанию: 0

Максимальное время выполнения запроса в секундах.

Параметр `max_execution_time` может быть немного сложным для понимания.
Он работает на основе интерполяции относительно текущей скорости выполнения запроса
(это поведение контролируется [`timeout_before_checking_execution_speed`](/operations/settings/settings#timeout_before_checking_execution_speed)).

ClickHouse прервет запрос, если предполагаемое время выполнения превысит
указанное `max_execution_time`. По умолчанию `timeout_before_checking_execution_speed`
установлен на 10 секунд. Это означает, что после 10 секунд выполнения запроса ClickHouse
начнет оценивать общее время выполнения. Если, например, `max_execution_time`
установлен на 3600 секунд (1 час), ClickHouse завершит запрос, если предполагаемое
время превысит этот лимит в 3600 секунд. Если вы установите `timeout_before_checking_execution_speed`
на 0, ClickHouse будет использовать время часов как основу для `max_execution_time`.

Если время выполнения запроса превышает указанное количество секунд, поведение будет
определяться 'timeout_overflow_mode', который по умолчанию установлен в `throw`.

:::note
Тайм-аут проверяется, и запрос может остановиться только в обозначенных местах во время обработки данных.
В настоящее время он не может остановиться во время слияния состояний агрегации или во время анализа запроса,
и фактическое время выполнения будет выше значения этой настройки.
:::
## max_execution_time_leaf {#max_execution_time_leaf}

Тип: Seconds

Значение по умолчанию: 0

Семантически аналогично [`max_execution_time`](#max_execution_time), но применяется только
на узлах-листах для распределенных или удаленных запросов.

Например, если мы хотим ограничить время выполнения на узле-листе до `10s`, но
не ограничивать на начальном узле, вместо того, чтобы устанавливать `max_execution_time` в настройках вложенного подзапроса:

```sql
SELECT count()
FROM cluster(cluster, view(SELECT * FROM t SETTINGS max_execution_time = 10));
```

Мы можем использовать `max_execution_time_leaf` в качестве настроек запроса:

```sql
SELECT count()
FROM cluster(cluster, view(SELECT * FROM t)) SETTINGS max_execution_time_leaf = 10;
```
## max_expanded_ast_elements {#max_expanded_ast_elements}

Тип: UInt64

Значение по умолчанию: 500000

Максимальный размер синтаксического дерева запроса в количестве узлов после расширения псевдонимов и звездочки.
## max_fetch_partition_retries_count {#max_fetch_partition_retries_count}

Тип: UInt64

Значение по умолчанию: 5

Количество попыток при получении раздела с другого хоста.
## max_final_threads {#max_final_threads}

Тип: MaxThreads

Значение по умолчанию: 'auto(14)'

Устанавливает максимальное количество параллельных потоков для фазы чтения данных запроса `SELECT` с модификатором [FINAL](/sql-reference/statements/select/from#final-modifier).

Возможные значения:

- Положительное целое число.
- 0 или 1 — Отключено. Запросы `SELECT` выполняются в одном потоке.
```
## max_http_get_redirects {#max_http_get_redirects}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество разрешенных переходов по HTTP GET редиректам. Обеспечивает дополнительные меры безопасности, чтобы предотвратить возможность злонамеренного сервера перенаправлять ваши запросы к неожиданным службам. Это происходит, когда внешний сервер перенаправляет на другой адрес, но этот адрес кажется внутренним для инфраструктуры компании, и, отправив HTTP-запрос на внутренний сервер, вы могли бы запросить внутренний API из внутренней сети, обойдя аутентификацию, или даже запрашивать другие службы, такие как Redis или Memcached. Когда у вас нет внутренней инфраструктуры (включая что-то, работающее на вашем localhost) или вы доверяете серверу, обычно безопасно разрешать редиректы. Однако имейте в виду, что если URL использует HTTP вместо HTTPS, вам придется доверять не только удаленному серверу, но и вашему провайдеру услуг связи, и всем сетям между ними.

## max_hyperscan_regexp_length {#max_hyperscan_regexp_length}

Тип: UInt64

Значение по умолчанию: 0

Определяет максимальную длину для каждого регулярного выражения в [функциях многократного совпадения hyperscan](/sql-reference/functions/string-search-functions#multimatchany).

Возможные значения:

- Положительное целое число.
- 0 - Длина не ограничена.

**Пример**

Запрос:

```sql
SELECT multiMatchAny('abcd', ['ab','bcd','c','d']) SETTINGS max_hyperscan_regexp_length = 3;
```

Результат:

```text
┌─multiMatchAny('abcd', ['ab', 'bcd', 'c', 'd'])─┐
│                                              1 │
└────────────────────────────────────────────────┘
```

Запрос:

```sql
SELECT multiMatchAny('abcd', ['ab','bcd','c','d']) SETTINGS max_hyperscan_regexp_length = 2;
```

Результат:

```text
Exception: Regexp length too large.
```

**См. также**

- [max_hyperscan_regexp_total_length](#max_hyperscan_regexp_total_length)

## max_hyperscan_regexp_total_length {#max_hyperscan_regexp_total_length}

Тип: UInt64

Значение по умолчанию: 0

Устанавливает максимальную общую длину всех регулярных выражений в каждой [функции многократного совпадения hyperscan](/sql-reference/functions/string-search-functions#multimatchany).

Возможные значения:

- Положительное целое число.
- 0 - Длина не ограничена.

**Пример**

Запрос:

```sql
SELECT multiMatchAny('abcd', ['a','b','c','d']) SETTINGS max_hyperscan_regexp_total_length = 5;
```

Результат:

```text
┌─multiMatchAny('abcd', ['a', 'b', 'c', 'd'])─┐
│                                           1 │
└─────────────────────────────────────────────┘
```

Запрос:

```sql
SELECT multiMatchAny('abcd', ['ab','bc','c','d']) SETTINGS max_hyperscan_regexp_total_length = 5;
```

Результат:

```text
Exception: Total regexp lengths too large.
```

**См. также**

- [max_hyperscan_regexp_length](#max_hyperscan_regexp_length)

## max_insert_block_size {#max_insert_block_size}

Тип: UInt64

Значение по умолчанию: 1048449

Размер блоков (в количестве строк), которые формируют для вставки в таблицу. Эта настройка применяется только в случаях, когда сервер формирует блоки. Например, для INSERT через HTTP интерфейс сервер анализирует формат данных и формирует блоки указанного размера. Но при использовании clickhouse-client клиент сам анализирует данные, и настройка 'max_insert_block_size' на сервере не влияет на размер вставляемых блоков. Настройка также не имеет смысла при использовании INSERT SELECT, поскольку данные вставляются с использованием тех же блоков, которые формируются после SELECT.

По умолчанию это немного больше, чем `max_block_size`. Причина этого в том, что некоторые движки таблиц (`*MergeTree`) формируют часть данных на диске для каждого вставленного блока, что является довольно крупной сущностью. Аналогично, таблицы `*MergeTree` сортируют данные во время вставки, и достаточно большой размер блока позволяет сортировать больше данных в оперативной памяти.

## max_insert_delayed_streams_for_parallel_write {#max_insert_delayed_streams_for_parallel_write}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество потоков (колонок) для задержки финальной выгрузки частей. По умолчанию - авто (100 в случае, если используется параллельная запись, например, S3, и отключена в противном случае).

## max_insert_threads {#max_insert_threads}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество потоков для выполнения запроса `INSERT SELECT`.

Возможные значения:

- 0 (или 1) — `INSERT SELECT` без параллельного выполнения.
- Положительное целое число. Больше чем 1.

Значение по умолчанию в облаке: от `2` до `4`, в зависимости от размера сервиса.

Параллельный `INSERT SELECT` имеет эффект только если часть `SELECT` выполняется параллельно, см. [max_threads](#max_threads) настройку. Более высокие значения приведут к большему потреблению памяти.

## max_joined_block_size_rows {#max_joined_block_size_rows}

Тип: UInt64

Значение по умолчанию: 65409

Максимальный размер блока для результата JOIN (если алгоритм соединения это поддерживает). 0 означает без ограничений.

## max_limit_for_ann_queries {#max_limit_for_ann_queries}
<ExperimentalBadge/>

Тип: UInt64

Значение по умолчанию: 1000000

SELECT запросы с LIMIT, превышающим эту настройку, не могут использовать векторные индексы сходства. Помогает предотвратить переполнение памяти в векторных индексах сходства.

## max_live_view_insert_blocks_before_refresh {#max_live_view_insert_blocks_before_refresh}
<ExperimentalBadge/>

Тип: UInt64

Значение по умолчанию: 64

Ограничивает максимальное количество вставленных блоков после которого сливаемые блоки удаляются, и запрос повторно выполняется.

## max_local_read_bandwidth {#max_local_read_bandwidth}

Тип: UInt64

Значение по умолчанию: 0

Максимальная скорость локальных чтений в байтах в секунду.

## max_local_write_bandwidth {#max_local_write_bandwidth}

Тип: UInt64

Значение по умолчанию: 0

Максимальная скорость локальных записей в байтах в секунду.

## max_memory_usage {#max_memory_usage}

Тип: UInt64

Значение по умолчанию: 0

Облачное значение по умолчанию: зависит от объема оперативной памяти на реплике.

Максимальное количество оперативной памяти, которое может использоваться для выполнения запроса на одном сервере. Значение `0` означает без ограничений.

Эта настройка не учитывает объем доступной памяти или общий объем памяти на машине. Ограничение применяется к одному запросу на одном сервере.

Вы можете использовать `SHOW PROCESSLIST`, чтобы увидеть текущее потребление памяти для каждого запроса. Пиковое потребление памяти отслеживается для каждого запроса и записывается в журнал.

Использование памяти не отслеживается полностью для состояний следующих агрегатных функций из аргументов `String` и `Array`:
- `min`
- `max`
- `any`
- `anyLast`
- `argMin`
- `argMax`

Потребление памяти также ограничивается параметрами [`max_memory_usage_for_user`](/operations/settings/settings#max_memory_usage_for_user) и [`max_server_memory_usage`](/operations/server-configuration-parameters/settings#max_server_memory_usage).

## max_memory_usage_for_user {#max_memory_usage_for_user}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество оперативной памяти, которое может использоваться для выполнения запросов пользователя на одном сервере. Ноль означает без ограничений.

По умолчанию объем не ограничен (`max_memory_usage_for_user = 0`).

См. также описание [`max_memory_usage`](/operations/settings/settings#max_memory_usage).

Например, если вы хотите установить `max_memory_usage_for_user` на 1000 байт для пользователя с именем `clickhouse_read`, вы можете использовать оператор

```sql
ALTER USER clickhouse_read SETTINGS max_memory_usage_for_user = 1000;
```

Вы можете проверить, что это сработало, выйдя из своего клиента, войдя снова, а затем используя функцию `getSetting`:

```sql
SELECT getSetting('max_memory_usage_for_user');
```

## max_network_bandwidth {#max_network_bandwidth}

Тип: UInt64

Значение по умолчанию: 0

Ограничивает скорость обмена данными по сети в байтах в секунду. Эта настройка применяется к каждому запросу.

Возможные значения:

- Положительное целое число.
- 0 — Контроль пропускной способности отключен.

## max_network_bandwidth_for_all_users {#max_network_bandwidth_for_all_users}

Тип: UInt64

Значение по умолчанию: 0

Ограничивает скорость обмена данными по сети в байтах в секунду. Эта настройка применяется ко всем одновременно выполняемым запросам на сервере.

Возможные значения:

- Положительное целое число.
- 0 — Управление скоростью данных отключено.

## max_network_bandwidth_for_user {#max_network_bandwidth_for_user}

Тип: UInt64

Значение по умолчанию: 0

Ограничивает скорость обмена данными по сети в байтах в секунду. Эта настройка применяется ко всем одновременно выполняемым запросам, выполняемым одним пользователем.

Возможные значения:

- Положительное целое число.
- 0 — Управление скоростью данных отключено. 

## max_network_bytes {#max_network_bytes}

Тип: UInt64

Значение по умолчанию: 0

Ограничивает объем данных (в байтах), который принимается или передается по сети при выполнении запроса. Эта настройка применяется к каждому индивидуальному запросу.

Возможные значения:

- Положительное целое число.
- 0 — Контроль объема данных отключен.

## max_number_of_partitions_for_independent_aggregation {#max_number_of_partitions_for_independent_aggregation}

Тип: UInt64

Значение по умолчанию: 128

Максимальное количество партиций в таблице для применения оптимизации.

## max_parallel_replicas {#max_parallel_replicas}

Тип: NonZeroUInt64

Значение по умолчанию: 1000

Максимальное количество реплик для каждого шарда при выполнении запроса.

Возможные значения:

- Положительное целое число.

**Дополнительная информация**

Эта опция даст разные результаты в зависимости от используемых настроек.

:::note
Эта настройка даст неправильные результаты, когда задействованы соединения или подзапросы, и все таблицы не соответствуют определенным требованиям. См. [Распределенные подзапросы и max_parallel_replicas](/operations/settings/settings#max_parallel_replicas) для получения дополнительных сведений.
:::
### Параллельная обработка с использованием ключа `SAMPLE`

Запрос может обрабатываться быстрее, если он выполняется на нескольких серверах параллельно. Но производительность запроса может ухудшиться в следующих случаях:

- Позиция ключа выборки в ключе партиционирования не позволяет эффективно выполнять диапазонные сканирования.
- Добавление ключа выборки в таблицу делает фильтрацию по другим колонкам менее эффективной.
- Ключ выборки — это выражение, которое дорого вычислить.
- Распределение задержки кластера имеет длинный хвост, поэтому запрос на большее число серверов увеличивает общую задержку запроса.

### Параллельная обработка с использованием [parallel_replicas_custom_key](#parallel_replicas_custom_key)

Эта настройка полезна для любых реплицируемых таблиц.

## max_parser_backtracks {#max_parser_backtracks}

Тип: UInt64

Значение по умолчанию: 1000000

Максимальная возвратная трассировка парсера (сколько раз он пробует разные альтернативы в процессе рекурсивного спуска парсинга).

## max_parser_depth {#max_parser_depth}

Тип: UInt64

Значение по умолчанию: 1000

Ограничивает максимальную глубину рекурсии в рекурсивном парсере. Позволяет контролировать размер стека.

Возможные значения:

- Положительное целое число.
- 0 — Глубина рекурсии не ограничена.

## max_parsing_threads {#max_parsing_threads}

Тип: MaxThreads

Значение по умолчанию: 'auto(14)'

Максимальное количество потоков для разбора данных во входных форматах, поддерживающих параллельный разбор. По умолчанию это определяется автоматически.

## max_partition_size_to_drop {#max_partition_size_to_drop}

Тип: UInt64

Значение по умолчанию: 50000000000

Ограничение на удаление партиций во время выполнения запроса. Значение 0 означает, что вы можете удалять партиции без каких-либо ограничений.

Облачное значение по умолчанию: 1 ТБ.

:::note
Эта настройка запроса перезаписывает ее эквивалент серверной настройки, см. [max_partition_size_to_drop](/operations/server-configuration-parameters/settings#max_partition_size_to_drop)
:::

## max_partitions_per_insert_block {#max_partitions_per_insert_block}

Тип: UInt64

Значение по умолчанию: 100

Ограничивает максимальное количество партиций в одном вставленном блоке, и возникает исключение, если блок содержит слишком много партиций.

- Положительное целое число.
- `0` — Неограниченное количество партиций.

**Подробности**

При вставке данных ClickHouse вычисляет количество партиций в вставленном блоке. Если количество партиций превышает `max_partitions_per_insert_block`, ClickHouse либо записывает предупреждение, либо вызывает исключение в зависимости от `throw_on_max_partitions_per_insert_block`. Исключения имеют следующий текст:

> "Слишком много партиций для одного вставленного блока (`partitions_count` партиций, лимит — " + toString(max_partitions) + "). 
  Лимит контролируется настройкой 'max_partitions_per_insert_block'. 
  Большое количество партиций является распространенным заблуждением. Это приведет к серьезному негативному влиянию на производительность, включая медленный запуск сервера, медленные запросы INSERT и медленные запросы SELECT. Рекомендуемое общее количество партиций для таблицы составляет менее 1000..10000. Обратите внимание, что партиционирование не предназначено для ускорения запросов SELECT (ORDER BY key достаточно, чтобы сделать диапазонные запросы быстрыми). 
  Партиции предназначены для манипуляции данными (DROP PARTITION и т. д.)."

:::note
Эта настройка является предохранительным порогом, так как использование большого количества партиций является распространенным заблуждением.
:::

## max_partitions_to_read {#max_partitions_to_read}

Тип: Int64

Значение по умолчанию: -1

Ограничивает максимальное количество партиций, которые можно использовать в одном запросе.

Значение настройки, указанное при создании таблицы, может быть переопределено с помощью настройки на уровне запроса.

Возможные значения:

- Положительное целое число
- `-1` - неограничено (по умолчанию)

:::note
Вы также можете указать настройку MergeTree [`max_partitions_to_read`](/operations/settings/settings#max_partitions_to_read) в настройках таблиц.
:::

## max_parts_to_move {#max_parts_to_move}

Тип: UInt64

Значение по умолчанию: 1000

Ограничивает количество частей, которые могут быть перемещены в одном запросе. Ноль означает неограниченное количество.

## max_query_size {#max_query_size}

Тип: UInt64

Значение по умолчанию: 262144

Максимальное количество байт строки запроса, разобранной SQL парсером. Данные в операторе VALUES запросов INSERT обрабатываются отдельным потоковым парсером (который потребляет O(1) оперативной памяти) и не подвержены этому ограничению.

:::note
`max_query_size` нельзя установить в SQL запросе (например, `SELECT now() SETTINGS max_query_size=10000`), поскольку ClickHouse должен выделить буфер для разбора запроса, и размер этого буфера определяется настройкой `max_query_size`, которая должна быть сконфигурирована перед выполнением запроса.
:::

## max_read_buffer_size {#max_read_buffer_size}

Тип: UInt64

Значение по умолчанию: 1048576

Максимальный размер буфера для чтения из файловой системы.

## max_read_buffer_size_local_fs {#max_read_buffer_size_local_fs}

Тип: UInt64

Значение по умолчанию: 131072

Максимальный размер буфера для чтения из локальной файловой системы. Если установлено в 0, будет использоваться max_read_buffer_size.

## max_read_buffer_size_remote_fs {#max_read_buffer_size_remote_fs}

Тип: UInt64

Значение по умолчанию: 0

Максимальный размер буфера для чтения из удаленной файловой системы. Если установлено в 0, будет использоваться max_read_buffer_size.

## max_recursive_cte_evaluation_depth {#max_recursive_cte_evaluation_depth}

Тип: UInt64

Значение по умолчанию: 1000

Максимальный предел глубины оценки рекурсивного CTE.

## max_remote_read_network_bandwidth {#max_remote_read_network_bandwidth}

Тип: UInt64

Значение по умолчанию: 0

Максимальная скорость обмена данными по сети в байтах в секунду для чтения.

## max_remote_write_network_bandwidth {#max_remote_write_network_bandwidth}

Тип: UInt64

Значение по умолчанию: 0

Максимальная скорость обмена данными по сети в байтах в секунду для записи.

## max_replica_delay_for_distributed_queries {#max_replica_delay_for_distributed_queries}

Тип: UInt64

Значение по умолчанию: 300

Отключает отстающие реплики для распределенных запросов. См. [Репликация](../../engines/table-engines/mergetree-family/replication.md).

Устанавливает время в секундах. Если задержка реплики больше или равна установленному значению, эта реплика не используется.

Возможные значения:

- Положительное целое число.
- 0 — Задержки реплик не проверяются.

Чтобы предотвратить использование какой-либо реплики с ненулевой задержкой, установите этот параметр в 1.

Используется при выполнении `SELECT` из распределенной таблицы, указывающей на реплицируемые таблицы.

## max_result_bytes {#max_result_bytes}

Тип: UInt64

Значение по умолчанию: 0

Ограничивает размер результата в байтах (без сжатия). Запрос будет остановлен после обработки блока данных, если будет достигнут порог, но последний блок результата не будет обрезан, поэтому размер результата может быть больше порога.

**Предупреждения**

Размер результата в памяти учитывается для этого порога. Даже если размер результата небольшой, он может ссылаться на более крупные структуры данных в памяти, представляющие словари столбцов LowCardinality и арены столбцов AggregateFunction, поэтому порог может быть превышен, несмотря на небольшой размер результата.

:::warning
Настройка достаточно низкого уровня и должна использоваться с осторожностью.
:::

## max_result_rows {#max_result_rows}

Тип: UInt64

Значение по умолчанию: 0

Облачное значение по умолчанию: `0`.

Ограничивает количество строк в результате. Также проверяется для подзапросов и на удаленных серверах при запуске частей распределенного запроса. Ограничение не применяется, если значение равно `0`.

Запрос остановится после обработки блока данных, если будет достигнут порог, но последний блок результата не будет обрезан, поэтому размер результата может быть больше порога.

## max_rows_in_distinct {#max_rows_in_distinct}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество различных строк при использовании DISTINCT.

## max_rows_in_join {#max_rows_in_join}

Тип: UInt64

Значение по умолчанию: 0

Ограничивает количество строк в хеш-таблице, которая используется при соединении таблиц.

Эта настройка применяется к операциям [SELECT ... JOIN](/sql-reference/statements/select/join) и движку таблицы [Join](/engines/table-engines/special/join).

Если запрос содержит несколько соединений, ClickHouse проверяет эту настройку для каждого промежуточного результата.

ClickHouse может выполнять различные действия, когда лимит достигнут. Используйте настройку [`join_overflow_mode`](/operations/settings/settings#join_overflow_mode), чтобы выбрать действие.

Возможные значения:

- Положительное целое число.
- `0` — Неограниченное количество строк.

## max_rows_in_set {#max_rows_in_set}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество строк для набора данных в операторе IN, созданном из подзапроса.

## max_rows_in_set_to_optimize_join {#max_rows_in_set_to_optimize_join}

Тип: UInt64

Значение по умолчанию: 0

Максимальный размер набора для фильтрации связанных таблиц по наборам строк друг друга перед соединением.

Возможные значения:

- 0 — Отключить.
- Любое положительное целое число.

## max_rows_to_group_by {#max_rows_to_group_by}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество уникальных ключей, полученных из агрегации. Эта настройка позволяет ограничить потребление памяти при агрегации.

Если агрегация во время GROUP BY генерирует больше, чем указанное количество строк (уникальных ключей GROUP BY), поведение будет определено 'group_by_overflow_mode', который по умолчанию равен `throw`, но также может быть переключен в режим приблизительной агрегации.

## max_rows_to_read {#max_rows_to_read}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество строк, которые могут быть прочитаны из таблицы при выполнении запроса. Ограничение проверяется для каждого обрабатываемого фрагмента данных, применяется только к глубочайшему выражению таблицы и при чтении с удаленного сервера проверяется только на удаленном сервере.

## max_rows_to_read_leaf {#max_rows_to_read_leaf}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество строк, которые могут быть прочитаны из локальной таблицы на конечном узле при выполнении распределенного запроса. В то время как распределенные запросы могут выдать несколько подзапросов к каждому шардированному (конечному) узлу — это ограничение будет проверено только на этапе чтения на конечных узлах и проигнорировано на этапе слияния результатов на корневом узле.

Например, кластер состоит из 2 шард и каждый шард содержит таблицу с 100 строками. Распределенный запрос, который должен прочитать все данные из обеих таблиц с настройкой `max_rows_to_read=150`, завершится неудачей, так как в общей сложности будет 200 строк. Запрос с `max_rows_to_read_leaf=150` будет успешным, так как конечные узлы будут читать максимум 100 строк.

Ограничение проверяется для каждого обрабатываемого фрагмента данных.

:::note
Эта настройка нестабильна с `prefer_localhost_replica=1`.
:::

## max_rows_to_sort {#max_rows_to_sort}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество строк до сортировки. Это позволяет ограничить потребление памяти при сортировке. Если для операции ORDER BY необходимо обработать больше указанного количества записей, поведение будет определено режимом `sort_overflow_mode`, который по умолчанию установлен в `throw`.

## max_rows_to_transfer {#max_rows_to_transfer}

Тип: UInt64

Значение по умолчанию: 0

Максимальный размер (в строках), который может быть передан на удаленный сервер или сохранен во временной таблице, когда выполняется секция GLOBAL IN/JOIN.

## max_sessions_for_user {#max_sessions_for_user}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество одновременных сеансов для авторизованного пользователя на сервере ClickHouse.

Пример:

```xml
<profiles>
    <single_session_profile>
        <max_sessions_for_user>1</max_sessions_for_user>
    </single_session_profile>
    <two_sessions_profile>
        <max_sessions_for_user>2</max_sessions_for_user>
    </two_sessions_profile>
    <unlimited_sessions_profile>
        <max_sessions_for_user>0</max_sessions_for_user>
    </unlimited_sessions_profile>
</profiles>
<users>
    <!-- Пользователь Алиса может подключаться к серверу ClickHouse не более одного раза одновременно. -->
    <Alice>
        <profile>single_session_profile</profile>
    </Alice>
    <!-- Пользователь Боб может использовать 2 одновременных сеанса. -->
    <Bob>
        <profile>two_sessions_profile</profile>
    </Bob>
    <!-- Пользователь Чарльз может использовать произвольное количество одновременных сеансов. -->
    <Charles>
        <profile>unlimited_sessions_profile</profile>
    </Charles>
</users>
```

Возможные значения:
- Положительное целое число.
- `0` - неограниченное количество одновременных сеансов (по умолчанию).

## max_size_to_preallocate_for_aggregation {#max_size_to_preallocate_for_aggregation}

Тип: UInt64

Значение по умолчанию: 1000000000000

На сколько элементов разрешено предвариательно выделять место во всех хеш-таблицах в целом перед агрегацией.

## max_size_to_preallocate_for_joins {#max_size_to_preallocate_for_joins}

Тип: UInt64

Значение по умолчанию: 1000000000000

На сколько элементов разрешено предвариательно выделять место во всех хеш-таблицах в целом перед соединением.

## max_streams_for_merge_tree_reading {#max_streams_for_merge_tree_reading}

Тип: UInt64

Значение по умолчанию: 0

Если не равно нулю, ограничьте количество потоков чтения для таблицы MergeTree.

## max_streams_multiplier_for_merge_tables {#max_streams_multiplier_for_merge_tables}

Тип: Float

Значение по умолчанию: 5

Запрашивайте больше потоков при чтении из таблицы Merge. Потоки будут распределены по таблицам, которые будет использовать таблица Merge. Это позволяет более равномерно распределить работу между потоками и особенно полезно, когда объединяемые таблицы отличаются по размеру.

## max_streams_to_max_threads_ratio {#max_streams_to_max_threads_ratio}

Тип: Float

Значение по умолчанию: 1

Позволяет использовать больше источников, чем количество потоков — чтобы равномернее распределить работу между потоками. Предполагается, что это временное решение, так как в будущем будет возможно сделать количество источников равным количеству потоков, но для каждого источника динамически выбирать доступную работу для себя.

## max_subquery_depth {#max_subquery_depth}

Тип: UInt64

Значение по умолчанию: 100

Если запрос имеет более указанного количества вложенных подзапросов, возникает исключение.

:::tip
Это позволяет вам иметь проверку на здоровье, чтобы защитить пользователей вашего кластера от написания чрезмерно сложных запросов.
:::

## max_table_size_to_drop {#max_table_size_to_drop}

Тип: UInt64

Значение по умолчанию: 50000000000

Ограничение на удаление таблиц во время выполнения запроса. Значение 0 означает, что вы можете удалять все таблицы без каких-либо ограничений.

Облачное значение по умолчанию: 1 ТБ.

:::note
Эта настройка запроса перезаписывает ее эквивалент серверной настройки, см. [max_table_size_to_drop](/operations/server-configuration-parameters/settings#max_table_size_to_drop)
:::

## max_temporary_columns {#max_temporary_columns}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество временных колонок, которые должны храниться в оперативной памяти одновременно при выполнении запроса, включая постоянные колонки. Если запрос генерирует более указанного количества временных колонок в памяти в результате промежуточного вычисления, то возникает исключение.

:::tip
Эта настройка полезна для предотвращения чрезмерно сложных запросов.
:::

Значение `0` означает неограниченно.

## max_temporary_data_on_disk_size_for_query {#max_temporary_data_on_disk_size_for_query}

Тип: UInt64

Значение по умолчанию: 0

Максимальный объем данных, потребляемых временными файлами на диске в байтах для всех одновременно выполняемых запросов.

Возможные значения:

- Положительное целое число.
- `0` — неограниченно (по умолчанию).

## max_temporary_data_on_disk_size_for_user {#max_temporary_data_on_disk_size_for_user}

Тип: UInt64

Значение по умолчанию: 0

Максимальный объем данных, потребляемых временными файлами на диске в байтах для всех одновременно выполняемых пользовательских запросов.

Возможные значения:

- Положительное целое число.
- `0` — неограниченно (по умолчанию).

## max_temporary_non_const_columns {#max_temporary_non_const_columns}

Тип: UInt64

Значение по умолчанию: 0

Как и `max_temporary_columns`, максимальное количество временных колонок, которые должны храниться в оперативной памяти одновременно при выполнении запроса, но без учета постоянных колонок.

:::note
Постоянные колонки формируются довольно часто во время выполнения запроса, но требуют примерно нулевых вычислительных ресурсов.
:::

## max_threads {#max_threads}

Тип: MaxThreads

Значение по умолчанию: 'auto(14)'

Максимальное количество потоков для обработки запроса, исключая потоки для извлечения данных с удаленных серверов (см. параметр 'max_distributed_connections').

Этот параметр применяется к потокам, которые выполняют одни и те же этапы конвейера обработки запроса параллельно. Например, при чтении из таблицы, если возможно оценить выражения с функциями, выполнить фильтрацию с помощью WHERE и предварительно агрегировать для GROUP BY параллельно, используя как минимум 'max_threads' количество потоков, то используются 'max_threads'.

Для быстро завершающихся запросов из-за LIMIT вы можете установить более низкий 'max_threads'. Например, если необходимое количество записей расположено в каждом блоке и max_threads = 8, то извлекаются 8 блоков, хотя было бы достаточно прочитать только один.

Меньшее значение `max_threads` приводит к меньшему потреблению памяти.

## max_threads_for_indexes {#max_threads_for_indexes}

Тип: UInt64

Значение по умолчанию: 0

Максимальное число потоков для обработки индексов.

## max_untracked_memory {#max_untracked_memory}

Тип: UInt64

Значение по умолчанию: 4194304

Небольшие выделения и деалокации группируются в локальной переменной потока и отслеживаются или профилируются только тогда, когда сумма (в абсолютном значении) становится больше указанного значения. Если значение выше 'memory_profiler_step', оно будет эффективно снижено до 'memory_profiler_step'.

## memory_overcommit_ratio_denominator {#memory_overcommit_ratio_denominator}

Тип: UInt64

Значение по умолчанию: 1073741824

Обозначает мягкий предел оперативной памяти, когда достигнут жесткий предел на глобальном уровне. Это значение используется для вычисления коэффициента перерасхода для запроса. Ноль означает пропустить запрос. Подробнее о [перерасходе памяти](memory-overcommit.md).

## memory_overcommit_ratio_denominator_for_user {#memory_overcommit_ratio_denominator_for_user}

Тип: UInt64

Значение по умолчанию: 1073741824

Обозначает мягкий предел оперативной памяти, когда достигнут жесткий предел на уровне пользователя. Это значение используется для вычисления коэффициента перерасхода для запроса. Ноль означает пропустить запрос. Подробнее о [перерасходе памяти](memory-overcommit.md).

## memory_profiler_sample_max_allocation_size {#memory_profiler_sample_max_allocation_size}

Тип: UInt64

Значение по умолчанию: 0

Собирает случайные выделения размера, менее или равного указанному значению с вероятностью, равной `memory_profiler_sample_probability`. 0 означает отключено. Вы можете установить 'max_untracked_memory' на 0, чтобы сделать этот порог работающим, как ожидается.

## memory_profiler_sample_min_allocation_size {#memory_profiler_sample_min_allocation_size}

Тип: UInt64

Значение по умолчанию: 0

Собирает случайные выделения размера, более или равного указанному значению с вероятностью, равной `memory_profiler_sample_probability`. 0 означает отключено. Вы можете установить 'max_untracked_memory' на 0, чтобы сделать этот порог работающим, как ожидается.

## memory_profiler_sample_probability {#memory_profiler_sample_probability}

Тип: Float

Значение по умолчанию: 0

Собирает случайные выделения и деалокации и записывает их в system.trace_log с типом трассировки 'MemorySample'. Вероятность относится к каждому выделению/освобождению независимо от размера выделения (можно изменить с помощью `memory_profiler_sample_min_allocation_size` и `memory_profiler_sample_max_allocation_size`). Обратите внимание, что выборка происходит только тогда, когда сумма неотслеживаемой памяти превышает 'max_untracked_memory'. Вы можете установить 'max_untracked_memory' на 0 для более детальной выборки.

## memory_profiler_step {#memory_profiler_step}

Тип: UInt64

Значение по умолчанию: 4194304

Устанавливает шаг профилировщика памяти. Каждый раз, когда использование памяти запроса становится больше каждого следующего шага в байтах, профилировщик памяти будет собирать стек вызовов аллокации и записывать его в [trace_log](/operations/system-tables/trace_log).

Возможные значения:

- Положительное целое число байт.

- 0 для отключения профилировщика памяти.

## memory_tracker_fault_probability {#memory_tracker_fault_probability}

Тип: Float

Значение по умолчанию: 0

Для тестирования `exception safety` - выбрасывайте исключение каждый раз, когда выделяете память с указанной вероятностью.

## memory_usage_overcommit_max_wait_microseconds {#memory_usage_overcommit_max_wait_microseconds}

Тип: UInt64

Значение по умолчанию: 5000000

Максимальное время, которое поток будет ждать освобождения памяти в случае перерасхода памяти на уровне пользователя. Если достигнут тайм-аут и память не освобождена, возникает исключение. Подробнее о [перерасходе памяти](memory-overcommit.md).
```yaml
title: 'Параметры конфигурации MergeTree'
sidebar_label: 'Параметры MergeTree'
keywords: ['merge', 'configuration', 'ClickHouse']
description: 'Параметры конфигурации для работы с таблицами MergeTree в ClickHouse.'
```

## merge_table_max_tables_to_look_for_schema_inference {#merge_table_max_tables_to_look_for_schema_inference}



Тип: UInt64

Значение по умолчанию: 1000

При создании таблицы `Merge` без явной схемы или при использовании табличной функции `merge` схема выводится как объединение не более указанного числа подходящих таблиц. Если число таблиц больше, схема будет выведена из первых указанных таблиц.
## merge_tree_coarse_index_granularity {#merge_tree_coarse_index_granularity}



Тип: UInt64

Значение по умолчанию: 8

При поиске данных ClickHouse проверяет метки данных в файле индекса. Если ClickHouse находит, что необходимые ключи находятся в каком-то диапазоне, он делит этот диапазон на `merge_tree_coarse_index_granularity` поддиапазонов и рекурсивно ищет необходимые ключи там.

Возможные значения:

- Любое положительное четное целое число.
## merge_tree_compact_parts_min_granules_to_multibuffer_read {#merge_tree_compact_parts_min_granules_to_multibuffer_read}


<CloudAvailableBadge/>

Тип: UInt64

Значение по умолчанию: 16

Имеет значение только в ClickHouse Cloud. Количество гранул в полосе компактной части таблиц MergeTree, для использования многобуферного чтения, которое поддерживает параллельное чтение и предвыемку. В случае чтения из удаленной файловой системы использование многобуферного чтения увеличивает количество запросов на чтение.
## merge_tree_determine_task_size_by_prewhere_columns {#merge_tree_determine_task_size_by_prewhere_columns}



Тип: Bool

Значение по умолчанию: 1

Использовать только размер столбцов prewhere для определения размера задачи чтения.
## merge_tree_max_bytes_to_use_cache {#merge_tree_max_bytes_to_use_cache}



Тип: UInt64

Значение по умолчанию: 2013265920

Если ClickHouse должен прочитать более `merge_tree_max_bytes_to_use_cache` байт в одном запросе, он не использует кэш некомпрессированных блоков.

Кэш некомпрессированных блоков хранит данные, извлеченные для запросов. ClickHouse использует этот кэш для ускорения ответов на повторяющиеся небольшие запросы. Эта настройка защищает кэш от уничтожения запросами, которые читают большое количество данных. Настройка [uncompressed_cache_size](/operations/server-configuration-parameters/settings#uncompressed_cache_size) сервера определяет размер кэша некомпрессированных блоков.

Возможные значения:

- Любое положительное целое число.
## merge_tree_max_rows_to_use_cache {#merge_tree_max_rows_to_use_cache}



Тип: UInt64

Значение по умолчанию: 1048576

Если ClickHouse должен прочитать более `merge_tree_max_rows_to_use_cache` строк в одном запросе, он не использует кэш некомпрессированных блоков.

Кэш некомпрессированных блоков хранит данные, извлеченные для запросов. ClickHouse использует этот кэш для ускорения ответов на повторяющиеся небольшие запросы. Эта настройка защищает кэш от уничтожения запросами, которые читают большое количество данных. Настройка [uncompressed_cache_size](/operations/server-configuration-parameters/settings#uncompressed_cache_size) сервера определяет размер кэша некомпрессированных блоков.

Возможные значения:

- Любое положительное целое число.
## merge_tree_min_bytes_for_concurrent_read {#merge_tree_min_bytes_for_concurrent_read}



Тип: UInt64

Значение по умолчанию: 251658240

Если количество байт, читаемых из одного файла таблицы с движком [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md), превышает `merge_tree_min_bytes_for_concurrent_read`, тогда ClickHouse пытается читать из этого файла одновременно в нескольких потоках.

Возможное значение:

- Положительное целое число.
## merge_tree_min_bytes_for_concurrent_read_for_remote_filesystem {#merge_tree_min_bytes_for_concurrent_read_for_remote_filesystem}



Тип: UInt64

Значение по умолчанию: 0

Минимальное количество байт для чтения из одного файла перед тем, как движок [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md) может параллелить чтение, при чтении из удаленной файловой системы. Мы не рекомендуем использовать эту настройку.

Возможные значения:

- Положительное целое число.
## merge_tree_min_bytes_for_seek {#merge_tree_min_bytes_for_seek}



Тип: UInt64

Значение по умолчанию: 0

Если расстояние между двумя блоками данных, которые нужно прочитать в одном файле, меньше `merge_tree_min_bytes_for_seek` байт, тогда ClickHouse последовательно считывает диапазон файла, который содержит оба блока, тем самым избегая лишних поисков.

Возможные значения:

- Любое положительное целое число.
## merge_tree_min_bytes_per_task_for_remote_reading {#merge_tree_min_bytes_per_task_for_remote_reading}



Тип: UInt64

Значение по умолчанию: 2097152

Минимальное количество байт для чтения на задачу.
## merge_tree_min_read_task_size {#merge_tree_min_read_task_size}



Тип: UInt64

Значение по умолчанию: 8

Жесткий нижний предел для размера задачи (даже когда количество гранул низкое, и количество доступных потоков велико, мы не выделим меньшие задачи).
## merge_tree_min_rows_for_concurrent_read {#merge_tree_min_rows_for_concurrent_read}



Тип: UInt64

Значение по умолчанию: 163840

Если количество строк, которые нужно прочитать из файла таблицы с движком [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md), превышает `merge_tree_min_rows_for_concurrent_read`, тогда ClickHouse пытается произвести параллельное чтение из этого файла в нескольких потоках.

Возможные значения:

- Положительное целое число.
## merge_tree_min_rows_for_concurrent_read_for_remote_filesystem {#merge_tree_min_rows_for_concurrent_read_for_remote_filesystem}



Тип: UInt64

Значение по умолчанию: 0

Минимальное количество строк для чтения из одного файла перед тем, как движок [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md) может параллелить чтение, при чтении из удаленной файловой системы. Мы не рекомендуем использовать эту настройку.

Возможные значения:

- Положительное целое число.
## merge_tree_min_rows_for_seek {#merge_tree_min_rows_for_seek}



Тип: UInt64

Значение по умолчанию: 0

Если расстояние между двумя блоками данных, которые нужно прочитать в одном файле, меньше `merge_tree_min_rows_for_seek` строк, тогда ClickHouse не перемещается по файлу, а читает данные последовательно.

Возможные значения:

- Любое положительное целое число.
## merge_tree_read_split_ranges_into_intersecting_and_non_intersecting_injection_probability {#merge_tree_read_split_ranges_into_intersecting_and_non_intersecting_injection_probability}



Тип: Float

Значение по умолчанию: 0

Для тестирования `PartsSplitter` - разделение читаемых диапазонов на пересекающиеся и непересекающиеся каждый раз, когда вы читаете из MergeTree с указанной вероятностью.
## merge_tree_use_const_size_tasks_for_remote_reading {#merge_tree_use_const_size_tasks_for_remote_reading}



Тип: Bool

Значение по умолчанию: 1

Использовать задачи фиксированного размера для чтения из удаленной таблицы.
## merge_tree_use_deserialization_prefixes_cache {#merge_tree_use_deserialization_prefixes_cache}



Тип: Bool

Значение по умолчанию: 1

Включает кэширование метаданных столбцов из префиксов файла при чтении из широких частей в MergeTree.
## merge_tree_use_prefixes_deserialization_thread_pool {#merge_tree_use_prefixes_deserialization_thread_pool}



Тип: Bool

Значение по умолчанию: 1

Включает использование пула потоков для параллельного чтения префиксов в широких частях в MergeTree. Размер этого пула потоков контролируется настройкой сервера `max_prefixes_deserialization_thread_pool_size`.
## merge_tree_use_v1_object_and_dynamic_serialization {#merge_tree_use_v1_object_and_dynamic_serialization}



Тип: Bool

Значение по умолчанию: 0

При включении будет использоваться версия сериализации V1 для типов JSON и Dynamic в MergeTree вместо V2. Изменение этой настройки вступает в силу только после перезапуска сервера.
## metrics_perf_events_enabled {#metrics_perf_events_enabled}



Тип: Bool

Значение по умолчанию: 0

Если включено, некоторые события производительности будут измеряться в процессе выполнения запросов.
## metrics_perf_events_list {#metrics_perf_events_list}



Тип: String

Значение по умолчанию: 

Список метрик производительности, разделенных запятыми, которые будут измеряться во время выполнения запросов. Пустое значение означает все события. См. PerfEventInfo в источниках для доступных событий.
## min_bytes_to_use_direct_io {#min_bytes_to_use_direct_io}



Тип: UInt64

Значение по умолчанию: 0

Минимальный объем данных, необходимый для использования прямого доступа к диску хранилища.

ClickHouse использует эту настройку при чтении данных из таблиц. Если общий объем хранилища всех данных для чтения превышает `min_bytes_to_use_direct_io` байт, ClickHouse читает данные из диска хранения с опцией `O_DIRECT`.

Возможные значения:

- 0 — Прямой доступ отключен.
- Положительное целое число.
## min_bytes_to_use_mmap_io {#min_bytes_to_use_mmap_io}



Тип: UInt64

Значение по умолчанию: 0

Это экспериментальная настройка. Устанавливает минимальное количество памяти для чтения больших файлов без копирования данных из ядра в пространство пользователя. Рекомендуемый порог составляет около 64 МБ, поскольку [mmap/munmap](https://en.wikipedia.org/wiki/Mmap) является медленным. Это имеет смысл только для больших файлов и помогает только если данные находятся в кэше страниц.

Возможные значения:

- Положительное целое число.
- 0 — Большие файлы читаются только с копированием данных из ядра в пространство пользователя.
## min_chunk_bytes_for_parallel_parsing {#min_chunk_bytes_for_parallel_parsing}



Тип: NonZeroUInt64

Значение по умолчанию: 10485760

- Тип: беззнаковое целое число
- Значение по умолчанию: 1 МБ

Минимальный размер чанка в байтах, который каждый поток будет разбирать параллельно.
## min_compress_block_size {#min_compress_block_size}



Тип: UInt64

Значение по умолчанию: 65536

Для таблиц [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md). Чтобы уменьшить задержки при обработке запросов, блок сжимается при записи следующей метки, если его размер составляет не менее `min_compress_block_size`. По умолчанию 65 536.

Фактический размер блока, если нефайловые данные меньше `max_compress_block_size`, не меньше этого значения и не меньше объема данных для одной метки.

Рассмотрим пример. Предположим, что `index_granularity` была установлена на 8192 при создании таблицы.

Мы записываем столбец типа UInt32 (4 байта на значение). При записи 8192 строк общий объем составит 32 КБ данных. Поскольку min_compress_block_size = 65 536, сжатый блок будет сформирован для каждых двух меток.

Мы записываем столбец URL типа String (средний размер 60 байт на значение). При записи 8192 строк средний объем будет немного меньше 500 КБ данных. Поскольку это больше 65 536, сжатый блок будет сформирован для каждой метки. В этом случае, при чтении данных с диска в диапазоне одной метки лишние данные не будут распакованы.

:::note
Это настройка на экспертном уровне, и вам не следует изменять ее, если вы только начинаете работать с ClickHouse.
:::
## min_count_to_compile_aggregate_expression {#min_count_to_compile_aggregate_expression}



Тип: UInt64

Значение по умолчанию: 3

Минимальное количество идентичных агрегатных выражений, чтобы начать JIT-компиляцию. Работает только если включена настройка [compile_aggregate_expressions](#compile_aggregate_expressions).

Возможные значения:

- Положительное целое число.
- 0 — Идентичные агрегатные выражения всегда JIT-компилируются.
## min_count_to_compile_expression {#min_count_to_compile_expression}



Тип: UInt64

Значение по умолчанию: 3

Минимальное количество запусков одного и того же выражения перед компиляцией.
## min_count_to_compile_sort_description {#min_count_to_compile_sort_description}



Тип: UInt64

Значение по умолчанию: 3

Количество идентичных описаний сортировки перед их JIT-компиляцией.
## min_execution_speed {#min_execution_speed}



Тип: UInt64

Значение по умолчанию: 0

Минимальная скорость выполнения в строках в секунду. Проверяется в каждом блоке данных по истечении [`timeout_before_checking_execution_speed`](/operations/settings/settings#timeout_before_checking_execution_speed). Если скорость выполнения ниже, возникает исключение.
## min_execution_speed_bytes {#min_execution_speed_bytes}



Тип: UInt64

Значение по умолчанию: 0

Минимальное количество байт выполнения в секунду. Проверяется в каждом блоке данных по истечении [`timeout_before_checking_execution_speed`](/operations/settings/settings#timeout_before_checking_execution_speed). Если скорость выполнения ниже, возникает исключение.
## min_external_sort_block_bytes {#min_external_sort_block_bytes}



Тип: UInt64

Значение по умолчанию: 104857600

Минимальный размер блока в байтах для внешней сортировки, который будет сброшен на диск, чтобы избежать слишком большого количества файлов.
## min_external_table_block_size_bytes {#min_external_table_block_size_bytes}



Тип: UInt64

Значение по умолчанию: 268402944

Сжать блоки, переданные внешней таблице, до указанного размера в байтах, если блоки недостаточно велики.
## min_external_table_block_size_rows {#min_external_table_block_size_rows}



Тип: UInt64

Значение по умолчанию: 1048449

Сжать блоки, переданные внешней таблице, до указанного размера в строках, если блоки недостаточно велики.
## min_free_disk_bytes_to_perform_insert {#min_free_disk_bytes_to_perform_insert}



Тип: UInt64

Значение по умолчанию: 0

Минимальное количество свободного дискового пространства в байтах для выполнения вставки.
## min_free_disk_ratio_to_perform_insert {#min_free_disk_ratio_to_perform_insert}



Тип: Float

Значение по умолчанию: 0

Минимальная доля свободного дискового пространства для выполнения вставки.
## min_free_disk_space_for_temporary_data {#min_free_disk_space_for_temporary_data}



Тип: UInt64

Значение по умолчанию: 0

Минимальное дисковое пространство, которое необходимо сохранить при записи временных данных, используемых во внешней сортировке и агрегации.
## min_hit_rate_to_use_consecutive_keys_optimization {#min_hit_rate_to_use_consecutive_keys_optimization}



Тип: Float

Значение по умолчанию: 0.5

Минимальная частота попаданий кэша, используемая для оптимизации последовательных ключей в агрегации, чтобы сохранить ее включенной.
## min_insert_block_size_bytes {#min_insert_block_size_bytes}



Тип: UInt64

Значение по умолчанию: 268402944

Устанавливает минимальное количество байт в блоке, который может быть вставлен в таблицу с помощью запроса `INSERT`. Блоки меньшего размера сжимаются в большие.

Возможные значения:

- Положительное целое число.
- 0 — Сжатие отключено.
## min_insert_block_size_bytes_for_materialized_views {#min_insert_block_size_bytes_for_materialized_views}



Тип: UInt64

Значение по умолчанию: 0

Устанавливает минимальное количество байт в блоке, который может быть вставлен в таблицу с помощью запроса `INSERT`. Блоки меньшего размера сжимаются в большие. Эта настройка применяется только к блокам, вставляемым в [материализованное представление](../../sql-reference/statements/create/view.md). Регулируя эту настройку, вы контролируете сжатие блоков при отправке в материализованное представление и избегаете чрезмерного использования памяти.

Возможные значения:

- Любое положительное целое число.
- 0 — Сжатие отключено.

**См. также**

- [min_insert_block_size_bytes](#min_insert_block_size_bytes)
## min_insert_block_size_rows {#min_insert_block_size_rows}



Тип: UInt64

Значение по умолчанию: 1048449

Устанавливает минимальное количество строк в блоке, которые могут быть вставлены в таблицу с помощью запроса `INSERT`. Блоки меньшего размера сжимаются в большие.

Возможные значения:

- Положительное целое число.
- 0 — Сжатие отключено.
## min_insert_block_size_rows_for_materialized_views {#min_insert_block_size_rows_for_materialized_views}



Тип: UInt64

Значение по умолчанию: 0

Устанавливает минимальное количество строк в блоке, которые могут быть вставлены в таблицу с помощью запроса `INSERT`. Блоки меньшего размера сжимаются в большие. Эта настройка применяется только к блокам, вставляемым в [материализованное представление](../../sql-reference/statements/create/view.md). Регулируя эту настройку, вы контролируете сжатие блоков при отправке в материализованное представление и избегаете чрезмерного использования памяти.

Возможные значения:

- Любое положительное целое число.
- 0 — Сжатие отключено.

**См. также**

- [min_insert_block_size_rows](#min_insert_block_size_rows)
## min_joined_block_size_bytes {#min_joined_block_size_bytes}



Тип: UInt64

Значение по умолчанию: 524288

Минимальный размер блока для результата JOIN (если алгоритм соединения поддерживает это). 0 означает неограниченный.
## mongodb_throw_on_unsupported_query {#mongodb_throw_on_unsupported_query}



Тип: Bool

Значение по умолчанию: 1

Если включено, таблицы MongoDB будут возвращать ошибку, когда нельзя построить запрос к MongoDB. В противном случае ClickHouse считывает полную таблицу и обрабатывает ее локально. Эта опция не применяется, когда 'allow_experimental_analyzer=0'.
## move_all_conditions_to_prewhere {#move_all_conditions_to_prewhere}



Тип: Bool

Значение по умолчанию: 1

Переместить все подходящие условия из WHERE в PREWHERE.
## move_primary_key_columns_to_end_of_prewhere {#move_primary_key_columns_to_end_of_prewhere}



Тип: Bool

Значение по умолчанию: 1

Переместить условия PREWHERE, содержащие столбцы первичного ключа, в конец цепочки AND. Скорее всего, эти условия учитываются при анализе первичного ключа и, таким образом, не будут сильно влиять на фильтрацию PREWHERE.
## multiple_joins_try_to_keep_original_names {#multiple_joins_try_to_keep_original_names}



Тип: Bool

Значение по умолчанию: 0

Не добавлять псевдонимы в верхний уровень списка выражений в переписи нескольких соединений.
## mutations_execute_nondeterministic_on_initiator {#mutations_execute_nondeterministic_on_initiator}



Тип: Bool

Значение по умолчанию: 0

Если true, постоянные недетерминированные функции (например, функция `now()`) выполняются на инициаторе и заменяются литералами в запросах `UPDATE` и `DELETE`. Это помогает поддерживать синхронизацию данных на репликах при выполнении мутаций с постоянными недетерминированными функциями. Значение по умолчанию: `false`.
## mutations_execute_subqueries_on_initiator {#mutations_execute_subqueries_on_initiator}



Тип: Bool

Значение по умолчанию: 0

Если true, скалярные подзапросы выполняются на инициаторе и заменяются литералами в запросах `UPDATE` и `DELETE`. Значение по умолчанию: `false`.
## mutations_max_literal_size_to_replace {#mutations_max_literal_size_to_replace}



Тип: UInt64

Значение по умолчанию: 16384

Максимальный размер сериализованного литерала в байтах для замены в запросах `UPDATE` и `DELETE`. Действует только в том случае, если включена хотя бы одна из двух настроек выше. Значение по умолчанию: 16384 (16 КБ).
## mutations_sync {#mutations_sync}



Тип: UInt64

Значение по умолчанию: 0

Позволяет выполнять запросы `ALTER TABLE ... UPDATE|DELETE|MATERIALIZE INDEX|MATERIALIZE PROJECTION|MATERIALIZE COLUMN|MATERIALIZE STATISTICS` ([мутации](../../sql-reference/statements/alter/index.md/#mutations)) синхронно.

Возможные значения:

- 0 - Мутации выполняются асинхронно.
- 1 - Запрос ждет завершения всех мутаций на текущем сервере.
- 2 - Запрос ждет завершения всех мутаций на всех репликах (если они существуют).
## mysql_datatypes_support_level {#mysql_datatypes_support_level}



Тип: MySQLDataTypesSupport

Значение по умолчанию: 

Определяет, как типы MySQL конвертируются в соответствующие типы ClickHouse. Список, разделенный запятыми, в любой комбинации из `decimal`, `datetime64`, `date2Date32` или `date2String`.
- `decimal`: конвертировать типы `NUMERIC` и `DECIMAL` в `Decimal`, когда это возможно.
- `datetime64`: конвертировать типы `DATETIME` и `TIMESTAMP` в `DateTime64` вместо `DateTime`, когда точность не равна `0`.
- `date2Date32`: конвертировать `DATE` в `Date32` вместо `Date`. Имеет приоритет над `date2String`.
- `date2String`: конвертировать `DATE` в `String` вместо `Date`. Переопределяется `datetime64`.
## mysql_map_fixed_string_to_text_in_show_columns {#mysql_map_fixed_string_to_text_in_show_columns}



Тип: Bool

Значение по умолчанию: 1

Когда включено, тип данных ClickHouse [FixedString](../../sql-reference/data-types/fixedstring.md) будет отображаться как `TEXT` в [SHOW COLUMNS](../../sql-reference/statements/show.md/#show_columns).

Это имеет значение только когда подключение производится через MySQL wire protocol.

- 0 - Использовать `BLOB`.
- 1 - Использовать `TEXT`.
## mysql_map_string_to_text_in_show_columns {#mysql_map_string_to_text_in_show_columns}



Тип: Bool

Значение по умолчанию: 1

Когда включено, тип данных ClickHouse [String](../../sql-reference/data-types/string.md) будет отображаться как `TEXT` в [SHOW COLUMNS](../../sql-reference/statements/show.md/#show_columns).

Это имеет значение только когда подключение производится через MySQL wire protocol.

- 0 - Использовать `BLOB`.
- 1 - Использовать `TEXT`.
## mysql_max_rows_to_insert {#mysql_max_rows_to_insert}



Тип: UInt64

Значение по умолчанию: 65536

Максимальное количество строк в пакетной вставке MySQL движка хранения MySQL.
## network_compression_method {#network_compression_method}



Тип: String

Значение по умолчанию: LZ4

Устанавливает метод сжатия данных, который используется для связи между серверами и между сервером и [clickhouse-client](../../interfaces/cli.md).

Возможные значения:

- `LZ4` — устанавливает метод сжатия LZ4.
- `ZSTD` — устанавливает метод сжатия ZSTD.

**См. также**

- [network_zstd_compression_level](#network_zstd_compression_level)
## network_zstd_compression_level {#network_zstd_compression_level}



Тип: Int64

Значение по умолчанию: 1

Настраивает уровень сжатия ZSTD. Используется только тогда, когда [network_compression_method](#network_compression_method) установлен на `ZSTD`.

Возможные значения:

- Положительное целое число от 1 до 15.
## normalize_function_names {#normalize_function_names}



Тип: Bool

Значение по умолчанию: 1

Нормализовать имена функций до их канонических имен.
## number_of_mutations_to_delay {#number_of_mutations_to_delay}



Тип: UInt64

Значение по умолчанию: 0

Если измененная таблица содержит как минимум столько незавершенных мутаций, искусственно замедлить мутации таблицы. 0 - отключено.
## number_of_mutations_to_throw {#number_of_mutations_to_throw}



Тип: UInt64

Значение по умолчанию: 0

Если измененная таблица содержит как минимум столько незавершенных мутаций, выбросить исключение 'Слишком много мутаций ...'. 0 - отключено.
## odbc_bridge_connection_pool_size {#odbc_bridge_connection_pool_size}



Тип: UInt64

Значение по умолчанию: 16

Размер пула соединений для каждой строки параметров соединения в ODBC мосту.
## odbc_bridge_use_connection_pooling {#odbc_bridge_use_connection_pooling}



Тип: Bool

Значение по умолчанию: 1

Использовать пул соединений в ODBC мосту. Если установлено в false, новое соединение создается каждый раз.
## offset {#offset}



Тип: UInt64

Значение по умолчанию: 0

Устанавливает количество строк для пропуска перед началом возврата строк из запроса. Это корректирует смещение, установленное оператором [OFFSET](/sql-reference/statements/select/offset), так что эти два значения суммируются.

Возможные значения:

- 0 — Не пропущено строк.
- Положительное целое число.

**Пример**

Исходная таблица:

```sql
CREATE TABLE test (i UInt64) ENGINE = MergeTree() ORDER BY i;
INSERT INTO test SELECT number FROM numbers(500);
```

Запрос:

```sql
SET limit = 5;
SET offset = 7;
SELECT * FROM test LIMIT 10 OFFSET 100;
```
Результат:

```text
┌───i─┐
│ 107 │
│ 108 │
│ 109 │
└─────┘
```
## opentelemetry_start_trace_probability {#opentelemetry_start_trace_probability}



Тип: Float

Значение по умолчанию: 0

Устанавливает вероятность того, что ClickHouse может начать трассировку для выполняемых запросов (если не задан родительский [контекст трассировки](https://www.w3.org/TR/trace-context/)).

Возможные значения:

- 0 — Трассировка для всех выполняемых запросов отключена (если не задан родительский контекст трассировки).
- Положительное число с плавающей запятой в диапазоне [0..1]. Например, если значение настройки равно `0,5`, ClickHouse может начать трассировку в среднем для половины запросов.
- 1 — Трассировка для всех выполняемых запросов включена.
## opentelemetry_trace_processors {#opentelemetry_trace_processors}



Тип: Bool

Значение по умолчанию: 0

Собирать спаны OpenTelemetry для процессоров.
## optimize_aggregation_in_order {#optimize_aggregation_in_order}



Тип: Bool

Значение по умолчанию: 0

Включает оптимизацию [GROUP BY](/sql-reference/statements/select/group-by) в запросах [SELECT](../../sql-reference/statements/select/index.md) для агрегации данных в соответствующем порядке в таблицах [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md).

Возможные значения:

- 0 — Оптимизация `GROUP BY` отключена.
- 1 — Оптимизация `GROUP BY` включена.

**См. также**

- [Оптимизация GROUP BY](/sql-reference/statements/select/group-by#group-by-optimization-depending-on-table-sorting-key)
## optimize_aggregators_of_group_by_keys {#optimize_aggregators_of_group_by_keys}



Тип: Bool

Значение по умолчанию: 1

Устраняет агрегаторы min/max/any/anyLast для ключей GROUP BY в разделе SELECT.
## optimize_and_compare_chain {#optimize_and_compare_chain}



Тип: Bool

Значение по умолчанию: 1

Наполняет постоянное сравнение в цепочках AND, чтобы улучшить возможности фильтрации. Поддерживаются операторы `<`, `<=`, `>`, `>=`, `=` и их смеси. Например, `(a < b) AND (b < c) AND (c < 5)` можно переписать как `(a < b) AND (b < c) AND (c < 5) AND (b < 5) AND (a < 5)`.
## optimize_append_index {#optimize_append_index}



Тип: Bool

Значение по умолчанию: 0

Использовать [ограничения](../../sql-reference/statements/create/table.md/#constraints) для добавления условия индекса. По умолчанию `false`.

Возможные значения:

- true, false
## optimize_arithmetic_operations_in_aggregate_functions {#optimize_arithmetic_operations_in_aggregate_functions}



Тип: Bool

Значение по умолчанию: 1

Переместить арифметические операции за пределы агрегатных функций.
## optimize_count_from_files {#optimize_count_from_files}



Тип: Bool

Значение по умолчанию: 1

Включает или отключает оптимизацию подсчета количества строк из файлов в различных входных форматах. Это применяется к табличным функциям/движкам `file`/`s3`/`url`/`hdfs`/`azureBlobStorage`.

Возможные значения:

- 0 — Оптимизация отключена.
- 1 — Оптимизация включена.
## optimize_distinct_in_order {#optimize_distinct_in_order}



Тип: Bool

Значение по умолчанию: 1

Включить оптимизацию DISTINCT, если некоторые столбцы в DISTINCT образуют префикс сортировки. Например, префикс сортировки в merge tree или операторе ORDER BY.
## optimize_distributed_group_by_sharding_key {#optimize_distributed_group_by_sharding_key}



Тип: Bool

Значение по умолчанию: 1

Оптимизировать запросы `GROUP BY sharding_key`, избегая дорогостоящей агрегации на сервере-инициаторе (что уменьшит использование памяти для запроса на сервере-инициаторе).

Поддерживаются следующие типы запросов (и все их комбинации):

- `SELECT DISTINCT [..., ]sharding_key[, ...] FROM dist`
- `SELECT ... FROM dist GROUP BY sharding_key[, ...]`
- `SELECT ... FROM dist GROUP BY sharding_key[, ...] ORDER BY x`
- `SELECT ... FROM dist GROUP BY sharding_key[, ...] LIMIT 1`
- `SELECT ... FROM dist GROUP BY sharding_key[, ...] LIMIT 1 BY x`

Следующие типы запросов не поддерживаются (поддержка некоторых из них может быть добавлена позже):

- `SELECT ... GROUP BY sharding_key[, ...] WITH TOTALS`
- `SELECT ... GROUP BY sharding_key[, ...] WITH ROLLUP`
- `SELECT ... GROUP BY sharding_key[, ...] WITH CUBE`
- `SELECT ... GROUP BY sharding_key[, ...] SETTINGS extremes=1`

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

См. также:

- [distributed_group_by_no_merge](#distributed_group_by_no_merge)
- [distributed_push_down_limit](#distributed_push_down_limit)
- [optimize_skip_unused_shards](#optimize_skip_unused_shards)

:::note
На данный момент это требует `optimize_skip_unused_shards` (причина в том, что в один прекрасный день это может быть включено по умолчанию и будет работать правильно только если данные были вставлены через распределенную таблицу, т.е. данные распределены согласно sharding_key).
:::
## optimize_extract_common_expressions {#optimize_extract_common_expressions}



Тип: Bool

Значение по умолчанию: 1

Позволяет извлекать общие выражения из дизъюнкций в WHERE, PREWHERE, ON, HAVING и QUALIFY выражениях. Логическое выражение, такое как `(A AND B) OR (A AND C)`, может быть переписано как `A AND (B OR C)`, что может помочь использовать:
- индексы в простых выражениях фильтрации
- оптимизацию перекрестного соединения к внутреннему
## optimize_functions_to_subcolumns {#optimize_functions_to_subcolumns}



Тип: Bool

Значение по умолчанию: 1

Включает или отключает оптимизацию путем преобразования некоторых функций для чтения подстолбцов. Это уменьшает объем данных для чтения.

Эти функции могут быть преобразованы:

- [length](/sql-reference/functions/array-functions#length) для чтения подстолбца [size0](../../sql-reference/data-types/array.md/#array-size).
- [empty](/sql-reference/functions/array-functions#empty) для чтения подстолбца [size0](../../sql-reference/data-types/array.md/#array-size).
- [notEmpty](/sql-reference/functions/array-functions#notempty) для чтения подстолбца [size0](../../sql-reference/data-types/array.md/#array-size).
- [isNull](/sql-reference/functions/functions-for-nulls#isnull) для чтения подстолбца [null](../../sql-reference/data-types/nullable.md/#finding-null).
- [isNotNull](/sql-reference/functions/functions-for-nulls#isnotnull) для чтения подстолбца [null](../../sql-reference/data-types/nullable.md/#finding-null).
- [count](/sql-reference/aggregate-functions/reference/count) для чтения подстолбца [null](../../sql-reference/data-types/nullable.md/#finding-null).
- [mapKeys](/sql-reference/functions/tuple-map-functions#mapkeys) для чтения подстолбца [keys](/sql-reference/data-types/map#reading-subcolumns-of-map).
- [mapValues](/sql-reference/functions/tuple-map-functions#mapvalues) для чтения подстолбца [values](/sql-reference/data-types/map#reading-subcolumns-of-map).

Возможные значения:

- 0 — Оптимизация отключена.
- 1 — Оптимизация включена.
## optimize_group_by_constant_keys {#optimize_group_by_constant_keys}



Тип: Bool

Значение по умолчанию: 1

Оптимизировать GROUP BY, когда все ключи в блоке постоянны.
## optimize_group_by_function_keys {#optimize_group_by_function_keys}



Тип: Bool

Значение по умолчанию: 1

Устраняет функции других ключей в разделе GROUP BY.
## optimize_if_chain_to_multiif {#optimize_if_chain_to_multiif}



Тип: Bool

Значение по умолчанию: 0

Заменить цепочки if(cond1, then1, if(cond2, ...)) на multiIf. В настоящее время это не выгодно для числовых типов.
## optimize_if_transform_strings_to_enum {#optimize_if_transform_strings_to_enum}



Тип: Bool

Значение по умолчанию: 0

Заменяет аргументы строкового типа в If и Transform на enum. Отключено по умолчанию, так как это может вызвать несоответствующие изменения в распределенном запросе, что приведет к его сбою.
## optimize_injective_functions_in_group_by {#optimize_injective_functions_in_group_by}



Тип: Bool

Значение по умолчанию: 1

Заменяет инъективные функции их аргументами в разделе GROUP BY.
## optimize_injective_functions_inside_uniq {#optimize_injective_functions_inside_uniq}



Тип: Bool

Значение по умолчанию: 1

Удаляет инъективные функции с одним аргументом внутри функций uniq*().
## optimize_min_equality_disjunction_chain_length {#optimize_min_equality_disjunction_chain_length}



Тип: UInt64

Значение по умолчанию: 3

Минимальная длина выражения `expr = x1 OR ... expr = xN` для оптимизации.
```
```yaml
title: 'Настройки оптимизации'
keywords: ['оптимизация', 'настройки', 'ClickHouse']
description: 'Настройки для управления оптимизацией запросов и обработки данных в ClickHouse.'
```

## optimize_min_inequality_conjunction_chain_length {#optimize_min_inequality_conjunction_chain_length}

Тип: UInt64

Значение по умолчанию: 3

Минимальная длина выражения `expr <> x1 AND ... expr <> xN` для оптимизации

## optimize_move_to_prewhere {#optimize_move_to_prewhere}

Тип: Bool

Значение по умолчанию: 1

Включает или отключает автоматическую оптимизацию [PREWHERE](../../sql-reference/statements/select/prewhere.md) в запросах [SELECT](../../sql-reference/statements/select/index.md).

Работает только для таблиц [*MergeTree](../../engines/table-engines/mergetree-family/index.md).

Возможные значения:

- 0 — Автоматическая оптимизация `PREWHERE` отключена.
- 1 — Автоматическая оптимизация `PREWHERE` включена.

## optimize_move_to_prewhere_if_final {#optimize_move_to_prewhere_if_final}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает автоматическую оптимизацию [PREWHERE](../../sql-reference/statements/select/prewhere.md) в запросах [SELECT](../../sql-reference/statements/select/index.md) с модификатором [FINAL](/sql-reference/statements/select/from#final-modifier).

Работает только для таблиц [*MergeTree](../../engines/table-engines/mergetree-family/index.md).

Возможные значения:

- 0 — Автоматическая оптимизация `PREWHERE` в запросах `SELECT` с модификатором `FINAL` отключена.
- 1 — Автоматическая оптимизация `PREWHERE` в запросах `SELECT` с модификатором `FINAL` включена.

**См. Также**

- Настройка [optimize_move_to_prewhere](#optimize_move_to_prewhere)

## optimize_multiif_to_if {#optimize_multiif_to_if}

Тип: Bool

Значение по умолчанию: 1

Заменяет 'multiIf' на только одно условие 'if'.

## optimize_normalize_count_variants {#optimize_normalize_count_variants}

Тип: Bool

Значение по умолчанию: 1

Переписывает агрегатные функции, которые семантически эквивалентны count(), как count().

## optimize_on_insert {#optimize_on_insert}

Тип: Bool

Значение по умолчанию: 1

Включает или отключает преобразование данных перед вставкой, как если бы слияние было выполнено над этим блоком (в соответствии с движком таблицы).

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

**Пример**

Разница между включенным и отключенным:

Запрос:

```sql
SET optimize_on_insert = 1;

CREATE TABLE test1 (`FirstTable` UInt32) ENGINE = ReplacingMergeTree ORDER BY FirstTable;

INSERT INTO test1 SELECT number % 2 FROM numbers(5);

SELECT * FROM test1;

SET optimize_on_insert = 0;

CREATE TABLE test2 (`SecondTable` UInt32) ENGINE = ReplacingMergeTree ORDER BY SecondTable;

INSERT INTO test2 SELECT number % 2 FROM numbers(5);

SELECT * FROM test2;
```

Результат:

```text
┌─FirstTable─┐
│          0 │
│          1 │
└────────────┘

┌─SecondTable─┐
│           0 │
│           0 │
│           0 │
│           1 │
│           1 │
└─────────────┘
```

Обратите внимание, что эта настройка влияет на поведение [Materialized view](/sql-reference/statements/create/view#materialized-view).

## optimize_or_like_chain {#optimize_or_like_chain}

Тип: Bool

Значение по умолчанию: 0

Оптимизирует несколько OR LIKE в multiMatchAny. Эта оптимизация не должна быть включена по умолчанию, поскольку в некоторых случаях она нарушает анализ индекса.

## optimize_read_in_order {#optimize_read_in_order}

Тип: Bool

Значение по умолчанию: 1

Включает оптимизацию [ORDER BY](/sql-reference/statements/select/order-by#optimization-of-data-reading) в запросах [SELECT](../../sql-reference/statements/select/index.md) для чтения данных из таблиц [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md).

Возможные значения:

- 0 — Оптимизация `ORDER BY` отключена.
- 1 — Оптимизация `ORDER BY` включена.

**См. Также**

- [ORDER BY Clause](/sql-reference/statements/select/order-by#optimization-of-data-reading)

## optimize_read_in_window_order {#optimize_read_in_window_order}

Тип: Bool

Значение по умолчанию: 1

Включает оптимизацию ORDER BY в окне для чтения данных в соответствующем порядке в таблицах MergeTree.

## optimize_redundant_functions_in_order_by {#optimize_redundant_functions_in_order_by}

Тип: Bool

Значение по умолчанию: 1

Удаляет функции из ORDER BY, если их аргумент тоже находится в ORDER BY.

## optimize_respect_aliases {#optimize_respect_aliases}

Тип: Bool

Значение по умолчанию: 1

Если установлено в true, оно будет учитывать алиасы в WHERE/GROUP BY/ORDER BY, что поможет с обрезкой партиций/вторичными индексами/оптимизацией агрегации в порядке/оптимизацией чтения в порядке/оптимизацией тривиального подсчета.

## optimize_rewrite_aggregate_function_with_if {#optimize_rewrite_aggregate_function_with_if}

Тип: Bool

Значение по умолчанию: 1

Переписывает агрегатные функции с выражением if в качестве аргумента, когда это логически эквивалентно. Например, `avg(if(cond, col, null))` может быть переписано как `avgOrNullIf(cond, col)`. Это может улучшить производительность.

:::note
Поддерживается только с анализатором (`enable_analyzer = 1`).
:::

## optimize_rewrite_array_exists_to_has {#optimize_rewrite_array_exists_to_has}

Тип: Bool

Значение по умолчанию: 0

Переписывает функции arrayExists() в has(), когда это логически эквивалентно. Например, arrayExists(x -> x = 1, arr) может быть переписано в has(arr, 1).

## optimize_rewrite_sum_if_to_count_if {#optimize_rewrite_sum_if_to_count_if}

Тип: Bool

Значение по умолчанию: 1

Переписывает функции sumIf() и sum(if()) в функцию countIf(), когда это логически эквивалентно.

## optimize_skip_merged_partitions {#optimize_skip_merged_partitions}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает оптимизацию для запроса [OPTIMIZE TABLE ... FINAL](../../sql-reference/statements/optimize.md), если есть только одна часть с уровнем > 0 и у нее нет просроченного TTL.

- `OPTIMIZE TABLE ... FINAL SETTINGS optimize_skip_merged_partitions=1`

По умолчанию запрос `OPTIMIZE TABLE ... FINAL` переписывает одну часть, даже если есть только одна часть.

Возможные значения:

- 1 - Включить оптимизацию.
- 0 - Отключить оптимизацию.

## optimize_skip_unused_shards {#optimize_skip_unused_shards}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает пропуск неиспользуемых шардов для запросов [SELECT](../../sql-reference/statements/select/index.md), которые имеют условие шардирования в `WHERE/PREWHERE` (при условии, что данные распределены по ключу шардирования, в противном случае запрос даст некорректный результат).

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

## optimize_skip_unused_shards_limit {#optimize_skip_unused_shards_limit}

Тип: UInt64

Значение по умолчанию: 1000

Предел для количества значений ключа шардирования, отключает `optimize_skip_unused_shards`, если предел достигнут.

Слишком много значений может потребовать значительных ресурсов для обработки, в то время как выгода сомнительна, поскольку, если у вас большое количество значений в `IN (...)`, то, скорее всего, запрос будет отправлен на все шарды.

## optimize_skip_unused_shards_nesting {#optimize_skip_unused_shards_nesting}

Тип: UInt64

Значение по умолчанию: 0

Контролирует [`optimize_skip_unused_shards`](#optimize_skip_unused_shards) (поэтому все еще требует [`optimize_skip_unused_shards`](#optimize_skip_unused_shards)), зависит от уровня вложенности распределенного запроса (случай, когда у вас есть `Distributed` таблица, которая обращается к другой `Distributed` таблице).

Возможные значения:

- 0 — Отключено, `optimize_skip_unused_shards` всегда работает.
- 1 — Включает `optimize_skip_unused_shards` только для первого уровня.
- 2 — Включает `optimize_skip_unused_shards` до второго уровня.

## optimize_skip_unused_shards_rewrite_in {#optimize_skip_unused_shards_rewrite_in}

Тип: Bool

Значение по умолчанию: 1

Переписывает IN в запросе для удаленных шардов, чтобы исключить значения, которые не принадлежат шару (требует optimize_skip_unused_shards).

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

## optimize_sorting_by_input_stream_properties {#optimize_sorting_by_input_stream_properties}

Тип: Bool

Значение по умолчанию: 1

Оптимизирует сортировку по свойствам входного потока.

## optimize_substitute_columns {#optimize_substitute_columns}

Тип: Bool

Значение по умолчанию: 0

Использует [constraints](../../sql-reference/statements/create/table.md/#constraints) для замены колонок. Значение по умолчанию `false`.

Возможные значения:

- true, false

## optimize_syntax_fuse_functions {#optimize_syntax_fuse_functions}

Тип: Bool

Значение по умолчанию: 0

Включает объединение агрегатных функций с идентичным аргументом. Он переписывает запрос, содержащий как минимум две агрегатные функции из [sum](/sql-reference/aggregate-functions/reference/sum), [count](/sql-reference/aggregate-functions/reference/count) или [avg](/sql-reference/aggregate-functions/reference/avg) с идентичным аргументом в [sumCount](/sql-reference/aggregate-functions/reference/sumcount).

Возможные значения:

- 0 — Функции с идентичным аргументом не объединяются.
- 1 — Функции с идентичным аргументом объединяются.

**Пример**

Запрос:

```sql
CREATE TABLE fuse_tbl(a Int8, b Int8) Engine = Log;
SET optimize_syntax_fuse_functions = 1;
EXPLAIN SYNTAX SELECT sum(a), sum(b), count(b), avg(b) from fuse_tbl FORMAT TSV;
```

Результат:

```text
SELECT
    sum(a),
    sumCount(b).1,
    sumCount(b).2,
    (sumCount(b).1) / (sumCount(b).2)
FROM fuse_tbl
```

## optimize_throw_if_noop {#optimize_throw_if_noop}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает выброс исключения, если запрос [OPTIMIZE](../../sql-reference/statements/optimize.md) не выполнил слияния.

По умолчанию `OPTIMIZE` завершается успешно, даже если ничего не было сделано. Эта настройка позволяет вам различать эти ситуации и получать причину в сообщении исключения.

Возможные значения:

- 1 — Включен выброс исключения.
- 0 — Выброс исключения отключен.

## optimize_time_filter_with_preimage {#optimize_time_filter_with_preimage}

Тип: Bool

Значение по умолчанию: 1

Оптимизирует предикаты Date и DateTime, преобразуя функции в эквивалентные сравнения без преобразований (например, `toYear(col) = 2023 -> col >= '2023-01-01' AND col <= '2023-12-31'`).

## optimize_trivial_approximate_count_query {#optimize_trivial_approximate_count_query}

Тип: Bool

Значение по умолчанию: 0

Использует приближенное значение для тривиальной оптимизации подсчета хранилищ, которые поддерживают такую оценку, например, EmbeddedRocksDB.

Возможные значения:

- 0 — Оптимизация отключена.
- 1 — Оптимизация включена.

## optimize_trivial_count_query {#optimize_trivial_count_query}

Тип: Bool

Значение по умолчанию: 1

Включает или отключает оптимизацию тривиального запроса `SELECT count() FROM table`, используя метаданные из MergeTree. Если вам необходимо использовать безопасность на уровне строк, отключите эту настройку.

Возможные значения:

- 0 — Оптимизация отключена.
- 1 — Оптимизация включена.

См. также:

- [optimize_functions_to_subcolumns](#optimize_functions_to_subcolumns)

## optimize_trivial_insert_select {#optimize_trivial_insert_select}

Тип: Bool

Значение по умолчанию: 0

Оптимизирует тривиальный запрос 'INSERT INTO table SELECT ... FROM TABLES'.

## optimize_uniq_to_count {#optimize_uniq_to_count}

Тип: Bool

Значение по умолчанию: 1

Переписывает uniq и его варианты (за исключением uniqUpTo) в count, если подзапрос имеет distinct или group by.

## optimize_use_implicit_projections {#optimize_use_implicit_projections}

Тип: Bool

Значение по умолчанию: 1

Автоматически выбирает неявные проекции для выполнения запроса SELECT.

## optimize_use_projections {#optimize_use_projections}

Тип: Bool

Значение по умолчанию: 1

Включает или отключает оптимизацию [projection](../../engines/table-engines/mergetree-family/mergetree.md/#projections) при обработке запросов `SELECT`.

Возможные значения:

- 0 — Оптимизация проекций отключена.
- 1 — Оптимизация проекций включена.

## optimize_using_constraints {#optimize_using_constraints}

Тип: Bool

Значение по умолчанию: 0

Использует [constraints](../../sql-reference/statements/create/table.md/#constraints) для оптимизации запросов. Значение по умолчанию `false`.

Возможные значения:

- true, false

## os_thread_priority {#os_thread_priority}

Тип: Int64

Значение по умолчанию: 0

Устанавливает приоритет ([nice](https://en.wikipedia.org/wiki/Nice_(Unix))) для потоков, выполняющих запросы. Планировщик ОС учитывает этот приоритет при выборе следующего потока для выполнения на каждом доступном ядре CPU.

:::note
Для использования этой настройки необходимо установить возможность `CAP_SYS_NICE`. Пакет `clickhouse-server` настраивает его во время установки. Некоторые виртуальные среды не позволяют установить возможность `CAP_SYS_NICE`. В этом случае `clickhouse-server` выводит сообщение об этом в начале.
:::

Возможные значения:

- Вы можете установить значения в диапазоне `[-20, 19]`.

Низкие значения означают более высокий приоритет. Потоки с низкими значениями приоритета `nice` выполняются чаще, чем потоки с высокими значениями. Высокие значения предпочтительны для длительных неинтерактивных запросов, поскольку это позволяет им быстро уступать ресурсы в пользу коротких интерактивных запросов, когда они приходят.

## output_format_compression_level {#output_format_compression_level}

Тип: UInt64

Значение по умолчанию: 3

Уровень сжатия по умолчанию, если вывод запроса сжат. Настройка применяется, когда запрос `SELECT` содержит `INTO OUTFILE` или при записи в табличные функции `file`, `url`, `hdfs`, `s3` или `azureBlobStorage`.

Возможные значения: от `1` до `22`.

## output_format_compression_zstd_window_log {#output_format_compression_zstd_window_log}

Тип: UInt64

Значение по умолчанию: 0

Может использоваться, когда метод сжатия вывода — `zstd`. Если больше 0, эта настройка явно устанавливает размер окна сжатия (степень `2`) и включает режим долгосрочного сжатия для zstd. Это может помочь достичь лучшего коэффициента сжатия.

Возможные значения: неотрицательные числа. Обратите внимание, что если значение слишком мало или слишком велико, `zstdlib` выдаст исключение. Типичные значения от `20` (размер окна = `1MB`) до `30` (размер окна = `1GB`).

## output_format_parallel_formatting {#output_format_parallel_formatting}

Тип: Bool

Значение по умолчанию: 1

Включает или отключает параллельное форматирование форматов данных. Поддерживается только для форматов [TSV](../../interfaces/formats.md/#tabseparated), [TSKV](../../interfaces/formats.md/#tskv), [CSV](../../interfaces/formats.md/#csv) и [JSONEachRow](../../interfaces/formats.md/#jsoneachrow).

Возможные значения:

- 1 — Включено.
- 0 — Отключено.

## page_cache_inject_eviction {#page_cache_inject_eviction}

Тип: Bool

Значение по умолчанию: 0

Пользовательская страница кеша иногда будет аннулировать некоторые страницы случайным образом. Предназначено для тестирования.

## parallel_distributed_insert_select {#parallel_distributed_insert_select}

Тип: UInt64

Значение по умолчанию: 0

Включает параллельный распределенный `INSERT ... SELECT` запрос.

Если мы выполняем запросы `INSERT INTO distributed_table_a SELECT ... FROM distributed_table_b`, и обе таблицы используют один и тот же кластер, и обе таблицы либо [реплицированы](../../engines/table-engines/mergetree-family/replication.md), либо не реплицированы, то этот запрос обрабатывается локально на каждом шарде.

Возможные значения:

- 0 — Отключено.
- 1 — `SELECT` будет выполняться на каждом шарде из подложной таблицы распределенного движка.
- 2 — `SELECT` и `INSERT` будут выполняться на каждом шарде из/в подложную таблицу распределенного движка.

## parallel_replica_offset {#parallel_replica_offset}
<BetaBadge/>

Тип: UInt64

Значение по умолчанию: 0

Это внутренняя настройка, которую не следует использовать напрямую и которая представляет собой деталь реализации режима "параллельные реплики". Эта настройка будет автоматически настроена инициирующим сервером для распределенных запросов на индекс реплики, участвующей в обработке запроса среди параллельных реплик.

## parallel_replicas_allow_in_with_subquery {#parallel_replicas_allow_in_with_subquery}
<BetaBadge/>

Тип: Bool

Значение по умолчанию: 1

Если true, подзапрос для IN будет выполняться на каждой подчиненной реплике.

## parallel_replicas_count {#parallel_replicas_count}
<BetaBadge/>

Тип: UInt64

Значение по умолчанию: 0

Это внутренняя настройка, которую не следует использовать напрямую и которая представляет собой деталь реализации режима "параллельные реплики". Эта настройка будет автоматически настроена инициирующим сервером для распределенных запросов на количество параллельных реплик, участвующих в обработке запроса.

## parallel_replicas_custom_key {#parallel_replicas_custom_key}
<BetaBadge/>

Тип: String

Значение по умолчанию: 

Произвольное целое выражение, которое можно использовать для распределения работы между репликами для конкретной таблицы. Значение может быть любым целым выражением.

Предпочтительно использовать простые выражения с первичными ключами.

Если эта настройка используется в кластере, который состоит из одного шарда с несколькими репликами, эти реплики будут преобразованы в виртуальные шары. В противном случае это будет работать так же, как и для ключа `SAMPLE`, это будет использовать несколько реплик каждого шард.

## parallel_replicas_custom_key_range_lower {#parallel_replicas_custom_key_range_lower}
<BetaBadge/>

Тип: UInt64

Значение по умолчанию: 0

Позволяет фильтру типа `range` равномерно распределять работу между репликами на основе пользовательского диапазона `[parallel_replicas_custom_key_range_lower, INT_MAX]`.

Когда используется вместе с [parallel_replicas_custom_key_range_upper](#parallel_replicas_custom_key_range_upper), это позволяет фильтру равномерно делить работу между репликами для диапазона `[parallel_replicas_custom_key_range_lower, parallel_replicas_custom_key_range_upper]`.

Примечание: Эта настройка не приведет к дополнительному фильтрации данных во время обработки запроса, она изменяет только точки, в которых фильтр диапазона разделяет диапазон `[0, INT_MAX]` для параллельной обработки.

## parallel_replicas_custom_key_range_upper {#parallel_replicas_custom_key_range_upper}
<BetaBadge/>

Тип: UInt64

Значение по умолчанию: 0

Позволяет фильтру типа `range` равномерно распределять работу между репликами на основе пользовательского диапазона `[0, parallel_replicas_custom_key_range_upper]`. Значение 0 отключает верхнюю границу, устанавливая ее на максимальное значение выражения пользовательского ключа.

Когда используется вместе с [parallel_replicas_custom_key_range_lower](#parallel_replicas_custom_key_range_lower), это позволяет фильтру равномерно делить работу между репликами для диапазона `[parallel_replicas_custom_key_range_lower, parallel_replicas_custom_key_range_upper]`.

Примечание: Эта настройка не приведет к дополнительному фильтрации данных во время обработки запроса, она изменяет только точки, в которых фильтр диапазона разделяет диапазон `[0, INT_MAX]` для параллельной обработки.

## parallel_replicas_for_cluster_engines {#parallel_replicas_for_cluster_engines}

Тип: Bool

Значение по умолчанию: 1

Заменяет движки функций таблиц их альтернативами -Cluster.

## parallel_replicas_for_non_replicated_merge_tree {#parallel_replicas_for_non_replicated_merge_tree}
<BetaBadge/>

Тип: Bool

Значение по умолчанию: 0

Если true, ClickHouse будет использовать алгоритм параллельных реплик также для нереплицированных таблиц MergeTree.

## parallel_replicas_index_analysis_only_on_coordinator {#parallel_replicas_index_analysis_only_on_coordinator}
<BetaBadge/>

Тип: Bool

Значение по умолчанию: 1

Анализ индекса выполняется только на реплике-координаторе и пропускается на других репликах. Эффективно только при включенном parallel_replicas_local_plan.

## parallel_replicas_local_plan {#parallel_replicas_local_plan}
<BetaBadge/>

Тип: Bool

Значение по умолчанию: 1

Создает локальный план для локальной реплики.

## parallel_replicas_mark_segment_size {#parallel_replicas_mark_segment_size}
<BetaBadge/>

Тип: UInt64

Значение по умолчанию: 0

Части виртуально разделены на сегменты, которые распределяются между репликами для параллельного чтения. Эта настройка контролирует размер этих сегментов. Не рекомендуется изменять, пока вы не будете абсолютно уверены в том, что делаете. Значение должно находиться в диапазоне [128; 16384].

## parallel_replicas_min_number_of_rows_per_replica {#parallel_replicas_min_number_of_rows_per_replica}
<BetaBadge/>

Тип: UInt64

Значение по умолчанию: 0

Ограничивает количество реплик, используемых в запросе, до (оценочное количество строк для чтения / min_number_of_rows_per_replica). Максимум все еще ограничен 'max_parallel_replicas'.

## parallel_replicas_mode {#parallel_replicas_mode}
<BetaBadge/>

Тип: ParallelReplicasMode

Значение по умолчанию: read_tasks

Тип фильтра, который следует использовать с пользовательским ключом для параллельных реплик. По умолчанию - использовать операцию по модулю на пользовательском ключе, диапазон - использовать фильтр диапазона на пользовательском ключе, используя все возможные значения для типа значения пользовательского ключа.

## parallel_replicas_only_with_analyzer {#parallel_replicas_only_with_analyzer}
<BetaBadge/>

Тип: Bool

Значение по умолчанию: 1

Анализатор должен быть включен для использования параллельных реплик. При отключенном анализаторе выполнение запроса возвращается к локальному выполнению, даже если параллельное чтение из реплик включено. Использование параллельных реплик без включенного анализатора не поддерживается.

## parallel_replicas_prefer_local_join {#parallel_replicas_prefer_local_join}
<BetaBadge/>

Тип: Bool

Значение по умолчанию: 1

Если true и JOIN может быть выполнен с алгоритмом параллельных реплик, и все хранилища правой части JOIN являются *MergeTree, будет использоваться локальный JOIN вместо GLOBAL JOIN.

## parallel_view_processing {#parallel_view_processing}

Тип: Bool

Значение по умолчанию: 0

Включает одновременное обновление прикрепленных представлений, а не поочередно.

## parallelize_output_from_storages {#parallelize_output_from_storages}

Тип: Bool

Значение по умолчанию: 1

Параллелизует вывод на этапе чтения из хранилища. Это позволяет параллелизовать обработку запроса сразу после чтения из хранилища, если это возможно.

## parsedatetime_parse_without_leading_zeros {#parsedatetime_parse_without_leading_zeros}

Тип: Bool

Значение по умолчанию: 1

Форматеры '%c', '%l' и '%k' в функции 'parseDateTime' разбирают месяцы и часы без ведущих нулей.

## partial_merge_join_left_table_buffer_bytes {#partial_merge_join_left_table_buffer_bytes}

Тип: UInt64

Значение по умолчанию: 0

Если не 0, группирует блоки левой таблицы в большие блоки для левой стороны таблицы в частичном объединении. Он использует до 2x указанной памяти на поток объединения.

## partial_merge_join_rows_in_right_blocks {#partial_merge_join_rows_in_right_blocks}

Тип: UInt64

Значение по умолчанию: 65536

Ограничивает размеры данных блоков правого JOIN в алгоритме частичного объединения для запросов [JOIN](../../sql-reference/statements/select/join.md).

Сервер ClickHouse:

1. Разделяет данные правого JOIN на блоки с максимум указанным количеством строк.
2. Индексирует каждый блок его минимальными и максимальными значениями.
3. Разгружает подготовленные блоки на диск, если это возможно.

Возможные значения:

- Любое положительное целое число. Рекомендуемый диапазон значений: \[1000, 100000\].

## partial_result_on_first_cancel {#partial_result_on_first_cancel}

Тип: Bool

Значение по умолчанию: 0

Позволяет запросу вернуть частичный результат после отмены.

## parts_to_delay_insert {#parts_to_delay_insert}

Тип: UInt64

Значение по умолчанию: 0

Если в целевой таблице содержится хотя бы столько активных частей в одной партиции, искусственно замедляет вставку в таблицу.

## parts_to_throw_insert {#parts_to_throw_insert}

Тип: UInt64

Значение по умолчанию: 0

Если в одной партиции целевой таблицы более этого числа активных частей, выбрасывает исключение 'Слишком много частей ...'.

## periodic_live_view_refresh {#periodic_live_view_refresh}

Тип: Seconds

Значение по умолчанию: 60

Интервал, через который периодически обновляемое live представление принудительно обновляется.

## poll_interval {#poll_interval}

Тип: UInt64

Значение по умолчанию: 10

Блокирует ожидание выполнения запроса на сервере на указанное количество секунд.

## postgresql_connection_attempt_timeout {#postgresql_connection_attempt_timeout}

Тип: UInt64

Значение по умолчанию: 2

Тайм-аут подключения в секундах для одной попытки подключения к конечной точке PostgreSQL. Значение передается как параметр `connect_timeout` URL подключения.

## postgresql_connection_pool_auto_close_connection {#postgresql_connection_pool_auto_close_connection}

Тип: Bool

Значение по умолчанию: 0

Закрывает соединение перед возвратом соединения в пул.

## postgresql_connection_pool_retries {#postgresql_connection_pool_retries}

Тип: UInt64

Значение по умолчанию: 2

Количество попыток подключения/выброса для пула соединений для таблиц PostgreSQL и движка базы данных.

## postgresql_connection_pool_size {#postgresql_connection_pool_size}

Тип: UInt64

Значение по умолчанию: 16

Размер пула соединений для таблиц PostgreSQL и движка базы данных.

## postgresql_connection_pool_wait_timeout {#postgresql_connection_pool_wait_timeout}

Тип: UInt64

Значение по умолчанию: 5000

Тайм-аут нажатия/вытаскивания пула соединений пустого пула для таблиц PostgreSQL и движка базы данных. По умолчанию будет блокировать на пустом пуле.

## postgresql_fault_injection_probability {#postgresql_fault_injection_probability}

Тип: Float

Значение по умолчанию: 0

Приблизительная вероятность сбоя внутренних (для репликации) запросов PostgreSQL. Допустимое значение находится в интервале [0.0f, 1.0f].

## prefer_column_name_to_alias {#prefer_column_name_to_alias}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает использование оригинальных имен колонок вместо алиасов в выражениях и условиях запроса. Это особенно важно, когда алиас совпадает с именем колонки, см. [Обозначения выражений](/sql-reference/syntax#notes-on-usage). Включите эту настройку, чтобы сделать правила синтаксиса алиасов в ClickHouse более совместимыми с большинством других движков баз данных.

Возможные значения:

- 0 — Имя колонки заменяется алиасом.
- 1 — Имя колонки не заменяется алиасом.

**Пример**

Разница между включенным и отключенным:

Запрос:

```sql
SET prefer_column_name_to_alias = 0;
SELECT avg(number) AS number, max(number) FROM numbers(10);
```

Результат:

```text
Received exception from server (version 21.5.1):
Code: 184. DB::Exception: Received from localhost:9000. DB::Exception: Aggregate function avg(number) is found inside another aggregate function in query: While processing avg(number) AS number.
```

Запрос:

```sql
SET prefer_column_name_to_alias = 1;
SELECT avg(number) AS number, max(number) FROM numbers(10);
```

Результат:

```text
┌─number─┬─max(number)─┐
│    4.5 │           9 │
└────────┴─────────────┘
```

## prefer_external_sort_block_bytes {#prefer_external_sort_block_bytes}

Тип: UInt64

Значение по умолчанию: 16744704

Предпочитает максимальный размер блока для внешней сортировки, снижает использование памяти во время слияния.

## prefer_global_in_and_join {#prefer_global_in_and_join}

Тип: Bool

Значение по умолчанию: 0

Включает замену операторов `IN`/`JOIN` на `GLOBAL IN`/`GLOBAL JOIN`.

Возможные значения:

- 0 — Отключено. Операторы `IN`/`JOIN` не заменяются на `GLOBAL IN`/`GLOBAL JOIN`.
- 1 — Включено. Операторы `IN`/`JOIN` заменяются на `GLOBAL IN`/`GLOBAL JOIN`.

**Использование**

Хотя `SET distributed_product_mode=global` может изменить поведение запросов для распределенных таблиц, он не подходит для локальных таблиц или таблиц из внешних ресурсов. Вот когда настройка `prefer_global_in_and_join` вступает в силу.

Например, у нас есть узлы запросов, которые содержат локальные таблицы, которые не подходят для распределения. Нам необходимо воссоздать их данные на лету во время распределенной обработки с ключевым словом `GLOBAL` — `GLOBAL IN`/`GLOBAL JOIN`.

Другой случай использования `prefer_global_in_and_join` — это доступ к таблицам, созданным внешними движками. Эта настройка помогает уменьшить количество обращений к внешним источникам во время соединения таких таблиц: только один вызов на запрос.

**См. также:**

- [Распределенные подзапросы](/sql-reference/operators/in#distributed-subqueries) для получения дополнительной информации о том, как использовать `GLOBAL IN`/`GLOBAL JOIN`.

## prefer_localhost_replica {#prefer_localhost_replica}

Тип: Bool

Значение по умолчанию: 1

Включает/отключает предпочтительное использование локальной реплики при обработке распределенных запросов.

Возможные значения:

- 1 — ClickHouse всегда отправляет запрос на локальную реплику, если она существует.
- 0 — ClickHouse использует стратегию балансировки, указанную в настройке [load_balancing](#load_balancing).

:::note
Отключите эту настройку, если вы используете [max_parallel_replicas](#max_parallel_replicas) без [parallel_replicas_custom_key](#parallel_replicas_custom_key).
Если [parallel_replicas_custom_key](#parallel_replicas_custom_key) установлен, отключайте эту настройку только в кластере с несколькими шардов, содержащими несколько реплик.
Если она используется в кластере с одним шаром и несколькими репликами, отключение этой настройки приведет к отрицательным последствиям.
:::

## prefer_warmed_unmerged_parts_seconds {#prefer_warmed_unmerged_parts_seconds}

<CloudAvailableBadge/>

Тип: Int64

Значение по умолчанию: 0

Эта настройка действует только в ClickHouse Cloud. Если объединенная часть младше этого количества секунд и не разогрета (см. [cache_populated_by_fetch](merge-tree-settings.md/#cache_populated_by_fetch)), но все ее исходные части доступны и разогреты, запросы SELECT будут считываться из этих частей. Только для Replicated-/SharedMergeTree. Обратите внимание, что это только проверяет, обработала ли CacheWarmer часть; если часть была извлечена в кеш чем-то другим, она все равно будет считаться холодной, пока CacheWarmer не дойдет до нее; если она была разогрета, а затем выгнана из кэша, она все равно будет считаться горячей.

## preferred_block_size_bytes {#preferred_block_size_bytes}

Тип: UInt64

Значение по умолчанию: 1000000

Эта настройка настраивает размер блока данных для обработки запроса и представляет собой дополнительную тонкую настройку для более грубой настройки 'max_block_size'. Если столбцы большие и с 'max_block_size' строк размеры блока вероятно будут больше указанного количества байт, его размер будет уменьшен для лучшей локальности кеша CPU.

## preferred_max_column_in_block_size_bytes {#preferred_max_column_in_block_size_bytes}

Тип: UInt64

Значение по умолчанию: 0

Ограничение на максимальный размер колонки в блоке во время чтения. Помогает уменьшить количество промахов кеша. Должно быть близко к размеру кеша L2.

## preferred_optimize_projection_name {#preferred_optimize_projection_name}

Тип: String

Значение по умолчанию: 

Если установлено в непустую строку, ClickHouse попытается применить указанную проекцию в запросе.

Возможные значения:

- строка: имя предпочтительной проекции.

## prefetch_buffer_size {#prefetch_buffer_size}

Тип: UInt64

Значение по умолчанию: 1048576

Максимальный размер буфера предзагрузки для чтения из файловой системы.


## print_pretty_type_names {#print_pretty_type_names}

Тип: Bool

Значение по умолчанию: 1

Позволяет выводить названия глубоко вложенных типов в красивом виде с отступами в запросе `DESCRIBE` и в функции `toTypeName()`.

Пример:

```sql
CREATE TABLE test (a Tuple(b String, c Tuple(d Nullable(UInt64), e Array(UInt32), f Array(Tuple(g String, h Map(String, Array(Tuple(i String, j UInt64))))), k Date), l Nullable(String))) ENGINE=Memory;
DESCRIBE TABLE test FORMAT TSVRaw SETTINGS print_pretty_type_names=1;
```

```
a   Tuple(
    b String,
    c Tuple(
        d Nullable(UInt64),
        e Array(UInt32),
        f Array(Tuple(
            g String,
            h Map(
                String,
                Array(Tuple(
                    i String,
                    j UInt64
                ))
            )
        )),
        k Date
    ),
    l Nullable(String)
)
```
## priority {#priority}

Тип: UInt64

Значение по умолчанию: 0

Приоритет запроса. 1 - самый высокий, более высокое значение - более низкий приоритет; 0 - не использовать приоритеты.
## push_external_roles_in_interserver_queries {#push_external_roles_in_interserver_queries}

Тип: Bool

Значение по умолчанию: 1

Включает передачу ролей пользователя от инициатора к другим узлам при выполнении запроса.
## query_cache_compress_entries {#query_cache_compress_entries}

Тип: Bool

Значение по умолчанию: 1

Сжимает записи в [кэше запросов](../query-cache.md). Уменьшает потребление памяти кэша запросов за счет более медленных вставок в него или чтений из него.

Возможные значения:

- 0 - Отключен
- 1 - Включен
## query_cache_max_entries {#query_cache_max_entries}

Тип: UInt64

Значение по умолчанию: 0

Максимальное число результатов запросов, которые текущий пользователь может сохранить в [кэше запросов](../query-cache.md). 0 означает неограниченно.

Возможные значения:

- Положительное целое число >= 0.
## query_cache_max_size_in_bytes {#query_cache_max_size_in_bytes}

Тип: UInt64

Значение по умолчанию: 0

Максимальный объем памяти (в байтах), который текущий пользователь может выделить в [кэше запросов](../query-cache.md). 0 означает неограниченно.

Возможные значения:

- Положительное целое число >= 0.
## query_cache_min_query_duration {#query_cache_min_query_duration}

Тип: Milliseconds

Значение по умолчанию: 0

Минимальная продолжительность в миллисекундах, необходимая запросу для сохранения его результата в [кэше запросов](../query-cache.md).

Возможные значения:

- Положительное целое число >= 0.
## query_cache_min_query_runs {#query_cache_min_query_runs}

Тип: UInt64

Значение по умолчанию: 0

Минимальное количество запусков запроса `SELECT`, прежде чем его результат будет сохранен в [кэше запросов](../query-cache.md).

Возможные значения:

- Положительное целое число >= 0.
## query_cache_nondeterministic_function_handling {#query_cache_nondeterministic_function_handling}

Тип: QueryResultCacheNondeterministicFunctionHandling

Значение по умолчанию: throw

Управляет тем, как [кэш запросов](../query-cache.md) обрабатывает запросы `SELECT` с недетерминированными функциями, такими как `rand()` или `now()`.

Возможные значения:

- `'throw'` - Генерировать исключение и не кэшировать результат запроса.
- `'save'` - Кэшировать результат запроса.
- `'ignore'` - Не кэшировать результат запроса и не генерировать исключение.
## query_cache_share_between_users {#query_cache_share_between_users}

Тип: Bool

Значение по умолчанию: 0

Если включено, результат запросов `SELECT`, кэшированных в [кэше запросов](../query-cache.md), может быть прочитан другими пользователями.
Не рекомендуется включать эту настройку по соображениям безопасности.

Возможные значения:

- 0 - Отключен
- 1 - Включен
## query_cache_squash_partial_results {#query_cache_squash_partial_results}

Тип: Bool

Значение по умолчанию: 1

Сжимаем блоки частичных результатов в блоки размером [max_block_size](#max_block_size). Уменьшает производительность вставок в [кэш запросов](../query-cache.md), но улучшает сжимаемость записей в кэше (см. [query_cache_compress_entries](#query_cache_compress_entries)).

Возможные значения:

- 0 - Отключен
- 1 - Включен
## query_cache_system_table_handling {#query_cache_system_table_handling}

Тип: QueryResultCacheSystemTableHandling

Значение по умолчанию: throw

Управляет тем, как [кэш запросов](../query-cache.md) обрабатывает запросы `SELECT` к системным таблицам, т.е. таблицам в базах данных `system.*` и `information_schema.*`.

Возможные значения:

- `'throw'` - Генерировать исключение и не кэшировать результат запроса.
- `'save'` - Кэшировать результат запроса.
- `'ignore'` - Не кэшировать результат запроса и не генерировать исключение.
## query_cache_tag {#query_cache_tag}

Тип: String

Значение по умолчанию: 

Строка, которая служит меткой для записей в [кэше запросов](../query-cache.md).
Одни и те же запросы с разными метками считаются различными кэшем запросов.

Возможные значения:

- Любая строка
## query_cache_ttl {#query_cache_ttl}

Тип: Seconds

Значение по умолчанию: 60

После этого времени в секундах записи в [кэше запросов](../query-cache.md) становятся устаревшими.

Возможные значения:

- Положительное целое число >= 0.
## query_metric_log_interval {#query_metric_log_interval}

Тип: Int64

Значение по умолчанию: -1

Интервал в миллисекундах, через который собирается [query_metric_log](../../operations/system-tables/query_metric_log.md) для отдельных запросов.

Если установлено любое отрицательное значение, будет взято значение `collect_interval_milliseconds` из настройки [query_metric_log](/operations/server-configuration-parameters/settings#query_metric_log) или значение по умолчанию, равное 1000, если не задано.

Чтобы отключить сбор отдельного запроса, установите `query_metric_log_interval` на 0.

Значение по умолчанию: -1
## query_plan_aggregation_in_order {#query_plan_aggregation_in_order}

Тип: Bool

Значение по умолчанию: 1

Переключает оптимизацию уровня плана запроса агрегации в порядке.
Вступает в силу только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка для экспертов, которая должна использоваться только для отладки разработчиками. Настройка может измениться в будущем в несовместимых направлениях или быть удалена.
:::

Возможные значения:

- 0 - Отключено
- 1 - Включено
## query_plan_convert_join_to_in {#query_plan_convert_join_to_in}

Тип: Bool

Значение по умолчанию: 0

Разрешить преобразование JOIN в подзапрос с IN, если выходные колонки связаны только с левой таблицей
## query_plan_convert_outer_join_to_inner_join {#query_plan_convert_outer_join_to_inner_join}

Тип: Bool

Значение по умолчанию: 1

Разрешить преобразование OUTER JOIN в INNER JOIN, если фильтр после JOIN всегда фильтрует значения по умолчанию
## query_plan_enable_multithreading_after_window_functions {#query_plan_enable_multithreading_after_window_functions}

Тип: Bool

Значение по умолчанию: 1

Включить многопоточность после вычисления оконных функций, чтобы разрешить параллельную обработку потоков
## query_plan_enable_optimizations {#query_plan_enable_optimizations}

Тип: Bool

Значение по умолчанию: 1

Переключает оптимизацию запросов на уровне плана запроса.

:::note
Это настройка для экспертов, которая должна использоваться только для отладки разработчиками. Настройка может измениться в будущем в несовместимых направлениях или быть удалена.
:::

Возможные значения:

- 0 - Отключить все оптимизации на уровне плана запроса
- 1 - Включить оптимизации на уровне плана запроса (но отдельные оптимизации могут быть отключены через их индивидуальные настройки)
## query_plan_execute_functions_after_sorting {#query_plan_execute_functions_after_sorting}

Тип: Bool

Значение по умолчанию: 1

Переключает оптимизацию уровня плана запроса, которая перемещает выражения после сортировки.
Вступает в силу только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка для экспертов, которая должна использоваться только для отладки разработчиками. Настройка может измениться в будущем в несовместимых направлениях или быть удалена.
:::

Возможные значения:

- 0 - Отключено
- 1 - Включено
## query_plan_filter_push_down {#query_plan_filter_push_down}

Тип: Bool

Значение по умолчанию: 1

Переключает оптимизацию уровня плана запроса, которая перемещает фильтры вниз в плане выполнения.
Вступает в силу только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка для экспертов, которая должна использоваться только для отладки разработчиками. Настройка может измениться в будущем в несовместимых направлениях или быть удалена.
:::

Возможные значения:

- 0 - Отключено
- 1 - Включено
## query_plan_join_shard_by_pk_ranges {#query_plan_join_shard_by_pk_ranges}

Тип: Bool

Значение по умолчанию: 0

Применять шардирование для JOIN, если ключи соединения содержат префикс PRIMARY KEY для обеих таблиц. Поддерживается для алгоритмов hash, parallel_hash и full_sorting_merge
## query_plan_join_swap_table {#query_plan_join_swap_table}

Тип: BoolAuto

Значение по умолчанию: auto

    Определить, какая сторона соединения должна быть таблицей сборки (также называется внутренней, той, которая вставляется в хеш-таблицу для хеш-соединения) в плане запроса. Эта настройка поддерживается только для строгого соединения `ALL` с условием `JOIN ON`. Возможные значения:
    - 'auto': Позволить планировщику решить, какую таблицу использовать как таблицу сборки.
    - 'false': Никогда не менять таблицы (правая таблица – таблица сборки).
    - 'true': Всегда менять таблицы (левая таблица – таблица сборки).
## query_plan_lift_up_array_join {#query_plan_lift_up_array_join}

Тип: Bool

Значение по умолчанию: 1

Переключает оптимизацию уровня плана запроса, которая перемещает ARRAY JOINs вверх в плане выполнения.
Вступает в силу только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка для экспертов, которая должна использоваться только для отладки разработчиками. Настройка может измениться в будущем в несовместимых направлениях или быть удалена.
:::

Возможные значения:

- 0 - Отключено
- 1 - Включено
## query_plan_lift_up_union {#query_plan_lift_up_union}

Тип: Bool

Значение по умолчанию: 1

Переключает оптимизацию уровня плана запроса, которая перемещает более крупные поддеревья плана запроса в объединение для возможности дальнейших оптимизаций.
Вступает в силу только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка для экспертов, которая должна использоваться только для отладки разработчиками. Настройка может измениться в будущем в несовместимых направлениях или быть удалена.
:::

Возможные значения:

- 0 - Отключено
- 1 - Включено
## query_plan_max_limit_for_lazy_materialization {#query_plan_max_limit_for_lazy_materialization}

Тип: UInt64

Значение по умолчанию: 10

Контрольное максимальное ограничение, позволяющее использовать план запроса для оптимизации ленивой материализации. Если ноль, ограничений нет
## query_plan_max_optimizations_to_apply {#query_plan_max_optimizations_to_apply}

Тип: UInt64

Значение по умолчанию: 10000

Ограничивает общее количество оптимизаций, применяемых к плану запроса, см. настройку [query_plan_enable_optimizations](#query_plan_enable_optimizations).
Полезно, чтобы избежать долгих времён оптимизации для сложных запросов.
На этапе выполнения запроса в EXPLAIN PLAN остановить применение оптимизаций после достижения этого ограничения и вернуть план как есть.
Для обычного выполнения запроса, если фактическое число оптимизаций превышает эту настройку, генерируется исключение.

:::note
Это настройка для экспертов, которая должна использоваться только для отладки разработчиками. Настройка может измениться в будущем в несовместимых направлениях или быть удалена.
:::
## query_plan_merge_expressions {#query_plan_merge_expressions}

Тип: Bool

Значение по умолчанию: 1

Переключает оптимизацию уровня плана запроса, которая объединяет последовательные фильтры.
Вступает в силу только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка для экспертов, которая должна использоваться только для отладки разработчиками. Настройка может измениться в будущем в несовместимых направлениях или быть удалена.
:::

Возможные значения:

- 0 - Отключено
- 1 - Включено
## query_plan_merge_filters {#query_plan_merge_filters}

Тип: Bool

Значение по умолчанию: 1

Разрешить объединять фильтры в плане запроса
## query_plan_optimize_lazy_materialization {#query_plan_optimize_lazy_materialization}

Тип: Bool

Значение по умолчанию: 1

Использовать план запроса для оптимизации ленивой материализации
## query_plan_optimize_prewhere {#query_plan_optimize_prewhere}

Тип: Bool

Значение по умолчанию: 1

Разрешить перемещение фильтра в выражение PREWHERE для поддерживаемых хранилищ
## query_plan_push_down_limit {#query_plan_push_down_limit}

Тип: Bool

Значение по умолчанию: 1

Переключает оптимизацию уровня плана запроса, которая перемещает LIMIT вниз в плане выполнения.
Вступает в силу только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка для экспертов, которая должна использоваться только для отладки разработчиками. Настройка может измениться в будущем в несовместимых направлениях или быть удалена.
:::

Возможные значения:

- 0 - Отключено
- 1 - Включено
## query_plan_read_in_order {#query_plan_read_in_order}

Тип: Bool

Значение по умолчанию: 1

Переключает оптимизацию чтения по порядку на уровне плана запроса.
Вступает в силу только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка для экспертов, которая должна использоваться только для отладки разработчиками. Настройка может измениться в будущем в несовместимых направлениях или быть удалена.
:::

Возможные значения:

- 0 - Отключено
- 1 - Включено
## query_plan_remove_redundant_distinct {#query_plan_remove_redundant_distinct}

Тип: Bool

Значение по умолчанию: 1

Переключает оптимизацию уровня плана запроса, которая удаляет избыточные шаги DISTINCT.
Вступает в силу только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка для экспертов, которая должна использоваться только для отладки разработчиками. Настройка может измениться в будущем в несовместимых направлениях или быть удалена.
:::

Возможные значения:

- 0 - Отключено
- 1 - Включено
## query_plan_remove_redundant_sorting {#query_plan_remove_redundant_sorting}

Тип: Bool

Значение по умолчанию: 1

Переключает оптимизацию уровня плана запроса, которая удаляет избыточные шаги сортировки, например, в подзапросах.
Вступает в силу только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка для экспертов, которая должна использоваться только для отладки разработчиками. Настройка может измениться в будущем в несовместимых направлениях или быть удалена.
:::

Возможные значения:

- 0 - Отключено
- 1 - Включено
## query_plan_reuse_storage_ordering_for_window_functions {#query_plan_reuse_storage_ordering_for_window_functions}

Тип: Bool

Значение по умолчанию: 1

Переключает оптимизацию уровня плана запроса, которая использует сортировку хранилища при сортировке для оконных функций.
Вступает в силу только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка для экспертов, которая должна использоваться только для отладки разработчиками. Настройка может измениться в будущем в несовместимых направлениях или быть удалена.
:::

Возможные значения:

- 0 - Отключено
- 1 - Включено
## query_plan_split_filter {#query_plan_split_filter}

Тип: Bool

Значение по умолчанию: 1

:::note
Это настройка для экспертов, которая должна использоваться только для отладки разработчиками. Настройка может измениться в будущем в несовместимых направлениях или быть удалена.
:::

Переключает оптимизацию уровня плана запроса, которая разбивает фильтры на выражения.
Вступает в силу только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

Возможные значения:

- 0 - Отключено
- 1 - Включено
## query_plan_try_use_vector_search {#query_plan_try_use_vector_search}

Тип: Bool

Значение по умолчанию: 1

Переключает оптимизацию уровня плана запроса, которая пытается использовать индекс векторной близости.
Вступает в силу только если настройка [query_plan_enable_optimizations](#query_plan_enable_optimizations) равна 1.

:::note
Это настройка для экспертов, которая должна использоваться только для отладки разработчиками. Настройка может измениться в будущем в несовместимых направлениях или быть удалена.
:::

Возможные значения:

- 0 - Отключено
- 1 - Включено
## query_plan_use_new_logical_join_step {#query_plan_use_new_logical_join_step}

Тип: Bool

Значение по умолчанию: 1

Использовать новый логический шаг соединения в плане запроса
## query_profiler_cpu_time_period_ns {#query_profiler_cpu_time_period_ns}

Тип: UInt64

Значение по умолчанию: 1000000000

Устанавливает период для таймера часов CPU [профайлера запросов](../../operations/optimizing-performance/sampling-query-profiler.md). Этот таймер учитывает только время CPU.

Возможные значения:

- Положительное целое число в наносекундах.

    Рекомендуемые значения:

            - 10000000 (100 раз в секунду) наносекунд и больше для отдельных запросов.
            - 1000000000 (раз в секунду) для профилирования по кластерам.

- 0 для отключения таймера.

**Временно отключено в ClickHouse Cloud.**

Смотрите также:

- Системная таблица [trace_log](/operations/system-tables/trace_log)
## query_profiler_real_time_period_ns {#query_profiler_real_time_period_ns}

Тип: UInt64

Значение по умолчанию: 1000000000

Устанавливает период для таймера реального времени [профайлера запросов](../../operations/optimizing-performance/sampling-query-profiler.md). Таймер реального времени учитывает время на стене.

Возможные значения:

- Положительное целое число, в наносекундах.

    Рекомендуемые значения:

            - 10000000 (100 раз в секунду) наносекунд и меньше для отдельных запросов.
            - 1000000000 (раз в секунду) для профилирования по кластерам.

- 0 для отключения таймера.

**Временно отключено в ClickHouse Cloud.**

Смотрите также:

- Системная таблица [trace_log](/operations/system-tables/trace_log)
## queue_max_wait_ms {#queue_max_wait_ms}

Тип: Milliseconds

Значение по умолчанию: 0

Время ожидания в очереди запросов, если количество параллельных запросов превышает максимальное.
## rabbitmq_max_wait_ms {#rabbitmq_max_wait_ms}

Тип: Milliseconds

Значение по умолчанию: 5000

Время ожидания чтения из RabbitMQ перед повторной попыткой.
## read_backoff_max_throughput {#read_backoff_max_throughput}

Тип: UInt64

Значение по умолчанию: 1048576

Настройки для уменьшения количества потоков в случае медленных чтений. Подсчет событий, когда полоса пропускания чтения меньше этого числа байт в секунду.
## read_backoff_min_concurrency {#read_backoff_min_concurrency}

Тип: UInt64

Значение по умолчанию: 1

Настройки, чтобы попытаться сохранить минимальное количество потоков в случае медленных чтений.
## read_backoff_min_events {#read_backoff_min_events}

Тип: UInt64

Значение по умолчанию: 2

Настройки для уменьшения количества потоков в случае медленных чтений. Количество событий, после которого количество потоков будет уменьшено.
## read_backoff_min_interval_between_events_ms {#read_backoff_min_interval_between_events_ms}

Тип: Milliseconds

Значение по умолчанию: 1000

Настройки для уменьшения количества потоков в случае медленных чтений. Не обращать внимания на событие, если предыдущее прошло менее определенного времени.
## read_backoff_min_latency_ms {#read_backoff_min_latency_ms}

Тип: Milliseconds

Значение по умолчанию: 1000

Настройка для уменьшения количества потоков в случае медленных чтений. Обращать внимание только на чтения, которые заняли по крайней мере столько времени.
## read_from_filesystem_cache_if_exists_otherwise_bypass_cache {#read_from_filesystem_cache_if_exists_otherwise_bypass_cache}

Тип: Bool

Значение по умолчанию: 0

Разрешить использовать файловый кэш в пассивном режиме - извлекать выгоду из существующих записей кэша, но не размещать новые записи в кэше. Если вы установите эту настройку для тяжелых ad-hoc запросов и оставите ее отключенной для коротких запросов в реальном времени, это поможет избежать тряски кэша из-за слишком тяжелых запросов и повысит общую эффективность системы.
## read_from_page_cache_if_exists_otherwise_bypass_cache {#read_from_page_cache_if_exists_otherwise_bypass_cache}

Тип: Bool

Значение по умолчанию: 0

Используйте кэш страниц пользовательского пространства в пассивном режиме, аналогично read_from_filesystem_cache_if_exists_otherwise_bypass_cache.
## read_in_order_two_level_merge_threshold {#read_in_order_two_level_merge_threshold}

Тип: UInt64

Значение по умолчанию: 100

Минимальное количество частей для чтения, чтобы выполнить предварительное слияние в процессе многопоточной сортировки по первичному ключу.
## read_in_order_use_buffering {#read_in_order_use_buffering}

Тип: Bool

Значение по умолчанию: 1

Использовать буферизацию перед слиянием при чтении в порядке первичного ключа. Это увеличивает параллелизм выполнения запросов
## read_in_order_use_virtual_row {#read_in_order_use_virtual_row}

Тип: Bool

Значение по умолчанию: 0

Использовать виртуальную строку при чтении в порядке первичного ключа или монотонной функции. Это полезно, когда поиск осуществляется по нескольким частям, поскольку затрагиваются только соответствующие.
## read_overflow_mode {#read_overflow_mode}

Тип: OverflowMode

Значение по умолчанию: throw

Что делать, когда превышен лимит.
## read_overflow_mode_leaf {#read_overflow_mode_leaf}

Тип: OverflowMode

Значение по умолчанию: throw

Устанавливает, что произойдет, когда объем прочитанных данных превышает один из предельных значений.

Возможные варианты:
- `throw`: генерировать исключение (по умолчанию).
- `break`: прекратить выполнение запроса и вернуть частичный результат.
## read_priority {#read_priority}

Тип: Int64

Значение по умолчанию: 0

Приоритет для чтения данных из локальной файловой системы или удаленной файловой системы. Поддерживается только для метода 'pread_threadpool' для локальной файловой системы и для метода `threadpool` для удаленной файловой системы.
## read_through_distributed_cache {#read_through_distributed_cache}

<CloudAvailableBadge/>

Тип: Bool

Значение по умолчанию: 0

Эта настройка имеет эффект только в ClickHouse Cloud. Разрешает чтение из распределенного кэша.
## readonly {#readonly}

Тип: UInt64

Значение по умолчанию: 0

0 - никаких ограничений на только для чтения. 1 - только запросы на чтение, а также изменение явно разрешенных настроек. 2 - только запросы на чтение, а также изменение настроек, за исключением настройки 'readonly'.
## receive_data_timeout_ms {#receive_data_timeout_ms}

Тип: Milliseconds

Значение по умолчанию: 2000

Таймаут соединения для получения первого пакета данных или пакета с положительным прогрессом от реплики.
## receive_timeout {#receive_timeout}

Тип: Seconds

Значение по умолчанию: 300

Таймаут для получения данных из сети, в секундах. Если в этом интервале не было получено ни одного байта, генерируется исключение. Если вы установите эту настройку на клиенте, 'send_timeout' для сокета также будет установлен на соответствующем конце соединения на сервере.
## regexp_max_matches_per_row {#regexp_max_matches_per_row}

Тип: UInt64

Значение по умолчанию: 1000

Устанавливает максимальное количество совпадений для одного регулярного выражения на строку. Используйте это, чтобы защититься от перегрузки памяти при использовании жадного регулярного выражения в функции [extractAllGroupsHorizontal](/sql-reference/functions/string-search-functions#extractallgroupshorizontal).

Возможные значения:

- Положительное целое число.
## reject_expensive_hyperscan_regexps {#reject_expensive_hyperscan_regexps}

Тип: Bool

Значение по умолчанию: 1

Отклонять шаблоны, которые, вероятно, будут дорогостоящими для оценки с помощью hyperscan (из-за взрывного роста состояния NFA).
## remerge_sort_lowered_memory_bytes_ratio {#remerge_sort_lowered_memory_bytes_ratio}

Тип: Float

Значение по умолчанию: 2

Если использование памяти после повторного слияния не снижается на эту величину, повторное слияние будет отключено.
## remote_filesystem_read_method {#remote_filesystem_read_method}

Тип: String

Значение по умолчанию: threadpool

Метод чтения данных из удаленной файловой системы, один из: read, threadpool.
## remote_filesystem_read_prefetch {#remote_filesystem_read_prefetch}

Тип: Bool

Значение по умолчанию: 1

Следует использовать предзагрузку при чтении данных из удаленной файловой системы.
## remote_fs_read_backoff_max_tries {#remote_fs_read_backoff_max_tries}

Тип: UInt64

Значение по умолчанию: 5

Максимальное количество попыток чтения с задержкой.
## remote_fs_read_max_backoff_ms {#remote_fs_read_max_backoff_ms}

Тип: UInt64

Значение по умолчанию: 10000

Максимальное время ожидания при попытке чтения данных для удаленного диска.
## remote_read_min_bytes_for_seek {#remote_read_min_bytes_for_seek}

Тип: UInt64

Значение по умолчанию: 4194304

Минимальное количество байтов, необходимых для удаленного чтения (url, s3), чтобы выполнить поиск, вместо чтения с игнорированием.
## rename_files_after_processing {#rename_files_after_processing}

Тип: String

Значение по умолчанию: 

- **Тип:** Строка

- **Значение по умолчанию:** Пустая строка

Эта настройка позволяет задать шаблон переименования для файлов, обрабатываемых функцией `file`. Когда опция установлена, все файлы, прочитанные функцией `file`, будут переименованы в соответствии со заданным шаблоном с заполнителями, только если обработка файлов была успешной.
### Заполнители

- `%a` — Полное оригинальное имя файла (например, "sample.csv").
- `%f` — Оригинальное имя файла без расширения (например, "sample").
- `%e` — Оригинальное расширение файла с точкой (например, ".csv").
- `%t` — Временная метка (в микросекундах).
- `%%` — Знак процента ("%").
### Пример
- Опция: `--rename_files_after_processing="processed_%f_%t%e"`

- Запрос: `SELECT * FROM file('sample.csv')`

Если чтение `sample.csv` успешно, файл будет переименован в `processed_sample_1683473210851438.csv`.
## replace_running_query {#replace_running_query}

Тип: Bool

Значение по умолчанию: 0

При использовании HTTP интерфейса можно передавать параметр 'query_id'. Это любая строка, которая служит идентификатором запроса.
Если запрос от того же пользователя с тем же 'query_id' уже существует в это время, поведение зависит от параметра 'replace_running_query'.

`0` (по умолчанию) – Генерировать исключение (не разрешать выполнение запроса, если запрос с тем же 'query_id' уже выполняется).

`1` – Прекратить старый запрос и начать выполнение нового.

Установите этот параметр в 1 для реализации предложений по условиям сегментации. После ввода следующего символа, если старый запрос еще не завершен, он должен быть отменен.
## replace_running_query_max_wait_ms {#replace_running_query_max_wait_ms}

Тип: Milliseconds

Значение по умолчанию: 5000

Время ожидания завершения запроса с тем же `query_id`, когда активна настройка [replace_running_query](#replace_running_query).

Возможные значения:

- Положительное целое число.
- 0 — Генерация исключения, которое не позволяет запустить новый запрос, если сервер уже выполняет запрос с тем же `query_id`.
## replication_wait_for_inactive_replica_timeout {#replication_wait_for_inactive_replica_timeout}

Тип: Int64

Значение по умолчанию: 120

Указывает, как долго (в секундах) ждать, пока неактивные реплики выполнят запросы [ALTER](../../sql-reference/statements/alter/index.md), [OPTIMIZE](../../sql-reference/statements/optimize.md) или [TRUNCATE](../../sql-reference/statements/truncate.md).

Возможные значения:

- 0 — Не ждать.
- Отрицательное целое число — Ждать неограниченное время.
- Положительное целое число — количество секунд ожидания.
## restore_replace_external_dictionary_source_to_null {#restore_replace_external_dictionary_source_to_null}

Тип: Bool

Значение по умолчанию: 0

Заменить внешние источники словарей на Null при восстановлении. Полезно для тестирования.
## restore_replace_external_engines_to_null {#restore_replace_external_engines_to_null}

Тип: Bool

Значение по умолчанию: 0

Для тестирования. Заменяет все внешние движки на Null, чтобы не инициировать внешние соединения.
## restore_replace_external_table_functions_to_null {#restore_replace_external_table_functions_to_null}

Тип: Bool

Значение по умолчанию: 0

Для тестирования. Заменяет все внешние табличные функции на Null, чтобы не инициировать внешние соединения.
## restore_replicated_merge_tree_to_shared_merge_tree {#restore_replicated_merge_tree_to_shared_merge_tree}

Тип: Bool

Значение по умолчанию: 0

Заменяет движок таблицы с Replicated*MergeTree на Shared*MergeTree во время ВОССТАНОВЛЕНИЯ.
## result_overflow_mode {#result_overflow_mode}

Тип: OverflowMode

Значение по умолчанию: throw

Облачное значение по умолчанию: `throw`

Устанавливает, что делать, если объем результата превышает одно из предельных значений.

Возможные значения:
- `throw`: генерировать исключение (по умолчанию).
- `break`: прекратить выполнение запроса и вернуть частичный результат, как если бы
           исходные данные закончились.

Использование 'break' похоже на использование LIMIT. `Break` прерывает выполнение только на уровне блока. Это означает, что количество возвращаемых строк больше, чем [`max_result_rows`](/operations/settings/settings#max_result_rows), кратно [`max_block_size`](/operations/settings/settings#max_block_size)
и зависит от [`max_threads`](/operations/settings/settings#max_threads).

**Пример**

```sql title="Запрос"
SET max_threads = 3, max_block_size = 3333;
SET max_result_rows = 3334, result_overflow_mode = 'break';

SELECT *
FROM numbers_mt(100000)
FORMAT Null;
```

```text title="Результат"
6666 строк в наборе. ...
```
## rewrite_count_distinct_if_with_count_distinct_implementation {#rewrite_count_distinct_if_with_count_distinct_implementation}

Тип: Bool

Значение по умолчанию: 0

Позволяет переписывать `countDistinctIf` с настройкой [count_distinct_implementation](#count_distinct_implementation).

Возможные значения:

- true — Разрешено.
- false — Запрещено.
## s3_allow_multipart_copy {#s3_allow_multipart_copy}

Тип: Bool

Значение по умолчанию: 1

Разрешить мультичастичное копирование в S3.
## s3_allow_parallel_part_upload {#s3_allow_parallel_part_upload}

Тип: Bool

Значение по умолчанию: 1

Использовать несколько потоков для многослойной загрузки в S3. Это может привести к немного большему использованию памяти.
## s3_check_objects_after_upload {#s3_check_objects_after_upload}

Тип: Bool

Значение по умолчанию: 0

Проверять каждый загруженный объект в S3 с помощью запроса head, чтобы убедиться, что загрузка была успешной.
## s3_connect_timeout_ms {#s3_connect_timeout_ms}

Тип: UInt64

Значение по умолчанию: 1000

Тайм-аут подключения для хоста с дисков S3.
## s3_create_new_file_on_insert {#s3_create_new_file_on_insert}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает создание нового файла при каждом вставке в таблицы движка S3. Если включено, при каждой вставке будет создан новый объект S3 с ключом, похожим на следующий шаблон:

начальный: `data.Parquet.gz` -> `data.1.Parquet.gz` -> `data.2.Parquet.gz` и т.д.

Возможные значения:
- 0 — Запрос `INSERT` создает новый файл или завершится с ошибкой, если файл существует и не установлен параметр s3_truncate_on_insert.
- 1 — Запрос `INSERT` создает новый файл при каждой вставке с использованием суффикса (со второго) при условии, что s3_truncate_on_insert не установлен.

Смотрите подробности [здесь](/integrations/s3#inserting-data).
```

## s3_disable_checksum {#s3_disable_checksum}

Тип: Bool

Значение по умолчанию: 0

Не вычислять контрольную сумму при отправке файла в S3. Это ускоряет записи, избегая чрезмерной обработки файла. Это в основном безопасно, так как данные таблиц MergeTree всё равно проверяются ClickHouse, и когда доступ к S3 осуществляется через HTTPS, уровень TLS уже обеспечивает целостность при передаче по сети. Хотя дополнительные контрольные суммы в S3 обеспечивают дополнительную защиту.

## s3_ignore_file_doesnt_exist {#s3_ignore_file_doesnt_exist}

Тип: Bool

Значение по умолчанию: 0

Игнорировать отсутствие файла, если он не существует при чтении определенных ключей.

Возможные значения:
- 1 — `SELECT` возвращает пустой результат.
- 0 — `SELECT` вызывает исключение.

## s3_list_object_keys_size {#s3_list_object_keys_size}

Тип: UInt64

Значение по умолчанию: 1000

Максимальное количество файлов, которые могут быть возвращены в批е по запросу ListObject.

## s3_max_connections {#s3_max_connections}

Тип: UInt64

Значение по умолчанию: 1024

Максимальное количество соединений на сервер.

## s3_max_get_burst {#s3_max_get_burst}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество запросов, которые могут быть отправлены одновременно, прежде чем будет достигнут лимит запросов в секунду. По умолчанию (0) равняется `s3_max_get_rps`.

## s3_max_get_rps {#s3_max_get_rps}

Тип: UInt64

Значение по умолчанию: 0

Лимит на GET запросы в секунду для S3 до ограничения скорости. Ноль означает безлимитный.

## s3_max_inflight_parts_for_one_file {#s3_max_inflight_parts_for_one_file}

Тип: UInt64

Значение по умолчанию: 20

Максимальное количество одновременно загружаемых частей в запросе многочастевой загрузки. 0 означает безлимитный.

## s3_max_part_number {#s3_max_part_number}

Тип: UInt64

Значение по умолчанию: 10000

Максимальный номер части для загрузки в S3.

## s3_max_put_burst {#s3_max_put_burst}

Тип: UInt64

Значение по умолчанию: 0

Максимальное количество запросов, которые могут быть отправлены одновременно, прежде чем будет достигнут лимит запросов в секунду. По умолчанию (0) равняется `s3_max_put_rps`.

## s3_max_put_rps {#s3_max_put_rps}

Тип: UInt64

Значение по умолчанию: 0

Лимит на PUT запросы в секунду для S3 до ограничения скорости. Ноль означает безлимитный.

## s3_max_redirects {#s3_max_redirects}

Тип: UInt64

Значение по умолчанию: 10

Максимальное количество перенаправлений S3, разрешенных.

## s3_max_single_operation_copy_size {#s3_max_single_operation_copy_size}

Тип: UInt64

Значение по умолчанию: 33554432

Максимальный размер для одномоментного копирования в S3. Настройка используется только если `s3_allow_multipart_copy` равно true.

## s3_max_single_part_upload_size {#s3_max_single_part_upload_size}

Тип: UInt64

Значение по умолчанию: 33554432

Максимальный размер объекта для загрузки с использованием одномоментной загрузки в S3.

## s3_max_single_read_retries {#s3_max_single_read_retries}

Тип: UInt64

Значение по умолчанию: 4

Максимальное количество попыток при одномоментном чтении из S3.

## s3_max_unexpected_write_error_retries {#s3_max_unexpected_write_error_retries}

Тип: UInt64

Значение по умолчанию: 4

Максимальное количество повторных попыток в случае неожиданных ошибок при записи в S3.

## s3_max_upload_part_size {#s3_max_upload_part_size}

Тип: UInt64

Значение по умолчанию: 5368709120

Максимальный размер части для загрузки во время многочастевой загрузки в S3.

## s3_min_upload_part_size {#s3_min_upload_part_size}

Тип: UInt64

Значение по умолчанию: 16777216

Минимальный размер части для загрузки во время многочастевой загрузки в S3.

## s3_request_timeout_ms {#s3_request_timeout_ms}

Тип: UInt64

Значение по умолчанию: 30000

Тайм-аут бездействия для отправки и получения данных из/в S3. Срабатывает, если один вызов чтения или записи TCP блокируется так долго.

## s3_retry_attempts {#s3_retry_attempts}

Тип: UInt64

Значение по умолчанию: 100

Настройка для Aws::Client::RetryStrategy, Aws::Client выполняет повторные попытки самостоятельно, 0 означает без повторных попыток.

## s3_skip_empty_files {#s3_skip_empty_files}

Тип: Bool

Значение по умолчанию: 1

Включает или отключает пропуск пустых файлов в таблицах движка [S3](../../engines/table-engines/integrations/s3.md).

Возможные значения:
- 0 — `SELECT` вызывает исключение, если пустой файл не совместим с запрашиваемым форматом.
- 1 — `SELECT` возвращает пустой результат для пустого файла.

## s3_strict_upload_part_size {#s3_strict_upload_part_size}

Тип: UInt64

Значение по умолчанию: 0

Точный размер части для загрузки во время многочастевой загрузки в S3 (некоторые реализации не поддерживают части переменного размера).

## s3_throw_on_zero_files_match {#s3_throw_on_zero_files_match}

Тип: Bool

Значение по умолчанию: 0

Выбросить ошибку, когда запрос ListObjects не может сопоставить ни один файл.

## s3_truncate_on_insert {#s3_truncate_on_insert}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает усечение перед вставками в таблицах движка S3. Если отключено, будет выброшено исключение при попытке вставки, если объект S3 уже существует.

Возможные значения:
- 0 — запрос `INSERT` создает новый файл или не удается, если файл существует и `s3_create_new_file_on_insert` не установлен.
- 1 — запрос `INSERT` заменяет существующее содержимое файла новыми данными.

Смотрите дополнительные детали [здесь](/integrations/s3#inserting-data).

## s3_upload_part_size_multiply_factor {#s3_upload_part_size_multiply_factor}

Тип: UInt64

Значение по умолчанию: 2

Умножает `s3_min_upload_part_size` на этот коэффициент каждый раз, когда `s3_multiply_parts_count_threshold` части были загружены с одной записи в S3.

## s3_upload_part_size_multiply_parts_count_threshold {#s3_upload_part_size_multiply_parts_count_threshold}

Тип: UInt64

Значение по умолчанию: 500

Каждый раз, когда это количество частей было загружено в S3, `s3_min_upload_part_size` умножается на `s3_upload_part_size_multiply_factor`.

## s3_use_adaptive_timeouts {#s3_use_adaptive_timeouts}

Тип: Bool

Значение по умолчанию: 1

Когда установлено в `true`, для всех запросов S3 первые две попытки выполняются с низкими таймаутами отправки и приема.
Когда установлено в `false`, все попытки выполняются с одинаковыми таймаутами.

## s3_validate_request_settings {#s3_validate_request_settings}

Тип: Bool

Значение по умолчанию: 1

Включает валидацию настроек запросов S3.

Возможные значения:
- 1 — валидировать настройки.
- 0 — не валидировать настройки.

## s3queue_default_zookeeper_path {#s3queue_default_zookeeper_path}

Тип: String

Значение по умолчанию: /clickhouse/s3queue/

Префикс пути по умолчанию Zookeeper для движка S3Queue.

## s3queue_enable_logging_to_s3queue_log {#s3queue_enable_logging_to_s3queue_log}

Тип: Bool

Значение по умолчанию: 0

Включить запись в system.s3queue_log. Значение может быть переопределено для таблицы с настройками таблицы.

## s3queue_migrate_old_metadata_to_buckets {#s3queue_migrate_old_metadata_to_buckets}

Тип: Bool

Значение по умолчанию: 0

Миграция старой структуры метаданных таблицы S3Queue в новую.

## schema_inference_cache_require_modification_time_for_url {#schema_inference_cache_require_modification_time_for_url}

Тип: Bool

Значение по умолчанию: 1

Использовать схему из кэша для URL с проверкой времени последнего изменения (для URL с заголовком Last-Modified).

## schema_inference_use_cache_for_azure {#schema_inference_use_cache_for_azure}

Тип: Bool

Значение по умолчанию: 1

Использовать кэш при выводе схемы при использовании функцией таблицы Azure.

## schema_inference_use_cache_for_file {#schema_inference_use_cache_for_file}

Тип: Bool

Значение по умолчанию: 1

Использовать кэш при выводе схемы при использовании функции таблицы файл.

## schema_inference_use_cache_for_hdfs {#schema_inference_use_cache_for_hdfs}

Тип: Bool

Значение по умолчанию: 1

Использовать кэш при выводе схемы при использовании функции таблицы HDFS.

## schema_inference_use_cache_for_s3 {#schema_inference_use_cache_for_s3}

Тип: Bool

Значение по умолчанию: 1

Использовать кэш при выводе схемы при использовании функции таблицы S3.

## schema_inference_use_cache_for_url {#schema_inference_use_cache_for_url}

Тип: Bool

Значение по умолчанию: 1

Использовать кэш при выводе схемы при использовании функции таблицы URL.

## select_sequential_consistency {#select_sequential_consistency}

Тип: UInt64

Значение по умолчанию: 0

:::note
Эта настройка имеет различия в поведении между SharedMergeTree и ReplicatedMergeTree, см. [Согласованность SharedMergeTree](/cloud/reference/shared-merge-tree#consistency) для получения дополнительной информации о поведении `select_sequential_consistency` в SharedMergeTree.
:::

Включает или отключает последовательную согласованность для запросов `SELECT`. Требует, чтобы `insert_quorum_parallel` был отключен (включен по умолчанию).

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

Использование

Когда последовательная согласованность включена, ClickHouse позволяет клиенту выполнять запрос `SELECT` только для тех реплик, которые содержат данные от всех предыдущих запросов `INSERT`, выполненных с `insert_quorum`. Если клиент ссылается на частичную реплику, ClickHouse сгенерирует исключение. Запрос `SELECT` не будет включать данные, которые еще не были записаны в кворум реплик.

Когда `insert_quorum_parallel` включен (по умолчанию), `select_sequential_consistency` не работает. Это связано с тем, что параллельные запросы `INSERT` могут быть записаны в разные наборы кворумных реплик, поэтому нет гарантии, что одна реплика получила все записи.

Смотрите также:

- [insert_quorum](#insert_quorum)
- [insert_quorum_timeout](#insert_quorum_timeout)
- [insert_quorum_parallel](#insert_quorum_parallel)

## send_logs_level {#send_logs_level}

Тип: LogsLevel

Значение по умолчанию: fatal

Отправлять текстовые логи сервера с заданным минимальным уровнем клиенту. Допустимые значения: 'trace', 'debug', 'information', 'warning', 'error', 'fatal', 'none'.

## send_logs_source_regexp {#send_logs_source_regexp}

Тип: String

Значение по умолчанию: 

Отправлять текстовые логи сервера с заданным регулярным выражением для сопоставления имени источника журнала. Пустое значение означает все источники.

## send_progress_in_http_headers {#send_progress_in_http_headers}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает HTTP заголовки ответа `X-ClickHouse-Progress` в ответах `clickhouse-server`.

Для получения дополнительной информации прочтите [описание HTTP интерфейса](../../interfaces/http.md).

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

## send_timeout {#send_timeout}

Тип: Seconds

Значение по умолчанию: 300

Тайм-аут на отправку данных в сеть, в секундах. Если клиенту нужно отправить некоторые данные, но он не может отправить ни один байт в этот интервал, выбрасывается исключение. Если вы устанавливаете эту настройку на клиенте, тайм-аут 'receive_timeout' для сокета также будет установлен на соответствующем соединении на сервере.

## session_timezone {#session_timezone}
<BetaBadge/>

Тип: Timezone

Значение по умолчанию:

Устанавливает неявный часовой пояс текущей сессии или запроса.
Неявный часовой пояс — это часовой пояс, который применяется к значениям типа DateTime/DateTime64, для которых явно не указан часовой пояс.
Настройка имеет приоритет над глобально настроенным (уровнем сервера) неявным часовым поясом.
Значение '' (пустая строка) означает, что неявный часовой пояс текущей сессии или запроса равен [среднему часовому поясу сервера](../server-configuration-parameters/settings.md/#timezone).

Вы можете использовать функции `timeZone()` и `serverTimeZone()`, чтобы получить часовой пояс сессии и часовой пояс сервера.

Возможные значения:

-    Любое имя часового пояса из `system.time_zones`, например `Europe/Berlin`, `UTC` или `Zulu`.

Примеры:

```sql
SELECT timeZone(), serverTimeZone() FORMAT CSV

"Europe/Berlin","Europe/Berlin"
```

```sql
SELECT timeZone(), serverTimeZone() SETTINGS session_timezone = 'Asia/Novosibirsk' FORMAT CSV

"Asia/Novosibirsk","Europe/Berlin"
```

Назначить часовой пояс сессии 'America/Denver' для внутреннего DateTime без явно указанного часового пояса:

```sql
SELECT toDateTime64(toDateTime64('1999-12-12 23:23:23.123', 3), 3, 'Europe/Zurich') SETTINGS session_timezone = 'America/Denver' FORMAT TSV

1999-12-13 07:23:23.123
```

:::warning
Не все функции, которые разбирают DateTime/DateTime64, учитывают `session_timezone`. Это может привести к тонким ошибкам.
Смотрите следующий пример и объяснение.
:::

```sql
CREATE TABLE test_tz (`d` DateTime('UTC')) ENGINE = Memory AS SELECT toDateTime('2000-01-01 00:00:00', 'UTC');

SELECT *, timeZone() FROM test_tz WHERE d = toDateTime('2000-01-01 00:00:00') SETTINGS session_timezone = 'Asia/Novosibirsk'
0 rows in set.

SELECT *, timeZone() FROM test_tz WHERE d = '2000-01-01 00:00:00' SETTINGS session_timezone = 'Asia/Novosibirsk'
┌───────────────────d─┬─timeZone()───────┐
│ 2000-01-01 00:00:00 │ Asia/Novosибирск │
└─────────────────────┴──────────────────┘
```

Это происходит из-за разных механизмов разбора:

- `toDateTime()` без явно указанного часового пояса, используемого в первом запросе `SELECT`, учитывает настройку `session_timezone` и глобальный часовой пояс.
- Во втором запросе DateTime разбирается из строки и наследует тип и часовой пояс существующего столбца `d`. Следовательно, установки `session_timezone` и глобального часового пояса не учитываются.

**Смотрите также**

- [timezone](../server-configuration-parameters/settings.md/#timezone)

## set_overflow_mode {#set_overflow_mode}

Тип: OverflowMode

Значение по умолчанию: throw

Устанавливает, что происходит, когда количество данных превышает один из лимитов.

Возможные значения:
- `throw`: выбросить исключение (по умолчанию).
- `break`: остановить выполнение запроса и вернуть частичный результат, как если бы исходные данные закончились.

## shared_merge_tree_sync_parts_on_partition_operations {#shared_merge_tree_sync_parts_on_partition_operations}

Тип: Bool

Значение по умолчанию: 1

Автоматически синхронизировать набор частей данных после операций MOVE|REPLACE|ATTACH для партиций в таблицах SMT. Только для облака.

## short_circuit_function_evaluation {#short_circuit_function_evaluation}

Тип: ShortCircuitFunctionEvaluation

Значение по умолчанию: enable

Позволяет вычислять функции [if](../../sql-reference/functions/conditional-functions.md/#if), [multiIf](../../sql-reference/functions/conditional-functions.md/#multiif), [and](/sql-reference/functions/logical-functions#and) и [or](/sql-reference/functions/logical-functions#or) в соответствии с [короткой схемой](https://en.wikipedia.org/wiki/Short-circuit_evaluation). Это помогает оптимизировать выполнение сложных выражений в этих функциях и предотвращает возможные исключения (например, деление на ноль, когда это не ожидается).

Возможные значения:

- `enable` — включает оценку функций с коротким замыканием для функций, которые подходят для этого (могут выбросить исключение или являются вычислительно сложными).
- `force_enable` — включает оценку функций с коротким замыканием для всех функций.
- `disable` — отключает оценку функций с коротким замыканием.

## short_circuit_function_evaluation_for_nulls {#short_circuit_function_evaluation_for_nulls}

Тип: Bool

Значение по умолчанию: 1

Оптимизирует оценку функций, которые возвращают NULL, когда любой аргумент равен NULL. Когда процент значений NULL в аргументах функции превышает `short_circuit_function_evaluation_for_nulls_threshold`, система пропускает оценку функции построчно. Вместо этого она сразу возвращает NULL для всех строк, избегая ненужных вычислений.

## short_circuit_function_evaluation_for_nulls_threshold {#short_circuit_function_evaluation_for_nulls_threshold}

Тип: Double

Значение по умолчанию: 1

Пороговое соотношение значений NULL для выполнения функций с Nullable аргументами только по строкам с не NULL значениями во всех аргументах. Применяется при включенной настройке `short_circuit_function_evaluation_for_nulls`.
Когда соотношение строк, содержащих значения NULL, к общему количеству строк превышает этот порог, эти строки, содержащие значения NULL, не будут оцениваться.

## show_table_uuid_in_table_create_query_if_not_nil {#show_table_uuid_in_table_create_query_if_not_nil}

Тип: Bool

Значение по умолчанию: 0

Устанавливает отображение запроса `SHOW TABLE`.

Возможные значения:

- 0 — Запрос будет отображаться без UUID таблицы.
- 1 — Запрос будет отображаться с UUID таблицы.

## single_join_prefer_left_table {#single_join_prefer_left_table}

Тип: Bool

Значение по умолчанию: 1

Для одного JOIN в случае неоднозначности идентификаторов предпочитать левую таблицу.

## skip_redundant_aliases_in_udf {#skip_redundant_aliases_in_udf}

Тип: Bool

Значение по умолчанию: 0

Избыточные псевдонимы не используются (не заменяются) в пользовательских функциях для упрощения их использования.

Возможные значения:

- 1 — Псевдонимы пропускаются (заменяются) в UDF.
- 0 — Псевдонимы не пропускаются (заменяются) в UDF.

**Пример**

Разница между включенным и отключенным:

Запрос:

```sql
SET skip_redundant_aliases_in_udf = 0;
CREATE FUNCTION IF NOT EXISTS test_03274 AS ( x ) -> ((x + 1 as y, y + 2));

EXPLAIN SYNTAX SELECT test_03274(4 + 2);
```

Результат:

```text
SELECT ((4 + 2) + 1 AS y, y + 2)
```

Запрос:

```sql
SET skip_redundant_aliases_in_udf = 1;
CREATE FUNCTION IF NOT EXISTS test_03274 AS ( x ) -> ((x + 1 as y, y + 2));

EXPLAIN SYNTAX SELECT test_03274(4 + 2);
```

Результат:

```text
SELECT ((4 + 2) + 1, ((4 + 2) + 1) + 2)
```

## skip_unavailable_shards {#skip_unavailable_shards}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает тихое пропускание недоступных шардов.

Шард считается недоступным, если все его реплики недоступны. Реплика недоступна в следующих случаях:

- ClickHouse не может подключиться к реплике по любой причине.

    При подключении к реплике ClickHouse выполняет несколько попыток. Если все эти попытки не удачны, реплика считается недоступной.

- Реплика не может быть разрешена через DNS.

    Если имя хоста реплики не может быть разрешено через DNS, это может указывать на следующие ситуации:

    - У реплики нет DNS-записи. Это может произойти в системах с динамическим DNS, например, в [Kubernetes](https://kubernetes.io), где узлы могут быть неразрешимыми во время простоя, и это не ошибка.

    - Ошибка конфигурации. Файл конфигурации ClickHouse содержит неправильное имя хоста.

Возможные значения:

- 1 — пропуск включен.

    Если шард недоступен, ClickHouse возвращает результат на основе частичных данных и не сообщает о проблемах с доступностью узла.

- 0 — пропуск отключён.

    Если шард недоступен, ClickHouse выбрасывает исключение.

## sleep_after_receiving_query_ms {#sleep_after_receiving_query_ms}

Тип: Milliseconds

Значение по умолчанию: 0

Время ожидания после получения запроса в TCPHandler.

## sleep_in_send_data_ms {#sleep_in_send_data_ms}

Тип: Milliseconds

Значение по умолчанию: 0

Время ожидания при отправке данных в TCPHandler.

## sleep_in_send_tables_status_ms {#sleep_in_send_tables_status_ms}

Тип: Milliseconds

Значение по умолчанию: 0

Время ожидания при отправке статуса таблиц в TCPHandler.

## sort_overflow_mode {#sort_overflow_mode}

Тип: OverflowMode

Значение по умолчанию: throw

Устанавливает, что происходит, если количество строк, полученных перед сортировкой, превышает один из лимитов.

Возможные значения:
- `throw`: выбросить исключение.
- `break`: остановить выполнение запроса и вернуть частичный результат.

## split_intersecting_parts_ranges_into_layers_final {#split_intersecting_parts_ranges_into_layers_final}

Тип: Bool

Значение по умолчанию: 1

Разделить пересекающиеся_ranges частей на слои во время финальной оптимизации.

## split_parts_ranges_into_intersecting_and_non_intersecting_final {#split_parts_ranges_into_intersecting_and_non_intersecting_final}

Тип: Bool

Значение по умолчанию: 1

Разделить диапазоны частей на пересекающиеся и непересекающиеся во время финальной оптимизации.

## splitby_max_substrings_includes_remaining_string {#splitby_max_substrings_includes_remaining_string}

Тип: Bool

Значение по умолчанию: 0

Управляет тем, будет ли функция [splitBy*()](../../sql-reference/functions/splitting-merging-functions.md) с аргументом `max_substrings` > 0 включать оставшуюся строку в последний элемент результирующего массива.

Возможные значения:

- `0` - Оставшаяся строка не будет включена в последний элемент результирующего массива.
- `1` - Оставшаяся строка будет включена в последний элемент результирующего массива. Это поведение функции [`split()`](https://spark.apache.org/docs/3.1.2/api/python/reference/api/pyspark.sql.functions.split.html) Spark и метода ['string.split()'](https://docs.python.org/3/library/stdtypes.html#str.split) Python.

## stop_refreshable_materialized_views_on_startup {#stop_refreshable_materialized_views_on_startup}
<ExperimentalBadge/>

Тип: Bool

Значение по умолчанию: 0

При запуске сервера предотвратить планирование обновляемых материализованных представлений, как если бы с SYSTEM STOP VIEWS. Вы можете вручную запустить их с помощью `SYSTEM START VIEWS` или `SYSTEM START VIEW <name>` позже. Также применяется к вновь созданным представлениям. Не оказывает влияния на не обновляемые материализованные представления.

## storage_file_read_method {#storage_file_read_method}

Тип: LocalFSReadMethod

Значение по умолчанию: pread

Метод чтения данных из файла хранилища, один из: `read`, `pread`, `mmap`. Метод mmap не применяется к clickhouse-server (он предназначен для clickhouse-local).

## storage_system_stack_trace_pipe_read_timeout_ms {#storage_system_stack_trace_pipe_read_timeout_ms}

Тип: Milliseconds

Значение по умолчанию: 100

Максимальное время для чтения из трубы для получения информации от потоков при запросе таблицы `system.stack_trace`. Эта настройка используется в тестовых целях и не предназначена для изменения пользователями.

## stream_flush_interval_ms {#stream_flush_interval_ms}

Тип: Milliseconds

Значение по умолчанию: 7500

Работает для таблиц с потоковой передачей в случае превышения времени ожидания или когда поток создает [max_insert_block_size](#max_insert_block_size) строк.

Значение по умолчанию равно 7500.

Чем меньше значение, тем чаще данные сбрасываются в таблицу. Установка слишком низкого значения приводит к плохой производительности.

## stream_like_engine_allow_direct_select {#stream_like_engine_allow_direct_select}

Тип: Bool

Значение по умолчанию: 0

Разрешить прямой запрос SELECT для движков Kafka, RabbitMQ, FileLog, Redis Streams и NATS. Если есть присоединенные материализованные представления, запрос SELECT не разрешается, даже если эта настройка включена.

## stream_like_engine_insert_queue {#stream_like_engine_insert_queue}

Тип: String

Значение по умолчанию: 

Когда движок с потоковым чтением читает из нескольких очередей, пользователю необходимо выбрать одну очередь для вставки при записи. Используется Redis Streams и NATS.

## stream_poll_timeout_ms {#stream_poll_timeout_ms}

Тип: Milliseconds

Значение по умолчанию: 500

Тайм-аут для опроса данных из/в потоковые хранилища.

## system_events_show_zero_values {#system_events_show_zero_values}

Тип: Bool

Значение по умолчанию: 0

Позволяет выбирать события с нулевыми значениями из [`system.events`](../../operations/system-tables/events.md).

Некоторые системы мониторинга требуют передачи всех значений метрик им для каждой контрольной точки, даже если значение метрики равно нулю.

Возможные значения:

- 0 — Отключено.
- 1 — Включено.

**Примеры**

Запрос

```sql
SELECT * FROM system.events WHERE event='QueryMemoryLimitExceeded';
```

Результат

```text
Ok.
```

Запрос
```sql
SET system_events_show_zero_values = 1;
SELECT * FROM system.events WHERE event='QueryMemoryLimitExceeded';
```

Результат

```text
┌─event────────────────────┬─value─┬─description───────────────────────────────────────────┐
│ QueryMemoryLimitExceeded │     0 │ Количество раз, когда предел памяти был превышен для запроса. │
└──────────────────────────┴───────┴───────────────────────────────────────────────────────┘
```

## table_function_remote_max_addresses {#table_function_remote_max_addresses}

Тип: UInt64

Значение по умолчанию: 1000

Устанавливает максимальное количество адресов, сгенерированных из шаблонов для функции [remote](../../sql-reference/table-functions/remote.md).

Возможные значения:

- Положительное целое число.

## tcp_keep_alive_timeout {#tcp_keep_alive_timeout}

Тип: Seconds

Значение по умолчанию: 290

Время в секундах, в течение которого соединение должно оставаться бездействующим, прежде чем TCP начнет отправлять опросы keepalive.

## temporary_data_in_cache_reserve_space_wait_lock_timeout_milliseconds {#temporary_data_in_cache_reserve_space_wait_lock_timeout_milliseconds}

Тип: UInt64

Значение по умолчанию: 600000

Время ожидания для блокировки кэша для резервирования пространства для временных данных в файловом кэше.

## temporary_files_codec {#temporary_files_codec}

Тип: String

Значение по умолчанию: LZ4

Устанавливает кодек сжатия для временных файлов, используемых в операциях сортировки и соединения на диске.

Возможные значения:

- LZ4 — применяется сжатие [LZ4](https://en.wikipedia.org/wiki/LZ4_(compression_algorithm)).
- NONE — сжатие не применяется.

## throw_if_deduplication_in_dependent_materialized_views_enabled_with_async_insert {#throw_if_deduplication_in_dependent_materialized_views_enabled_with_async_insert}

Тип: Bool

Значение по умолчанию: 1

Выбросить исключение при выполнении запроса INSERT, когда настройка `deduplicate_blocks_in_dependent_materialized_views` включена вместе с `async_insert`. Это гарантирует корректность, так как эти функции не могут работать вместе.

## throw_if_no_data_to_insert {#throw_if_no_data_to_insert}

Тип: Bool

Значение по умолчанию: 1

Разрешает или запрещает пустые INSERT, включено по умолчанию (вызывает ошибку при пустой вставке). Применяется только к INSERT, использующим [`clickhouse-client`](/interfaces/cli) или используя [gRPC интерфейс](/interfaces/grpc).

## throw_on_error_from_cache_on_write_operations {#throw_on_error_from_cache_on_write_operations}

Тип: Bool

Значение по умолчанию: 0

Игнорировать ошибку из кэша при кэшировании операций записи (INSERT, объединения).

## throw_on_max_partitions_per_insert_block {#throw_on_max_partitions_per_insert_block}

Тип: Bool

Значение по умолчанию: 1

Позволяет контролировать поведение, когда достигается `max_partitions_per_insert_block`.

Возможные значения:
- `true`  - Когда блок вставки достигает `max_partitions_per_insert_block`, выбрасывается исключение.
- `false` - Выводит предупреждение при достижении `max_partitions_per_insert_block`.

:::tip
Это может быть полезным, если вы пытаетесь понять влияние на пользователей при изменении [`max_partitions_per_insert_block`](/operations/settings/settings#max_partitions_per_insert_block).
:::

## throw_on_unsupported_query_inside_transaction {#throw_on_unsupported_query_inside_transaction}
<ExperimentalBadge/>

Тип: Bool

Значение по умолчанию: 1

Выбросить исключение, если неподдерживаемый запрос используется внутри транзакции.

## timeout_before_checking_execution_speed {#timeout_before_checking_execution_speed}

Тип: Seconds

Значение по умолчанию: 10

Проверяет, что скорость выполнения не слишком медленная (не менее `min_execution_speed`), после истечения указанного времени в секундах.

## timeout_overflow_mode {#timeout_overflow_mode}

Тип: OverflowMode

Значение по умолчанию: throw

Устанавливает, что делать, если запрос выполняется дольше, чем `max_execution_time` или оценочное время выполнения превышает `max_estimated_execution_time`.

Возможные значения:
- `throw`: выбросить исключение (по умолчанию).
- `break`: остановить выполнение запроса и вернуть частичный результат, как если бы исходные данные закончились.

## timeout_overflow_mode_leaf {#timeout_overflow_mode_leaf}

Тип: OverflowMode

Значение по умолчанию: throw

Устанавливает, что происходит, когда запрос в листовом узле выполняется дольше, чем `max_execution_time_leaf`.

Возможные значения:
- `throw`: выбросить исключение (по умолчанию).
- `break`: остановить выполнение запроса и вернуть частичный результат, как если бы исходные данные закончились.

## totals_auto_threshold {#totals_auto_threshold}

Тип: Float

Значение по умолчанию: 0.5

Порог для `totals_mode = 'auto'`.
См. раздел "модификатор WITH TOTALS".

## totals_mode {#totals_mode}

Тип: TotalsMode

Значение по умолчанию: after_having_exclusive

Как рассчитывать TOTALS, когда HAVING присутствует, а также когда `max_rows_to_group_by` и `group_by_overflow_mode = 'any'` присутствуют.
См. раздел "модификатор WITH TOTALS".

## trace_profile_events {#trace_profile_events}

Тип: Bool

Значение по умолчанию: 0

Включает или отключает сбор стеков вызовов при каждом обновлении профилевых событий вместе с именем профилевого события и значением увеличения, отправляя их в [trace_log](/operations/system-tables/trace_log).

Возможные значения:

- 1 — Трассировка профилевых событий включена.
- 0 — Трассировка профилевых событий отключена.

## transfer_overflow_mode {#transfer_overflow_mode}

Тип: OverflowMode

Значение по умолчанию: throw

Устанавливает, что происходит, когда количество данных превышает один из лимитов.

Возможные значения:
- `throw`: выбросить исключение (по умолчанию).
- `break`: остановить выполнение запроса и вернуть частичный результат, как если бы исходные данные закончились.

## transform_null_in {#transform_null_in}

Тип: Bool

Значение по умолчанию: 0

Включает равенство значений [NULL](/sql-reference/syntax#null) для оператора [IN](../../sql-reference/operators/in.md).

По умолчанию `NULL` значения не могут быть сравнены, потому что `NULL` означает неопределенное значение. Поэтому сравнение `expr = NULL` должно всегда возвращать `false`. С этой настройкой `NULL = NULL` возвращает `true` для оператора `IN`.

Возможные значения:

- 0 — Сравнение значений `NULL` в операторе `IN` возвращает `false`.
- 1 — Сравнение значений `NULL` в операторе `IN` возвращает `true`.

**Пример**

Рассмотрим таблицу `null_in`:

```text
┌──idx─┬─────i─┐
│    1 │     1 │
│    2 │  NULL │
│    3 │     3 │
└──────┴───────┘
```

Запрос:

```sql
SELECT idx, i FROM null_in WHERE i IN (1, NULL) SETTINGS transform_null_in = 0;
```

Результат:

```text
┌──idx─┬────i─┐
│    1 │    1 │
└──────┴──────┘
```

Запрос:

```sql
SELECT idx, i FROM null_in WHERE i IN (1, NULL) SETTINGS transform_null_in = 1;
```

Результат:

```text
┌──idx─┬─────i─┐
│    1 │     1 │
│    2 │  NULL │
└──────┴───────┘
```

**Смотрите также**

- [Обработка NULL в операторах IN](/sql-reference/operators/in#null-processing).

## traverse_shadow_remote_data_paths {#traverse_shadow_remote_data_paths}

Тип: Bool

Значение по умолчанию: 0

Обход замороженных данных (теневая директория) в дополнение к фактическим данным таблицы при запросе системы.remote_data_paths.

## union_default_mode {#union_default_mode}

Тип: SetOperationMode

Значение по умолчанию: 

Устанавливает режим для объединения результатов запросов `SELECT`. Настройка используется только тогда, когда делится с [UNION](../../sql-reference/statements/select/union.md) без явного указания `UNION ALL` или `UNION DISTINCT`.

Возможные значения:

- `'DISTINCT'` — ClickHouse выводит строки в результате объединения запросов, убирая дубликаты.
- `'ALL'` — ClickHouse выводит все строки в результате объединения запросов, включая дубликаты.
- `''` — ClickHouse генерирует исключение при использовании с `UNION`.

Смотрите примеры в [UNION](../../sql-reference/statements/select/union.md).

## unknown_packet_in_send_data {#unknown_packet_in_send_data}

Тип: UInt64

Значение по умолчанию: 0

Отправить неизвестный пакет вместо N-го пакета данных.
```
## use_async_executor_for_materialized_views {#use_async_executor_for_materialized_views}

Тип: Bool

Значение по умолчанию: 0

Использовать асинхронное и потенциально многопоточное выполнение запросов к материализованным представлениям, что может ускорить обработку представлений во время INSERT, но также потребует больше памяти.

## use_cache_for_count_from_files {#use_cache_for_count_from_files}

Тип: Bool

Значение по умолчанию: 1

Включает кэширование числа строк при подсчете из файлов в табличных функциях `file`/`s3`/`url`/`hdfs`/`azureBlobStorage`.

Включено по умолчанию.

## use_client_time_zone {#use_client_time_zone}

Тип: Bool

Значение по умолчанию: 0

Использовать часовой пояс клиента для интерпретации строковых значений DateTime, вместо принятия серверного часового пояса.

## use_compact_format_in_distributed_parts_names {#use_compact_format_in_distributed_parts_names}

Тип: Bool

Значение по умолчанию: 1

Использует компактный формат для хранения блоков для фоновых (`distributed_foreground_insert`) вставок в таблицы с движком `Distributed`.

Возможные значения:

- 0 — Использует формат директории `user[:password]@host:port#default_database`.
- 1 — Использует формат директории `[shard{shard_index}[_replica{replica_index}]]`.

:::note
- При `use_compact_format_in_distributed_parts_names=0` изменения из определения кластера не будут применены для фоновых вставок.
- При `use_compact_format_in_distributed_parts_names=1` изменение порядка узлов в определении кластера приведет к изменению `shard_index`/`replica_index`, имейте это в виду.
:::

## use_concurrency_control {#use_concurrency_control}

Тип: Bool

Значение по умолчанию: 1

Учитывает контроль параллелизма сервера (см. глобальные настройки сервера `concurrent_threads_soft_limit_num` и `concurrent_threads_soft_limit_ratio_to_cores`). Если отключено, позволяет использовать большее количество потоков, даже если сервер перегружен (не рекомендуется для нормального использования, требуется в основном для тестов).

## use_hedged_requests {#use_hedged_requests}

Тип: Bool

Значение по умолчанию: 1

Включает логику подстраховочных запросов для удаленных запросов. Это позволяет устанавливать множество соединений с различными репликами для запроса.
Новое соединение включается, если существующие соединения с репликами не были установлены в течение `hedged_connection_timeout`
или данные не были получены в течение `receive_data_timeout`. Запрос использует первое соединение, которое отправляет непустой пакет прогресса (или пакет данных, если `allow_changing_replica_until_first_data_packet`);
другие соединения отменяются. Запросы с `max_parallel_replicas > 1` поддерживаются.

Включено по умолчанию.

По умолчанию отключено в Cloud.

## use_hive_partitioning {#use_hive_partitioning}

Тип: Bool

Значение по умолчанию: 1

При включении ClickHouse будет обнаруживать партиционирование в стиле Hive в пути (`/name=value/`) в таблицах файловых движков [File](/sql-reference/table-functions/file#hive-style-partitioning)/[S3](/sql-reference/table-functions/s3#hive-style-partitioning)/[URL](/sql-reference/table-functions/url#hive-style-partitioning)/[HDFS](/sql-reference/table-functions/hdfs#hive-style-partitioning)/[AzureBlobStorage](/sql-reference/table-functions/azureBlobStorage#hive-style-partitioning) и позволит использовать партиционные колонки как виртуальные колонки в запросе. Эти виртуальные колонки будут иметь те же имена, что и в партиционированном пути, но начинаются с `_`.

## use_iceberg_partition_pruning {#use_iceberg_partition_pruning}

Тип: Bool

Значение по умолчанию: 0

Использовать отсечение партиций Iceberg для таблиц Iceberg.

## use_index_for_in_with_subqueries {#use_index_for_in_with_subqueries}

Тип: Bool

Значение по умолчанию: 1

Попробовать использовать индекс, если справа от оператора IN есть подзапрос или табличное выражение.

## use_index_for_in_with_subqueries_max_values {#use_index_for_in_with_subqueries_max_values}

Тип: UInt64

Значение по умолчанию: 0

Максимальный размер множества справа от оператора IN для использования индекса таблицы для фильтрации. Позволяет избежать ухудшения производительности и увеличения использования памяти из-за подготовки дополнительных структур данных для больших запросов. Ноль означает отсутствие ограничений.

## use_json_alias_for_old_object_type {#use_json_alias_for_old_object_type}

Тип: Bool

Значение по умолчанию: 0

При включении будет использован псевдоним типа `JSON` для создания старого [Object('json')](../../sql-reference/data-types/json.md) типа вместо нового [JSON](../../sql-reference/data-types/newjson.md) типа.

## use_page_cache_for_disks_without_file_cache {#use_page_cache_for_disks_without_file_cache}

Тип: Bool

Значение по умолчанию: 0

Использовать кэш страниц пользовательского пространства для удаленных дисков, на которых не включен файловый кэш.

## use_page_cache_with_distributed_cache {#use_page_cache_with_distributed_cache}

Тип: Bool

Значение по умолчанию: 0

Использовать кэш страниц пользовательского пространства, когда используется распределенный кэш.

## use_query_cache {#use_query_cache}

Тип: Bool

Значение по умолчанию: 0

Если включено, запросы `SELECT` могут использовать [кэш запросов](../query-cache.md). Параметры [enable_reads_from_query_cache](#enable_reads_from_query_cache)
и [enable_writes_to_query_cache](#enable_writes_to_query_cache) более подробно контролируют, как используется кэш.

Возможные значения:

- 0 - Отключен
- 1 - Включен

## use_query_condition_cache {#use_query_condition_cache}

Тип: Bool

Значение по умолчанию: 0

Включить [кэш условий запросов](/operations/query-condition-cache). Кэш хранит диапазоны гранул в частях данных, которые не соответствуют условию в `WHERE` предложении,
и повторно использует эту информацию как эфемерный индекс для последующих запросов.

Возможные значения:

- 0 - Отключен
- 1 - Включен

## use_skip_indexes {#use_skip_indexes}

Тип: Bool

Значение по умолчанию: 1

Использовать индексы пропуска данных при выполнении запросов.

Возможные значения:

- 0 — Отключен.
- 1 — Включен.

## use_skip_indexes_if_final {#use_skip_indexes_if_final}

Тип: Bool

Значение по умолчанию: 0

Контролирует, используются ли индексы пропуска при выполнении запроса с модификатором FINAL.

По умолчанию этот параметр отключен, потому что индексы пропуска могут исключать строки (гранулы), содержащие последние данные, что может привести к некорректным результатам. При включении индексы пропуска применяются даже с модификатором FINAL, что может улучшить производительность, но с риском пропуска недавних обновлений.

Возможные значения:

- 0 — Отключен.
- 1 — Включен.

## use_structure_from_insertion_table_in_table_functions {#use_structure_from_insertion_table_in_table_functions}

Тип: UInt64

Значение по умолчанию: 2

Использовать структуру из таблицы вставки вместо вывода схемы из данных. Возможные значения: 0 - отключен, 1 - включен, 2 - автоматически.

## use_uncompressed_cache {#use_uncompressed_cache}

Тип: Bool

Значение по умолчанию: 0

Использовать ли кэш нежатых блоков. Принимает 0 или 1. По умолчанию 0 (отключен).
Использование нежатого кэша (только для таблиц семейства MergeTree) может значительно снизить задержку и увеличить пропускную способность при работе с большим объемом коротких запросов. Включите этот параметр для пользователей, отправляющих частые короткие запросы. Также обратите внимание на параметр [uncompressed_cache_size](/operations/server-configuration-parameters/settings#uncompressed_cache_size) конфигурации (указан только в файле конфигурации) – размер блоков кэша нежатых данных. По умолчанию это 8 GiB. Кэш нежатых данных заполняется по мере необходимости, и наименее используемые данные автоматически удаляются.

Для запросов, которые читают хотя бы некоторый достаточно большой объем данных (один миллион строк или более), кэш нежатых данных автоматически отключается, чтобы сэкономить место для действительно малых запросов. Это означает, что вы можете всегда оставлять параметр 'use_uncompressed_cache' установленным на 1.

## use_variant_as_common_type {#use_variant_as_common_type}

Тип: Bool

Значение по умолчанию: 0

Позволяет использовать тип `Variant` в качестве типа результата для функций [if](../../sql-reference/functions/conditional-functions.md/#if)/[multiIf](../../sql-reference/functions/conditional-functions.md/#multiif)/[array](../../sql-reference/functions/array-functions.md)/[map](../../sql-reference/functions/tuple-map-functions.md), когда для типов аргументов нет общего типа.

Пример:

```sql
SET use_variant_as_common_type = 1;
SELECT toTypeName(if(number % 2, number, range(number))) as variant_type FROM numbers(1);
SELECT if(number % 2, number, range(number)) as variant FROM numbers(5);
```

```text
┌─variant_type───────────────────┐
│ Variant(Array(UInt64), UInt64) │
└────────────────────────────────┘
┌─variant───┐
│ []        │
│ 1         │
│ [0,1]     │
│ 3         │
│ [0,1,2,3] │
└───────────┘
```

```sql
SET use_variant_as_common_type = 1;
SELECT toTypeName(multiIf((number % 4) = 0, 42, (number % 4) = 1, [1, 2, 3], (number % 4) = 2, 'Hello, World!', NULL)) AS variant_type FROM numbers(1);
SELECT multiIf((number % 4) = 0, 42, (number % 4) = 1, [1, 2, 3], (number % 4) = 2, 'Hello, World!', NULL) AS variant FROM numbers(4);
```

```text
─variant_type─────────────────────────┐
│ Variant(Array(UInt8), String, UInt8) │
└──────────────────────────────────────┘

┌─variant───────┐
│ 42            │
│ [1,2,3]       │
│ Hello, World! │
│ ᴺᵁᴸᴸ          │
└───────────────┘
```

```sql
SET use_variant_as_common_type = 1;
SELECT toTypeName(array(range(number), number, 'str_' || toString(number))) as array_of_variants_type from numbers(1);
SELECT array(range(number), number, 'str_' || toString(number)) as array_of_variants FROM numbers(3);
```

```text
┌─array_of_variants_type────────────────────────┐
│ Array(Variant(Array(UInt64), String, UInt64)) │
└───────────────────────────────────────────────┘

┌─array_of_variants─┐
│ [[],0,'str_0']    │
│ [[0],1,'str_1']   │
│ [[0,1],2,'str_2'] │
└───────────────────┘
```

```sql
SET use_variant_as_common_type = 1;
SELECT toTypeName(map('a', range(number), 'b', number, 'c', 'str_' || toString(number))) as map_of_variants_type from numbers(1);
SELECT map('a', range(number), 'b', number, 'c', 'str_' || toString(number)) as map_of_variants FROM numbers(3);
```

```text
┌─map_of_variants_type────────────────────────────────┐
│ Map(String, Variant(Array(UInt64), String, UInt64)) │
└─────────────────────────────────────────────────────┘

┌─map_of_variants───────────────┐
│ {'a':[],'b':0,'c':'str_0'}    │
│ {'a':[0],'b':1,'c':'str_1'}   │
│ {'a':[0,1],'b':2,'c':'str_2'} │
└───────────────────────────────┘
```

## use_with_fill_by_sorting_prefix {#use_with_fill_by_sorting_prefix}

Тип: Bool

Значение по умолчанию: 1

Колонки, предшествующие столбцам WITH FILL в предложении ORDER BY, образуют сортирующий префикс. Строки с разными значениями в сортирующем префиксе заполняются независимо.

## validate_enum_literals_in_operators {#validate_enum_literals_in_operators}

Тип: Bool

Значение по умолчанию: 0

При включении проверяются литералы перечисления в операторах, таких как `IN`, `NOT IN`, `==`, `!=`, по сравнению с типом перечисления, и будет выдано исключение, если литерал не является допустимым значением перечисления.

## validate_mutation_query {#validate_mutation_query}

Тип: Bool

Значение по умолчанию: 1

Проверять запросы мутаций перед их принятием. Мутации выполняются в фоновом режиме, и выполнение недопустимого запроса приведет к зависанию мутаций, требуя ручного вмешательства.

Изменяйте эту настройку только в случае возникновения несовместимой с версией ошибки.

## validate_polygons {#validate_polygons}

Тип: Bool

Значение по умолчанию: 1

Включает или отключает выбрасывание исключения в функции [pointInPolygon](/sql-reference/functions/geo/coordinates#pointinpolygon), если многоугольник самопересекающийся или самотрогательный.

Возможные значения:

- 0 — Выбрасывание исключения отключено. `pointInPolygon` принимает недопустимые многоугольники и возвращает, возможно, неправильные результаты для них.
- 1 — Выбрасывание исключения включено.

## wait_changes_become_visible_after_commit_mode {#wait_changes_become_visible_after_commit_mode}
<ExperimentalBadge/>

Тип: TransactionsWaitCSNMode

Значение по умолчанию: wait_unknown

Ожидать, пока подтвержденные изменения станут фактически видимыми в последнем снимке.

## wait_for_async_insert {#wait_for_async_insert}

Тип: Bool

Значение по умолчанию: 1

Если true, ждать завершения обработки асинхронной вставки.

## wait_for_async_insert_timeout {#wait_for_async_insert_timeout}

Тип: Seconds

Значение по умолчанию: 120

Таймаут ожидания завершения обработки асинхронной вставки.

## wait_for_window_view_fire_signal_timeout {#wait_for_window_view_fire_signal_timeout}
<ExperimentalBadge/>

Тип: Seconds

Значение по умолчанию: 10

Таймаут ожидания сигнала активации оконного представления в обработке временных событий.

## window_view_clean_interval {#window_view_clean_interval}
<ExperimentalBadge/>

Тип: Seconds

Значение по умолчанию: 60

Интервал очистки оконного представления в секундах для освобождения устаревших данных.

## window_view_heartbeat_interval {#window_view_heartbeat_interval}
<ExperimentalBadge/>

Тип: Seconds

Значение по умолчанию: 15

Интервал "сердцебиения" в секундах, чтобы указать, что наблюдение запросов активно.

## workload {#workload}

Тип: String

Значение по умолчанию: default

Имя рабочего процесса, которое будет использоваться для доступа к ресурсам.

## write_through_distributed_cache {#write_through_distributed_cache}

<CloudAvailableBadge/>

Тип: Bool

Значение по умолчанию: 0

Имеет эффект только в ClickHouse Cloud. Разрешает запись в распределенный кэш (запись в s3 также будет осуществляться через распределенный кэш).

## zstd_window_log_max {#zstd_window_log_max}

Тип: Int64

Значение по умолчанию: 0

Позволяет выбрать максимальный лог окна ZSTD (он не будет использоваться для семейства MergeTree).
