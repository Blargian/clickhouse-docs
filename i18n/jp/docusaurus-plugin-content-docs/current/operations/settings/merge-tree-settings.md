---
description: 'Settings for MergeTree which are in `system.merge_tree_settings`'
slug: '/operations/settings/merge-tree-settings'
title: 'MergeTree tables settings'
---

import ExperimentalBadge from '@theme/badges/ExperimentalBadge';
import BetaBadge from '@theme/badges/BetaBadge';
import SettingsInfoBlock from '@theme/SettingsInfoBlock/SettingsInfoBlock';
import VersionHistory from '@theme/VersionHistory/VersionHistory';


System table `system.merge_tree_settings` は、全体に設定された MergeTree 設定を示します。

MergeTree 設定は、サーバー設定ファイルの `merge_tree` セクションで設定するか、`CREATE TABLE` ステートメントの `SETTINGS` 句で個々の `MergeTree` テーブルに対して指定できます。

設定 `max_suspicious_broken_parts` をカスタマイズする例：

サーバー設定ファイルでの全ての `MergeTree` テーブルのデフォルトを設定します：

```text
<merge_tree>
    <max_suspicious_broken_parts>5</max_suspicious_broken_parts>
</merge_tree>
```

特定のテーブルに設定する：

```sql
CREATE TABLE tab
(
    `A` Int64
)
ENGINE = MergeTree
ORDER BY tuple()
SETTINGS max_suspicious_broken_parts = 500;
```

特定のテーブルの設定を変更するには、`ALTER TABLE ... MODIFY SETTING` を使用します：

```sql
ALTER TABLE tab MODIFY SETTING max_suspicious_broken_parts = 100;

-- グローバルデフォルトにリセット (system.merge_tree_settings からの値)
ALTER TABLE tab RESET SETTING max_suspicious_broken_parts;
```
## MergeTree settings {#mergetree-settings}
<!-- The settings below are autogenerated by the script at 
https://github.com/ClickHouse/clickhouse-docs/blob/main/scripts/settings/autogenerate-settings.sh
-->
## adaptive_write_buffer_initial_size {#adaptive_write_buffer_initial_size} 
<SettingsInfoBlock type="UInt64" default_value="16384" />

適応型書き込みバッファの初期サイズ
## add_implicit_sign_column_constraint_for_collapsing_engine {#add_implicit_sign_column_constraint_for_collapsing_engine} 
<SettingsInfoBlock type="Bool" default_value="0" />

true の場合、CollapsingMergeTree または VersionedCollapsingMergeTree テーブルの `sign` カラムに対して、有効な値（`1` および `-1`）のみを許可する暗黙の制約を追加します。
## add_minmax_index_for_numeric_columns {#add_minmax_index_for_numeric_columns} 
<SettingsInfoBlock type="Bool" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "0"},{"label": "New setting"}]}]}/>

有効な場合、テーブルの全ての数値カラムに対して min-max（スキッピング）インデックスが追加されます。
## add_minmax_index_for_string_columns {#add_minmax_index_for_string_columns} 
<SettingsInfoBlock type="Bool" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "0"},{"label": "New setting"}]}]}/>

有効な場合、テーブルの全ての文字列カラムに対して min-max（スキッピング）インデックスが追加されます。
## allow_experimental_replacing_merge_with_cleanup {#allow_experimental_replacing_merge_with_cleanup} 

<ExperimentalBadge/>
<SettingsInfoBlock type="Bool" default_value="0" />

`is_deleted` カラムを持つ ReplacingMergeTree のための実験的な CLEANUP マージを許可します。これを有効にすると、手動でパーティション内の全てのパーツを1つのパーツにマージし、削除された行を削除するために `OPTIMIZE ... FINAL CLEANUP` を使用できるようになります。

また、`min_age_to_force_merge_seconds`、`min_age_to_force_merge_on_partition_only`、および `enable_replacing_merge_with_cleanup_for_min_age_to_force_merge` 設定を使用して、自動的にバックグランドでそのようなマージを発生させることも可能です。
## allow_experimental_reverse_key {#allow_experimental_reverse_key} 

<ExperimentalBadge/>
<SettingsInfoBlock type="Bool" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "24.12"},{"label": "0"},{"label": "New setting"}]}]}/>

MergeTree のソートキーにおける降順のサポートを有効にします。この設定は、時系列分析や Top-N クエリに特に有用で、データを逆の年代順に格納してクエリのパフォーマンスを最適化することができます。

`allow_experimental_reverse_key` を有効にすると、MergeTree テーブルの `ORDER BY` 句内で降順のソート順を定義できます。これにより、降順クエリに対して `ReadInReverseOrder` の代わりに、より効率的な `ReadInOrder` 最適化を使用することが可能になります。

**例**

```sql
CREATE TABLE example
(
time DateTime,
key Int32,
value String
) ENGINE = MergeTree
ORDER BY (time DESC, key)  -- 'time' フィールドに対する降順
SETTINGS allow_experimental_reverse_key = 1;

SELECT * FROM example WHERE key = 'xxx' ORDER BY time DESC LIMIT 10;
```

クエリに `ORDER BY time DESC` を使用することで、`ReadInOrder` が適用されます。

**デフォルト値：** false
## allow_floating_point_partition_key {#allow_floating_point_partition_key} 
<SettingsInfoBlock type="Bool" default_value="0" />

浮動小数点数をパーティションキーとして許可することを有効にします。

可能な値：
- `0` — 浮動小数点パーティションキーは許可されていません。
- `1` — 浮動小数点パーティションキーが許可されています。
## allow_nullable_key {#allow_nullable_key} 
<SettingsInfoBlock type="Bool" default_value="0" />

Nullable 型を主キーとして許可します。
## allow_reduce_blocking_parts_task {#allow_reduce_blocking_parts_task} 
<SettingsInfoBlock type="Bool" default_value="1" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.2"},{"label": "1"},{"label": "Now SMT will remove stale blocking parts from ZooKeeper by default"}]}, {"id": "row-2","items": [{"label": "25.1"},{"label": "0"},{"label": "Cloud sync"}]}]}/>

共有マージテーブルのブロッキングパーツを削減するためのバックグラウンドタスク。
ClickHouse Cloud のみで利用可能
## allow_remote_fs_zero_copy_replication {#allow_remote_fs_zero_copy_replication} 

<BetaBadge/>
<SettingsInfoBlock type="Bool" default_value="0" />

この設定は本番環境では使用しないでください。準備が整っていません。
## allow_summing_columns_in_partition_or_order_key {#allow_summing_columns_in_partition_or_order_key} 
<SettingsInfoBlock type="Bool" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.4"},{"label": "0"},{"label": "New setting to allow summing of partition or sorting key columns"}]}]}/>

有効になっている場合、SummingMergeTree テーブルでのカラムをパーティションまたはソートキーに使用することを許可します。
## allow_suspicious_indices {#allow_suspicious_indices} 
<SettingsInfoBlock type="Bool" default_value="0" />

同一の式を持つ主キー/副キーおよびソートキーを拒否します。
## allow_vertical_merges_from_compact_to_wide_parts {#allow_vertical_merges_from_compact_to_wide_parts} 
<SettingsInfoBlock type="Bool" default_value="1" />

コンパクトからワイドパーツへの垂直マージを許可します。この設定は全てのレプリカで同じ値を持っている必要があります。
## always_fetch_merged_part {#always_fetch_merged_part} 
<SettingsInfoBlock type="Bool" default_value="0" />

true の場合、このレプリカは決してパーツをマージせず、常に他のレプリカからマージされたパーツをダウンロードします。

可能な値：
- true, false
## always_use_copy_instead_of_hardlinks {#always_use_copy_instead_of_hardlinks} 
<SettingsInfoBlock type="Bool" default_value="0" />

常にデータをコピーして、ミューテーション/置換/切り離しなどの際にハードリンクではなくします。
## apply_patches_on_merge {#apply_patches_on_merge} 
<SettingsInfoBlock type="Bool" default_value="1" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.5"},{"label": "1"},{"label": "New setting"}]}]}/>

true の場合、マージ時にパッチパーツが適用されます。
## assign_part_uuids {#assign_part_uuids} 
<SettingsInfoBlock type="Bool" default_value="0" />

有効にすると、新しいパーツごとに一意のパート識別子が割り当てられます。
有効にする前に、全てのレプリカが UUID バージョン 4 をサポートしていることを確認してください。
## async_block_ids_cache_update_wait_ms {#async_block_ids_cache_update_wait_ms} 
<SettingsInfoBlock type="Milliseconds" default_value="100" />

各挿入イテレーションが async_block_ids_cache 更新のために待機する時間
## async_insert {#async_insert} 
<SettingsInfoBlock type="Bool" default_value="0" />

true の場合、INSERT クエリからのデータがキューに保存され、後でバックグラウンドでテーブルにフラッシュされます。
## background_task_preferred_step_execution_time_ms {#background_task_preferred_step_execution_time_ms} 
<SettingsInfoBlock type="Milliseconds" default_value="50" />

マージまたはミューテーションの1ステップの実行に対するターゲット時間。1ステップが長くかかる場合は超えることができます。
## cache_populated_by_fetch {#cache_populated_by_fetch} 
<SettingsInfoBlock type="Bool" default_value="0" />

:::note
この設定は、ClickHouse Cloud のみに適用されます。
:::

`cache_populated_by_fetch` が無効（デフォルト設定）になっている場合、新しいデータパーツは、それらのパーツを必要とするクエリが実行されるまでキャッシュに読み込まれません。

有効にすると、`cache_populated_by_fetch` は、全てのノードがクエリをトリガーすることなくストレージから新しいデータパーツをそのキャッシュに読み込むようになります。

**参考**

- [ignore_cold_parts_seconds](/operations/settings/settings#ignore_cold_parts_seconds)
- [prefer_warmed_unmerged_parts_seconds](/operations/settings/settings#prefer_warmed_unmerged_parts_seconds)
- [cache_warmer_threads](/operations/settings/settings#cache_warmer_threads)
## check_delay_period {#check_delay_period} 
<SettingsInfoBlock type="UInt64" default_value="60" />
廃止された設定で、何も行いません。
## check_sample_column_is_correct {#check_sample_column_is_correct} 
<SettingsInfoBlock type="Bool" default_value="1" />

サンプリングまたはサンプリング式に対して、カラムのデータ型が正しいか確認するための設定を、テーブル作成時に有効にします。データ型は、符号なしの [整数型](/sql-reference/data-types/int-uint)： `UInt8`, `UInt16`, `UInt32`, `UInt64` のいずれかでなければなりません。

可能な値：
- `true`  — チェックが有効です。
- `false` — テーブル作成時にチェックが無効です。

デフォルト値： `true`。

デフォルトでは、ClickHouse サーバーはテーブル作成時に、サンプリングまたはサンプリング式のカラムのデータ型をチェックします。既に不正なサンプリング式を持つテーブルがあり、サーバーが起動時に例外を発生させないようにしたい場合は、`check_sample_column_is_correct` を `false` に設定します。
## clean_deleted_rows {#clean_deleted_rows} 
<SettingsInfoBlock type="CleanDeletedRows" default_value="Never" />
廃止された設定で、何も行いません。
## cleanup_delay_period {#cleanup_delay_period} 
<SettingsInfoBlock type="UInt64" default_value="30" />

古いキューログ、ブロックハッシュ、およびパーツをクリーンアップする最小期間。
## cleanup_delay_period_random_add {#cleanup_delay_period_random_add} 
<SettingsInfoBlock type="UInt64" default_value="10" />

cleanup_delay_period に対して均等に分布した値（0 から x 秒まで）を追加して、雷鳴効果を避け、大量のテーブルがある場合に ZooKeeper の DoS を回避します。
## cleanup_thread_preferred_points_per_iteration {#cleanup_thread_preferred_points_per_iteration} 
<SettingsInfoBlock type="UInt64" default_value="150" />

バックグラウンドクリーンアップのための推奨バッチサイズ（ポイントは抽象的ですが、1ポイントはおおよそ1挿入ブロックに相当します）。
## cleanup_threads {#cleanup_threads} 
<SettingsInfoBlock type="UInt64" default_value="128" />

古いスレッドのクリーンアップのためのスレッド。ClickHouse Cloud のみで利用可能
## columns_and_secondary_indices_sizes_lazy_calculation {#columns_and_secondary_indices_sizes_lazy_calculation} 
<SettingsInfoBlock type="Bool" default_value="1" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.2"},{"label": "1"},{"label": "New setting to calculate columns and indices sizes lazily"}]}]}/>

初回リクエストの際に columns と secondary indices のサイズを遅延計算します。
## columns_to_prewarm_mark_cache {#columns_to_prewarm_mark_cache} 

プリウォームマークキャッシュのためのカラムのリスト（有効な場合）。空の場合は全てのカラムを意味します。
## compact_parts_max_bytes_to_buffer {#compact_parts_max_bytes_to_buffer} 
<SettingsInfoBlock type="UInt64" default_value="134217728" />

ClickHouse Cloud のみで利用可能。コンパクトパーツの単一ストライプに書き込む最大バイト数。
## compact_parts_max_granules_to_buffer {#compact_parts_max_granules_to_buffer} 
<SettingsInfoBlock type="UInt64" default_value="128" />

ClickHouse Cloud のみで利用可能。コンパクトパーツの単一ストライプに書き込む最大グラニュール数。
## compact_parts_merge_max_bytes_to_prefetch_part {#compact_parts_merge_max_bytes_to_prefetch_part} 
<SettingsInfoBlock type="UInt64" default_value="16777216" />

ClickHouse Cloud のみで利用可能。マージ中にメモリに全体を読み込む最大のコンパクトパートサイズ。
## compatibility_allow_sampling_expression_not_in_primary_key {#compatibility_allow_sampling_expression_not_in_primary_key} 
<SettingsInfoBlock type="Bool" default_value="0" />

主キーに無いサンプリング式を持つテーブルの作成を許可します。これは、間違ったテーブルでサーバーを一時的に実行可能にするためにのみ必要です。
## compress_marks {#compress_marks} 
<SettingsInfoBlock type="Bool" default_value="1" />

マークの圧縮をサポートし、マークファイルのサイズを削減し、ネットワーク転送をスピードアップします。
## compress_primary_key {#compress_primary_key} 
<SettingsInfoBlock type="Bool" default_value="1" />

主キーの圧縮をサポートし、主キーファイルのサイズを削減し、ネットワーク転送をスピードアップします。
## concurrent_part_removal_threshold {#concurrent_part_removal_threshold} 
<SettingsInfoBlock type="UInt64" default_value="100" />

非アクティブなデータパーツの数がこの値以上の場合のみ、同時パート削除をアクティブ化します（'max_part_removal_threads' を参照）。
## deduplicate_merge_projection_mode {#deduplicate_merge_projection_mode} 
<SettingsInfoBlock type="DeduplicateMergeProjectionMode" default_value="throw" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "24.8"},{"label": "throw"},{"label": "Do not allow to create inconsistent projection"}]}]}/>

非クラシックな MergeTree のテーブル用のプロジェクションを作成することを許可するかどうかを決定します。非クラシックな MergeTree とは (Replicated, Shared) MergeTree ではないものです。Ignore オプションは単純に互換性のために存在し、誤った答えを生じる可能性があります。許可される場合は、マージプロジェクション時にどのアクションを行うか、つまり削除するか再構築するかです。したがって、クラシック MergeTree はこの設定を無視します。これにより `OPTIMIZE DEDUPLICATE` も制御されますが、すべての MergeTree ファミリメンバーに影響を与えます。`lightweight_mutation_projection_mode` オプションに似ており、これは部分レベルです。

可能な値：
- `ignore`
- `throw`
- `drop`
- `rebuild`
## default_compression_codec {#default_compression_codec} 

<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.4"},{"label": ""},{"label": "New setting"}]}]}/>

特定のカラムに対して定義されていない場合に使用されるデフォルトの圧縮コーデックを指定します。
カラムに対する圧縮コーデック選択順序：
1. テーブル宣言でカラムのために定義された圧縮コーデック
2. `default_compression_codec` で定義された圧縮コーデック（この設定）
3. `compression` 設定で定義されたデフォルトの圧縮コーデック
デフォルト値：空の文字列（未定義）。
## detach_not_byte_identical_parts {#detach_not_byte_identical_parts} 
<SettingsInfoBlock type="Bool" default_value="0" />

マージまたはミューテーション後に、他のレプリカのデータパーツとバイト同一でない場合にデータパーツをレプリカから切り離すことを有効または無効にします。無効の場合、データパーツは削除されます。後でそのようなパーツを分析したい場合はこの設定をアクティブにします。

この設定は [データレプリケーション](/engines/table-engines/mergetree-family/replacingmergetree) が有効な `MergeTree` テーブルに適用されます。

可能な値：

- `0` — パーツは削除されます。
- `1` — パーツは切り離されます。
## detach_old_local_parts_when_cloning_replica {#detach_old_local_parts_when_cloning_replica} 
<SettingsInfoBlock type="Bool" default_value="1" />

失われたレプリカの修復時に古いローカルパーツを削除しないでください。

可能な値：
- `true`
- `false`
## disable_detach_partition_for_zero_copy_replication {#disable_detach_partition_for_zero_copy_replication} 
<SettingsInfoBlock type="Bool" default_value="1" />

ゼロコピーのレプリケーションのために、DETACH PARTITION クエリを無効にします。
## disable_fetch_partition_for_zero_copy_replication {#disable_fetch_partition_for_zero_copy_replication} 
<SettingsInfoBlock type="Bool" default_value="1" />

ゼロコピーのレプリケーションのために、FETCH PARTITION クエリを無効にします。
## disable_freeze_partition_for_zero_copy_replication {#disable_freeze_partition_for_zero_copy_replication} 
<SettingsInfoBlock type="Bool" default_value="1" />

ゼロコピーのレプリケーションのために、FREEZE PARTITION クエリを無効にします。
## disk {#disk} 

ストレージディスクの名前。ストレージポリシーの代わりに指定できます。
## enable_block_number_column {#enable_block_number_column} 
<SettingsInfoBlock type="Bool" default_value="0" />

各行のために _block_number カラムを永続化することを有効にします。
## enable_block_offset_column {#enable_block_offset_column} 
<SettingsInfoBlock type="Bool" default_value="0" />

マージ時に仮想カラム `_block_number` を永続化します。
## enable_index_granularity_compression {#enable_index_granularity_compression} 
<SettingsInfoBlock type="Bool" default_value="1" />

可能な場合は、メモリ内のインデックスの粒度の値を圧縮します。
## enable_max_bytes_limit_for_min_age_to_force_merge {#enable_max_bytes_limit_for_min_age_to_force_merge} 
<SettingsInfoBlock type="Bool" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "0"},{"label": "Added new setting to limit max bytes for min_age_to_force_merge."}]}, {"id": "row-2","items": [{"label": "25.1"},{"label": "0"},{"label": "New setting"}]}]}/>

`min_age_to_force_merge_seconds` と `min_age_to_force_merge_on_partition_only` 設定は、`max_bytes_to_merge_at_max_space_in_pool` 設定を尊重する必要があります。

可能な値：
- `true`
- `false`
## enable_mixed_granularity_parts {#enable_mixed_granularity_parts} 
<SettingsInfoBlock type="Bool" default_value="1" />

`index_granularity_bytes` 設定でグラニュールサイズを制御する移行を有効または無効にします。バージョン 19.11 より前は、グラニュールサイズを制限するための唯一の設定は `index_granularity` でした。`index_granularity_bytes` 設定は、非常に大きな行（数十メガバイトおよび数百メガバイト）を持つテーブルからデータを選択する際の ClickHouse のパフォーマンスを向上させます。大きな行を持つテーブルがある場合は、この設定をテーブルに対して有効にすることで `SELECT` クエリの効率を向上させることができます。
## enable_replacing_merge_with_cleanup_for_min_age_to_force_merge {#enable_replacing_merge_with_cleanup_for_min_age_to_force_merge} 

<ExperimentalBadge/>
<SettingsInfoBlock type="Bool" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.3"},{"label": "0"},{"label": "New setting to allow automatic cleanup merges for ReplacingMergeTree"}]}]}/>

パーティションを単一パーツにマージする際に ReplacingMergeTree のために CLEANUP マージを使用するかどうかを決定します。`allow_experimental_replacing_merge_with_cleanup`、`min_age_to_force_merge_seconds`、`min_age_to_force_merge_on_partition_only` を有効にする必要があります。

可能な値：
- `true`
- `false`
## enable_the_endpoint_id_with_zookeeper_name_prefix {#enable_the_endpoint_id_with_zookeeper_name_prefix} 
<SettingsInfoBlock type="Bool" default_value="0" />

レプリケートマージテーブルの zookeeper 名称接頭辞を使用したエンドポイント ID を有効にします。
## enable_vertical_merge_algorithm {#enable_vertical_merge_algorithm} 
<SettingsInfoBlock type="UInt64" default_value="1" />

垂直マージアルゴリズムの使用を有効にします。
## enforce_index_structure_match_on_partition_manipulation {#enforce_index_structure_match_on_partition_manipulation} 
<SettingsInfoBlock type="Bool" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "24.12"},{"label": "0"},{"label": "New setting"}]}]}/>

パーティション操作クエリ（`ATTACH/MOVE/REPLACE PARTITION`）の対象テーブルに対してこの設定が有効な場合、インデックスとプロジェクションはソーステーブルとデスティネーションテーブルの間で同一でなければなりません。そうでない場合、デスティネーションテーブルはソーステーブルのインデックスおよびプロジェクションのスーパーセットを持つことができます。
## exclude_deleted_rows_for_part_size_in_merge {#exclude_deleted_rows_for_part_size_in_merge} 
<SettingsInfoBlock type="Bool" default_value="0" />

有効な場合、データパーツの推定実際のサイズ（つまり、`DELETE FROM` を通じて削除された行を除外したもの）がマージする部分を選択する際に使用されます。この動作は、設定が有効になった後に実行された `DELETE FROM` に影響を受けたデータパーツに対してのみトリガーされます。

可能な値：
- `true`
- `false`

**参考**
- [load_existing_rows_count_for_old_parts](#load_existing_rows_count_for_old_parts) 設定
## execute_merges_on_single_replica_time_threshold {#execute_merges_on_single_replica_time_threshold} 
<SettingsInfoBlock type="Seconds" default_value="0" />

この設定の値がゼロより大きい場合、単一のレプリカだけがすぐにマージを開始し、他のレプリカはその結果をダウンロードするために最大その時間だけ待機します。選択したレプリカがその時間内にマージを完了しなかった場合、標準の動作にフォールバックします。

可能な値：
- 任意の正の整数。
## fault_probability_after_part_commit {#fault_probability_after_part_commit} 
<SettingsInfoBlock type="Float" default_value="0" />

テスト用。変更しないでください。
## fault_probability_before_part_commit {#fault_probability_before_part_commit} 
<SettingsInfoBlock type="Float" default_value="0" />

テスト用。変更しないでください。
## finished_mutations_to_keep {#finished_mutations_to_keep} 
<SettingsInfoBlock type="UInt64" default_value="100" />

保持する完了したミューテーションのレコード数。ゼロの場合、全てを保持します。
## force_read_through_cache_for_merges {#force_read_through_cache_for_merges} 

<ExperimentalBadge/>
<SettingsInfoBlock type="Bool" default_value="0" />

マージのためにファイルシステムキャッシュを強制読み込みします。
## fsync_after_insert {#fsync_after_insert} 
<SettingsInfoBlock type="Bool" default_value="0" />

挿入された各パーツの fsync を実行します。挿入のパフォーマンスが著しく低下しますので、ワイドパーツと一緒に使用することはお勧めしません。
## fsync_part_directory {#fsync_part_directory} 
<SettingsInfoBlock type="Bool" default_value="0" />

全てのパート操作（書き込み、名前変更など）の後にパートディレクトリの fsync を実行します。
## in_memory_parts_enable_wal {#in_memory_parts_enable_wal} 
<SettingsInfoBlock type="Bool" default_value="1" />
廃止された設定で、何も行いません。
## in_memory_parts_insert_sync {#in_memory_parts_insert_sync} 
<SettingsInfoBlock type="Bool" default_value="0" />
廃止された設定で、何も行いません。
## inactive_parts_to_delay_insert {#inactive_parts_to_delay_insert} 
<SettingsInfoBlock type="UInt64" default_value="0" />

テーブルの単一パーティション内に非アクティブなパーツの数が `inactive_parts_to_delay_insert` 値を超えると、`INSERT` が人工的に遅延されます。

:::tip
サーバーがパーツを迅速にクリーンアップできない場合に役立ちます。
:::

可能な値：
- 任意の正の整数。
## inactive_parts_to_throw_insert {#inactive_parts_to_throw_insert} 
<SettingsInfoBlock type="UInt64" default_value="0" />

単一パーティション内の非アクティブなパーツの数が `inactive_parts_to_throw_insert` 値を超えた場合、`INSERT` が以下のエラーで中断されます：

> "Too many inactive parts (N). Parts cleaning are processing significantly slower than inserts" 例外。

可能な値：
- 任意の正の整数。
## index_granularity {#index_granularity} 
<SettingsInfoBlock type="UInt64" default_value="8192" />

インデックスのマーク間のデータ行の最大数。すなわち、1つの主キー値に対応する行数。
## index_granularity_bytes {#index_granularity_bytes} 
<SettingsInfoBlock type="UInt64" default_value="10485760" />

バイト単位でのデータグラニュールの最大サイズ。

行数のみでグラニュールサイズを制限するには、`0` に設定してください（推奨されません）。
## initialization_retry_period {#initialization_retry_period} 
<SettingsInfoBlock type="Seconds" default_value="60" />

テーブル初期化の再試行期間（秒）。
## kill_delay_period {#kill_delay_period} 
<SettingsInfoBlock type="UInt64" default_value="30" />
廃止された設定で、何も行いません。
## kill_delay_period_random_add {#kill_delay_period_random_add} 
<SettingsInfoBlock type="UInt64" default_value="10" />
廃止された設定で、何も行いません。
## kill_threads {#kill_threads} 
<SettingsInfoBlock type="UInt64" default_value="128" />
廃止された設定で、何も行いません。
## lightweight_mutation_projection_mode {#lightweight_mutation_projection_mode} 
<SettingsInfoBlock type="LightweightMutationProjectionMode" default_value="throw" />

デフォルトでは、軽量削除 `DELETE` はプロジェクションを持つテーブルでは機能しません。これは、プロジェクション内の行が `DELETE` 操作の影響を受ける可能性があるためです。デフォルト値は `throw` となります。しかし、このオプションは動作を変更することができます。値が `drop` または `rebuild` の場合、削除はプロジェクションとともに機能します。`drop` はプロジェクションを削除しますので、現在のクエリでは高速ですが、将来のクエリではプロジェクションが付随しないため遅くなります。`rebuild` はプロジェクションを再構築するので、現在のクエリのパフォーマンスに影響を与える可能性がありますが、将来のクエリを高速化する可能性があります。良い点は、これらのオプションは部分レベルでのみ機能し、触れられないパート内のプロジェクションはそのまま残るため、削除や再構築のようなアクションを引き起こすことはありません。

可能な値：
- `throw`
- `drop`
- `rebuild`
## load_existing_rows_count_for_old_parts {#load_existing_rows_count_for_old_parts} 
<SettingsInfoBlock type="Bool" default_value="0" />

`exclude_deleted_rows_for_part_size_in_merge` と共に有効な場合、テーブルの起動時に既存のデータパーツの削除された行のカウントが計算されます。テーブルの起動が遅くなる可能性がありますので、注意が必要です。

可能な値：
- `true`
- `false`

**参考**
- [exclude_deleted_rows_for_part_size_in_merge](#exclude_deleted_rows_for_part_size_in_merge) 設定
## lock_acquire_timeout_for_background_operations {#lock_acquire_timeout_for_background_operations} 
<SettingsInfoBlock type="Seconds" default_value="120" />

マージやミューテーションなどのバックグラウンド操作のため。テーブルロックを取得できないまでの秒数。
## marks_compress_block_size {#marks_compress_block_size} 
<SettingsInfoBlock type="NonZeroUInt64" default_value="65536" />

マーク圧縮ブロックサイズ、圧縮するブロックの実際のサイズ。
## marks_compression_codec {#marks_compression_codec} 
<SettingsInfoBlock type="String" default_value="ZSTD(3)" />

マークによって使用される圧縮エンコーディング、マークは小さくキャッシュされるので、デフォルトの圧縮は ZSTD(3) です。
## materialize_skip_indexes_on_merge {#materialize_skip_indexes_on_merge} 
<SettingsInfoBlock type="Bool" default_value="1" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "1"},{"label": "New setting"}]}]}/>

有効な場合、マージにおいて新しいパーツのためにスキップインデックスがビルドされ、保存されます。
そうでなければ、明示的に MATERIALIZE INDEX によって作成/保存されることがあります。
## materialize_ttl_recalculate_only {#materialize_ttl_recalculate_only} 
<SettingsInfoBlock type="Bool" default_value="0" />

MATERIALIZE TTL の際にのみ ttl 情報を再計算します。
## max_avg_part_size_for_too_many_parts {#max_avg_part_size_for_too_many_parts} 
<SettingsInfoBlock type="UInt64" default_value="1073741824" />

「パーツが多すぎる」チェックは、「parts_to_delay_insert」および「parts_to_throw_insert」に従って、該当するパーティション内の平均パートサイズが指定された閾値以下である場合のみ活動します。それを上回る場合、INSERT は遅延または拒否されません。これにより、パーツが成功裏に大きなパーツにマージされる場合、単一のサーバー上に何百テラバイトも保持できるようになります。これは、非アクティブなパーツや全パーツの閾値には影響しません。
## max_bytes_to_merge_at_max_space_in_pool {#max_bytes_to_merge_at_max_space_in_pool} 
<SettingsInfoBlock type="UInt64" default_value="161061273600" />

十分なリソースが利用可能な場合、1つのパーツにマージされる最大パーツサイズ（バイト単位）。

可能な値：

- 任意の非負整数。

マージスケジューラは定期的にパーティション内のサイズとパーツ数を分析し、プールに十分な空きリソースがある場合はバックグラウンドマージを開始します。マージは、ソースパーツの総サイズが `max_bytes_to_merge_at_max_space_in_pool` より大きくなるまで発生します。

[OPTIMIZE FINAL](/sql-reference/statements/optimize) によって開始されたマージは `max_bytes_to_merge_at_max_space_in_pool` を無視します（空きディスク容量のみを考慮に入れます）。
## max_bytes_to_merge_at_min_space_in_pool {#max_bytes_to_merge_at_min_space_in_pool} 
<SettingsInfoBlock type="UInt64" default_value="1048576" />

バックグラウンドプール内の最小リソースを持つ場合に1つのパーツにマージされる最大パーツサイズ（バイト単位）。

可能な値：
- 任意の正の整数。

`max_bytes_to_merge_at_min_space_in_pool` は、利用可能なディスクスペースが不足しているにもかかわらずマージできる最大パーツサイズを定義します（プール内）。これは、小さなパーツ数を削減し、「Too many parts」エラーの可能性を減らすために必要です。
マージは、合計マージされたパーツサイズを2倍にしてディスクスペースを予約します。
したがって、フリーのディスクスペースが少ない場合、すでに進行中の大規模なマージによってこのスペースが予約されているため、新たなマージが開始できず、各挿入で小さなパーツ数が増加する状況が発生する可能性があります。
## max_cleanup_delay_period {#max_cleanup_delay_period} 
<SettingsInfoBlock type="UInt64" default_value="300" />

古いキューログ、ブロックハッシュ、およびパーツをクリーンアップする最大期間。
## max_compress_block_size {#max_compress_block_size} 
<SettingsInfoBlock type="UInt64" default_value="0" />

テーブルに書き込むために圧縮する前の非圧縮データブロックの最大サイズ。この設定はグローバル設定でも指定できます（[max_compress_block_size](/operations/settings/merge-tree-settings#max_compress_block_size) 設定を参照）。テーブル作成時に指定された値は、この設定に対するグローバル値を上書きします。
```
## max_concurrent_queries {#max_concurrent_queries} 
<SettingsInfoBlock type="UInt64" default_value="0" />

MergeTree テーブルに関連する同時実行クエリの最大数。
クエリは他の `max_concurrent_queries` 設定によっても制限されます。

可能な値:
- 正の整数。
- `0` — 制限なし。

デフォルト値: `0` (制限なし)。

**例**

```xml
<max_concurrent_queries>50</max_concurrent_queries>
```
## max_delay_to_insert {#max_delay_to_insert} 
<SettingsInfoBlock type="UInt64" default_value="1" />

アクティブなパーツの数が単一パーティションで [parts_to_delay_insert](#parts_to_delay_insert) 値を超えた場合の `INSERT` 遅延を計算するために使用される秒数の値。

可能な値:
- 任意の正の整数。

`INSERT` の遅延（ミリ秒）は次の式で計算されます:

```code
max_k = parts_to_throw_insert - parts_to_delay_insert
k = 1 + parts_count_in_partition - parts_to_delay_insert
delay_milliseconds = pow(max_delay_to_insert * 1000, k / max_k)
```
例えば、パーティションに299のアクティブパーツがあり、parts_to_throw_insert = 300、parts_to_delay_insert = 150、max_delay_to_insert = 1の場合、`INSERT`は `pow( 1 * 1000, (1 + 299 - 150) / (300 - 150) ) = 1000` ミリ秒遅延します。

バージョン23.1から、式が次のように変更されました:

```code
allowed_parts_over_threshold = parts_to_throw_insert - parts_to_delay_insert
parts_over_threshold = parts_count_in_partition - parts_to_delay_insert + 1
delay_milliseconds = max(min_delay_to_insert_ms, (max_delay_to_insert * 1000)
* parts_over_threshold / allowed_parts_over_threshold)
```

例えば、パーティションに224のアクティブパーツがあり、parts_to_throw_insert = 300、parts_to_delay_insert = 150、max_delay_to_insert = 1、min_delay_to_insert_ms = 10の場合、`INSERT`は `max( 10, 1 * 1000 *
(224 - 150 + 1) / (300 - 150) ) = 500` ミリ秒遅延します。
## max_delay_to_mutate_ms {#max_delay_to_mutate_ms} 
<SettingsInfoBlock type="UInt64" default_value="1000" />

未完了の変異が多数存在する場合の、MergeTree テーブルの最大遅延（ミリ秒）。
## max_digestion_size_per_segment {#max_digestion_size_per_segment} 
<SettingsInfoBlock type="UInt64" default_value="268435456" />

GIN インデックスを構築するために、セグメントごとに消化する最大バイト数。
## max_file_name_length {#max_file_name_length} 
<SettingsInfoBlock type="UInt64" default_value="127" />

ハッシュ化せずにそのまま保持できるファイル名の最大長。
設定 `replace_long_file_name_to_hash` が有効な場合にのみ有効です。
この設定の値にはファイル拡張子の長さは含まれません。そのため、ファイルシステムエラーを避けるために、最大ファイル名長（通常255バイト）以下に設定することが推奨されます。
## max_files_to_modify_in_alter_columns {#max_files_to_modify_in_alter_columns} 
<SettingsInfoBlock type="UInt64" default_value="75" />

この設定よりも修正（削除、追加）のためのファイル数が多い場合はALTERを適用しない。

可能な値:

- 任意の正の整数。

デフォルト値: 75
## max_files_to_remove_in_alter_columns {#max_files_to_remove_in_alter_columns} 
<SettingsInfoBlock type="UInt64" default_value="50" />

この設定よりも削除のためのファイル数が多い場合はALTERを適用しない。

可能な値:
- 任意の正の整数。
## max_merge_delayed_streams_for_parallel_write {#max_merge_delayed_streams_for_parallel_write} 
<SettingsInfoBlock type="UInt64" default_value="40" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.4"},{"label": "40"},{"label": "新しい設定"}]}]}/>


同時にフラッシュできるストリーム（カラム）の最大数（マージ用の max_insert_delayed_streams_for_parallel_write の類似）。垂直マージのみに適用されます。
## max_merge_selecting_sleep_ms {#max_merge_selecting_sleep_ms} 
<SettingsInfoBlock type="UInt64" default_value="60000" />

パーツが選択されなかった後に再度マージ用のパーツを選択する前に待機する最大時間。設定を低くすると、大規模クラスタにおいてzookeeperへのリクエストが大量に発生することになります。
## max_number_of_merges_with_ttl_in_pool {#max_number_of_merges_with_ttl_in_pool} 
<SettingsInfoBlock type="UInt64" default_value="2" />
プール内にTTLエントリを持つマージの指定数を超えた場合、新しいTTLを有するマージを割り当てない。この設定は通常のマージのための自由なスレッドを残し、"Too many parts" を避けるためです。
## max_number_of_mutations_for_replica {#max_number_of_mutations_for_replica} 
<SettingsInfoBlock type="UInt64" default_value="0" />

レプリカあたりのパーツ変異の数を指定された数に制限します。
ゼロはレプリカあたりの変異の制限なしを意味します（他の設定によって実行が制約される場合があります）。
## max_part_loading_threads {#max_part_loading_threads} 
<SettingsInfoBlock type="MaxThreads" default_value="'auto(14)'" />
廃止された設定で、何もしません。
## max_part_removal_threads {#max_part_removal_threads} 
<SettingsInfoBlock type="MaxThreads" default_value="'auto(14)'" />
廃止された設定で、何もしません。
## max_partitions_to_read {#max_partitions_to_read} 
<SettingsInfoBlock type="Int64" default_value="-1" />

1つのクエリでアクセスできるパーティションの最大数を制限します。

テーブルを作成する際に指定された設定値は、クエリレベルの設定によって上書きできます。

可能な値:
- 任意の正の整数。

クエリ/セッション/プロファイルレベルでクエリの複雑さの設定 [max_partitions_to_read](/operations/settings/settings#max_partitions_to_read) を指定することもできます。
## max_parts_in_total {#max_parts_in_total} 
<SettingsInfoBlock type="UInt64" default_value="100000" />

テーブルのすべてのパーティションにおけるアクティブパーツの総数が `max_parts_in_total` 値を超えた場合、`INSERT` は `Too many parts (N)` 例外で中断されます。

可能な値:
- 任意の正の整数。

テーブル内のパーツが多すぎると、ClickHouseクエリの性能が低下し、ClickHouseの起動時間が増加します。この問題は通常、パーティショニング戦略の選択ミスなどの不正設計の結果です（パーティションが小さすぎる）。 
## max_parts_to_merge_at_once {#max_parts_to_merge_at_once} 
<SettingsInfoBlock type="UInt64" default_value="100" />

同時にマージされることができるパーツの最大数（0 - 無効）。OPTIMIZE FINAL クエリに影響しません。
## max_postpone_time_for_failed_mutations_ms {#max_postpone_time_for_failed_mutations_ms} 
<SettingsInfoBlock type="UInt64" default_value="300000" />

失敗した変異に対する最大延期時間。
## max_postpone_time_for_failed_replicated_fetches_ms {#max_postpone_time_for_failed_replicated_fetches_ms} 
<SettingsInfoBlock type="UInt64" default_value="60000" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.4"},{"label": "60000"},{"label": "レプリケーションキュー内のフェッチタスクの延期を可能にする新しい設定を追加しました。"}]}]}/>


失敗したレプリケートフェッチに対する最大延期時間。
## max_postpone_time_for_failed_replicated_merges_ms {#max_postpone_time_for_failed_replicated_merges_ms} 
<SettingsInfoBlock type="UInt64" default_value="60000" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.4"},{"label": "60000"},{"label": "レプリケーションキュー内のマージタスクの延期を可能にする新しい設定を追加しました。"}]}]}/>


失敗したレプリケートマージに対する最大延期時間。
## max_postpone_time_for_failed_replicated_tasks_ms {#max_postpone_time_for_failed_replicated_tasks_ms} 
<SettingsInfoBlock type="UInt64" default_value="300000" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.4"},{"label": "300000"},{"label": "レプリケーションキュー内のタスクの延期を可能にする新しい設定を追加しました。"}]}]}/>


失敗したレプリケートタスクに対する最大延期時間。この値は、タスクがフェッチ、マージ、または変異でない場合に使用されます。
## max_projections {#max_projections} 
<SettingsInfoBlock type="UInt64" default_value="25" />

Merge tree プロジェクションの最大数。
## max_replicated_fetches_network_bandwidth {#max_replicated_fetches_network_bandwidth} 
<SettingsInfoBlock type="UInt64" default_value="0" />

[Replicated](../../engines/table-engines/mergetree-family/replication.md) フェッチにおけるネットワーク経由のデータ交換の最大速度をバイト/秒で制限します。この設定は特定のテーブルに適用され、サーバーに適用される [`max_replicated_fetches_network_bandwidth_for_server`](/operations/settings/merge-tree-settings#max_replicated_fetches_network_bandwidth) 設定とは異なります。

サーバーネットワークと特定のテーブルのネットワークの両方を制限できますが、テーブルレベルの設定の値はサーバーレベルのものより小さくする必要があります。さもなければ、サーバーは `max_replicated_fetches_network_bandwidth_for_server` 設定のみを考慮します。

設定は完全に正確には遵守されません。

可能な値:

- 正の整数。
- `0` — 無制限。

デフォルト値: `0`。

**使用方法**

新しいノードを追加または置き換えるためにデータをレプリケートするときに速度を制限するために使用できる。
## max_replicated_logs_to_keep {#max_replicated_logs_to_keep} 
<SettingsInfoBlock type="UInt64" default_value="1000" />

非アクティブなレプリカがある場合、ClickHouse Keeper ログに記録できる最大数。この数を超えると、非アクティブレプリカとみなされます。

可能な値:
- 任意の正の整数。
## max_replicated_merges_in_queue {#max_replicated_merges_in_queue} 
<SettingsInfoBlock type="UInt64" default_value="1000" />

ReplicatedMergeTree キューで同時に許可されるパーツのマージおよび変異タスクの数。
## max_replicated_merges_with_ttl_in_queue {#max_replicated_merges_with_ttl_in_queue} 
<SettingsInfoBlock type="UInt64" default_value="1" />

ReplicatedMergeTree キューで同時に許可されるTTLを持つパーツのマージタスクの数。
## max_replicated_mutations_in_queue {#max_replicated_mutations_in_queue} 
<SettingsInfoBlock type="UInt64" default_value="8" />

ReplicatedMergeTree キューで同時に許可されるパーツの変異タスクの数。
## max_replicated_sends_network_bandwidth {#max_replicated_sends_network_bandwidth} 
<SettingsInfoBlock type="UInt64" default_value="0" />

[Replicated](/engines/table-engines/mergetree-family/replacingmergetree) 送信におけるネットワーク経由のデータ交換の最大速度をバイト/秒で制限します。この設定は特定のテーブルに適用され、サーバーに適用される [`max_replicated_sends_network_bandwidth_for_server`](/operations/settings/merge-tree-settings#max_replicated_sends_network_bandwidth) 設定とは異なります。

サーバーネットワークと特定のテーブルのネットワークの両方を制限できますが、テーブルレベルの設定の値はサーバーレベルのものより小さくする必要があります。さもなければ、サーバーは `max_replicated_sends_network_bandwidth_for_server` 設定のみを考慮します。

設定は完全に正確には遵守されません。

可能な値:

- 正の整数。
- `0` — 無制限。

**使用方法**

新しいノードを追加または置き換えるためにデータをレプリケートするときに速度を制限するために使用できる。
## max_suspicious_broken_parts {#max_suspicious_broken_parts} 
<SettingsInfoBlock type="UInt64" default_value="100" />

単一パーティション内の破損したパーツの数が `max_suspicious_broken_parts` 値を超えると、自動削除が拒否されます。

可能な値:
- 任意の正の整数。
## max_suspicious_broken_parts_bytes {#max_suspicious_broken_parts_bytes} 
<SettingsInfoBlock type="UInt64" default_value="1073741824" />

破損したパーツの最大サイズ、これを超えると自動削除が拒否されます。

可能な値:
- 任意の正の整数。
## merge_max_block_size {#merge_max_block_size} 
<SettingsInfoBlock type="UInt64" default_value="8192" />

マージされたパーツからメモリに読み込まれる行の数。

可能な値:
- 任意の正の整数。

マージは `merge_max_block_size` 行ごとにパーツから行を読み込み、その後マージして新しいパーツに結果を書き込みます。読み取りブロックはRAMに配置されるため、`merge_max_block_size` はマージに必要なRAMのサイズに影響します。したがって、非常に広い行を持つテーブルでは、マージのために大量のRAMを消費する場合があります（平均行サイズが100kbの場合、10のパーツをマージすると、(100kb * 10 * 8192) = ~ 8GBのRAM）。`merge_max_block_size`を減少させることで、マージに必要なRAMの量を減らせますが、マージを遅くする可能性があります。
## merge_max_block_size_bytes {#merge_max_block_size_bytes} 
<SettingsInfoBlock type="UInt64" default_value="10485760" />

マージ操作のために形成されるブロック内のバイト数。デフォルトでは`index_granularity_bytes`と同じ値を持ちます。
## merge_max_bytes_to_prewarm_cache {#merge_max_bytes_to_prewarm_cache} 
<SettingsInfoBlock type="UInt64" default_value="1073741824" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "1073741824"},{"label": "Cloud sync"}]}]}/>


ClickHouse Cloud のみで利用可能。マージの際にキャッシュを事前に温めるためのパーツ（コンパクトまたはパック）の最大サイズ。
## merge_selecting_sleep_ms {#merge_selecting_sleep_ms} 
<SettingsInfoBlock type="UInt64" default_value="5000" />

パーツが選択されなかった後に再度マージ用のパーツを選択する前に待機する最小時間。設定を低くすると、大規模クラスタに於いてzookeeperへのリクエストが大量に発生します。
## merge_selecting_sleep_slowdown_factor {#merge_selecting_sleep_slowdown_factor} 
<SettingsInfoBlock type="Float" default_value="1.2" />

マージ選択タスクの待機時間は、マージするものが何もないときはこのファクターで乗算され、マージが割当てられた場合は除算されます。
## merge_selector_algorithm {#merge_selector_algorithm} 

<ExperimentalBadge/>
<SettingsInfoBlock type="MergeSelectorAlgorithm" default_value="Simple" />

マージの割当のためにパーツを選択するアルゴリズム。
## merge_selector_base {#merge_selector_base} 
<SettingsInfoBlock type="Float" default_value="5" />
割当られたマージの書き込み増幅に影響します（専門レベルの設定で、何をしているのかわからない場合は変更しないでください）。Simple および StochasticSimple マージセレクタに対して機能します。
## merge_selector_blurry_base_scale_factor {#merge_selector_blurry_base_scale_factor} 
<SettingsInfoBlock type="UInt64" default_value="0" />

パーティション内のパーツの数に対して論理の発動を制御します。ファクターが大きいほど、反応が遅れます。
## merge_selector_enable_heuristic_to_remove_small_parts_at_right {#merge_selector_enable_heuristic_to_remove_small_parts_at_right} 
<SettingsInfoBlock type="Bool" default_value="1" />

指定された比率（0.01）の合計サイズに対して、小さなパーツを範囲の右側から削除するためのヒューリスティックを有効にします。Simple および StochasticSimple マージセレクタに対して機能します。
## merge_selector_window_size {#merge_selector_window_size} 
<SettingsInfoBlock type="UInt64" default_value="1000" />

一度にどれだけのパーツを調べるか。
## merge_total_max_bytes_to_prewarm_cache {#merge_total_max_bytes_to_prewarm_cache} 
<SettingsInfoBlock type="UInt64" default_value="16106127360" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "16106127360"},{"label": "Cloud sync"}]}]}/>


ClickHouse Cloud のみで利用可能。マージの際にキャッシュを事前に温めるためのパーツの総最大サイズ。
## merge_tree_clear_old_broken_detached_parts_ttl_timeout_seconds {#merge_tree_clear_old_broken_detached_parts_ttl_timeout_seconds} 
<SettingsInfoBlock type="UInt64" default_value="2592000" />
廃止された設定で、何もしません。
## merge_tree_clear_old_parts_interval_seconds {#merge_tree_clear_old_parts_interval_seconds} 
<SettingsInfoBlock type="UInt64" default_value="1" />

ClickHouse が古いパーツ、WAL、変異のクリーンアップを実行するための間隔（秒）を設定します。

可能な値:
- 任意の正の整数。
## merge_tree_clear_old_temporary_directories_interval_seconds {#merge_tree_clear_old_temporary_directories_interval_seconds} 
<SettingsInfoBlock type="UInt64" default_value="60" />

ClickHouse が古い一時ディレクトリのクリーンアップを実行するための間隔（秒）を設定します。

可能な値:
- 任意の正の整数。
## merge_tree_enable_clear_old_broken_detached {#merge_tree_enable_clear_old_broken_detached} 
<SettingsInfoBlock type="UInt64" default_value="0" />
廃止された設定で、何もしません。
## merge_with_recompression_ttl_timeout {#merge_with_recompression_ttl_timeout} 
<SettingsInfoBlock type="Int64" default_value="14400" />

再圧縮TTLでのマージを再実行する前の最小遅延（秒）。
## merge_with_ttl_timeout {#merge_with_ttl_timeout} 
<SettingsInfoBlock type="Int64" default_value="14400" />

削除TTLでのマージを再実行する前の最小遅延（秒）。
## merge_workload {#merge_workload} 


リソースの利用とマージおよび他のワークロード間の共有を調整するために使用されます。指定された値は、このテーブルのバックグラウンドマージに対する `workload` 設定値として使用されます。指定されていない場合（空文字列）、サーバー設定 `merge_workload` が代わりに使用されます。

**参照**
- [ワークロードスケジューリング](/operations/workload-scheduling.md)
## min_absolute_delay_to_close {#min_absolute_delay_to_close} 
<SettingsInfoBlock type="UInt64" default_value="0" />

リクエストのサービスを停止し、ステータスチェック中に Ok を返さずに閉じるための最小の絶対遅延。
## min_age_to_force_merge_on_partition_only {#min_age_to_force_merge_on_partition_only} 
<SettingsInfoBlock type="Bool" default_value="0" />

`min_age_to_force_merge_seconds` がパーティション全体に対してのみ適用されるべきか、部分集合に対しては適用されないか。

デフォルトでは、`max_bytes_to_merge_at_max_space_in_pool` 設定を無視します（`enable_max_bytes_limit_for_min_age_to_force_merge`を参照）。

可能な値:
- true, false
## min_age_to_force_merge_seconds {#min_age_to_force_merge_seconds} 
<SettingsInfoBlock type="UInt64" default_value="0" />

範囲内のすべてのパーツが `min_age_to_force_merge_seconds` の値より古い場合、マージパーツを作成します。

デフォルトでは、`max_bytes_to_merge_at_max_space_in_pool` 設定を無視します（`enable_max_bytes_limit_for_min_age_to_force_merge`を参照）。

可能な値:
- 正の整数。
## min_bytes_for_compact_part {#min_bytes_for_compact_part} 
<SettingsInfoBlock type="UInt64" default_value="0" />
廃止された設定で、何もしません。
## min_bytes_for_full_part_storage {#min_bytes_for_full_part_storage} 
<SettingsInfoBlock type="UInt64" default_value="0" />

ClickHouse Cloud のみで利用可能。パートデータのフルタイプストレージを使用するために必要な最小の未圧縮サイズ（バイト）。
## min_bytes_for_wide_part {#min_bytes_for_wide_part} 
<SettingsInfoBlock type="UInt64" default_value="10485760" />

`Wide` フォーマットで保存できるデータパーツ内の最小バイト数/行数。この設定の1つ、両方、またはどちらも指定できます。
## min_bytes_to_prewarm_caches {#min_bytes_to_prewarm_caches} 
<SettingsInfoBlock type="UInt64" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "24.12"},{"label": "0"},{"label": "新しい設定"}]}]}/>


新しいパーツのためにマークキャッシュとプライマリインデックスキャッシュを事前に温めるための最小サイズ（未圧縮バイト）。
## min_bytes_to_rebalance_partition_over_jbod {#min_bytes_to_rebalance_partition_over_jbod} 
<SettingsInfoBlock type="UInt64" default_value="0" />

新しい大きなパーツをボリュームディスク [JBOD](https://en.wikipedia.org/wiki/Non-RAID_drive_architectures) に分配するときに再バランスを有効にするための最小バイト数を設定します。

可能な値:
- 正の整数。
- `0` — バランスは無効。

**使用方法**

`min_bytes_to_rebalance_partition_over_jbod` 設定の値は、[max_bytes_to_merge_at_max_space_in_pool](/operations/settings/merge-tree-settings#max_bytes_to_merge_at_max_space_in_pool) の値 / 1024 より小さくするべきです。そうでない場合、ClickHouseは例外をスローします。
## min_compress_block_size {#min_compress_block_size} 
<SettingsInfoBlock type="UInt64" default_value="0" />

次のマークを書き込むときに圧縮のために必要な未圧縮データの最小サイズのブロック。グローバル設定でこの設定を指定することもできます（[min_compress_block_size](/operations/settings/merge-tree-settings#min_compress_block_size) 設定を参照）。テーブル作成時に指定した値は、この設定のグローバル値を上書きします。
## min_compressed_bytes_to_fsync_after_fetch {#min_compressed_bytes_to_fsync_after_fetch} 
<SettingsInfoBlock type="UInt64" default_value="0" />

フェッチ後にパートの fsync を行うための最小圧縮バイト数（0 - 無効）。
## min_compressed_bytes_to_fsync_after_merge {#min_compressed_bytes_to_fsync_after_merge} 
<SettingsInfoBlock type="UInt64" default_value="0" />

マージ後にパートの fsync を行うための最小圧縮バイト数（0 - 無効）。
## min_delay_to_insert_ms {#min_delay_to_insert_ms} 
<SettingsInfoBlock type="UInt64" default_value="10" />

単一パーティション内に多数の未マージパーツがある場合の、MergeTree テーブルにデータを挿入するための最小遅延（ミリ秒）。
## min_delay_to_mutate_ms {#min_delay_to_mutate_ms} 
<SettingsInfoBlock type="UInt64" default_value="10" />

未完了の変異が多数存在する場合の、MergeTree テーブルの最小遅延（ミリ秒）。
## min_free_disk_bytes_to_perform_insert {#min_free_disk_bytes_to_perform_insert} 
<SettingsInfoBlock type="UInt64" default_value="0" />

データを挿入するためにディスクスペースに必要な最小バイト数。`min_free_disk_bytes_to_perform_insert` よりも利用可能な空きバイトが少ない場合、例外がスローされ、挿入は実行されません。この設定は:
- `keep_free_space_bytes` 設定を考慮します。
- `INSERT` 操作によって書き込まれるデータの量は考慮しません。
- 正の（ゼロ以外の）バイト数が指定された場合にのみチェックされます。

可能な値:
- 任意の正の整数。

:::note
`min_free_disk_bytes_to_perform_insert` と `min_free_disk_ratio_to_perform_insert` の両方が指定されている場合、ClickHouse はより多くの空きメモリで挿入を行える値を考慮します。
:::
## min_free_disk_ratio_to_perform_insert {#min_free_disk_ratio_to_perform_insert} 
<SettingsInfoBlock type="Float" default_value="0" />

`INSERT` を実行するための最小の空きディスクと総ディスクの割合。0から1の間の浮動小数点値でなければなりません。この設定は:
- `keep_free_space_bytes` 設定を考慮します。
- `INSERT` 操作によって書き込まれるデータの量は考慮しません。
- 正の（ゼロ以外の）比率が指定された場合にのみチェックされます。

可能な値:
- Float, 0.0 - 1.0

`min_free_disk_ratio_to_perform_insert` と `min_free_disk_bytes_to_perform_insert` の両方が指定されている場合、ClickHouse はより多くの空きメモリで挿入を行える値を考慮します。
## min_index_granularity_bytes {#min_index_granularity_bytes} 
<SettingsInfoBlock type="UInt64" default_value="1024" />

バイト単位でのデータグラニュールの最小許可サイズ。

非常に低い `index_granularity_bytes` を持つテーブルが誤って作成されるのを防ぐための保護措置です。
## min_marks_to_honor_max_concurrent_queries {#min_marks_to_honor_max_concurrent_queries} 
<SettingsInfoBlock type="UInt64" default_value="0" />

[ max_concurrent_queries](#max_concurrent_queries) 設定を適用するためにクエリによって読み取られる最小のマーク数。

:::note
クエリは他の `max_concurrent_queries` 設定によっても制限されます。
:::

可能な値:
- 正の整数。
- `0` — 無効（`max_concurrent_queries` 限界がクエリに適用されない）。

**例**

```xml
<min_marks_to_honor_max_concurrent_queries>10</min_marks_to_honor_max_concurrent_queries>
```
## min_merge_bytes_to_use_direct_io {#min_merge_bytes_to_use_direct_io} 
<SettingsInfoBlock type="UInt64" default_value="10737418240" />

ストレージディスクへの直接 I/O アクセスを使用するために必要なマージ操作の最小データ量。この量を超えると、ClickHouseは直接 I/O インターフェース（`O_DIRECT` オプション）を使用して、データをストレージディスクに読み書きします。`min_merge_bytes_to_use_direct_io = 0` の場合、直接 I/O は無効になります。
## min_parts_to_merge_at_once {#min_parts_to_merge_at_once} 
<SettingsInfoBlock type="UInt64" default_value="0" />

マージセレクタが一度にマージするために選択できる最小データパーツ数（専門レベルの設定で、何をしているのかわからない場合は変更しないでください）。 0 - 無効。Simple および StochasticSimple マージセレクタに対して機能します。
## min_relative_delay_to_close {#min_relative_delay_to_close} 
<SettingsInfoBlock type="UInt64" default_value="300" />

他のレプリカからの最小遅延、閉じるために、リクエストのサービスを停止し、ステータスチェック中に Ok を返さない。
## min_relative_delay_to_measure {#min_relative_delay_to_measure} 
<SettingsInfoBlock type="UInt64" default_value="120" />

絶対遅延がこの値未満でない場合にのみ、相対レプリカ遅延を計算する。
## min_relative_delay_to_yield_leadership {#min_relative_delay_to_yield_leadership} 
<SettingsInfoBlock type="UInt64" default_value="120" />
廃止された設定で、何もしません。
## min_replicated_logs_to_keep {#min_replicated_logs_to_keep} 
<SettingsInfoBlock type="UInt64" default_value="10" />

古くなった場合でも、ZooKeeper ログ内の最後のこの数の記録を保持します。テーブルの動作には影響しません: 清掃前の ZooKeeper ログを診断するためにのみ使用されます。

可能な値:
- 任意の正の整数。
## min_rows_for_compact_part {#min_rows_for_compact_part} 
<SettingsInfoBlock type="UInt64" default_value="0" />
廃止された設定で、何もしません。
## min_rows_for_full_part_storage {#min_rows_for_full_part_storage} 
<SettingsInfoBlock type="UInt64" default_value="0" />

ClickHouse Cloud のみで利用可能。パートデータのフルタイプストレージを使用するのに必要な最小行数。
## min_rows_for_wide_part {#min_rows_for_wide_part} 
<SettingsInfoBlock type="UInt64" default_value="0" />

コンパクトではなく広域形式の部分を作成するための最小行数。
## min_rows_to_fsync_after_merge {#min_rows_to_fsync_after_merge} 
<SettingsInfoBlock type="UInt64" default_value="0" />

マージ後の部分の fsync のための最小行数（0 - 無効）。
## mutation_workload {#mutation_workload} 


変異と他のワークロード間でリソースがどのように利用され、共有されるかを調整するために使用されます。指定された値は、このテーブルのバックグラウンド変異に対する `workload` 設定値として使用されます。指定されていない場合（空文字列）、サーバー設定 `mutation_workload` が代わりに使用されます。

**参照**
- [ワークロードスケジューリング](/operations/workload-scheduling.md)
## non_replicated_deduplication_window {#non_replicated_deduplication_window} 
<SettingsInfoBlock type="UInt64" default_value="0" />

重複を確認するためにハッシュサムが保存される非レプリケート [MergeTree](../../engines/table-engines/mergetree-family/mergetree.md) テーブル内の最近挿入されたブロックの数。

可能な値:
- 任意の正の整数。
- `0` (重複排除無効)。

重複排除メカニズムは、レプリケートテーブルで使用されるものと類似しています（[replicated_deduplication_window](#replicated_deduplication_window) 設定を参照）。作成されたパーツのハッシュサムは、ディスク上のローカルファイルに書き込まれます。
## notify_newest_block_number {#notify_newest_block_number} 

<ExperimentalBadge/>
<SettingsInfoBlock type="Bool" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "0"},{"label": "Cloud sync"}]}]}/>


SharedJoin または SharedSet に最新のブロック番号を通知します。ClickHouse Cloud のみに適用されます。
## number_of_free_entries_in_pool_to_execute_mutation {#number_of_free_entries_in_pool_to_execute_mutation} 
<SettingsInfoBlock type="UInt64" default_value="20" />

プール内の空きエントリの指定された数が未満の場合、部分変異を実行しません。これは通常のマージのための自由なスレッドを残し、「Too many parts」エラーを避けるためです。

可能な値:
- 任意の正の整数。

**使用方法**

`number_of_free_entries_in_pool_to_execute_mutation` 設定の値は、[background_pool_size](/operations/server-configuration-parameters/settings.md/#background_pool_size) と
[background_merges_mutations_concurrency_ratio](/operations/server-configuration-parameters/settings.md/#background_merges_mutations_concurrency_ratio) の値より小さくするべきです。そうでない場合、ClickHouseは例外をスローします。
## number_of_free_entries_in_pool_to_execute_optimize_entire_partition {#number_of_free_entries_in_pool_to_execute_optimize_entire_partition} 
<SettingsInfoBlock type="UInt64" default_value="25" />

プール内の空きエントリの指定された数が未満の場合、バックグラウンドで全パーティションを最適化することを実行しません（このタスクは `min_age_to_force_merge_seconds` を設定したときに生成され、`min_age_to_force_merge_on_partition_only` が有効になっています）。これは通常のマージのための自由なスレッドを残し、「Too many parts」を避けるためです。

可能な値:
- 正の整数。

`number_of_free_entries_in_pool_to_execute_optimize_entire_partition` 設定の値は、[background_pool_size](/operations/server-configuration-parameters/settings.md/#background_pool_size) と
[background_merges_mutations_concurrency_ratio](/operations/server-configuration-parameters/settings.md/#background_merges_mutations_concurrency_ratio) の値より小さくするべきです。そうでない場合、ClickHouseは例外をスローします。
## number_of_free_entries_in_pool_to_lower_max_size_of_merge {#number_of_free_entries_in_pool_to_lower_max_size_of_merge} 
<SettingsInfoBlock type="UInt64" default_value="8" />

プール内（またはレプリケートキュー）で空きエントリの数が指定された数未満になると、処理する最大マージサイズを下げます（またはキューに入れます）。
これは小さなマージが処理できるようにするためで、長時間実行されるマージでプールが埋まらないようにします。

可能な値:
- 任意の正の整数。
## number_of_mutations_to_delay {#number_of_mutations_to_delay} 
<SettingsInfoBlock type="UInt64" default_value="500" />
テーブルに未完了のミューテーションがその数以上ある場合、テーブルのミューテーションを人工的に遅延させます。0に設定すると無効になります。

## number_of_mutations_to_throw {#number_of_mutations_to_throw} 
<SettingsInfoBlock type="UInt64" default_value="1000" />
テーブルに未完了のミューテーションがその数以上ある場合、'Too many mutations'例外がスローされます。0に設定すると無効になります。

## number_of_partitions_to_consider_for_merge {#number_of_partitions_to_consider_for_merge} 
<SettingsInfoBlock type="UInt64" default_value="10" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "10"},{"label": "Cloud sync"}]}]}/>

ClickHouse Cloudでのみ利用可能です。マージを考慮する上位N個のパーティション。重み付けされたランダムな方法で選択され、重みはこのパーティションでマージ可能なデータパーツの量です。

## old_parts_lifetime {#old_parts_lifetime} 
<SettingsInfoBlock type="Seconds" default_value="480" />
inactiveなパーツを保存する時間（秒）。サーバーの自発的な再起動中のデータ損失を防ぐためのものです。

可能な値：
- 任意の正の整数。

複数のパーツを新しいパーツにマージした後、ClickHouseは元のパーツを非アクティブとしてマークし、`old_parts_lifetime`秒経過後にのみ削除します。非アクティブなパーツは、現在のクエリで使用されていない場合に削除されます。つまり、パーツの`refcount`が1の場合です。

新しいパーツには`fsync`は呼び出されないため、新しいパーツはサーバーのRAM（OSキャッシュ）のみでしばらく存在します。サーバーが自発的に再起動されると、新しいパーツが失われたり損傷したりする可能性があります。データを保護するために、非アクティブなパーツはすぐに削除されません。

起動時にClickHouseはパーツの整合性をチェックします。マージされたパーツが損傷している場合、ClickHouseは非アクティブなパーツをアクティブリストに戻し、後で再度マージします。この後、損傷したパーツは名前が変更され（`broken_`プレフィックスが追加され）、`detached`フォルダーに移動されます。マージされたパーツが損傷していない場合、元の非アクティブなパーツは名前が変更され（`ignored_`プレフィックスが追加され）、`detached`フォルダーに移動されます。

デフォルトの`dirty_expire_centisecs`値（Linuxカーネルの設定）は30秒です（書き込まれたデータがRAMにのみ保存される最大時間）が、ディスクシステムに負荷がかかると、データははるかに遅れて書き込まれる可能性があります。実験的に、`old_parts_lifetime`の値は480秒に設定されており、この間に新しいパーツが確実にディスクに書き込まれることが保証されます。

## optimize_row_order {#optimize_row_order} 
<SettingsInfoBlock type="Bool" default_value="0" />
挿入時に行の順序を最適化して、新しく挿入されたテーブルパーツの圧縮性を改善するかどうかを制御します。

これは通常のMergeTreeエンジンテーブルにのみ影響があります。特化したMergeTreeエンジンテーブル（例：CollapsingMergeTree）には何の効果もありません。

MergeTreeテーブルは、[compression codecs](/sql-reference/statements/create/table#column_compression_codec)を使用してオプションで圧縮されます。LZ4やZSTDなどの一般的な圧縮コーデックは、データにパターンが表示される場合に最大圧縮率を達成します。同じ値の長いランは通常、非常によく圧縮されます。

この設定が有効になっている場合、ClickHouseは新しく挿入されたパーツのデータを、カラムの列の間で同じ値のランの数を最小化する行の順序に格納しようとします。言い換えれば、少数の同じ値のランは、その個々のランが長く、よく圧縮されることを意味します。

最適な行の順序を見つけることは計算上扱いが難しい（NP困難）です。そのため、ClickHouseはオリジナルの行の順序よりも圧縮率を改善する行の順序を迅速に見つけるためのヒューリスティクスを使用します。

<details markdown="1">

<summary>行の順序を見つけるためのヒューリスティクス</summary>

SQLでは同じテーブル（またはテーブルパーツ）を異なる行の順序で考慮することが等価と見なされるため、テーブルの行を自由にシャッフルすることが一般的に可能です。

テーブルに主キーが定義されている場合、この行のシャッフルの自由度は制限されます。ClickHouseでは、主キー`C1, C2, ..., CN`は、テーブル行が`C1`、`C2`、... `Cn`のカラムによってソートされることを強制します（[clustered index](https://en.wikipedia.org/wiki/Database_index#Clustered)）。そのため、行は「同値クラス」の内部でのみシャッフルできます。つまり、主キーカラムの値が同じ行です。主キーが高カーディナリティであると、たとえば`DateTime64`タイムスタンプカラムを含む場合、非常に小さな同値クラスが多数生成されます。同様に、カーディナリティが低い主キーのテーブルは、少数の大きな同値クラスを生成します。主キーがないテーブルは、すべての行を網羅する単一の同値クラスの極端なケースを表します。

同値クラスの数が少なく、同値クラスが大きいほど、行を再シャッフルする自由度が高くなります。

各同値クラス内で最良の行の順序を見つけるために適用されるヒューリスティクスは、D. Lemire、O. Kaserによって提案されています[Reordering columns for smaller indexes](https://doi.org/10.1016/j.ins.2011.02.002)および非主キー列のカーディナリティの昇順で各同値クラス内の行をソートすることに基づいています。

3つのステップを実行します。
1. 主キー列の行の値に基づいてすべての同値クラスを見つけます。
2. 各同値クラスについて、非主キー列のカーディナリティを計算（通常は推定）します。
3. 各同値クラスについて、非主キー列のカーディナリティの昇順で行をソートします。

</details>

これが有効な場合、挿入操作は、新しいデータの行の順序を分析し最適化するために追加のCPUコストが発生します。INSERTはデータの特性によっては30〜50％長くなると予想されます。LZ4またはZSTDの圧縮率は平均で20〜40％向上します。

この設定は、主キーがないテーブルやカーディナリティの低い主キーを持つテーブルに最適に機能します。つまり、異なる主キー値が少ないテーブルです。高カーディナリティの主キー、例：`DateTime64`型タイムスタンプカラムを含むものは、この設定の恩恵を受けることは期待できません。

## part_moves_between_shards_delay_seconds {#part_moves_between_shards_delay_seconds} 

<ExperimentalBadge/>
<SettingsInfoBlock type="UInt64" default_value="30" />

シャード間でパーツを移動する前後の待機時間。

## part_moves_between_shards_enable {#part_moves_between_shards_enable} 

<ExperimentalBadge/>
<SettingsInfoBlock type="UInt64" default_value="0" />

シャード間でパーツを移動するための実験的/未完成の機能。シャーディング式は考慮しません。

## parts_to_delay_insert {#parts_to_delay_insert} 
<SettingsInfoBlock type="UInt64" default_value="1000" />

単一のパーティション内のアクティブなパーツの数が`parts_to_delay_insert`値を超えると、`INSERT`は人工的に遅延されます。

可能な値：
- 任意の正の整数。

ClickHouseは`INSERT`を人工的に長く実行します（'sleep'を追加）。これにより、バックグラウンドマージプロセスが追加されるよりも速くパーツをマージできます。

## parts_to_throw_insert {#parts_to_throw_insert} 
<SettingsInfoBlock type="UInt64" default_value="3000" />

単一のパーティション内のアクティブなパーツの数が`parts_to_throw_insert`値を超えると、`INSERT`が`Too many parts (N). Merges are processing significantly slower than inserts`例外をもって中断されます。

可能な値：
- 任意の正の整数。

`SELECT`クエリの最大パフォーマンスを実現するには、処理されるパーツの数を最小限に抑える必要があります。詳細は[Merge Tree](/development/architecture#merge-tree)を参照してください。

バージョン23.6以前では、この設定は300に設定されていました。より高い異なる値を設定すると、`Too many parts`エラーの確率が減少しますが、同時に`SELECT`パフォーマンスが低下する可能性があります。またマージの問題（例えば、ディスクスペース不足による）を元の300で処理するよりも遅く気が付くことになります。

## prefer_fetch_merged_part_size_threshold {#prefer_fetch_merged_part_size_threshold} 
<SettingsInfoBlock type="UInt64" default_value="10737418240" />

パーツのサイズの合計がこの閾値を超え、レプリケーションログエントリの作成からの時間が`prefer_fetch_merged_part_time_threshold`を超える場合、ローカルでマージする代わりにレプリカからマージされたパーツを取得することを優先します。これは非常に長いマージをスピードアップするためのものです。

可能な値：
- 任意の正の整数。

## prefer_fetch_merged_part_time_threshold {#prefer_fetch_merged_part_time_threshold} 
<SettingsInfoBlock type="Seconds" default_value="3600" />

レプリケーションログ（ClickHouse KeeperまたはZooKeeper）エントリの作成からの時間がこの閾値を超え、パーツのサイズの合計が`prefer_fetch_merged_part_size_threshold`より大きい場合、ローカルでマージする代わりにレプリカからマージされたパーツを取得することを優先します。これは非常に長いマージをスピードアップするためのものです。

可能な値：
- 任意の正の整数。

## prewarm_mark_cache {#prewarm_mark_cache} 
<SettingsInfoBlock type="Bool" default_value="0" />
もしtrueなら、マークキャッシュは挿入、マージ、フェッチ、サーバーの起動時にマークを保存することによってプレウォームされます。

## prewarm_primary_key_cache {#prewarm_primary_key_cache} 
<SettingsInfoBlock type="Bool" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "24.12"},{"label": "0"},{"label": "New setting"}]}]}/>

もしtrueなら、プライマリインデックスキャッシュは挿入、マージ、フェッチ、サーバーの起動時にマークを保存することによってプレウォームされます。

## primary_key_compress_block_size {#primary_key_compress_block_size} 
<SettingsInfoBlock type="NonZeroUInt64" default_value="65536" />

プライマリ圧縮ブロックサイズ、圧縮するブロックの実際のサイズ。

## primary_key_compression_codec {#primary_key_compression_codec} 
<SettingsInfoBlock type="String" default_value="ZSTD(3)" />

プライマリが使用する圧縮エンコーディング。プライマリキーは十分小さく、キャッシュされているため、デフォルトの圧縮はZSTD(3)です。

## primary_key_lazy_load {#primary_key_lazy_load} 
<SettingsInfoBlock type="Bool" default_value="1" />
テーブル初期化の代わりに、初回使用時にプライマリキーをメモリにロードします。これにより、大量のテーブルがある場合にメモリを節約できます。

## primary_key_ratio_of_unique_prefix_values_to_skip_suffix_columns {#primary_key_ratio_of_unique_prefix_values_to_skip_suffix_columns} 
<SettingsInfoBlock type="Float" default_value="0.9" />

主キーデータパーツの列の値がこの比率以上に変化する場合、メモリに次のカラムをロードすることをスキップします。これは、主キーの無駄なカラムをロードしないことでメモリ使用量を節約できます。

## ratio_of_defaults_for_sparse_serialization {#ratio_of_defaults_for_sparse_serialization} 
<SettingsInfoBlock type="Float" default_value="0.9375" />

列のすべての値に対するデフォルト値の数の最小比率。この値を設定すると、スパースシリアライズを使用して列が保存されます。

列がスパース（主にゼロを含む）の場合、ClickHouseはそれをスパース形式でえんコードし、計算を自動的に最適化できます - クエリ中にデータの完全なデコンプレッションを必要としません。このスパースシリアリゼーションを有効にするには、`ratio_of_defaults_for_sparse_serialization`設定を1.0未満に設定します。値が1.0以上の場合、カラムは通常の完全なシリアリゼーションを使用して常に記述されます。

可能な値：

- スパースシリアリゼーションを有効にするための`0`から`1`の間のFloat
- スパースシリアリゼーションを使用したくない場合は`1.0`（またはそれ以上）

**例**

以下のテーブルの`s`カラムは95％の行に対して空の文字列です。`my_regular_table`ではスパースシリアリゼーションを使用せず、`my_sparse_table`では`ratio_of_defaults_for_sparse_serialization`を0.95に設定します：

```sql
CREATE TABLE my_regular_table
(
`id` UInt64,
`s` String
)
ENGINE = MergeTree
ORDER BY id;

INSERT INTO my_regular_table
SELECT
number AS id,
number % 20 = 0 ? toString(number): '' AS s
FROM
numbers(10000000);


CREATE TABLE my_sparse_table
(
`id` UInt64,
`s` String
)
ENGINE = MergeTree
ORDER BY id
SETTINGS ratio_of_defaults_for_sparse_serialization = 0.95;

INSERT INTO my_sparse_table
SELECT
number,
number % 20 = 0 ? toString(number): ''
FROM
numbers(10000000);
```

`my_sparse_table`の`s`カラムはディスク上でより少ないストレージスペースを使用しています：

```sql
SELECT table, name, data_compressed_bytes, data_uncompressed_bytes FROM system.columns
WHERE table LIKE 'my_%_table';
```

```response
┌─table────────────┬─name─┬─data_compressed_bytes─┬─data_uncompressed_bytes─┐
│ my_regular_table │ id   │              37790741 │                75488328 │
│ my_regular_table │ s    │               2451377 │                12683106 │
│ my_sparse_table  │ id   │              37790741 │                75488328 │
│ my_sparse_table  │ s    │               2283454 │                 9855751 │
└──────────────────┴──────┴───────────────────────┴─────────────────────────┘
```

スパースエンコーディングを使用しているかどうかを確認するには、`system.parts_columns`テーブルの`serialization_kind`カラムを表示します：

```sql
SELECT column, serialization_kind FROM system.parts_columns
WHERE table LIKE 'my_sparse_table';
```

`s`のどのパーツがスパースシリアリゼーションを使用して保存されているかを見ることができます：

```response
┌─column─┬─serialization_kind─┐
│ id     │ Default            │
│ s      │ Default            │
│ id     │ Default            │
│ s      │ Default            │
│ id     │ Default            │
│ s      │ Sparse             │
│ id     │ Default            │
│ s      │ Sparse             │
│ id     │ Default            │
│ s      │ Sparse             │
│ id     │ Default            │
│ s      │ Sparse             │
│ id     │ Default            │
│ s      │ Sparse             │
│ id     │ Default            │
│ s      │ Sparse             │
│ id     │ Default            │
│ s      │ Sparse             │
│ id     │ Default            │
│ s      │ Sparse             │
│ id     │ Default            │
│ s      │ Sparse             │
└────────┴────────────────────┘
```

## reduce_blocking_parts_sleep_ms {#reduce_blocking_parts_sleep_ms} 
<SettingsInfoBlock type="UInt64" default_value="5000" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "5000"},{"label": "Cloud sync"}]}]}/>

ClickHouse Cloudでのみ使用可能。範囲が削除/置き換えられなかった後に再度ブロッキングパーツを減らそうとする最小時間。設定を低くすると、large-scaleクラスターで大量のリクエストがZooKeeperに発生するため、background_schedule_poolでタスクが頻繁にトリガーされます。

## refresh_parts_interval {#refresh_parts_interval} 
<SettingsInfoBlock type="Seconds" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.4"},{"label": "0"},{"label": "A new setting"}]}]}/>

値がゼロより大きい場合 - 基本ファイルシステムからデータパーツのリストをリフレッシュして、データが内部で更新されたかどうかを確認します。この設定は、テーブルが読み取り専用ディスクにある場合のみ設定できます（これは、別のレプリカによってデータが書き込まれている間の読み取り専用レプリカを意味します）。

## remote_fs_execute_merges_on_single_replica_time_threshold {#remote_fs_execute_merges_on_single_replica_time_threshold} 
<SettingsInfoBlock type="Seconds" default_value="10800" />

この設定の値がゼロより大きい場合、共有ストレージ上のマージパーツで`allow_remote_fs_zero_copy_replication`が有効であれば、単一のレプリカがすぐにマージを開始します。

:::note
ゼロコピー複製は本番環境にはまだ準備が整っていません。
ゼロコピー複製はClickHouseバージョン22.8以降、デフォルトで無効になっています。

この機能は本番環境での使用は推奨されません。
:::

可能な値：
- 任意の正の整数。

## remote_fs_zero_copy_path_compatible_mode {#remote_fs_zero_copy_path_compatible_mode} 

<ExperimentalBadge/>
<SettingsInfoBlock type="Bool" default_value="0" />

変換プロセス中に互換モードでゼロコピーを実行します。

## remote_fs_zero_copy_zookeeper_path {#remote_fs_zero_copy_zookeeper_path} 

<ExperimentalBadge/>
<SettingsInfoBlock type="String" default_value="/clickhouse/zero_copy" />

ゼロコピーのテーブル非依存情報のためのZooKeeperパス。

## remove_empty_parts {#remove_empty_parts} 
<SettingsInfoBlock type="Bool" default_value="1" />

TTL、ミューテーション、またはコラプシングマージアルゴリズムでプルーニングされた後、空のパーツを削除します。

## remove_rolled_back_parts_immediately {#remove_rolled_back_parts_immediately} 

<ExperimentalBadge/>
<SettingsInfoBlock type="Bool" default_value="1" />

未完成の実験的機能のための設定です。

## remove_unused_patch_parts {#remove_unused_patch_parts} 
<SettingsInfoBlock type="Bool" default_value="1" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.5"},{"label": "1"},{"label": "New setting"}]}]}/>

すべてのアクティブなパーツに適用されるパッチパーツをバックグラウンドで削除します。

## replace_long_file_name_to_hash {#replace_long_file_name_to_hash} 
<SettingsInfoBlock type="Bool" default_value="1" />

カラムのファイル名が長すぎる場合（'max_file_name_length'バイトを超える）、これをSipHash128に置き換えます。

## replicated_can_become_leader {#replicated_can_become_leader} 
<SettingsInfoBlock type="Bool" default_value="1" />

もしtrueなら、このノードのレプリカでレプリケーションされたテーブルがリーダーシップを取得しようとします。

可能な値：
- `true`
- `false`

## replicated_deduplication_window {#replicated_deduplication_window} 
<SettingsInfoBlock type="UInt64" default_value="1000" />

ClickHouse Keeperが重複を確認するために保持する、最近挿入されたブロックの数。

可能な値：
- 任意の正の整数。
- 0（重複排除を無効にする）

`Insert`コマンドは1つ以上のブロック（パーツ）を作成します。[挿入の重複排除](../../engines/table-engines/mergetree-family/replication.md)の目的で、レプリケートテーブルに書き込む際、ClickHouseは作成されたパーツのハッシュの合計をClickHouse Keeperに書き込みます。ハッシュの合計は、最近の`replicated_deduplication_window`ブロックのみに保持されます。最古のハッシュの合計はClickHouse Keeperから削除されます。

`replicated_deduplication_window`の大きな数は`Inserts`を遅くします。なぜなら、比較すべきエントリが増えるからです。ハッシュの合計は、フィールド名と型の構成と挿入されたパーツのデータ（バイトストリーム）から計算されます。

## replicated_deduplication_window_for_async_inserts {#replicated_deduplication_window_for_async_inserts} 
<SettingsInfoBlock type="UInt64" default_value="10000" />

最近非同期に挿入されたブロックの数について、ClickHouse Keeperが重複を確認するためにハッシュの合計を保持します。

可能な値：
- 任意の正の整数。
- 0（非同期挿入の重複排除を無効にする）

[非同期挿入](/operations/settings/settings#async_insert)コマンドは1つ以上のブロック（パーツ）にキャッシュされます。[挿入の重複排除](/engines/table-engines/mergetree-family/replication)のために、レプリケートテーブルに書き込む際、ClickHouseは各挿入のハッシュの合計をClickHouse Keeperに書き込みます。ハッシュの合計は最近の`replicated_deduplication_window_for_async_inserts`ブロックのみに保持されます。最古のハッシュの合計はClickHouse Keeperから削除されます。

`replicated_deduplication_window_for_async_inserts`の大きな数は`Async Inserts`を遅くします。より多くのエントリを比較する必要があるからです。ハッシュの合計はフィールド名と型の構成および挿入されたデータ（バイトストリーム）から計算されます。

## replicated_deduplication_window_seconds {#replicated_deduplication_window_seconds} 
<SettingsInfoBlock type="UInt64" default_value="604800" />

挿入されたブロックのハッシュの合計がClickHouse Keeperから削除されるまでの秒数。

可能な値：
- 任意の正の整数。

[replicated_deduplication_window](#replicated_deduplication_window)と同様に、`replicated_deduplication_window_seconds`は挿入の重複排除のためにハッシュの合計をどのくらいの期間保持するかを指定します。`replicated_deduplication_window_seconds`より古いハッシュの合計はClickHouse Keeperから削除されます。`replicated_deduplication_window`未満の場合でも適用されます。

この時間は、最新のレコードの時間に対して相対的であり、壁の時間に対してではありません。唯一のレコードである場合、このレコードは永遠に保持されます。

## replicated_deduplication_window_seconds_for_async_inserts {#replicated_deduplication_window_seconds_for_async_inserts} 
<SettingsInfoBlock type="UInt64" default_value="604800" />

非同期挿入のハッシュの合計がClickHouse Keeperから削除されるまでの秒数。

可能な値：
- 任意の正の整数。

[replicated_deduplication_window_for_async_inserts](#replicated_deduplication_window_for_async_inserts)と同様に、`replicated_deduplication_window_seconds_for_async_inserts`は非同期挿入の重複排除のためにハッシュの合計をどのくらいの期間保持するかを指定します。`replicated_deduplication_window_seconds_for_async_inserts`より古いハッシュの合計はClickHouse Keeperから削除されます。`replicated_deduplication_window_for_async_inserts`未満の場合でも適用されます。

この時間は、最新のレコードの時間に対して相対的であり、壁の時間に対してではありません。唯一のレコードである場合、このレコードは永遠に保持されます。

## replicated_fetches_http_connection_timeout {#replicated_fetches_http_connection_timeout} 
<SettingsInfoBlock type="Seconds" default_value="0" />
廃止された設定で、何も行いません。

## replicated_fetches_http_receive_timeout {#replicated_fetches_http_receive_timeout} 
<SettingsInfoBlock type="Seconds" default_value="0" />
廃止された設定で、何も行いません。

## replicated_fetches_http_send_timeout {#replicated_fetches_http_send_timeout} 
<SettingsInfoBlock type="Seconds" default_value="0" />
廃止された設定で、何も行いません。

## replicated_max_mutations_in_one_entry {#replicated_max_mutations_in_one_entry} 
<SettingsInfoBlock type="UInt64" default_value="10000" />

1つのMUTATE_PARTエントリでまとめて実行できる最大のミューテーションコマンド数（0は無制限を意味します）。

## replicated_max_parallel_fetches {#replicated_max_parallel_fetches} 
<SettingsInfoBlock type="UInt64" default_value="0" />
廃止された設定で、何も行いません。

## replicated_max_parallel_fetches_for_host {#replicated_max_parallel_fetches_for_host} 
<SettingsInfoBlock type="UInt64" default_value="15" />
廃止された設定で、何も行いません。

## replicated_max_parallel_fetches_for_table {#replicated_max_parallel_fetches_for_table} 
<SettingsInfoBlock type="UInt64" default_value="0" />
廃止された設定で、何も行いません。

## replicated_max_parallel_sends {#replicated_max_parallel_sends} 
<SettingsInfoBlock type="UInt64" default_value="0" />
廃止された設定で、何も行いません。

## replicated_max_parallel_sends_for_table {#replicated_max_parallel_sends_for_table} 
<SettingsInfoBlock type="UInt64" default_value="0" />
廃止された設定で、何も行いません。

## replicated_max_ratio_of_wrong_parts {#replicated_max_ratio_of_wrong_parts} 
<SettingsInfoBlock type="Float" default_value="0.5" />

間違ったパーツの割合が全パーツの数よりもこの値以下であれば開始を許可します。

可能な値：
- Float、0.0 - 1.0

## shared_merge_tree_create_per_replica_metadata_nodes {#shared_merge_tree_create_per_replica_metadata_nodes} 
<SettingsInfoBlock type="Bool" default_value="1" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "1"},{"label": "Cloud sync"}]}]}/>

ZooKeeperにおけるレプリカごとの/metadataおよび/columnsノードの作成を有効にします。ClickHouse Cloudでのみ利用可能です。

## shared_merge_tree_disable_merges_and_mutations_assignment {#shared_merge_tree_disable_merges_and_mutations_assignment} 
<SettingsInfoBlock type="Bool" default_value="0" />

共有マージツリーのマージ割り当てを停止します。ClickHouse Cloudでのみ利用可能です。

## shared_merge_tree_enable_coordinated_merges {#shared_merge_tree_enable_coordinated_merges} 

<ExperimentalBadge/>
<SettingsInfoBlock type="Bool" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.5"},{"label": "0"},{"label": "New setting"}]}]}/>

コーディネートマージ戦略を有効にします。

## shared_merge_tree_enable_keeper_parts_extra_data {#shared_merge_tree_enable_keeper_parts_extra_data} 

<ExperimentalBadge/>
<SettingsInfoBlock type="Bool" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.3"},{"label": "0"},{"label": "New setting"}]}]}/>

仮想パーツ内に属性を書き込み、キーパーでブロックをコミットすることを有効にします。

## shared_merge_tree_enable_outdated_parts_check {#shared_merge_tree_enable_outdated_parts_check} 
<SettingsInfoBlock type="Bool" default_value="1" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "1"},{"label": "Cloud sync"}]}]}/>

古いパーツのチェックを有効にします。ClickHouse Cloudでのみ利用可能です。

## shared_merge_tree_idle_parts_update_seconds {#shared_merge_tree_idle_parts_update_seconds} 
<SettingsInfoBlock type="UInt64" default_value="3600" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "3600"},{"label": "Cloud sync"}]}]}/>

共有マージツリーのZooKeeperウォッチによってトリガーされずにパーツの更新を行う間隔（秒）。ClickHouse Cloudでのみ利用可能です。

## shared_merge_tree_initial_parts_update_backoff_ms {#shared_merge_tree_initial_parts_update_backoff_ms} 
<SettingsInfoBlock type="UInt64" default_value="50" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.2"},{"label": "50"},{"label": "New setting"}]}]}/>

パーツの更新のための初期バックオフ。ClickHouse Cloudでのみ利用可能です。

## shared_merge_tree_interserver_http_connection_timeout_ms {#shared_merge_tree_interserver_http_connection_timeout_ms} 
<SettingsInfoBlock type="UInt64" default_value="100" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.2"},{"label": "100"},{"label": "New setting"}]}]}/>

サーバー間HTTP接続のためのタイムアウト。ClickHouse Cloudでのみ利用可能です。

## shared_merge_tree_interserver_http_timeout_ms {#shared_merge_tree_interserver_http_timeout_ms} 
<SettingsInfoBlock type="UInt64" default_value="10000" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "10000"},{"label": "Cloud sync"}]}]}/>

サーバー間HTTP通信のためのタイムアウト。ClickHouse Cloudでのみ利用可能です。

## shared_merge_tree_leader_update_period_random_add_seconds {#shared_merge_tree_leader_update_period_random_add_seconds} 
<SettingsInfoBlock type="UInt64" default_value="10" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "10"},{"label": "Cloud sync"}]}]}/>

集中して負荷がかかる現象を避けるために、shared_merge_tree_leader_update_periodに0からx秒の均等に分布した値を追加します。ClickHouse Cloudでのみ利用可能です。

## shared_merge_tree_leader_update_period_seconds {#shared_merge_tree_leader_update_period_seconds} 
<SettingsInfoBlock type="UInt64" default_value="30" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "30"},{"label": "Cloud sync"}]}]}/>

パーツの更新のためにリーダーシップを再チェックする最大期間。ClickHouse Cloudでのみ利用可能です。

## shared_merge_tree_max_outdated_parts_to_process_at_once {#shared_merge_tree_max_outdated_parts_to_process_at_once} 
<SettingsInfoBlock type="UInt64" default_value="1000" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "1000"},{"label": "Cloud sync"}]}]}/>

1回のHTTPリクエストでリーダーが削除のために確認しようとする最大の古いパーツ数。ClickHouse Cloudでのみ利用可能です。

## shared_merge_tree_max_parts_update_backoff_ms {#shared_merge_tree_max_parts_update_backoff_ms} 
<SettingsInfoBlock type="UInt64" default_value="5000" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.2"},{"label": "5000"},{"label": "New setting"}]}]}/>

パーツの更新に関する最大バックオフ。ClickHouse Cloudでのみ利用可能です。

## shared_merge_tree_max_parts_update_leaders_in_total {#shared_merge_tree_max_parts_update_leaders_in_total} 
<SettingsInfoBlock type="UInt64" default_value="6" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "6"},{"label": "Cloud sync"}]}]}/>

最大のパーツ更新リーダー数。ClickHouse Cloudでのみ利用可能です。

## shared_merge_tree_max_parts_update_leaders_per_az {#shared_merge_tree_max_parts_update_leaders_per_az} 
<SettingsInfoBlock type="UInt64" default_value="2" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "2"},{"label": "Cloud sync"}]}]}/>

エリアごとの最大のパーツ更新リーダー数。ClickHouse Cloudでのみ利用可能です。

## shared_merge_tree_max_replicas_for_parts_deletion {#shared_merge_tree_max_replicas_for_parts_deletion} 
<SettingsInfoBlock type="UInt64" default_value="10" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "10"},{"label": "Cloud sync"}]}]}/>

パーツ削除に参加する最大のレプリカ数（キラースレッド）。ClickHouse Cloudでのみ利用可能です。

## shared_merge_tree_max_replicas_to_merge_parts_for_each_parts_range {#shared_merge_tree_max_replicas_to_merge_parts_for_each_parts_range} 
<SettingsInfoBlock type="UInt64" default_value="5" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "5"},{"label": "Cloud sync"}]}]}/>

各パーツ範囲に対してパーツのマージを試みる最大のレプリカ数（マージ割り当てにおける冗長な競合を回避するのを助ける）。0は無効を意味します。ClickHouse Cloudでのみ利用可能です。

## shared_merge_tree_max_suspicious_broken_parts {#shared_merge_tree_max_suspicious_broken_parts} 
<SettingsInfoBlock type="UInt64" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.2"},{"label": "0"},{"label": "SMTのための最大壊れたパーツ数、それ以上は自動解除を拒否する"}]}]}/>

SMTのための最大壊れたパーツ数、それ以上は自動解除を拒否します。

## shared_merge_tree_max_suspicious_broken_parts_bytes {#shared_merge_tree_max_suspicious_broken_parts_bytes} 
<SettingsInfoBlock type="UInt64" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.2"},{"label": "0"},{"label": "SMTのためのすべての壊れたパーツの最大サイズ、それ以上は自動解除を拒否する"}]}]}/>

SMTのためのすべての壊れたパーツの最大サイズ、それ以上は自動解除を拒否します。
## shared_merge_tree_memo_ids_remove_timeout_seconds {#shared_merge_tree_memo_ids_remove_timeout_seconds} 
<SettingsInfoBlock type="Int64" default_value="1800" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "1800"},{"label": "Cloud sync"}]}]}/>


挿入のリトライ中に誤ったアクションを避けるために、挿入メモ化IDをどのくらいの期間保存するか。ClickHouse Cloud でのみ利用可能です。
## shared_merge_tree_merge_coordinator_election_check_period_ms {#shared_merge_tree_merge_coordinator_election_check_period_ms} 

<ExperimentalBadge/>
<SettingsInfoBlock type="Milliseconds" default_value="30000" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.5"},{"label": "30000"},{"label": "New setting"}]}]}/>


マージコーディネーター選挙スレッドの実行間隔
## shared_merge_tree_merge_coordinator_factor {#shared_merge_tree_merge_coordinator_factor} 

<ExperimentalBadge/>
<SettingsInfoBlock type="UInt64" default_value="2" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.5"},{"label": "2"},{"label": "New setting"}]}]}/>


コーディネータースレッドの遅延の変化要因
## shared_merge_tree_merge_coordinator_fetch_fresh_metadata_period_ms {#shared_merge_tree_merge_coordinator_fetch_fresh_metadata_period_ms} 

<ExperimentalBadge/>
<SettingsInfoBlock type="Milliseconds" default_value="10000" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.5"},{"label": "10000"},{"label": "New setting"}]}]}/>


マージコーディネーターが新しいメタデータを取得するために zookeeper と同期する頻度
## shared_merge_tree_merge_coordinator_max_merge_request_size {#shared_merge_tree_merge_coordinator_max_merge_request_size} 

<ExperimentalBadge/>
<SettingsInfoBlock type="UInt64" default_value="20" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.5"},{"label": "20"},{"label": "New setting"}]}]}/>


コーディネーターが MergerMutator に一度にリクエストできるマージの数
## shared_merge_tree_merge_coordinator_max_period_ms {#shared_merge_tree_merge_coordinator_max_period_ms} 

<ExperimentalBadge/>
<SettingsInfoBlock type="Milliseconds" default_value="10000" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.5"},{"label": "10000"},{"label": "New setting"}]}]}/>


マージコーディネータースレッドの実行間隔の最大時間
## shared_merge_tree_merge_coordinator_merges_prepare_count {#shared_merge_tree_merge_coordinator_merges_prepare_count} 

<ExperimentalBadge/>
<SettingsInfoBlock type="UInt64" default_value="100" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.5"},{"label": "100"},{"label": "New setting"}]}]}/>


コーディネーターが準備し、ワーカーに配布すべきマージエントリの数
## shared_merge_tree_merge_coordinator_min_period_ms {#shared_merge_tree_merge_coordinator_min_period_ms} 

<ExperimentalBadge/>
<SettingsInfoBlock type="Milliseconds" default_value="1" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.5"},{"label": "1"},{"label": "New setting"}]}]}/>


マージコーディネータースレッドの実行間隔の最小時間
## shared_merge_tree_merge_worker_fast_timeout_ms {#shared_merge_tree_merge_worker_fast_timeout_ms} 

<ExperimentalBadge/>
<SettingsInfoBlock type="Milliseconds" default_value="100" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.5"},{"label": "100"},{"label": "New setting"}]}]}/>


マージワーカースレッドが即時のアクションの後に状態を更新する必要がある場合に使用するタイムアウト
## shared_merge_tree_merge_worker_regular_timeout_ms {#shared_merge_tree_merge_worker_regular_timeout_ms} 

<ExperimentalBadge/>
<SettingsInfoBlock type="Milliseconds" default_value="10000" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.5"},{"label": "10000"},{"label": "New setting"}]}]}/>


マージワーカースレッドの実行間隔
## shared_merge_tree_partitions_hint_ratio_to_reload_merge_pred_for_mutations {#shared_merge_tree_partitions_hint_ratio_to_reload_merge_pred_for_mutations} 
<SettingsInfoBlock type="Float" default_value="0.5" />

`<candidate partitions for mutations only (partitions that cannot be merged)>/<candidate partitions for mutations>` の比率がこの設定を超えた場合に、マージ/ミューテート選択タスクでマージ述語を再読み込みします。ClickHouse Cloud でのみ利用可能です。
## shared_merge_tree_parts_load_batch_size {#shared_merge_tree_parts_load_batch_size} 
<SettingsInfoBlock type="UInt64" default_value="32" />

一度にスケジュール可能なフェッチ部分メタデータジョブの量。ClickHouse Cloud でのみ利用可能です。
## shared_merge_tree_postpone_next_merge_for_locally_merged_parts_ms {#shared_merge_tree_postpone_next_merge_for_locally_merged_parts_ms} 
<SettingsInfoBlock type="UInt64" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "0"},{"label": "Cloud sync"}]}]}/>


ローカルでマージされたパーツを保持する時間。これにより、他のレプリカがパーツを取得し、このマージを開始できる機会を与えます。ClickHouse Cloud でのみ利用可能です。
## shared_merge_tree_postpone_next_merge_for_locally_merged_parts_rows_threshold {#shared_merge_tree_postpone_next_merge_for_locally_merged_parts_rows_threshold} 
<SettingsInfoBlock type="UInt64" default_value="1000000" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "1000000"},{"label": "Cloud sync"}]}]}/>


ローカルでマージされた後に次のマージを延期するためのパーツの最小サイズ（行数）。ClickHouse Cloud でのみ利用可能です。
## shared_merge_tree_range_for_merge_window_size {#shared_merge_tree_range_for_merge_window_size} 
<SettingsInfoBlock type="UInt64" default_value="10" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "10"},{"label": "Cloud sync"}]}]}/>


ローカルでマージされたパーツを保持する時間。これにより、他のレプリカがパーツを取得し、このマージを開始できる機会を与えます。ClickHouse Cloud でのみ利用可能です。
## shared_merge_tree_read_virtual_parts_from_leader {#shared_merge_tree_read_virtual_parts_from_leader} 
<SettingsInfoBlock type="Bool" default_value="1" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "1"},{"label": "Cloud sync"}]}]}/>


可能な場合、リーダーから仮想パーツを読み取ります。ClickHouse Cloud でのみ利用可能です。
## shared_merge_tree_try_fetch_part_in_memory_data_from_replicas {#shared_merge_tree_try_fetch_part_in_memory_data_from_replicas} 
<SettingsInfoBlock type="Bool" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "0"},{"label": "New setting to fetch parts data from other replicas"}]}]}/>


有効にすると、すべてのレプリカが他のレプリカからメモリ上のデータ（プライマリキー、パーティション情報など）を取得しようとします。
## shared_merge_tree_use_metadata_hints_cache {#shared_merge_tree_use_metadata_hints_cache} 
<SettingsInfoBlock type="Bool" default_value="1" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "1"},{"label": "Cloud sync"}]}]}/>


他のレプリカのメモリ内キャッシュから FS キャッシュヒントを要求することを有効にします。ClickHouse Cloud でのみ利用可能です。
## shared_merge_tree_use_outdated_parts_compact_format {#shared_merge_tree_use_outdated_parts_compact_format} 
<SettingsInfoBlock type="Bool" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "0"},{"label": "Cloud sync"}]}]}/>


古いパーツのコンパクトフォーマットを使用します：Keeperへの負荷を軽減し、古いパーツの処理を改善します。ClickHouse Cloud でのみ利用可能です。
## shared_merge_tree_use_too_many_parts_count_from_virtual_parts {#shared_merge_tree_use_too_many_parts_count_from_virtual_parts} 
<SettingsInfoBlock type="Bool" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.1"},{"label": "0"},{"label": "Cloud sync"}]}]}/>


有効にすると、多すぎるパーツのカウンターはローカルレプリカの状態ではなく、Keeper の共有データに依存します。ClickHouse Cloud でのみ利用可能です。
## simultaneous_parts_removal_limit {#simultaneous_parts_removal_limit} 
<SettingsInfoBlock type="UInt64" default_value="0" />

古いパーツが多数ある場合、クリーンスレッドは1回の反復中に`simultaneous_parts_removal_limit`個のパーツを削除しようとします。`simultaneous_parts_removal_limit`が`0`に設定されている場合、無制限を意味します。
## sleep_before_commit_local_part_in_replicated_table_ms {#sleep_before_commit_local_part_in_replicated_table_ms} 
<SettingsInfoBlock type="Milliseconds" default_value="0" />

テスト用です。変更しないでください。
## sleep_before_loading_outdated_parts_ms {#sleep_before_loading_outdated_parts_ms} 
<SettingsInfoBlock type="UInt64" default_value="0" />

テスト用です。変更しないでください。
## storage_policy {#storage_policy} 
<SettingsInfoBlock type="String" default_value="default" />

ストレージディスクポリシーの名前
## table_disk {#table_disk} 
<SettingsInfoBlock type="Bool" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.2"},{"label": "0"},{"label": "New setting"}]}]}/>


これはテーブルディスクであり、パス/エンドポイントはデータベースデータではなくテーブルデータを指す必要があります。s3_plain/s3_plain_rewritable/web のみ設定できます。
## temporary_directories_lifetime {#temporary_directories_lifetime} 
<SettingsInfoBlock type="Seconds" default_value="86400" />

tmp_-ディレクトリを保持する秒数。この値を低く設定しないでください。マージやミューテーションがこの設定の低い値で機能できなくなる可能性があります。
## try_fetch_recompressed_part_timeout {#try_fetch_recompressed_part_timeout} 
<SettingsInfoBlock type="Seconds" default_value="7200" />

再圧縮とのマージを開始する前のタイムアウト（秒単位）。この間、ClickHouseは再圧縮を伴うマージを割り当てられたレプリカから再圧縮されたパーツを取得しようとします。

ほとんどのケースで再圧縮は遅いため、このタイムアウトが終了するまで再圧縮を伴うマージを開始せず、再圧縮されたパーツを取得しようとします。

可能な値：
- 任意の正の整数。
## ttl_only_drop_parts {#ttl_only_drop_parts} 
<SettingsInfoBlock type="Bool" default_value="0" />

MergeTree テーブルで、すべての行がその `TTL` 設定に従って期限切れになったときにデータパーツが完全に削除されるかどうかを制御します。

`ttl_only_drop_parts` が無効（デフォルト）になっている場合、TTL 設定に基づいて期限切れになった行のみが削除されます。

`ttl_only_drop_parts` が有効になっている場合、そのパーツ内のすべての行が TTL 設定に従って期限切れになった場合、全体のパーツが削除されます。
## use_adaptive_write_buffer_for_dynamic_subcolumns {#use_adaptive_write_buffer_for_dynamic_subcolumns} 
<SettingsInfoBlock type="Bool" default_value="1" />

動的サブカラムを書き込む際にメモリ使用量を減らすために、適応型ライターバッファの使用を許可します。
## use_async_block_ids_cache {#use_async_block_ids_cache} 
<SettingsInfoBlock type="Bool" default_value="1" />

TRUEの場合、非同期挿入のハッシュサムをキャッシュします。

可能な値：
- `true`
- `false`

複数の非同期挿入を持つブロックは、複数のハッシュサムを生成します。
挿入の一部が重複している場合、Keeperは1つのRPCで重複したハッシュサムをのみ返し、これにより不要なRPCの再試行が発生します。このキャッシュはKeeper内のハッシュサムパスを監視します。Keeperで更新が監視されると、キャッシュはできるだけ早く更新され、メモリ内の重複する挿入をフィルタリングできるようになります。
## use_compact_variant_discriminators_serialization {#use_compact_variant_discriminators_serialization} 
<SettingsInfoBlock type="Bool" default_value="1" />

Variant データ型における識別子のバイナリシリアライズにコンパクトモードを有効にします。
このモードにより、ほとんど1つのバリアントか多くの NULL 値がある場合に、パーツ内に識別子を保存するために必要なメモリを大幅に減らすことができます。
## use_const_adaptive_granularity {#use_const_adaptive_granularity} 
<SettingsInfoBlock type="Bool" default_value="0" />

全体のパーツに対して一定の粒度を常に使用します。これにより、インデックス粒度の値をメモリ内で圧縮できます。非常に大規模なワークロードで薄いテーブルで役立つ場合があります。
## use_metadata_cache {#use_metadata_cache} 
<SettingsInfoBlock type="Bool" default_value="0" />
廃止された設定で、何もしません。
## use_minimalistic_checksums_in_zookeeper {#use_minimalistic_checksums_in_zookeeper} 
<SettingsInfoBlock type="Bool" default_value="1" />

ZooKeeper 内のパーツチェックサムに小さなフォーマット（数十バイト）を使用します。普通のフォーマット（数十KB）ではなく、すべてのレプリカが新しいフォーマットをサポートしていることを確認してから有効にしてください。
## use_minimalistic_part_header_in_zookeeper {#use_minimalistic_part_header_in_zookeeper} 
<SettingsInfoBlock type="Bool" default_value="1" />

ZooKeeper におけるデータパーツヘッダーの保存方法です。これを有効にすると、ZooKeeper が格納するデータが少なくなります。詳細は [こちら](/operations/server-configuration-parameters/settings#use_minimalistic_part_header_in_zookeeper) を参照してください。
## use_primary_key_cache {#use_primary_key_cache} 
<SettingsInfoBlock type="Bool" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "24.12"},{"label": "0"},{"label": "New setting"}]}]}/>

すべてのインデックスをメモリに保存するのではなく、プライマリインデックスのためのキャッシュを使用します。非常に大きなテーブルで役立つ場合があります。
## vertical_merge_algorithm_min_bytes_to_activate {#vertical_merge_algorithm_min_bytes_to_activate} 
<SettingsInfoBlock type="UInt64" default_value="0" />

垂直マージアルゴリズムを有効にするためのマージパーツの最小（おおよその）未圧縮サイズ（バイト単位）。
## vertical_merge_algorithm_min_columns_to_activate {#vertical_merge_algorithm_min_columns_to_activate} 
<SettingsInfoBlock type="UInt64" default_value="11" />

垂直マージアルゴリズムを有効にするための最小の非PKカラム数。
## vertical_merge_algorithm_min_rows_to_activate {#vertical_merge_algorithm_min_rows_to_activate} 
<SettingsInfoBlock type="UInt64" default_value="131072" />

垂直マージアルゴリズムを有効にするためのマージパーツの最小（おおよその）行数の合計。
## vertical_merge_remote_filesystem_prefetch {#vertical_merge_remote_filesystem_prefetch} 
<SettingsInfoBlock type="Bool" default_value="1" />

TRUEの場合、マージ中の次のカラムのためにリモートファイルシステムからデータをプレフェッチします。
## wait_for_unique_parts_send_before_shutdown_ms {#wait_for_unique_parts_send_before_shutdown_ms} 
<SettingsInfoBlock type="Milliseconds" default_value="0" />

シャットダウン前に、ユニークパーツ（現在のレプリカにのみ存在する）を他のレプリカが取得するために必要な間隔待機します（0は無効を意味します）。
## write_ahead_log_bytes_to_fsync {#write_ahead_log_bytes_to_fsync} 
<SettingsInfoBlock type="UInt64" default_value="104857600" />
廃止された設定で、何もしません。
## write_ahead_log_interval_ms_to_fsync {#write_ahead_log_interval_ms_to_fsync} 
<SettingsInfoBlock type="UInt64" default_value="100" />
廃止された設定で、何もしません。
## write_ahead_log_max_bytes {#write_ahead_log_max_bytes} 
<SettingsInfoBlock type="UInt64" default_value="1073741824" />
廃止された設定で、何もしません。
## write_final_mark {#write_final_mark} 
<SettingsInfoBlock type="Bool" default_value="1" />
廃止された設定で、何もしません。
## write_marks_for_substreams_in_compact_parts {#write_marks_for_substreams_in_compact_parts} 
<SettingsInfoBlock type="Bool" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.5"},{"label": "0"},{"label": "New setting"}]}]}/>


コンパクトパーツ内の各サブストリームごとにマークを記録することを有効にします。これにより、データパーツから個別のサブカラムを効率的に読み取ることが可能になります。
## zero_copy_concurrent_part_removal_max_postpone_ratio {#zero_copy_concurrent_part_removal_max_postpone_ratio} 
<SettingsInfoBlock type="Float" default_value="0.05" />

より小さな独立した範囲を取得するために削除を延期する最上位パーツの最大割合。変更しないことをお勧めします。
## zero_copy_concurrent_part_removal_max_split_times {#zero_copy_concurrent_part_removal_max_split_times} 
<SettingsInfoBlock type="UInt64" default_value="5" />

独立した古いパーツ範囲を小さなサブレンジに分割するための最大再帰深度。変更しないことをお勧めします。
## zero_copy_merge_mutation_min_parts_size_sleep_before_lock {#zero_copy_merge_mutation_min_parts_size_sleep_before_lock} 
<SettingsInfoBlock type="UInt64" default_value="1073741824" />

ゼロコピーのレプリケーションが有効になっている場合、マージまたはミューテーションのためにロックを試みる前に、パーツのサイズに応じてランダムな時間スリープします。
## zero_copy_merge_mutation_min_parts_size_sleep_no_scale_before_lock {#zero_copy_merge_mutation_min_parts_size_sleep_no_scale_before_lock} 
<SettingsInfoBlock type="UInt64" default_value="0" />
<VersionHistory rows={[{"id": "row-1","items": [{"label": "25.3"},{"label": "0"},{"label": "New setting"}]}]}/>


ゼロコピーのレプリケーションが有効になっている場合、マージまたはミューテーションのためにロックを試みる前に、最大500ミリ秒の間ランダムな時間スリープします。
## zookeeper_session_expiration_check_period {#zookeeper_session_expiration_check_period} 
<SettingsInfoBlock type="Seconds" default_value="60" />

ZooKeeper セッションの有効期限切れを確認する間隔（秒単位）。

可能な値：
- 任意の正の整数。
