---
description: 'Системная таблица, содержащая метрики, которые периодически рассчитываются в фоновом режиме. Например, объем используемой оперативной памяти.'
keywords: ['системная таблица', 'асинхронные метрики']
slug: /operations/system-tables/asynchronous_metrics
title: 'system.asynchronous_metrics'
---

import SystemTableCloud from '@site/i18n/ru/docusaurus-plugin-content-docs/current/_snippets/_system_table_cloud.md';

# system.asynchronous_metrics

<SystemTableCloud/>

Содержит метрики, которые периодически рассчитываются в фоновом режиме. Например, объем используемой оперативной памяти.

Столбцы:

- `metric` ([String](../../sql-reference/data-types/string.md)) — Название метрики.
- `value` ([Float64](../../sql-reference/data-types/float.md)) — Значение метрики.
- `description` ([String](../../sql-reference/data-types/string.md)) — Описание метрики.

**Пример**

```sql
SELECT * FROM system.asynchronous_metrics LIMIT 10
```

```text
┌─metric──────────────────────────────────┬──────value─┬─description────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│ AsynchronousMetricsCalculationTimeSpent │ 0.00179053 │ Время в секундах, затраченное на расчет асинхронных метрик (это накладные расходы асинхронных метрик).                                                                                                                                              │
│ NumberOfDetachedByUserParts             │          0 │ Общее количество частей, открепленных от таблиц MergeTree пользователями с помощью запроса `ALTER TABLE DETACH` (в отличие от неожиданных, поврежденных или игнорируемых частей). Сервер не заботится об открепленных частях, и они могут быть удалены.                          │
│ NumberOfDetachedParts                   │          0 │ Общее количество частей, открепленных от таблиц MergeTree. Часть может быть откреплена пользователем с помощью запроса `ALTER TABLE DETACH` или самим сервером в случае, если часть повреждена, неожиданна или не нужна. Сервер не заботится об открепленных частях, и они могут быть удалены. │
│ TotalRowsOfMergeTreeTables              │    2781309 │ Общее количество строк (записей), хранящихся во всех таблицах семейства MergeTree.                                                                                                                                                                                   │
│ TotalBytesOfMergeTreeTables             │    7741926 │ Общее количество байт (сжато, включая данные и индексы), хранящихся во всех таблицах семейства MergeTree.                                                                                                                                                   │
│ NumberOfTables                          │         93 │ Общее количество таблиц, суммируемое по базам данных на сервере, исключая базы данных, которые не могут содержать таблицы MergeTree. Исключенные движки баз данных — это те, которые создают набор таблиц на лету, такие как `Lazy`, `MySQL`, `PostgreSQL`, `SQlite`. │
│ NumberOfDatabases                       │          6 │ Общее количество баз данных на сервере.                                                                                                                                                                                                                   │
│ MaxPartCountForPartition                │          6 │ Максимальное количество частей на раздел для всех разделов всех таблиц семейства MergeTree. Значения больше 300 указывают на неправильную конфигурацию, перегрузку или массовую загрузку данных.                                                                       │
│ ReplicasSumMergesInQueue                │          0 │ Сумма операций слияния в очереди (которые еще предстоит применить) в распределенных таблицах.                                                                                                                                                                       │
│ ReplicasSumInsertsInQueue               │          0 │ Сумма операций INSERT в очереди (которые еще предстоит реплицировать) в распределенных таблицах.                                                                                                                                                                   │
└─────────────────────────────────────────┴────────────┴────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

<!--- В отличие от system.events и system.metrics, асинхронные метрики не собираются в простом списке в файле исходного кода - они смешаны с логикой в src/Interpreters/ServerAsynchronousMetrics.cpp. Перечисление их здесь, для удобства читателя. --->
## Описания метрик {#metric-descriptions}
### AsynchronousHeavyMetricsCalculationTimeSpent {#asynchronousheavymetricscalculationtimespent}

Время в секундах, затраченное на расчет асинхронных тяжелых (связанных с таблицами) метрик (это накладные расходы асинхронных метрик).
### AsynchronousHeavyMetricsUpdateInterval {#asynchronousheavymetricsupdateinterval}

Интервал обновления тяжелых (связанных с таблицами) метрик.
### AsynchronousMetricsCalculationTimeSpent {#asynchronousmetricscalculationtimespent}

Время в секундах, затраченное на расчет асинхронных метрик (это накладные расходы асинхронных метрик).
### AsynchronousMetricsUpdateInterval {#asynchronousmetricsupdateinterval}

Интервал обновления метрик.
### BlockActiveTime_*name* {#blockactivetime_name}

Время в секундах, в течение которого блок-устройство имело очередь запросов IO. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt
### BlockDiscardBytes_*name* {#blockdiscardbytes_name}

КоличествоDiscarded bytes на блок-устройстве. Эти операции актуальны для SSD. Операции удаления не используются ClickHouse, но могут использоваться другими процессами в системе. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt
### BlockDiscardMerges_*name* {#blockdiscardmerges_name}

Количество операций удаления, запрашиваемых с блока и объединяемых ОС-IO планировщиком. Эти операции актуальны для SSD. Операции удаления не используются ClickHouse, но могут использоваться другими процессами в системе. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt
### BlockDiscardOps_*name* {#blockdiscardops_name}

Количество операций удаления, запрашиваемых на блок-устройстве. Эти операции актуальны для SSD. Операции удаления не используются ClickHouse, но могут использоваться другими процессами в системе. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt
### BlockDiscardTime_*name* {#blockdiscardtime_name}

Время в секундах, проведенное на операциях удаления, запрашиваемых с блока, суммированное по всем операциям. Эти операции актуальны для SSD. Операции удаления не используются ClickHouse, но могут использоваться другими процессами в системе. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt
### BlockInFlightOps_*name* {#blockinflightops_name}

Это значение учитывает число запросов I/O, которые были выданы драйверу устройства, но еще не завершены. Это не включает запросы IO, которые находятся в очереди, но еще не были выданы драйверу устройства. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt
### BlockQueueTime_*name* {#blockqueuetime_name}

Это значение учитывает количество миллисекунд, которые запросы IO ожидали на этом блок-устройстве. Если несколько запросов IO ждут, это значение увеличится как произведение числа миллисекунд на количество ожидающих запросов. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt
### BlockReadBytes_*name* {#blockreadbytes_name}

Количество байт, прочитанных с блока-устройства. Это может быть меньше, чем количество байт, прочитанных из файловой системы из-за использования кэша страниц ОС, который экономит IO. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt
### BlockReadMerges_*name* {#blockreadmerges_name}

Количество операций чтения, запрашиваемых с блока-устройства и объединяемых ОС-IO планировщиком. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt
### BlockReadOps_*name* {#blockreadops_name}

Количество операций чтения, запрашиваемых с блока-устройства. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt
### BlockReadTime_*name* {#blockreadtime_name}

Время в секундах, проведенное на операциях чтения, запрашиваемых с блока-устройства, суммированное по всем операциям. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt
### BlockWriteBytes_*name* {#blockwritebytes_name}

Количество байт, записанных на блок-устройство. Это может быть меньше, чем количество байт, записанных в файловую систему из-за использования кэша страниц ОС, который экономит IO. Запись на блок-устройство может произойти позже, чем соответствующая запись в файловую систему из-за кэширования записи. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt
### BlockWriteMerges_*name* {#blockwritemerges_name}

Количество операций записи, запрашиваемых с блок-устройства и объединяемых ОС-IO планировщиком. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt
### BlockWriteOps_*name* {#blockwriteops_name}

Количество операций записи, запрашиваемых с блок-устройства. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt
### BlockWriteTime_*name* {#blockwritetime_name}

Время в секундах, проведенное на операциях записи, запрашиваемых с блок-устройства, суммированное по всем операциям. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Источник: `/sys/block`. См. https://www.kernel.org/doc/Documentation/block/stat.txt
### CPUFrequencyMHz_*name* {#cpufrequencymhz_name}

Текущая частота CPU, в МГц. Большинство современных CPU динамически регулируют частоту для экономии энергии и Turbo Boost.
### CompiledExpressionCacheBytes {#compiledexpressioncachebytes}

Общее количество байт, используемых для кэша JIT-скомпилированного кода.
### CompiledExpressionCacheCount {#compiledexpressioncachecount}

Общее количество записей в кэше JIT-скомпилированного кода.
### DiskAvailable_*name* {#diskavailable_name}

Доступные байты на диске (виртуальная файловая система). Удаленные файловые системы могут показывать большие значения, такие как 16 EiB.
### DiskTotal_*name* {#disktotal_name}

Общий размер в байтах диска (виртуальная файловая система). Удаленные файловые системы могут показывать большие значения, такие как 16 EiB.
### DiskUnreserved_*name* {#diskunreserved_name}

Доступные байты на диске (виртуальная файловая система) без резервирования для слияний, извлечений и перемещений. Удаленные файловые системы могут показывать большие значения, такие как 16 EiB.
### DiskUsed_*name* {#diskused_name}

Используемые байты на диске (виртуальная файловая система). Удаленные файловые системы не всегда предоставляют эту информацию.
### FilesystemCacheBytes {#filesystemcachebytes}

Общее количество байт в виртуальной файловой системе `cache`. Этот кэш хранится на диске.
### FilesystemCacheFiles {#filesystemcachefiles}

Общее количество сегментов файлов в кэше виртуальной файловой системы `cache`. Этот кэш хранится на диске.
### FilesystemLogsPathAvailableBytes {#filesystemlogspathavailablebytes}

Доступные байты на разделе, где смонтирован путь журнала ClickHouse. Если это значение приближается к нулю, вам следует настроить ротацию журналов в файле конфигурации.
### FilesystemLogsPathAvailableINodes {#filesystemlogspathavailableinodes}

Количество доступных инодов на разделе, где смонтирован путь журнала ClickHouse.
### FilesystemLogsPathTotalBytes {#filesystemlogspathtotalbytes}

Размер раздела, на котором смонтирован путь журнала ClickHouse, в байтах. Рекомендуется иметь не менее 10 ГБ для журналов.
### FilesystemLogsPathTotalINodes {#filesystemlogspathtotalinodes}

Общее количество инодов на разделе, где смонтирован путь журнала ClickHouse.
### FilesystemLogsPathUsedBytes {#filesystemlogspathusedbytes}

Используемые байты на разделе, где смонтирован путь журнала ClickHouse.
### FilesystemLogsPathUsedINodes {#filesystemlogspathusedinodes}

Количество использованных инодов на разделе, где смонтирован путь журнала ClickHouse.
### FilesystemMainPathAvailableBytes {#filesystemmainpathavailablebytes}

Доступные байты на разделе, где смонтирован основной путь ClickHouse.
### FilesystemMainPathAvailableINodes {#filesystemmainpathavailableinodes}

Количество доступных инодов на разделе, где смонтирован основной путь ClickHouse. Если оно близко к нулю, это указывает на неправильную конфигурацию, и вы получите сообщение 'недостаточно места на устройстве', даже когда диск не заполнен.
### FilesystemMainPathTotalBytes {#filesystemmainpathtotalbytes}

Размер раздела, где смонтирован основной путь ClickHouse, в байтах.
### FilesystemMainPathTotalINodes {#filesystemmainpathtotalinodes}

Общее количество инодов на разделе, где смонтирован основной путь ClickHouse. Если оно меньше 25 миллионов, это указывает на неправильную конфигурацию.
### FilesystemMainPathUsedBytes {#filesystemmainpathusedbytes}

Используемые байты на разделе, где смонтирован основной путь ClickHouse.
### FilesystemMainPathUsedINodes {#filesystemmainpathusedinodes}

Количество использованных инодов на разделе, где смонтирован основной путь ClickHouse. Это значение в основном соответствует количеству файлов.
### HTTPThreads {#httpthreads}

Количество потоков в сервере HTTP-интерфейса (без TLS).
### InterserverThreads {#interserverthreads}

Количество потоков в сервере протокола коммуникации реплик (без TLS).
### Jitter {#jitter}

Разница во времени, когда поток для расчета асинхронных метрик был запланирован для пробуждения и времени, когда он фактически проснулся. Прокси-показатель общей задержки и отклика системы.
### LoadAverage*N* {#loadaveragen}

Общая нагрузка системы, усредненная с экспоненциальным сглаживанием за 1 минуту. Нагрузка представляет количество потоков среди всех процессов (сущностей планирования ядра ОС), которые в данный момент выполняются процессором или ожидают IO, или готовы к выполнению, но в данный момент не планируются. Это число включает все процессы, а не только clickhouse-server. Число может превышать количество ядер CPU, если система перегружена, и многие процессы готовы к выполнению, но ожидают CPU или IO.
### MMapCacheCells {#mmapcachecells}

Количество файлов, открытых с помощью `mmap` (отображенных в памяти). Это используется для запросов с установленной конфигурацией `local_filesystem_read_method`, установленной на `mmap`. Файлы, открытые с помощью `mmap`, хранятся в кэше, чтобы избежать затратных сбросов TLB.
### MarkCacheBytes {#markcachebytes}

Общий размер кэша меток в байтах.
### MarkCacheFiles {#markcachefiles}

Общее количество файлов меток в кэше меток.
### MaxPartCountForPartition {#maxpartcountforpartition}

Максимальное количество частей на раздел для всех разделов всех таблиц семейства MergeTree. Значения больше 300 указывают на неправильную конфигурацию, перегрузку или массовую загрузку данных.
### MemoryCode {#memorycode}

Общее количество виртуальной памяти, распределенной для страниц машинного кода процесса сервера, в байтах.
### MemoryDataAndStack {#memorydataandstack}

Количество виртуальной памяти, распределенной для использования стека и для выделенной памяти, в байтах. Не указано, включает ли это стеки на потоках и большую часть выделенной памяти, которая выделяется с помощью системного вызова 'mmap'. Эта метрика существует только по причине полноты. Я рекомендую использовать метрику `MemoryResident` для мониторинга.
### MemoryResidentMax {#memoryresidentmax}

Максимальное количество физической памяти, используемой процессом сервера, в байтах.
### MemoryResident {#memoryresident}

Количество физической памяти, используемой процессом сервера, в байтах.
### MemoryShared {#memoryshared}

Количество памяти, используемой процессом сервера, которая также используется другими процессами, в байтах. ClickHouse не использует совместно используемую память, но некоторая память может быть обозначена ОС как совместно используемая по своим причинам. Эта метрика не имеет большого смысла для наблюдения и существует только для полноты.
### MemoryVirtual {#memoryvirtual}

Размер виртуального адресного пространства, выделенного процессом сервера, в байтах. Размер виртуального адресного пространства обычно намного больше, чем потребление физической памяти, и не должен использоваться в качестве оценки потребления памяти. Большие значения этой метрики полностью нормальны и имеют только технический смысл.
### MySQLThreads {#mysqlthreads}

Количество потоков в сервере протокола совместимости MySQL.
### NetworkReceiveBytes_*name* {#networkreceivebytes_name}

Количество байт, полученных через сетевой интерфейс. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server.
### NetworkReceiveDrop_*name* {#networkreceivedrop_name}

Количество байт, потерянных пакетом при получении через сетевой интерфейс. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server.
### NetworkReceiveErrors_*name* {#networkreceiveerrors_name}

Количество раз, когда произошла ошибка во время получения через сетевой интерфейс. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server.
### NetworkReceivePackets_*name* {#networkreceivepackets_name}

Количество сетевых пакетов, полученных через сетевой интерфейс. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server.
### NetworkSendBytes_*name* {#networksendbytes_name}

Количество байт, отправленных через сетевой интерфейс. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server.
### NetworkSendDrop_*name* {#networksenddrop_name}

Количество раз, когда пакет был потерян при отправке через сетевой интерфейс. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server.
### NetworkSendErrors_*name* {#networksenderrors_name}

Количество раз, когда произошла ошибка (например, повторная передача TCP) во время отправки через сетевой интерфейс. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server.
### NetworkSendPackets_*name* {#networksendpackets_name}

Количество сетевых пакетов, отправленных через сетевой интерфейс. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server.
### NumberOfDatabases {#numberofdatabases}

Общее количество баз данных на сервере.
### NumberOfDetachedByUserParts {#numberofdetachedbyuserparts}

Общее количество частей, открепленных от таблиц MergeTree пользователями с помощью запроса `ALTER TABLE DETACH` (в отличие от неожиданных, поврежденных или игнорируемых частей). Сервер не заботится об открепленных частях, и они могут быть удалены.
### NumberOfDetachedParts {#numberofdetachedparts}

Общее количество частей, открепленных от таблиц MergeTree. Часть может быть откреплена пользователем с помощью запроса `ALTER TABLE DETACH` или самим сервером в случае, если часть повреждена, неожиданна или не нужна. Сервер не заботится об открепленных частях, и они могут быть удалены.
### NumberOfTables {#numberoftables}

Общее количество таблиц, суммируемое по базам данных на сервере, исключая базы данных, которые не могут содержать таблицы MergeTree. Исключенные движки баз данных — это те, которые создают набор таблиц на лету, такие как `Lazy`, `MySQL`, `PostgreSQL`, `SQlite`.
### OSContextSwitches {#oscontextswitches}

Количество переключений контекста, произошедших в системе на хост-машине. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server.
### OSGuestNiceTime {#osguestnicetime}

Соотношение времени, затраченного на выполнение виртуального CPU для гостевых операционных систем под контролем ядра Linux, когда гость был установлен на более высокий приоритет (см. `man procfs`). Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Эта метрика не имеет значения для ClickHouse, но все же существует для полноты. Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU рассчитывается как сумма по всем ядрам [0..num cores].
### OSGuestNiceTimeCPU_*N* {#osguestnicetimecpu_n}

Соотношение времени, затраченного на выполнение виртуального CPU для гостевых операционных систем под контролем ядра Linux, когда гость был установлен на более высокий приоритет (см. `man procfs`). Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Эта метрика не имеет значения для ClickHouse, но все же существует для полноты. Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU рассчитывается как сумма по всем ядрам [0..num cores].
### OSGuestNiceTimeNormalized {#osguestnicetimenormalized}

Значение аналогично `OSGuestNiceTime`, но делится на количество ядер CPU, чтобы быть измеряемым в интервале [0..1], независимо от количества ядер. Это позволяет усреднить значения этой метрики по нескольким серверам в кластере, даже если количество ядер неоднородно, и все еще получить усредненный показатель использования ресурсов.
### OSGuestTime {#osguesttime}

Соотношение времени, затраченного на выполнение виртуального CPU для гостевых операционных систем под контролем ядра Linux (см. `man procfs`). Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Эта метрика не имеет значения для ClickHouse, но все же существует для полноты. Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU рассчитывается как сумма по всем ядрам [0..num cores].
### OSGuestTimeCPU_*N* {#osguesttimecpu_n}

Соотношение времени, затраченного на выполнение виртуального CPU для гостевых операционных систем под контролем ядра Linux (см. `man procfs`). Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Эта метрика не имеет значения для ClickHouse, но все же существует для полноты. Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU рассчитывается как сумма по всем ядрам [0..num cores].
### OSGuestTimeNormalized {#osguesttimenormalized}

Значение аналогично `OSGuestTime`, но делится на количество ядер CPU, чтобы быть измеряемым в интервале [0..1], независимо от количества ядер. Это позволяет усреднить значения этой метрики по нескольким серверам в кластере, даже если количество ядер неоднородно, и все еще получить усредненный показатель использования ресурсов.
### OSIOWaitTime {#osiowaittime}

Соотношение времени, в течение которого ядро CPU не выполняло код, но когда ядро ОС не запускало другие процессы на этом CPU, так как процессы ожидали IO. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU рассчитывается как сумма по всем ядрам [0..num cores].
### OSIOWaitTimeCPU_*N* {#osiowaittimecpu_n}

Соотношение времени, в течение которого ядро CPU не выполняло код, но когда ядро ОС не запускало другие процессы на этом CPU, так как процессы ожидали IO. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU рассчитывается как сумма по всем ядрам [0..num cores].
### OSIOWaitTimeNormalized {#osiowaittimenormalized}

Значение аналогично `OSIOWaitTime`, но делится на количество ядер CPU, чтобы быть измеряемым в интервале [0..1], независимо от количества ядер. Это позволяет усреднить значения этой метрики по нескольким серверам в кластере, даже если количество ядер неоднородно, и все еще получить усредненный показатель использования ресурсов.
### OSIdleTime {#osidletime}

Соотношение времени, в течение которого ядро CPU было бездействующим (даже не готовым к запуску процесса, ожидающего IO) с точки зрения ядра ОС. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Это не включает время, когда CPU использовался недостаточно из-за причин, внутренних для CPU (загрузки памяти, зависания конвейера, ошибочные прогнозы ветвлений, работа другого SMT-ядра). Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU рассчитывается как сумма по всем ядрам [0..num cores].
### OSIdleTimeCPU_*N* {#osidletimecpu_n}

Соотношение времени, в течение которого ядро CPU было бездействующим (даже не готовым к запуску процесса, ожидающего IO) с точки зрения ядра ОС. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Это не включает время, когда CPU использовался недостаточно из-за причин, внутренних для CPU (загрузки памяти, зависания конвейера, ошибочные прогнозы ветвлений, работа другого SMT-ядра). Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU рассчитывается как сумма по всем ядрам [0..num cores].
### OSIdleTimeNormalized {#osidletimenormalized}

Значение аналогично `OSIdleTime`, но делится на количество ядер CPU, чтобы быть измеряемым в интервале [0..1], независимо от количества ядер. Это позволяет усреднить значения этой метрики по нескольким серверам в кластере, даже если количество ядер неоднородно, и все еще получить усредненный показатель использования ресурсов.
### OSInterrupts {#osinterrupts}

Количество прерываний на хост-машине. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server.
### OSIrqTime {#osirqtime}

Соотношение времени, затраченного на выполнение аппаратных запросов прерываний на CPU. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Высокое значение этой метрики может указывать на неправильную конфигурацию оборудования или очень высокую нагрузку сети. Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU рассчитывается как сумма по всем ядрам [0..num cores].
### OSIrqTimeCPU_*N* {#osirqtimecpu_n}

Соотношение времени, затраченного на выполнение аппаратных запросов прерываний на CPU. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server. Высокое значение этой метрики может указывать на неправильную конфигурацию оборудования или очень высокую нагрузку сети. Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU рассчитывается как сумма по всем ядрам [0..num cores].
### OSIrqTimeNormalized {#osirqtimenormalized}

Значение аналогично `OSIrqTime`, но делится на количество ядер CPU, чтобы быть измеряемым в интервале [0..1], независимо от количества ядер. Это позволяет усреднить значения этой метрики по нескольким серверам в кластере, даже если количество ядер неоднородно, и все еще получить усредненный показатель использования ресурсов.
### OSMemoryAvailable {#osmemoryavailable}

Количество памяти, доступной для использования программами, в байтах. Это очень похоже на метрику `OSMemoryFreePlusCached`. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server.
### OSMemoryBuffers {#osmemorybuffers}

Количество памяти, используемой буферами ядра ОС, в байтах. Обычно это должно быть небольшим, и большие значения могут указывать на неправильную конфигурацию ОС. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server.
### OSMemoryCached {#osmemorycached}

Количество памяти, используемой кэшем страниц ОС, в байтах. Обычно почти вся доступная память используется кэшем страниц ОС — высокие значения этой метрики нормальны и ожидаемы. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server.
### OSMemoryFreePlusCached {#osmemoryfreepluscached}

Количество свободной памяти плюс память кэша страниц ОС на хост-системе, в байтах. Эта память доступна для использования программами. Значение должно быть очень похоже на `OSMemoryAvailable`. Это метрика по всей системе, она включает все процессы на хост-машине, а не только clickhouse-server.
### OSMemoryFreeWithoutCached {#osmemoryfreewithoutcached}

Объем свободной памяти на хост-системе в байтах. Это значение не включает память, используемую кешем страниц ОС, в байтах. Память кеша страниц также доступна для использования программами, поэтому значение этой метрики может быть несколько запутанным. Вместо этого смотрите метрику `OSMemoryAvailable`. Для удобства мы также предоставляем метрику `OSMemoryFreePlusCached`, которая должна быть похожа на OSMemoryAvailable. Смотрите также https://www.linuxatemyram.com/. Это метрика на уровне системы, она включает все процессы на хост-машине, а не только clickhouse-server.
### OSMemoryTotal {#osmemorytotal}

Общее количество памяти на хост-системе в байтах.
### OSNiceTime {#osnicetime}

Соотношение времени, в течение которого ядро CPU выполняло код пользовательского пространства с более высоким приоритетом. Это метрика на уровне системы, она включает все процессы на хост-машине, а не только clickhouse-server. Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма этих значений [0..число ядер].
### OSNiceTimeCPU_*N* {#osnicetimecpu_n}

Соотношение времени, в течение которого ядро CPU выполняло код пользовательского пространства с более высоким приоритетом. Это метрика на уровне системы, она включает все процессы на хост-машине, а не только clickhouse-server. Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма этих значений [0..число ядер].
### OSNiceTimeNormalized {#osnicetimenormalized}

Значение похоже на `OSNiceTime`, но делится на количество ядер CPU, чтобы измеряться в интервале [0..1], независимо от количества ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер неравномерное, и по-прежнему получать среднюю метрику использования ресурсов.
### OSOpenFiles {#osopenfiles}

Общее количество открытых файлов на хост-машине. Это метрика на уровне системы, она включает все процессы на хост-машине, а не только clickhouse-server.
### OSProcessesBlocked {#osprocessesblocked}

Количество потоков, ожидающих завершения ввода-вывода (`man procfs`). Это метрика на уровне системы, она включает все процессы на хост-машине, а не только clickhouse-server.
### OSProcessesCreated {#osprocessescreated}

Количество созданных процессов. Это метрика на уровне системы, она включает все процессы на хост-машине, а не только clickhouse-server.
### OSProcessesRunning {#osprocessesrunning}

Количество потоков, готовых к выполнению (выполняющихся или ожидающих выполнения), по версии операционной системы. Это метрика на уровне системы, она включает все процессы на хост-машине, а не только clickhouse-server.
### OSSoftIrqTime {#ossoftirqtime}

Соотношение времени, затраченного на выполнение программных прерываний на CPU. Это метрика на уровне системы, она включает все процессы на хост-машине, а не только clickhouse-server. Высокое значение этой метрики может указывать на неэффективное программное обеспечение, работащее на системе. Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма этих значений [0..число ядер].
### OSSoftIrqTimeCPU_*N* {#ossoftirqtimecpu_n}

Соотношение времени, затраченного на выполнение программных прерываний на CPU. Это метрика на уровне системы, она включает все процессы на хост-машине, а не только clickhouse-server. Высокое значение этой метрики может указывать на неэффективное программное обеспечение, работающее на системе. Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма этих значений [0..число ядер].
### OSSoftIrqTimeNormalized {#ossoftirqtimenormalized}

Значение похоже на `OSSoftIrqTime`, но делится на количество ядер CPU, чтобы измеряться в интервале [0..1], независимо от количества ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер неравномерное, и по-прежнему получать среднюю метрику использования ресурсов.
### OSStealTime {#osstealtime}

Соотношение времени, затраченного CPU на работу в других операционных системах при работе в виртуализированной среде. Это метрика на уровне системы, она включает все процессы на хост-машине, а не только clickhouse-server. Не каждая виртуализированная среда предоставляет эту метрику, и большинство из них этого не делает. Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма этих значений [0..число ядер].
### OSStealTimeCPU_*N* {#osstealtimecpu_n}

Соотношение времени, затраченного CPU на работу в других операционных системах при работе в виртуализированной среде. Это метрика на уровне системы, она включает все процессы на хост-машине, а не только clickhouse-server. Не каждая виртуализированная среда предоставляет эту метрику, и большинство из них этого не делает. Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма этих значений [0..число ядер].
### OSStealTimeNormalized {#osstealtimenormalized}

Значение похоже на `OSStealTime`, но делится на количество ядер CPU, чтобы измеряться в интервале [0..1], независимо от количества ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер неравномерное, и по-прежнему получать среднюю метрику использования ресурсов.
### OSSystemTime {#ossystemtime}

Соотношение времени, в течение которого ядро CPU выполняло код ядра ОС (системный код). Это метрика на уровне системы, она включает все процессы на хост-машине, а не только clickhouse-server. Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма этих значений [0..число ядер].
### OSSystemTimeCPU_*N* {#ossystemtimecpu_n}

Соотношение времени, в течение которого ядро CPU выполняло код ядра ОС (системный код). Это метрика на уровне системы, она включает все процессы на хост-машине, а не только clickhouse-server. Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма этих значений [0..число ядер].
### OSSystemTimeNormalized {#ossystemtimenormalized}

Значение похоже на `OSSystemTime`, но делится на количество ядер CPU, чтобы измеряться в интервале [0..1], независимо от количества ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер неравномерное, и по-прежнему получать среднюю метрику использования ресурсов.
### OSThreadsRunnable {#osthreadsrunnable}

Общее количество "выполнимых" потоков, по версии планировщика ядра ОС.
### OSThreadsTotal {#osthreadstotal}

Общее количество потоков, по версии планировщика ядра ОС.
### OSUptime {#osuptime}

Время работы хост-сервера (машина, на которой запущен ClickHouse) в секундах.
### OSUserTime {#osusertime}

Соотношение времени, в течение которого ядро CPU выполняло код пользовательского пространства. Это метрика на уровне системы, она включает все процессы на хост-машине, а не только clickhouse-server. Это также включает время, когда CPU был частично недозагружен по причинам, внутренним для CPU (загрузки памяти, зависания в конвейере, неверные предсказания ветвлений, работа другого ядра SMT). Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма этих значений [0..число ядер].
### OSUserTimeCPU_*N* {#osusertimecpu_n}

Соотношение времени, в течение которого ядро CPU выполняло код пользовательского пространства. Это метрика на уровне системы, она включает все процессы на хост-машине, а не только clickhouse-server. Это также включает время, когда CPU был частично недозагружен по причинам, внутренним для CPU (загрузки памяти, зависания в конвейере, неверные предсказания ветвлений, работа другого ядра SMT). Значение для одного ядра CPU будет в интервале [0..1]. Значение для всех ядер CPU вычисляется как сумма этих значений [0..число ядер].
### OSUserTimeNormalized {#osusertimenormalized}

Значение похоже на `OSUserTime`, но делится на количество ядер CPU, чтобы измеряться в интервале [0..1], независимо от количества ядер. Это позволяет усреднять значения этой метрики по нескольким серверам в кластере, даже если количество ядер неравномерное, и по-прежнему получать среднюю метрику использования ресурсов.
### PostgreSQLThreads {#postgresqlthreads}

Количество потоков на сервере протокола совместимости PostgreSQL.
### QueryCacheBytes {#querycachebytes}

Общий размер кэша запросов в байтах.
### QueryCacheEntries {#querycacheentries}

Общее количество записей в кэше запросов.
### ReplicasMaxAbsoluteDelay {#replicasmaxabsolutedelay}

Максимальная разница в секундах между самой свежей реплицированной частью и самой свежей частью данных, которая еще не была реплицирована, по всем реплицированным таблицам. Очень высокое значение указывает на реплику без данных.
### ReplicasMaxInsertsInQueue {#replicasmaxinsertsinqueue}

Максимальное количество операций INSERT в очереди (еще не реплицированных) по всем реплицированным таблицам.
### ReplicasMaxMergesInQueue {#replicasmaxmergesinqueue}

Максимальное количество операций слияния в очереди (еще не примененных) по всем реплицированным таблицам.
### ReplicasMaxQueueSize {#replicasmaxqueuesize}

Максимальный размер очереди (в количестве операций, таких как get, merge) по всем реплицированным таблицам.
### ReplicasMaxRelativeDelay {#replicasmaxrelativedelay}

Максимальная разница между задержкой реплики и задержкой самой актуальной реплики той же таблицы, по всем реплицированным таблицам.
### ReplicasSumInsertsInQueue {#replicassuminsertsinqueue}

Сумма операций INSERT в очереди (еще не реплицированных) по всем реплицированным таблицам.
### ReplicasSumMergesInQueue {#replicassummergesinqueue}

Сумма операций слияния в очереди (еще не примененных) по всем реплицированным таблицам.
### ReplicasSumQueueSize {#replicassumqueuesize}

Сумма размера очереди (в количестве операций, таких как get, merge) по всем реплицированным таблицам.
### TCPThreads {#tcpthreads}

Количество потоков в сервере протокола TCP (без TLS).
### Temperature_*N* {#temperature_n}

Температура соответствующего устройства в ℃. Датчик может возвращать нереалистичное значение. Источник: `/sys/class/thermal`
### Temperature_*name* {#temperature_name}

Температура, сообщаемая соответствующим аппаратным монитором и соответствующим датчиком в ℃. Датчик может возвращать нереалистичное значение. Источник: `/sys/class/hwmon`
### TotalBytesOfMergeTreeTables {#totalbytesofmergetreetables}

Общее количество байт (сжатых, включая данные и индексы), хранящихся во всех таблицах семейства MergeTree.
### TotalPartsOfMergeTreeTables {#totalpartsofmergetreetables}

Общее количество частей данных во всех таблицах семейства MergeTree. Числа больше 10 000 негативно влияют на время запуска сервера и могут указывать на неразумный выбор ключа раздела.
### TotalPrimaryKeyBytesInMemory {#totalprimarykeybytesinmemory}

Общее количество памяти (в байтах), используемой значениями первичного ключа (учитываются только активные части).
### TotalPrimaryKeyBytesInMemoryAllocated {#totalprimarykeybytesinmemoryallocated}

Общее количество памяти (в байтах), зарезервированной для значений первичного ключа (учитываются только активные части).
### TotalRowsOfMergeTreeTables {#totalrowsofmergetreetables}

Общее количество строк (записей), хранящихся во всех таблицах семейства MergeTree.
### UncompressedCacheBytes {#uncompressedcachebytes}

Общий размер несжатого кэша в байтах. Несжато кэш обычно не увеличивает производительность и его стоит избегать.
### UncompressedCacheCells {#uncompressedcachecells}

Общее количество записей в несжатом кэше. Каждая запись представляет собой распакованный блок данных. Несжатый кэш обычно не увеличивает производительность и его стоит избегать.
### Uptime {#uptime}

Время работы сервера в секундах. Включает время, затраченное на инициализацию сервера перед принятием соединений.
### jemalloc.active {#jemallocactive}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html
### jemalloc.allocated {#jemallocallocated}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html
### jemalloc.arenas.all.dirty_purged {#jemallocarenasalldirty_purged}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html
### jemalloc.arenas.all.muzzy_purged {#jemallocarenasallmuzzy_purged}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html
### jemalloc.arenas.all.pactive {#jemallocarenasallpactive}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html
### jemalloc.arenas.all.pdirty {#jemallocarenasallpdirty}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html
### jemalloc.arenas.all.pmuzzy {#jemallocarenasallpmuzzy}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html
### jemalloc.background_thread.num_runs {#jemallocbackground_threadnum_runs}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html
### jemalloc.background_thread.num_threads {#jemallocbackground_threadnum_threads}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html
### jemalloc.background_thread.run_intervals {#jemallocbackground_threadrun_intervals}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html
### jemalloc.epoch {#jemallocepoch}

Внутренний номер инкрементного обновления статистики jemalloc (аллокатора памяти Джейсона Эванса), используемый во всех других метриках `jemalloc`.
### jemalloc.mapped {#jemallocmapped}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html
### jemalloc.metadata {#jemallocmetadata}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html
### jemalloc.metadata_thp {#jemallocmetadata_thp}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html
### jemalloc.resident {#jemallocresident}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html
### jemalloc.retained {#jemallocretained}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html
### jemalloc.prof.active {#jemallocprofactive}

Внутренняя метрика низкоуровневого аллокатора памяти (jemalloc). См. https://jemalloc.net/jemalloc.3.html

**Смотрите также**

- [Monitoring](../../operations/monitoring.md) — Основные концепции мониторинга ClickHouse.
- [system.metrics](/operations/system-tables/metrics) — Содержит моментально вычисляемые метрики.
- [system.events](/operations/system-tables/events) — Содержит ряд произошедших событий.
- [system.metric_log](/operations/system-tables/metric_log) — Содержит историю значений метрик из таблиц `system.metrics` и `system.events`.
