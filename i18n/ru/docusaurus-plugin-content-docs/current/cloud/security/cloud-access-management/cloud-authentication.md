---
sidebar_label: 'Аутентификация в облаке'
slug: /cloud/security/cloud-authentication
title: 'Аутентификация в облаке'
description: 'Этот гид объясняет некоторые хорошие практики для настройки вашей аутентификации.'
---

import ScalePlanFeatureBadge from '@theme/badges/ScalePlanFeatureBadge'
import EnterprisePlanFeatureBadge from '@theme/badges/EnterprisePlanFeatureBadge'


# Аутентификация в облаке

ClickHouse Cloud предоставляет несколько способов для аутентификации. Этот гид объясняет некоторые хорошие практики для настройки вашей аутентификации. Всегда консультируйтесь с вашей командой безопасности при выборе методов аутентификации.

## Настройки пароля {#password-settings}

Минимальные настройки пароля для нашей консоли и сервисов (баз данных) в настоящее время соответствуют [NIST 800-63B](https://pages.nist.gov/800-63-3/sp800-63b.html#sec4) Уровень уверенности аутентификатора 1:
- Минимум 12 символов
- Включает 3 из следующих 4 элементов:
   - 1 заглавную букву
   - 1 строчную букву
   - 1 цифру
   - 1 специальный символ

## Email + Пароль {#email--password}

ClickHouse Cloud позволяет вам аутентифицироваться с помощью адреса электронной почты и пароля. При использовании этого метода лучший способ защитить вашу учетную запись ClickHouse - использовать надежный пароль. Существует много онлайн-ресурсов, которые помогут вам придумать запоминающийся пароль. В качестве альтернативы вы можете использовать генератор случайных паролей и хранить свой пароль в менеджере паролей для повышения безопасности.

## SSO с помощью Google или Microsoft Социальной аутентификации {#sso-using-google-or-microsoft-social-authentication}

Если ваша компания использует Google Workspace или Microsoft 365, вы можете использовать вашу текущую настройку единого входа в ClickHouse Cloud. Для этого просто зарегистрируйтесь, используя адрес электронной почты вашей компании, и пригласите других пользователей, используя их корпоративные электронные почты. Эффект заключается в том, что ваши пользователи должны войти в систему, используя ваши корпоративные потоки входа, будь то через вашего провайдера идентификации или непосредственно через аутентификацию Google или Microsoft, прежде чем они смогут аутентифицироваться в ClickHouse Cloud. 

## Многофакторная аутентификация {#multi-factor-authentication}

Пользователи с email + паролем или социальной аутентификацией могут дополнительно обеспечить безопасность своей учетной записи, используя многофакторную аутентификацию (MFA). Чтобы настроить MFA:
1. Войдите в console.clickhouse.cloud
2. Нажмите на свои инициалы в верхнем левом углу рядом с логотипом ClickHouse
3. Выберите Профиль
4. Выберите Безопасность слева
5. Нажмите Настроить на плитке в приложении аутентификатора
6. Используйте приложение аутентификатора, такое как Authy, 1Password или Google Authenticator, чтобы отсканировать QR-код
7. Введите код для подтверждения
8. На следующем экране скопируйте код восстановления и сохраните его в надежном месте
9. Установите галочку рядом с `Я безопасно записал этот код`
10. Нажмите Продолжить
    
## Восстановление учетной записи {#account-recovery}

<details> 
   <summary>Получить код восстановления</summary>

   Если вы ранее зарегистрировались в MFA и либо не создали, либо потеряли свой код восстановления, выполните следующие шаги, чтобы получить новый код восстановления:
   1. Перейдите на https://console.clickhouse.cloud
   2. Войдите с вашими учетными данными и MFA
   3. Перейдите в ваш профиль в верхнем левом углу
   4. Нажмите Безопасность слева
   5. Нажмите на корзину рядом с вашим приложением аутентификатора
   6. Нажмите Удалить приложение аутентификатора
   7. Введите ваш код и нажмите Продолжить
   8. Нажмите Настроить в разделе приложения аутентификатора
   9. Отсканируйте QR-код и введите новый код
   10. Скопируйте ваш код восстановления и сохраните его в надежном месте
   11. Установите галочку рядом с `Я безопасно записал этот код`
   12. Нажмите Продолжить
   
</details>
<details>
   <summary>Забыл пароль</summary>

   Если вы забыли свой пароль, выполните следующие шаги для самостоятельного восстановления:
   1. Перейдите на https://console.clickhouse.cloud
   2. Введите ваш адрес электронной почты и нажмите Продолжить
   3. Нажмите Забыли пароль?
   4. Нажмите Отправить ссылку для сброса пароля
   5. Проверьте свою электронную почту и нажмите Сбросить пароль в письме
   6. Введите ваш новый пароль, подтвердите пароль и нажмите Обновить пароль
   7. Нажмите Назад к входу
   8. Войдите как обычно с вашим новым паролем
            
</details>
<details>
   <summary>Потерянное устройство или токен MFA</summary>

   Если вы потеряли ваше устройство MFA или удалили токен, выполните следующие шаги, чтобы восстановить и создать новый токен:
   1. Перейдите на https://console.clickhouse.cloud
   2. Введите ваши учетные данные и нажмите Продолжить
   3. На экране многофакторной аутентификации нажмите Отмена
   4. Нажмите Код восстановления
   5. Введите код и нажмите Продолжить
   6. Скопируйте новый код восстановления и сохраните его в надежном месте
   7. Установите галочку рядом с `Я безопасно записал этот код` и нажмите продолжить
   8. После входа перейдите в ваш профиль в верхнем левом углу
   9. Нажмите на безопасность в верхнем левом углу
   10. Нажмите на иконку корзины рядом с приложением аутентификатора, чтобы удалить ваш старый аутентификатор
   11. Нажмите Удалить приложение аутентификатора
   12. Когда вас попросят о вашей многофакторной аутентификации, нажмите Отмена
   13. Нажмите Код восстановления
   14. Введите ваш код восстановления (это новый код, сгенерированный на шаге 7) и нажмите Продолжить
   15. Скопируйте новый код восстановления и сохраните его в надежном месте - это запасной вариант на случай, если вы покинете экран во время процесса удаления
   16. Установите галочку рядом с `Я безопасно записал этот код` и нажмите Продолжить
   17. Следуйте процессу выше, чтобы настроить новый фактор MFA
       
</details>
<details>
   <summary>Потерянный MFA и код восстановления</summary>

   Если вы потеряли ваше устройство MFA И код восстановления или вы потеряли ваше устройство MFA и никогда не получили код восстановления, выполните следующие шаги, чтобы запросить сброс:

   **Отправьте запрос**: Если вы находитесь в организации, в которой есть другие административные пользователи, даже если вы пытаетесь получить доступ к организации с одним пользователем, спросите члена вашей организации, которому назначена роль администратора, войти в организацию и отправить тикет в службу поддержки для сброса вашего MFA от вашего имени. Как только мы подтвердим, что запрос прошел аутентификацию, мы сбросим ваш MFA и уведомим администратора. Войдите как обычно без MFA и перейдите в настройки вашего профиля, чтобы зарегистрировать новый фактор, если вы хотите.

   **Сброс через электронную почту**: Если вы единственный пользователь в организации, отправьте обращение в службу поддержки по электронной почте (support@clickhouse.com), используя адрес электронной почты, связанный с вашей учетной записью. Как только мы подтвердим, что запрос поступает с правильного адреса электронной почты, мы сбросим ваш MFA И пароль. Получите доступ к вашей электронной почте, чтобы перейти по ссылке для сброса пароля. Настройте новый пароль, а затем перейдите в настройки вашего профиля, чтобы зарегистрировать новый фактор, если вы хотите. 
   
</details>

## SAML SSO {#saml-sso}

<EnterprisePlanFeatureBadge feature="SAML SSO"/>

ClickHouse Cloud также поддерживает язык разметки утверждений безопасности (SAML) для единого входа (SSO). Для получения дополнительной информации см. [Настройка SAML SSO](/cloud/security/saml-setup).

## Идентификатор пользователя базы данных + Пароль {#database-user-id--password}

Используйте метод SHA256_hash при [создании учетных записей пользователей](/sql-reference/statements/create/user.md), чтобы защитить пароли.

**СОВЕТ:** Поскольку пользователи с менее чем административными привилегиями не могут устанавливать свои собственные пароли, попросите пользователя захешировать свой пароль с помощью генератора, 
таких как [этот](https://tools.keycdn.com/sha256-online-generator), прежде чем передать его администратору для настройки учетной записи. Пароли должны соответствовать [требованиям](#password-settings), указанным выше.

```sql
CREATE USER userName IDENTIFIED WITH sha256_hash BY 'hash';
```
