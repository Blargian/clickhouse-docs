---
description: '通常関数のドキュメント'
sidebar_label: '概要'
sidebar_position: 1
slug: /sql-reference/functions/overview
title: '通常関数'
---


# 通常関数

少なくとも\*二種類の関数があります - 通常関数（単に「関数」と呼ばれます）と集約関数です。これらは全く異なる概念です。通常関数は各行に個別に適用されるように機能します（各行に対して、関数の結果は他の行に依存しません）。集約関数は、さまざまな行からの値のセットを蓄積します（つまり、全行のセットに依存します）。

このセクションでは通常関数について説明します。集約関数については「集約関数」セクションを参照してください。

:::note 
['arrayJoin' 関数](../functions/array-join.md) は第三のタイプの関数に属します。また、[テーブル関数](../table-functions/index.md) も別に挙げることができます。
:::

## 強い型付け {#strong-typing}

標準SQLとは対照的に、ClickHouseは強い型付けを持っています。言い換えれば、型の間で暗黙の変換は行われません。各関数は特定の型のセットに対して動作します。これは、場合によっては型変換関数を使用する必要があることを意味します。

## 共通部分式の削除 {#common-subexpression-elimination}

同じAST（同じレコードまたは同じ文法解析の結果）を持つクエリ内の全ての式は、同一の値を持つと見なされます。このような式は連結され、一度だけ実行されます。識別可能なサブクエリもこの方法で削除されます。

## 結果の型 {#types-of-results}

全ての関数は、結果として単一の値を返します（いくつかの値やゼロの値ではありません）。結果の型は通常、引数の型によってのみ定義され、値によっては定義されません。例外はtupleElement関数（a.N演算子）およびtoFixedString関数です。

## 定数 {#constants}

簡潔さのために、特定の関数は一部の引数に対して定数のみで動作します。例えば、LIKE演算子の右側の引数は定数でなければなりません。
ほぼ全ての関数は、定数の引数に対して定数を返します。例外は乱数を生成する関数です。
'now'関数は、異なる時間に実行されたクエリに対して異なる値を返しますが、その結果は単一のクエリ内でのみ重要なため、定数と見なされます。
定数式も定数と見なされます（例えば、LIKE演算子の右半分は複数の定数から構築されることができます）。

関数は、定数および非定数の引数に対して異なる方法で実装される場合があります（異なるコードが実行されます）。しかし、定数と真のカラムの同じ値が含まれる場合、その結果は一致する必要があります。

## NULL処理 {#null-processing}

関数は次のように動作します：

- 引数のうち少なくとも1つが`NULL`である場合、関数の結果も`NULL`になります。
- 各関数の説明に個別に指定された特別な動作。ClickHouseのソースコードでは、これらの関数は`UseDefaultImplementationForNulls=false`を持っています。

## 不変性 {#constancy}

関数はその引数の値を変更できません - 変更は結果として返されます。このため、個別の関数を計算した結果は、クエリ内で関数が書かれる順序には依存しません。

## 高階関数 {#higher-order-functions}

### `->` 演算子およびlambda(params, expr)関数 {#arrow-operator-and-lambda}

高階関数は、関数的引数としてのみlambda関数を受け取ることができます。高階関数にlambda関数を渡すには`->`演算子を使用します。矢印の左側には形式的なパラメータがあり、任意のIDまたはタプル内の複数の形式的パラメータがあります。矢印の右側には、これらの形式的パラメータおよび任意のテーブルカラムを使用できる式があります。

例:

```python
x -> 2 * x
str -> str != Referer
```

複数の引数を受け取るlambda関数も高階関数に渡すことができます。この場合、高階関数にはこれらの引数に対応する同じ長さの複数の配列が渡されます。

一部の関数では、最初の引数（lambda関数）を省略できます。この場合、同一のマッピングが仮定されます。

## ユーザー定義関数 (UDFs) {#user-defined-functions-udfs}

ClickHouseはユーザー定義関数をサポートしています。詳細は[UDFs](../functions/udf.md)を参照してください。
