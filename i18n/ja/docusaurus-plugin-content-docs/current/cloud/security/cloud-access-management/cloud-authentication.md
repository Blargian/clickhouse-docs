---
sidebar_label: クラウド認証
slug: /cloud/security/cloud-authentication
title: クラウド認証
---

import ScalePlanFeatureBadge from '@theme/badges/ScalePlanFeatureBadge'
import EnterprisePlanFeatureBadge from '@theme/badges/EnterprisePlanFeatureBadge'

# クラウド認証

ClickHouse Cloudは、認証のためのいくつかの方法を提供しています。このガイドでは、認証を構成するための良いプラクティスを説明します。認証方法を選択する際は、常にセキュリティチームと確認してください。

## パスワード設定 {#password-settings}

私たちのコンソールとサービス（データベース）の最小パスワード設定は、現在[NIST 800-63B](https://pages.nist.gov/800-63-3/sp800-63b.html#sec4) 認証者保証レベル1に準拠しています：
- 最小12文字
- 以下の4項目のうち3つを含む：
   - 1つの大文字
   - 1つの小文字
   - 1つの数字
   - 1つの特殊文字

## メール + パスワード {#email--password}

ClickHouse Cloudでは、メールアドレスとパスワードで認証することができます。この方法を使用する際には、ClickHouseアカウントを保護するために強力なパスワードを使用するのが最良の方法です。覚えやすいパスワードを考えるための多くのオンラインリソースがあります。あるいは、ランダムパスワードジェネレーターを使用し、パスワードマネージャーにパスワードを保存することでセキュリティを向上させることもできます。

## SSO（GoogleまたはMicrosoftソーシャル認証を使用） {#sso-using-google-or-microsoft-social-authentication}

会社がGoogle WorkspaceまたはMicrosoft 365を使用している場合、ClickHouse Cloud内の現在のシングルサインオン設定を利用することができます。これを行うには、会社のメールアドレスを使用して登録し、他のユーザーを会社のメールで招待します。その結果、ユーザーはClickHouse Cloudに認証する前に、IDプロバイダーを介して、またはGoogleまたはMicrosoft認証を直接使用して、会社のログインフローでログインする必要があります。

## マルチファクター認証 {#multi-factor-authentication}

メール + パスワードまたはソーシャル認証を使用しているユーザーは、マルチファクター認証（MFA）を使用してアカウントをさらに安全にすることができます。MFAを設定するには：
1. console.clickhouse.cloudにログインします
2. ClickHouseロゴの横にある左上のあなたのイニシャルをクリックします
3. プロフィールを選択します
4. 左側でセキュリティを選択します
5. 認証アプリのタイルでセットアップをクリックします
6. Authy、1Password、またはGoogle Authenticatorなどの認証アプリを使用してQRコードをスキャンします
7. コードを入力して確認します
8. 次の画面で、リカバリーコードをコピーし、安全な場所に保管します
9. `このコードを安全に記録しました`の隣のボックスにチェックを入れます
10. 続けるをクリックします
    
## アカウント回復 {#account-recovery}

<details> 
   <summary>リカバリーコードを取得する</summary>

   以前にMFAに登録しており、リカバリーコードを作成していないか、紛失した場合は、新しいリカバリーコードを取得するために以下の手順に従ってください：
   1. https://console.clickhouse.cloud にアクセスします
   2. 認証情報とMFAでサインインします
   3. 左上隅のプロフィールに移動します
   4. 左側でセキュリティをクリックします
   5. 認証アプリの横にあるゴミ箱アイコンをクリックします
   6. 認証アプリを削除をクリックします
   7. コードを入力して続けるをクリックします
   8. 認証アプリセクションでセットアップをクリックします
   9. QRコードをスキャンし、新しいコードを入力します
   10. リカバリーコードをコピーし、安全な場所に保管します
   11. `このコードを安全に記録しました`の隣のボックスにチェックを入れます
   12. 続けるをクリックします
   
</details>
<details>
   <summary>パスワードを忘れた</summary>

   パスワードを忘れた場合は、次の手順でセルフサービス回復を行います：
   1. https://console.clickhouse.cloud にアクセスします
   2. メールアドレスを入力し、続けるをクリックします
   3. パスワードをお忘れですか？をクリックします
   4. パスワードリセットリンクを送信をクリックします
   5. メールを確認し、メールからパスワードをリセットをクリックします
   6. 新しいパスワードを入力し、確認した後、パスワードを更新をクリックします
   7. サインインに戻るをクリックします
   8. 新しいパスワードで通常通りサインインします
            
</details>
<details>
   <summary>MFAデバイスまたはトークンを紛失した</summary>

   MFAデバイスを紛失した場合、またはトークンを削除した場合、新しいトークンを回復して作成するために以下の手順に従ってください：
   1. https://console.clickhouse.cloud にアクセスします
   2. 認証情報を入力し、続けるをクリックします
   3. マルチファクター認証画面でキャンセルをクリックします
   4. リカバリーコードをクリックします
   5. コードを入力し、続けるを押します
   6. 新しいリカバリーコードをコピーし、安全な場所に保管します
   7. `このコードを安全に記録しました`の隣のボックスにチェックを入れ、続けるをクリックします
   8. サインインしたら、左上のプロフィールに移動します
   9. 左上のセキュリティをクリックします
   10. 認証アプリの横にあるゴミ箱アイコンをクリックし、古い認証器を削除します
   11. 認証アプリを削除をクリックします
   12. マルチファクター認証のプロンプトが表示されたら、キャンセルをクリックします
   13. リカバリーコードをクリックします
   14. リカバリーコードを入力します（これはステップ7で生成された新しいコードです）そして、続けるをクリックします
   15. 新しいリカバリーコードをコピーし、安全な場所に保管します - これは、削除プロセス中に画面を離れた場合の保険です
   16. `このコードを安全に記録しました`の隣のボックスにチェックを入れ、続けるをクリックします
   17. 上記のプロセスに従って新しいMFAファクターを設定します
       
</details>
<details>
   <summary>MFAとリカバリーコードを紛失した</summary>

   MFAデバイスとリカバリーコードの両方を紛失した場合、またはMFAデバイスを紛失し、リカバリーコードを取得していない場合は、リセットをリクエストするために次の手順に従ってください：

   **チケットを提出する**： 他の管理ユーザーがいる組織に所属している場合、たとえ単一ユーザーの組織にアクセスしようとしている場合でも、管理者役割が割り当てられた組織のメンバーに、組織にログインしてMFAのリセットを代わりにサポートチケットを提出するように頼んでください。リクエストが認証されていることを確認後、MFAをリセットし、管理者に通知します。通常通りサインインし、希望があれば新しいファクターを登録するためにプロフィール設定に移動します。

   **メールでリセット**： 組織で唯一のユーザーの場合、アカウントに関連付けられたメールアドレスを使用して、メール（support@clickhouse.com）経由でサポートケースを提出します。リクエストが正しいメールから来ていることを確認後、MFAとパスワードをリセットします。メールにアクセスし、パスワードリセットリンクにアクセスします。新しいパスワードを設定し、希望があれば新しいファクターを登録するためにプロフィール設定に移動します。
   
</details>

## SAML SSO {#saml-sso}

<EnterprisePlanFeatureBadge feature="SAML SSO"/>

ClickHouse Cloudは、セキュリティアサーションマークアップ言語（SAML）シングルサインオン（SSO）をサポートしています。詳細については、[SAML SSO設定](/cloud/security/saml-setup)を参照してください。

## データベースユーザーID + パスワード {#database-user-id--password}

ユーザーアカウントを[作成する際](/sql-reference/statements/create/user.md)は、SHA256_hashメソッドを使用してパスワードを保護してください。

**ヒント:** 管理権限を持たないユーザーは自分でパスワードを設定できないため、ユーザーにハッシュジェネレーターを使用してパスワードをハッシュしてもらうように依頼してください。
例えば[こちら](https://tools.keycdn.com/sha256-online-generator)を使用して生成することができます。パスワードは前述の[要件](#password-settings)に従う必要があります。

```sql
CREATE USER userName IDENTIFIED WITH sha256_hash BY 'hash';
```
