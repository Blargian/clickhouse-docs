---
sidebar_label: アップグレード
slug: /manage/updates
---

import EnterprisePlanFeatureBadge from '@theme/badges/EnterprisePlanFeatureBadge'
import ScalePlanFeatureBadge from '@theme/badges/ScalePlanFeatureBadge'

# アップグレード

ClickHouse Cloudを使用することで、パッチ適用やアップグレードを心配する必要はありません。定期的に修正、新機能、パフォーマンスの改善を含むアップグレードを展開しています。ClickHouseの新機能の完全なリストについては、[Cloudの変更ログ](/cloud/reference/changelog.md)をご覧ください。

:::note	
新しいアップグレードメカニズム「メイク・ビフォー・ブレイク」（MBB）を導入します。この新しいアプローチでは、アップグレード操作中に古いレプリカを削除する前に、更新されたレプリカを追加します。これにより、実行中のワークロードへの影響が少ない、よりシームレスなアップグレードが実現します。	

この変更の一環として、過去のシステムテーブルデータは、アップグレードイベントの一環として最大30日間保持されます。さらに、AWSまたはGCPのサービスに関しては2024年12月19日以前のシステムテーブルデータ、Azureのサービスについては2025年1月14日以前のデータは、新しい組織階層への移行の一環として保持されません。
:::

## バージョンの互換性 {#version-compatibility}

サービスを作成する際、[`compatibility`](/operations/settings/settings#compatibility)設定は、サービスが初めてプロビジョニングされた時点でClickHouse Cloudで提供されている最も最新のClickHouseバージョンに設定されます。

`compatibility`設定を使用すると、以前のバージョンからの設定のデフォルト値を使用できます。サービスが新しいバージョンにアップグレードされると、`compatibility`設定で指定されたバージョンは変更されません。これにより、サービスを最初に作成したときに存在していた設定のデフォルト値は変更されないことになります（既にデフォルト値をオーバーライドしている場合は、アップグレード後もそれらの値は保持されます）。

サービスの`compatibility`設定を管理することはできません。`compatibility`設定のバージョンを変更したい場合は、[サポートに連絡してください](https://clickhouse.com/support/program)。

## メンテナンスモード {#maintenance-mode}

時には、サービスの更新が必要となる場合があり、その際にはスケーリングやアイドル状態のような特定の機能を無効にする必要があることがあります。稀に、問題が発生しているサービスに対してアクションを行い、正常な状態に戻す必要がある場合があります。そのようなメンテナンス中には、サービスページに「_メンテナンス進行中_」というバナーが表示されます。この時間中でもクエリのためにサービスを使用できる場合があります。

サービスがメンテナンス中の時間については料金が発生しません。_メンテナンスモード_は稀な事態で、通常のサービスアップグレードと混同しないでください。

## リリースチャンネル（アップグレードスケジュール） {#release-channels-upgrade-schedule}

特定のリリースチャンネルに加入することで、ClickHouse Cloudサービスのアップグレードスケジュールを指定できます。

### ファストリリースチャンネル（早期アップグレード） {#fast-release-channel-early-upgrades}

<ScalePlanFeatureBadge feature="ファストリリースチャンネル"/>

定期的なアップグレードスケジュールに加えて、**ファストリリース**チャンネルを提供しており、サービスが通常のリリーススケジュールより早く更新を受け取ることができます。

具体的には、サービスは以下を受け取ります：

- 最新のClickHouseリリースを受け取る
- 新しいリリースがテストされる度により頻繁にアップグレードが行われる

Cloudコンソールでサービスのリリーススケジュールを以下のように変更できます：

<div class="eighty-percent">
![プランを選択](./images/fast_release.png)
</div>
<br/>

<div class="eighty-percent">
![プランを選択](./images/enroll_fast_release.png)
</div>
<br/>

この**ファストリリース**チャンネルは、重要でない環境で新機能をテストするのに適しています。**稼働時間と信頼性に厳しい要件を持つプロダクションワークロードには推奨されません。**

### レギュラーリリースチャンネル {#regular-release-channel}

リリースチャンネルやアップグレードスケジュールが設定されていないすべてのScaleおよびEnterpriseティアサービスには、レギュラーリリースの一環としてアップグレードが行われます。これはプロダクション環境に推奨されています。

レギュラーリリースチャンネルへのアップグレードは、通常**ファストリリースチャンネル**の2週間後に行われます。

:::note
ベーシックティアサービスは、ファストリリースチャンネルのすぐ後にアップグレードされます。
:::

## スケジュールされたアップグレード {#scheduled-upgrades}

<EnterprisePlanFeatureBadge feature="スケジュールされたアップグレード" linking_verb_are="true"/>

ユーザーはEnterpriseティアのサービスに対してアップグレードウィンドウを設定できます。

アップグレードのスケジュールを指定したいサービスを選択し、左メニューから`設定`を選択します。`スケジュールされたアップグレード`までスクロールしてください。

<div class="eighty-percent">
![スケジュールされたアップグレード](./images/scheduled_upgrades.png)
</div>
<br/>

このオプションを選択すると、データベースおよびクラウドのアップグレードの曜日/時間ウィンドウを選択できます。

<div class="eighty-percent">
![スケジュールされたアップグレード](./images/scheduled_upgrade_window.png)
</div>
<br/>
:::note
スケジュールされたアップグレードは定義されたスケジュールに従いますが、重大なセキュリティパッチや脆弱性修正については例外が適用されることがあります。緊急のセキュリティ問題が特定された場合、スケジュール外でのアップグレードが行われることがあります。このような例外については、必要に応じて顧客に通知されます。
:::
