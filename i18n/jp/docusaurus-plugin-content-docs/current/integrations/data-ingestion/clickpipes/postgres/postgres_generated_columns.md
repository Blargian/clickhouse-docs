---
title: 'Postgres Generated Columns: Gotchas and Best Practices'
slug: '/integrations/clickpipes/postgres/generated_columns'
description: 'Page describing important considerations to keep in mind when using
  PostgreSQL generated columns in tables that are being replicated'
---



PostgreSQLの生成カラムを含むテーブルをレプリケーションする際には、いくつかの重要な考慮事項があります。これらの注意点は、レプリケーションプロセスや、宛先システムにおけるデータの整合性に影響を及ぼす可能性があります。

## 生成カラムの問題 {#the-problem-with-generated-columns}

1. **`pgoutput`を介して公開されない:** 生成カラムは、`pgoutput`論理レプリケーションプラグインを通じて公開されません。これは、PostgreSQLから別のシステムにデータをレプリケートする際に、生成カラムの値がレプリケーションストリームに含まれないことを意味します。

2. **主キーに関する問題:** 生成カラムが主キーの一部である場合、宛先での重複排除に問題を引き起こす可能性があります。生成カラムの値はレプリケートされないため、宛先システムは行を適切に識別し、重複を排除するために必要な情報を持っていません。

## ベストプラクティス {#best-practices}

これらの制限を回避するために、次のベストプラクティスを考慮してください。

1. **宛先で生成カラムを再作成:** レプリケーションプロセスに生成カラムの処理を任せるのではなく、dbt（data build tool）や他のデータ変換メカニズムを使用して、宛先でこれらのカラムを再作成することをお勧めします。

2. **主キーに生成カラムを使用しない:** レプリケートされるテーブルを設計する際には、生成カラムを主キーの一部として含めない方が良いです。

## 今後のUIの改善 {#upcoming-improvements-to-ui}

今後のバージョンでは、ユーザーを支援するためにUIを追加する予定です。

1. **生成カラムを持つテーブルの特定:** UIには、生成カラムを含むテーブルを特定する機能が追加されます。これにより、ユーザーはどのテーブルがこの問題の影響を受けているかを理解しやすくなります。

2. **ドキュメントとベストプラクティス:** UIには、レプリケートテーブルで生成カラムを使用するためのベストプラクティスが含まれ、一般的な落とし穴を避けるためのガイダンスが提供されます。
